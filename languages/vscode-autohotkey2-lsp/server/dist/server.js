(()=>{var e={6169:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.update_comment_tags=t.is_line_continue=t.check_same_name_error=t.make_same_name_error=t.get_detail=t.traverse_include=t.update_include_cache=t.get_callinfo=t.find_symbols=t.find_symbol=t.join_types=t.generate_type_annotation=t.decltype_returns=t.decltype_invoke=t.decltype_expr=t.find_class=t.get_class_constructor=t.get_class_members=t.get_class_member=t.get_class_base=t.parse_include=t.find_include_path=t.Lexer=t.allIdentifierChar=t.SUPER=t.THIS=t.VARREF=t.STRING=t.ANY=t.isIdentifierChar=t.FuncNode=t.SymbolNode=t.SemanticTokenModifiers=t.SemanticTokenTypes=t.FuncScope=void 0;const i=n(7147),o=n(1017),r=n(2374),s=n(8952),a=n(7237),c=n(4780),l=n(7994),u=n(3939);var d,f,p,h,m,g;function y(e){return!(e<48)&&(e<58||!(e<65)&&(e<91||(e<97?95===e:e<123||e>127)))}!function(e){e[e.DEFAULT=0]="DEFAULT",e[e.STATIC=1]="STATIC",e[e.GLOBAL=2]="GLOBAL"}(d||(t.FuncScope=d={})),function(e){e[e.class=0]="class",e[e.function=1]="function",e[e.method=2]="method",e[e.parameter=3]="parameter",e[e.variable=4]="variable",e[e.property=5]="property",e[e.keyword=6]="keyword",e[e.string=7]="string",e[e.number=8]="number",e[e.operator=9]="operator"}(f||(t.SemanticTokenTypes=f={})),function(e){e[e.static=1]="static",e[e.readonly=2]="readonly",e[e.definition=4]="definition",e[e.defaultLibrary=8]="defaultLibrary",e[e.deprecated=16]="deprecated"}(p||(t.SemanticTokenModifiers=p={})),function(e){e.create=function(e,t,n,i,o){return{name:e,kind:t,range:n,selectionRange:i,children:o}}}(h||(t.SymbolNode=h={})),function(e){e.create=function(e,t,n,i,o,r,s){let a="",c=!1,l=!1,u=[];o.format?.(o);for(let e of o)u.push(a.length),a+=`, ${e.pass_by_ref?(c=!0,++u[u.length-1],"&"):""}${e.name}${e.defaultVal?` := ${e.defaultVal}`:null===e.defaultVal?"?":e.arr?(l=!0,"*"):""}`;return{assume:d.DEFAULT,static:s,variadic:l,children:r,hasref:c,name:e,kind:t,range:n,selectionRange:i,params:o,param_offsets:u,param_def_len:a.length||2,full:`${s?"static ":""}${e}(${a.substring(2)})`,declaration:{},global:{},local:{},labels:{}}}}(m||(t.FuncNode=m={})),function(e){e.create=function(e,t,n){return{name:e,kind:t,range:n,selectionRange:{...n}}}}(g||(g={})),t.isIdentifierChar=y,String.prototype.trim=function(){return this.replace(/^[ \t\r\n]+|[ \t\r\n]+$/g,"")},String.prototype.trimLeft=function(){return this.replace(/^[ \t\r\n]+/,"")},String.prototype.trimRight=function(){return this.replace(/[ \t\r\n]+$/,"")};const _=new RegExp(/['"\s](c|background|#)?((0x)?[\da-f]{6}([\da-f]{2})?|(black|silver|gray|white|maroon|red|purple|fuchsia|green|lime|olive|yellow|navy|blue|teal|aqua))\b/i),b=JSON.parse('{ "black": "000000", "silver": "c0c0c0", "gray": "808080", "white": "ffffff", "maroon": "800000", "red": "ff0000", "purple": "800080", "fuchsia": "ff00ff", "green": "008000", "lime": "00ff00", "olive": "808000", "yellow": "ffff00", "navy": "000080", "blue": "0000ff", "teal": "008080", "aqua": "00ffff" }'),v=" \t\r\n",k="+ - * / % & ++ -- ** // = += -= *= /= //= .= == := != !== ~= > < >= <= >>> >> << >>>= >>= <<= && &= | || ! ~ , ?? ??= : ? ^ ^= |= =>".split(" "),T="try,throw,return,global,local,static,if,switch,case,for,while,loop,continue,break,goto".split(","),R=T.concat(["class","in","is","isset","contains","else","until","catch","finally","and","or","not","as","super"]),S={BlockStatement:"BlockStatement",Statement:"Statement",ObjectLiteral:"ObjectLiteral",ArrayLiteral:"ArrayLiteral",Conditional:"Conditional",Expression:"Expression"},w=/^(alttab|alttabandmenu|alttabmenu|alttabmenudismiss|shiftalttab|shift|lshift|rshift|alt|lalt|ralt|control|lcontrol|rcontrol|ctrl|lctrl|rctrl|lwin|rwin|appskey|lbutton|rbutton|mbutton|wheeldown|wheelup|wheelleft|wheelright|xbutton1|xbutton2|(0*[2-9]|0*1[0-6]?)?joy0*([1-9]|[12]\d|3[12])|space|tab|enter|escape|esc|backspace|bs|delete|del|insert|ins|pgdn|pgup|home|end|up|down|left|right|printscreen|ctrlbreak|pause|scrolllock|capslock|numlock|numpad0|numpad1|numpad2|numpad3|numpad4|numpad5|numpad6|numpad7|numpad8|numpad9|numpadmult|numpadadd|numpadsub|numpaddiv|numpaddot|numpaddel|numpadins|numpadclear|numpadleft|numpadright|numpaddown|numpadup|numpadhome|numpadend|numpadpgdn|numpadpgup|numpadenter|f1|f2|f3|f4|f5|f6|f7|f8|f9|f10|f11|f12|f13|f14|f15|f16|f17|f18|f19|f20|f21|f22|f23|f24|browser_back|browser_forward|browser_refresh|browser_stop|browser_search|browser_favorites|browser_home|volume_mute|volume_down|volume_up|media_next|media_prev|media_stop|media_play_pause|launch_mail|launch_media|launch_app1|launch_app2|vk[a-f\d]{1,2}(sc[a-f\d]+)?|sc[a-f\d]+|`[;{]|[\x21-\x7E])$/i,C={type:"",content:"",offset:0,length:0,topofline:0,next_token_offset:-1},D={collapse:2,expand:1,none:0},x={start:{line:0,character:0},end:{line:0,character:0}},E=["__NEW","__INIT","__ITEM","__ENUM","__GET","__CALL","__SET","__DELETE"];t.ANY=j("Any");const O=j("Float",r.SymbolKind.Number),K=j("Integer",r.SymbolKind.Number),P=j("Number",r.SymbolKind.Number);t.STRING=j("String",r.SymbolKind.String);const A=j("Array",r.SymbolKind.Class,"Array"),N=j("Object",r.SymbolKind.Class);t.VARREF=j("VarRef",r.SymbolKind.Class,"Any"),t.THIS={def:!0,detail:l.completionitem._this(),is_param:!0,kind:r.SymbolKind.Variable,name:"this",range:x,selectionRange:x},t.SUPER={...t.THIS,name:"super",detail:l.completionitem._super()},t.allIdentifierChar=new RegExp("^[^\0-/:-@[-^`{-]+$");let M=new RegExp("^;;\\s*(?<tag>.+)");const I={ANY:t.ANY,OBJECT:N,STRING:t.STRING,NUMBER:P,INTEGER:K,FLOAT:O,CLASS:t.ANY,FUNC:t.ANY,REGEXMATCHINFO:t.ANY},L={ANY:t.ANY,ARRAY:A,FLOAT:O,INTEGER:K,NUMBER:P,OBJECT:N,STRING:t.STRING,VARREF:t.VARREF,UNSET:j("unset",r.SymbolKind.Null)};class q{message;token;constructor(e,t){this.message=e,this.token=t}}class F{actionwhenv1;actived=!1;beautify;checkmember;children=[];d=0;d_uri="";declaration={};diagnostics=[];diags=0;last_diags=0;dlldir=new Map;dllpaths=[];document;find_token;foldingranges=[];fsPath="";get_token;include={};includedir=new Map;isparsed=!1;labels={};libdirs=[];linepos={};maybev1;object={method:{},property:{}};parseScript;scriptdir="";scriptpath="";STB=new r.SemanticTokensBuilder;symbolInformation;texts={};typedef={};tokenranges=[];tokens={};uri="";workspaceFolder="";hotstringExecuteAction=!1;constructor(e,n,o=0){let _,b,O,K,j,U,V,B,H,G,z,X,J,Q,Z,ee,te,ne,ie,oe,re,ce,le,ue,de,fe,pe,he,me,_e,be,ve,ke,Te,Re=this,Se=!0,we=!0,Ce=!1,De=u.isahk2_h,xe=!1,Ee=!1,Oe=!1,Ke=a.URI.parse(e.uri);const Pe={TK_START_EXPR:function(){tt()&&(oe.last_word="_"),(ut()||X&&!ye(pe.previous_token??C,pe))&&ze(null);let e=S.Expression;if("("!==he){if(pe.ignore)return Qe(e),ke="("!==pe.previous_token?.content,void Ye();if(pe.topofline<1&&Y(pe.previous_token??C))return Qe(e),re.indentation_level=rt(),Ye(),oe.indentation_level=re.indentation_level+1,void(le.space_in_paren&&(ke=!0));(!X&&pe.previous_token?.callsite||"TK_RESERVED"===be)&&(ke=!0),e=S.ArrayLiteral}else pe.ignore?ze(!0):"TK_END_EXPR"===be||"TK_WORD"===be?ke=v.includes(pe.prefix_is_whitespace||"\0"):"TK_STRING"===be?ke=!0:"TK_RESERVED"===be&&(ke=!ve.match(/^(break|continue|goto)$/i)&&(["if","for","while","loop","case","catch","switch"].includes(ve)?Boolean(le.space_before_conditional):fe));if(et()||(X&&le.preserve_newlines?ze(!0):"TK_EQUALS"!==be&&"TK_COMMA"!==be&&"TK_OPERATOR"!==be||Ge()),Qe(e),oe.indentation_level=re.indentation_level=rt(),Ye(),pe.ignore){let e=pe.data.content;e&&Ye(e)}else le.space_in_paren&&(ke=!0);Xe(),"["===he&&(oe.array_style??le.array_style)===D.expand&&ze(!0)},TK_END_EXPR:function(){for(;oe.mode===S.Statement;)Ze();if("]"===he&&oe.mode===S.ArrayLiteral){let e=oe.array_style??le.array_style;e===D.collapse||"["===ve?Be():(e||X&&le.preserve_newlines)&&ze(!0)}else("TK_END_EXPR"===be||"TK_END_BLOCK"===be)&&oe.indentation_level<oe.parent.indentation_level?Be():"TK_START_EXPR"!==be&&Ge();ke=Boolean(le.space_in_paren&&!("TK_START_EXPR"===be&&!le.space_in_empty_paren)),Ze(),He()&&ie.length>1&&re.indentation_level===oe.indentation_level&&Be(),Ye(),oe.mode!==S.BlockStatement&&(oe.indentation_level=(oe.parent??oe).indentation_level+1),K??=!1},TK_START_BLOCK:function(){if(pe.data)Qe(S.ObjectLiteral),oe.indentation_level=rt(),re.mode!==S.Conditional&&(re.indentation_level=oe.indentation_level),ke||=fe&&"TK_START_EXPR"!==be,Ye(),Xe(),(oe.object_style??le.object_style)===D.expand?ze(!0):ke=fe;else{let e=oe.had_comment;if(!["try","if","for","while","loop","catch","else","finally","switch"].includes(oe.last_word))for(;oe.mode===S.Statement;)Ze();oe.declaration_statement=!1,Qe(S.BlockStatement),ke??=fe,re.in_case_statement&&!e&&"TK_LABEL"===be&&/^(default)?:$/.test(ve)&&(oe.indentation_level--,oe.case_body=null,Be()),(0===le.brace_style||X&&le.preserve_newlines&&!le.brace_style)&&(void 0!==pe.in_expr&&oe.mode!==S.Expression||ze(!0));let t=!He();Ye(),re.indentation_level=Math.min(re.indentation_level,oe.indentation_level=rt()),le.switch_case_alignment&&"switch"===oe.last_word||Xe(),t||void 0!==le.brace_style?ze(!0):ke=fe}},TK_END_BLOCK:function(){for(;oe.mode===S.Statement;)Ze();let e=oe.mode===S.ObjectLiteral,t=e||void 0!==pe.in_expr;if(e){let e=oe.object_style??le.object_style;e===D.collapse||"{"===ve?Be():(e||X&&le.preserve_newlines)&&ze(!0),ke=fe&&"{"!==ve}else(void 0!==le.brace_style||X)&&ze(!0);Ze(),Ye(),t?oe.mode!==S.BlockStatement&&(oe.indentation_level=(oe.parent??oe).indentation_level+1):(null===re.case_body&&Xe(),void 0!==le.brace_style&&ze(!0),ke=fe)},TK_WORD:at,TK_RESERVED:at,TK_STRING:function(){if(tt()?X&&le.preserve_newlines?ze(!0):ke=oe.declaration_statement?"TK_OPERATOR"!==be:fe:"TK_RESERVED"===be||"TK_WORD"===be?X?ze():ke=!0:"TK_COMMA"===be||"TK_START_EXPR"===be||"TK_EQUALS"===be||"TK_OPERATOR"===be?et()||Ge():(X&&ze(),ke=!pe.ignore&&void 0===pe.data),pe.ignore){let e;if(ze(!0),le.ignore_comment&&he.trimLeft().startsWith("(")&&(e=he.indexOf("\n"))>0){let t=he.slice(0,e).trimRight().replace(/\s+;.*$/,"");he=/(^\s*\(|\s)c(om(ments?)?)?/i.test(t)?`${t}\n${he.slice(e+1).replace(/^\s*;.*\r?\n/gm,"").replace(/\s+;.*/gm,"")}`:`${t}\n${he.slice(e+1)}`}return Ye(),void(ie[ie.length-1].text=[he])}Ye()},TK_EQUALS:function(){tt(),ke=fe,Ye(),ke=fe},TK_OPERATOR:function(){let e=Boolean(fe||he.match(/^\w/)),t=e;if(pe.previous_token?.callsite&&(ke=!0),tt()){if(oe.declaration_statement&&me.match(/^(\+\+|--|%|!|~|not)$/))return ke=!0,oe.last_word="_",Ye(),void("not"===me&&(ke=!0))}else if("=>"===he)oe.mode===S.BlockStatement?Qe(S.Statement):Te&&oe.parent.mode===S.BlockStatement&&(Te=!1),Xe(),oe.in_fat_arrow=!0;else if(me.match(/^(\+\+|--|%|!|~|not)$/)&&ut())return ze(),Ye(),void("not"===me&&(ke=!0));return"TK_RESERVED"===be&&(ke=!0),"%"===he?(t=Boolean(void 0!==pe.previous_pair_pos&&" \t".includes(G.charAt(pe.offset+1)||"\0")),ke||=Boolean(pe.next_pair_pos&&" \t".includes(pe.prefix_is_whitespace||"\0")),X&&le.preserve_newlines&&oe.mode===S.Statement&&ye(pe.previous_token??C,pe)&&ze(!0),Ye(),void(ke=t)):":"===he&&(oe.in_case||oe.mode===S.Statement&&oe.parent.in_case)?(oe.in_case||Ze(),Xe(),Ye(),nt("\n")?ze():ke=fe,oe.in_case=!1,oe.case_body=!0,Qe(S.Statement),oe.case_body=!0,void(_e="TK_LABEL")):(X&&le.preserve_newlines?ze(!0):"TK_OPERATOR"!==be||ve.match(/^(--|\+\+|%|!|~|not)$/)||Ge(),["--","++","!","~"].includes(he)||"-+".includes(he)&&(["TK_START_BLOCK","TK_START_EXPR","TK_EQUALS","TK_OPERATOR","TK_COMMA","TK_RESERVED"].includes(be)||pe.previous_token?.callsite)?(t=!1,e="!"===he&&"TK_WORD"===be,ke||"++"!==he&&"--"!==he||!["TK_END_EXPR","TK_WORD"].includes(be)||(t=!0)):":"===he?oe.ternary_depth?(Ze(),oe.ternary_depth--):(e=!1,st()&&Be()):"?"===he?pe.ignore?(e=!1,t=Re.tokens[pe.next_token_offset]?.content.startsWith("?")??!1):(void 0===oe.ternary_depth?oe.ternary_depth=1:(oe.ternary_depth++,Xe()),Qe(S.Expression)):"."===he?t=e=!0:"&"===he?(("TK_WORD"!==be&&"TK_END_EXPR"!==be||pe.previous_token?.callsite)&&(t=!1),"TK_COMMA"!==be&&"TK_START_EXPR"!==be||(e=!1)):"*"===he&&(","===ve?t=!1:"TK_END_EXPR"===Re.tokens[pe.next_token_offset]?.type&&(e=t=!1)),ke||=e,Ye(),void(ke=t))},TK_COMMA:function(){(oe.mode===S.BlockStatement||oe.declaration_statement)&&(Qe(S.Statement),Xe()),"TK_WORD"===be&&v.includes(pe.prefix_is_whitespace||"\0")&&pe.previous_token?.callsite?X&&le.preserve_newlines?ze(!0):ke=!0:(ke=fe&&"TK_COMMA"===be||"for"===ve&&"TK_RESERVED"===be,oe.mode===S.Statement&&oe.parent.mode===S.ObjectLiteral&&Ze(),X&&le.preserve_newlines?ze(!0):He()||(X=!1));let e=st();e&&Be(),Ye(),e===D.expand?ze(!0):ke=fe},TK_BLOCK_COMMENT:function(){if(oe.mode===S.Statement){let e=Re.tokens[pe.previous_token?.next_token_offset];e&&(oe.in_expression||ye(e.previous_token??C,e))?oe.had_comment<2&&Be():ze()}if(le.ignore_comment)return;let e=he.split("\n"),t=/^\/\*\*(?!\/)/.test(he),n="";t||(n=new RegExp(`^${G.substring(G.lastIndexOf("\n",pe.offset)+1,pe.offset)}`)),ze(!0),Ye(e[0].trimRight());for(let i=1,o=e.length-1;i<o;i++)ze(!0),Ye(t?e[i].replace(/^(\s*(\*?\s*(?=@)|\* ?))?/," * "):e[i].trimRight().replace(n,""));e.length>1&&(ze(!0),Ye((t?" ":"")+e.at(-1).trim())),ze(!0),oe.had_comment=3},TK_INLINE_COMMENT:function(){if(ct(he),le.ignore_comment)return;let e;He()&&ie.length>1&&ie.pop(),ie[ie.length-1].text.push(le.white_space_before_inline_comment||((e=pe.previous_token)?G.substring(e.skip_pos??e.offset+e.length,pe.offset):"\t"),he),ze(!0),oe.had_comment=1},TK_COMMENT:function(){if(oe.mode===S.Statement){let e=Re.tokens[pe.previous_token?.next_token_offset];e&&(oe.in_expression||ye(e.previous_token??C,e))?oe.had_comment<2&&Be():ze()}ct(he),le.ignore_comment||(he.split("\n").forEach((e=>{ze(!0),Ye(e.trim())})),ze(!0),oe.had_comment=2)},TK_DOT:function(){tt(),Ge(")"===oe.last_text&&le.break_chained_methods),Ye()},TK_HOT:lt,TK_SHARP:lt,TK_NUMBER:function(){_e="TK_WORD",at()},TK_LABEL:function(){if(ze(null),"default:"===me&&(oe.in_case_statement||oe.mode===S.BlockStatement&&"switch"===oe.last_word))return oe.case_body?Je():oe.case_body=!0,Ye(),Xe(),oe.in_case=!1,oe.in_case_statement=!0,ke=fe,Qe(S.Statement),void(oe.case_body=!0);Ye();let e=ie.at(-1).text;""===e[0].trim()?ie[ie.length-1].text=e.slice(1):Xe()},TK_HOTLINE:lt,TK_UNKNOWN:function(){Ye(),1===Re.tokens[pe.next_token_offset]?.topofline&&ze()}};function Ae(e,t){le={max_preserve_newlines:1},fe=!0,de="\t",Ce=!0,ue="",delete t.format;for(let n of t){if(!n.range_offset)continue;let[t,i]=n.range_offset;for(be=ve="",ie=[{text:[],indent:0}],ke=!1,ce=[],oe=null,Qe(S.Expression),pe=e[e[t].next_token_offset];pe&&pe.offset<i;pe=e[pe.next_token_offset])_e=pe.type,he=pe.content,me=he.toLowerCase(),Pe[_e](),be=_e,oe.last_text=ve=me;n.defaultVal=ie.map((e=>e.text.join(""))).join("\n").trim()}Ce=!1,ie=[]}function Ne(){for(let e of Object.values(O))null===e.data&&/^[ \t]*\*?[ \t]*@typedef\s/m.test(e.content)&&We(Re,e.content,{})}function Me(e,t=!1,n=l.diagnostic.maybev1()){if(Ee)return!1;switch(Re.maybev1??=1,Re.actionwhenv1??u.extsettings.ActionWhenV1IsDetected){case"SkipLine":if(!t)return!1;if(Re.addDiagnostic(l.diagnostic.skipline(),e.offset,e.length,r.DiagnosticSeverity.Warning),"TK_WORD"===e.type)do{let e=G.indexOf("\n",te);e<0&&(e=z);let t=G.substring(te,e).trimLeft();t.length&&Ue(t,"TK_STRING",e-t.length,t.length,0),te=e}while(nt(","));return!0;case"SwitchToV1":if(!Re.actived)break;u.connection.console.info([Re.document.uri,n,l.diagnostic.tryswitchtov1()].join(" ")),n="",(0,u.setTextDocumentLanguage)(Re.document.uri)&&(Re.actionwhenv1="SwitchToV1");break;case"Continue":return!1;case"Warn":if(!Re.actived)break;u.connection.window.showWarningMessage(`file: '${Re.fsPath}', ${n}`,{title:l.action.switchtov1(),action:"SwitchToV1"},{title:l.action.skipline(),action:"SkipLine"},{title:l.action.stopparsing(),action:"Stop"}).then((e=>{"Stop"!==(Re.actionwhenv1=e?.action??"Continue")&&("SwitchToV1"===Re.actionwhenv1?(0,u.setTextDocumentLanguage)(Re.document.uri):Re.update())}))}throw Re.clear(),te=z,new q(n,e)}function Ie(e=0,n=Re,i=""){const o=[],s=Re.document,a=Re.tokens;let k,R,S,w,D,A=Re.tokens[te-1]??C,M=A.previous_token??C,I=0,L=!0,q="",F=[],$=[],U=j,V=xe;return we=!0,0!==e&&(F.push(te-1),delete A.data),j=n,xe=!1,X(),j=U,xe=V,"TK_EOF"===A.type&&I>(0===e?0:-1)?Re.addDiagnostic(l.diagnostic.missing("}"),F[I-(0===e?1:0)],1):void 0!==D&&Re.addFoldingRange(D,M.offset,"region"),o;function B(){if("("!==G.charAt(A.offset+A.length))return!1;let e=M,t=A,n=Z,i=te,o="",r=0,s=A.topofline>0,a="";for(we=!1;ke();)if("("===(o=A.content))r++;else if(")"===o&&!--r){ke(),a=A.content;break}return M=e,A=t,Z=n,te=i,L=!0,"=>"===a||s&&"{"===a}function H(e){let i=e.op_type??=o(e);return(i>=0&&(1===e.topofline||!Y(e.previous_token))||i<=0&&!function(i){switch(i?.type){case"TK_START_BLOCK":case"TK_START_EXPR":case"TK_NUMBER":case"TK_STRING":return!0;case"TK_WORD":return 1!==i.topofline||!t.allIdentifierChar.test(e.content)||!n.ranges;case"TK_RESERVED":return/^(class|isset|throw|super)$/.test(i.content.toLowerCase());case"TK_OPERATOR":return-1===(i.op_type??=o(i));case"TK_END_EXPR":case"TK_EOF":if(e.op_type<1&&"*"===e.content)return e.op_type=1;default:return!1}}(Re.get_token(e.offset+e.length,!0)))&&Re.addDiagnostic(l.diagnostic.missingoperand(),e.offset,e.length),e.op_type;function o(e){switch(e.content.toLowerCase()){case"!":case"~":case"not":return-1;case"%":return void 0===e.previous_pair_pos?-1:1;case"&":case"+":case"-":return e.topofline<1&&Y(e.previous_token??C)?0:-1;case"++":case"--":return Y(e)?1:-1;case":":return 0;case"?":return e.ignore?1:0;case"*":if(",([".includes(e.previous_token?.content??"\0")&&",),]()[]".includes(e.previous_token.content+(Re.get_token(e.offset+1,!0).content||"\0")))return-1;default:return 0}}}function X(c=0){for("TK_START_BLOCK"===A.type&&(delete A.data,ke(),L=!1,A.topofline||M.topofline||Re.addDiagnostic(l.diagnostic.unexpected(A.content),A.offset,A.length));we=!0,ke();){let u;if(1===A.topofline){let n;R=A.offset,2===e?"TK_RESERVED"!==A.type&&t.allIdentifierChar.test(A.content)&&(A.type="TK_WORD",delete A.semantic):(n=nt(":"))&&($.length&&"default"===A.content.toLowerCase()&&":"===Re.get_token(n).content||n===te&&v.includes(G.charAt(te+1))&&t.allIdentifierChar.test(A.content)&&(!$.length||"case"!==A.content.toLowerCase()))&&((u=a[n])&&((A.next_token_offset=u.next_token_offset)>0&&(a[u.next_token_offset].previous_token=A),delete a[n]),A.content+=":",A.length=(te=n+1)-A.offset,A.type="TK_LABEL",delete A.semantic,R=void 0)}switch(A.type){case"TK_EOF":return;case"TK_WORD":if(A.topofline>0&&!A.ignore){let t=B();if(ke(),t||!De||2===e||1!==M.topofline||A.topofline||"TK_WORD"!==A.type||"macro"!==M.content.toLowerCase()||(A.topofline=1,(t=B())?ke():A.topofline=0),t){let t,a,c=M,u=o.length,d=M.semantic={type:2===e?f.method:f.function},h=ue(!0),g=2===c.topofline,y=g?c.previous_token?.offset:c.offset;if(R=void 0,/^\d/.test(a=c.content.toUpperCase())&&Re.addDiagnostic(l.diagnostic.invalidsymbolname(c.content),c.offset,c.length),h||(h=[],Re.addDiagnostic(l.diagnostic.invalidparam(),c.offset,A.offset+1-c.offset)),c.symbol=c.definition=t=m.create(c.content,2===e?r.SymbolKind.Method:r.SymbolKind.Function,r.Range.create(c.pos=s.positionAt(c.offset),{line:0,character:0}),$e(c.offset,c.length),h,void 0,g),0!==e&&(t.parent=n),ke()&&"=>"===A.content){let i=o.splice(u),r=e,a=n;e=2===e?3:1,n=t,t.returns=[te,0];let c=se(void 0,"return",1);o.push(t),n=a,e=r,t.range.end=s.positionAt(t.returns[1]=M.offset+M.length),Re.addFoldingRangePos(t.range.start,t.range.end,"line"),t.children=i,i.push(...c),Re.linepos[t.range.end.line]=y}else{if("{"!==A.content){Re.addDiagnostic(l.diagnostic.unexpected(A.content),A.offset,A.length);break}{let n=o.splice(u),r=A.offset;A.previous_pair_pos=y,o.push(t),t.children=n,n.push(...Ie(2===e?3:1,t,i)),t.range.end=s.positionAt(te),Re.addSymbolFolding(t,r)}}d.modifier=p.definition|p.readonly|g,(k=O[t.selectionRange.start.line])&&je(k.symbol=t,k),2===e&&(t.has_this_param=!0,t.full=`(${i.slice(0,-1)}) `+t.full,(Re.object.method[a]??=[]).push(t)),ve(t);break}if(2===e){if("["===G.charAt(M.offset+M.length)||A.content.match(/^(=>|\{)$/)){let t,a=M,c=o.length,u=[];if(R=void 0,"["===A.content&&(u=ue(!0,"]")??[],ke(),0===u.length&&Re.addDiagnostic(l.diagnostic.propemptyparams(),a.offset,M.offset-a.offset+1),!A.content.match(/^(=>|\{)$/))){Re.addDiagnostic(l.diagnostic.propdeclaraerr(),a.offset,a.length),L=!1;break}let d=2===a.topofline,h=d?a.previous_token?.offset:a.offset,y=a.symbol=r.DocumentSymbol.create(a.content,void 0,r.SymbolKind.Property,t=$e(a.offset,a.length),{...t});(k=O[y.selectionRange.start.line])&&je(k.symbol=y,k),y.parent=n,y.has_this_param=!0,y.static=d,y.children=o.splice(c);let _="";if(u.length){let e=m.create("",r.SymbolKind.Function,t,t,u);_=`[${e.full.slice(1,-1)}]`,y.local=e.local,y.declaration=e.declaration,y.param_offsets=e.param_offsets,y.children.unshift(...u);for(let t of y.params=u)e.local[q=t.name.toUpperCase()]??=e.declaration[q]=t;for(let t of y.children)(t.def||t.kind===r.SymbolKind.Function)&&(e.declaration[t.name.toUpperCase()]??=t)}if(y.full=`(${i.slice(0,-1)}) ${d?"static ":""}${a.content}${_}`,o.push(y),be(a,y),a.semantic={type:f.property,modifier:p.definition|d},"{"===A.content){let t,n,o,c,d=e,f=A.offset;for(A.previous_pair_pos=h,ke(),L=!1,e=1,"TK_END_BLOCK"!==A.type||M.topofline||A.topofline||Re.addDiagnostic(l.diagnostic.unexpected(A.content),A.offset,A.length);ke()&&"TK_END_BLOCK"!==A.type;)if(A.topofline&&/^[gs]et$/.test(c=A.content.toLowerCase())){let a;if(ke(),t=M,"=>"===A.content)o=m.create(c,r.SymbolKind.Function,$e(M.offset,te-M.offset),$e(M.offset,M.length),[...u]),e=3,o.returns=[te,0],o.parent=y,o.children=se(void 0,"return",1),e=2,o.range.end=s.positionAt(o.returns[1]=M.offset+M.length),y.range.end=o.range.end,y.returns=o.returns,Re.addFoldingRangePos(o.range.start,o.range.end,"line"),"=>"===M.content&&Re.addDiagnostic(l.diagnostic.invaliddefinition("function"),t.offset,t.length),"set"===c?(o.params.unshift(a=g.create("Value",r.SymbolKind.Variable,r.Range.create(0,0,0,0))),a.is_param=a.assigned=a.def=!0,a.detail=l.completionitem.value()):y.returns=o.returns,o.has_this_param=!0,ve(o),Re.linepos[o.range.end.line]=t.offset;else if("{"===A.content)o=m.create(c,r.SymbolKind.Function,$e(t.offset,te-t.offset),$e(t.offset,3),[...u]),n=A,o.parent=y,o.children=Ie(3,o,i),o.range.end=s.positionAt(te),"set"===c?(o.params.unshift(a=g.create("Value",r.SymbolKind.Variable,r.Range.create(0,0,0,0))),a.is_param=a.assigned=a.def=!0,a.detail=l.completionitem.value()):y.returns=o.returns,o.has_this_param=!0,ve(o),Re.addSymbolFolding(o,n.offset);else{if(o=void 0,Re.addDiagnostic(l.diagnostic.invalidprop(),A.offset,A.length),"}"===A.content){L=!1;break}{let e=0;for(;"TK_EOF"!==A.type;){if("{"===A.content)e++;else if("}"===A.content&&--e<0)break;ke()}L=!1}}o&&o!==(y[o.name]??=o)&&Re.addDiagnostic(l.diagnostic.dupdeclaration(),t.offset,t.length)}else{let e=0;for(Re.addDiagnostic(l.diagnostic.invalidprop(),A.offset,A.length),L=!1;ke();)if("{"===A.content)e++;else if("}"===A.content&&--e<0)break;L=!1}y.range.end=s.positionAt(te-1),e=d,Re.addSymbolFolding(y,f),y.get&&!y.set&&(a.semantic.modifier|=p.readonly)}else if("=>"===A.content){let n,i=te;e=3,n=m.create("get",r.SymbolKind.Function,t=$e(i,te-i),x,u),n.parent=y,y.get=n,y.returns=n.returns=[te,0],n.children=se(void 0,"return",1),e=2,y.range.end=n.range.end=s.positionAt(n.returns[1]=M.offset+M.length),Re.addFoldingRangePos(n.range.start,n.range.end,"line"),n.has_this_param=!0,ve(n),Re.linepos[y.range.end.line]=h,a.semantic.modifier|=p.readonly}break}A=M,M=C,L=!1,te=A.offset+A.length;let t=o.length,a=n;n=n.$property.__INIT;let c=ce("");n.children.push(...o.splice(t)),n=a,o.push(...c),c.forEach((e=>e.parent=a)),void 0!==R&&(Re.linepos[(M.pos??=s.positionAt(M.offset)).line]=R)}else ne(A),A=M,M=C,te=A.offset+A.length,ie(),void 0!==R&&(Re.linepos[(M.pos??=s.positionAt(M.offset)).line]=R);break}if(2===e){let e=o.length,t=n;n=n.$property.__INIT;let i=ce("");n.children.push(...o.splice(e)),n=t,o.push(...i),i.forEach((e=>e.parent=t))}else A.topofline?ie():(L=!1,o.push(...se())),void 0!==R&&(Re.linepos[(M.pos??=s.positionAt(M.offset)).line]=R);break;case"TK_SHARP":ae();break;case"TK_RESERVED":J();break;case"TK_START_BLOCK":2===e?Re.addDiagnostic(l.diagnostic.unexpected(A.content),A.offset,A.length):(I++,F.push(te-1));break;case"TK_END_BLOCK":if(--I>=0&&F.length){let e=F.pop();Re.addFoldingRange(A.previous_pair_pos=e,te-1),a[e].next_pair_pos=A.offset,1===A.topofline&&(Q=A.offset,_=!0)}if(I<c){if(0!==e||0!==c)return void(F.length&&void 0===A.previous_pair_pos&&(a[A.previous_pair_pos=F.at(-1)].next_pair_pos=A.offset));Re.addDiagnostic(l.diagnostic.unexpected("}"),A.offset,1),I=0,F.length=0}break;case"TK_END_EXPR":Re.addDiagnostic(l.diagnostic.unexpected(A.content),A.offset,1),R=void 0;break;case"TK_LABEL":if($.length&&"default:"===A.content.toLowerCase()){let e=$.pop();$.push(A.offset),e&&Re.addFoldingRange(e,M.offset,"case"),ke(),L=!1,A.topofline||=-1;break}if(2===e){Re.addDiagnostic(l.diagnostic.propdeclaraerr(),A.offset,A.length);break}A.symbol=S=h.create(A.content,r.SymbolKind.Field,$e(A.offset,A.length),$e(A.offset,A.length-1)),S.data=F.at(-1),o.push(S);let t=n.labels;t&&(q=A.content.toUpperCase().slice(0,-1),S.def=!0,t[q]?t[q][0].def?(Re.addDiagnostic(l.diagnostic.duplabel(),A.offset,A.length-1),t[q].splice(1,0,S)):t[q].unshift(S):t[q]=[S]),(k=O[S.selectionRange.start.line])&&je(S,k),(u=Re.get_token(te,!0)).topofline||Re.addDiagnostic(l.diagnostic.unexpected(u.content),u.offset,u.length);break;case"TK_HOTLINE":if(A.symbol=S=h.create(A.content,r.SymbolKind.Event,$e(A.offset,A.length),$e(A.offset,A.length-2)),S.range.end=s.positionAt(te-1),o.push(S),(k=O[S.selectionRange.start.line])&&je(S,k),0!==e&&Re.addDiagnostic(l.diagnostic.hotdeferr(),A.offset,A.length),A.ignore){for(;ke()&&A.ignore&&"TK_STRING"===A.type;);S.range.end=s.positionAt(M.offset+M.length),L=!1;break}W(A.content)||Re.addDiagnostic(l.diagnostic.invalidhotdef(),A.offset,A.length);break;case"TK_HOT":{0!==e?Re.addDiagnostic(l.diagnostic.hotdeferr(),A.offset,A.length):A.ignore||W(A.content)||Re.addDiagnostic(l.diagnostic.invalidhotdef(),A.offset,A.length);let t=h.create(A.content,r.SymbolKind.Event,$e(A.offset,A.length),$e(A.offset,A.length-2));(k=O[t.selectionRange.start.line])&&je(t,k),A.symbol=t,ke();let i,s=M;for(t.declaration={},o.push(t),t.global={},t.local={};"TK_SHARP"===A.type;)ae(),ke();if("{"===A.content)A.previous_pair_pos=s.offset,t.params=[i=g.create("ThisHotkey",r.SymbolKind.Variable,$e(0,0))],i.detail=l.completionitem.thishotkey(),t.children=Ie(1,t),t.range=$e(s.offset,te-s.offset),Re.addSymbolFolding(t,A.offset),ve(t);else if(A.topofline){if(ve(t),L=!1,A.type.startsWith("TK_HOT"))break;"TK_WORD"===A.type&&B()||(Me(s),Re.addDiagnostic(l.diagnostic.hotmissbrace(),s.offset,s.length)),L=!1}else{t.params=[i=g.create("ThisHotkey",r.SymbolKind.Variable,$e(0,0))],i.detail=l.completionitem.thishotkey();let a=n,c=e,u=A.content.toLowerCase(),d=o.length;n=t,e=1,"return"===u?t.children=se(void 0,"return"):["global","local","static"].includes(u)?(J(),t.children=o.splice(d)):(L=!1,re(null,s.offset),t.children=o.splice(d)),n=a,e=c,ve(t);let f=M.offset+M.length;for(;" \t".includes(G.charAt(f)||"\0");)f++;t.range=$e(s.offset,f-s.offset),Re.linepos[t.range.end.line]=s.offset}break}case"TK_UNKNOWN":Re.addDiagnostic(l.diagnostic.unknowntoken(A.content),A.offset,A.length);break;default:1===A.topofline&&(M!==C&&ye(M,A,n)?A.topofline=-1:M=C),L=!1,2===e?(Re.addDiagnostic(l.diagnostic.propdeclaraerr(),A.offset,A.length),se()):(o.push(...se()),void 0!==R&&(Re.linepos[(M.pos??=s.positionAt(M.offset)).line]=R))}}}function J(){let s,a=A.content.toLowerCase(),c=A.offset,h=M,g=te;if(we=!1,2===e){if(s=ot(),L=!1,te=g,A.type="TK_WORD",".[(".includes(G.charAt(A.offset+A.length))||s.content.match(/^(:=|=>|\{)$/))return;if("TK_EQUALS"===s.type||"class"!==a&&"static"!==a)return;s=void 0,L=!0,A.type="TK_RESERVED"}else if("%"===G.charAt(A.offset-1)||"%"===G.charAt(A.offset+A.length))return A.type="TK_WORD",L=!1,void(A.semantic={type:f.variable});switch(a){case"class":if(1!==A.topofline){L=!1,A.type="TK_WORD";break}let _,b="";if(ke(),A.topofline||"TK_RESERVED"!==A.type||(A.type="TK_WORD",2!==e&&Re.addDiagnostic(l.diagnostic.reservedworderr(A.content),A.offset,A.length)),!A.topofline&&"TK_WORD"===A.type){if(1&e&&Re.addDiagnostic(l.diagnostic.classinfuncerr(),A.offset,A.length),_=A,ke(),"extends"===A.content.toLowerCase())if(A=ot(),"TK_WORD"===A.type){for(b=A.content,_e(A,0,Re.children);te<z&&"."===G.charAt(te)&&(ot(),A=ot(),"TK_WORD"===A.type);)b+="."+A.content,be(A);"TK_WORD"===A.type&&ke()}else Re.addDiagnostic(l.diagnostic.unexpected(A.content),A.offset,A.length);if("TK_START_BLOCK"!==A.type){L=!1;break}A.previous_pair_pos=c,_.content.match(/^\d/)&&Re.addDiagnostic(l.diagnostic.invalidsymbolname(_.content),_.offset,_.length);let t=r.DocumentSymbol.create(_.content,void 0,r.SymbolKind.Class,x,$e(_.offset,_.length));_.symbol=_.definition=t,t.full=i+_.content,t.extends=b,t.uri=Re.uri,(k=O[t.selectionRange.start.line])&&je(t,k),t.prototype={...t,detail:void 0,property:t.$property={}},t.children=[],t.cache=[],t.property={},t.type_annotations=[t.full];let n=m.create("__Init",r.SymbolKind.Method,$e(0,0),$e(0,0),[],[],!0);return(t.property.__INIT=n).ranges=[],n.parent=t,n.full=`(${t.full}) static __Init()`,n=m.create("__Init",r.SymbolKind.Method,$e(0,0),$e(0,0),[],[]),(t.$property.__INIT=n).ranges=[],n.parent=t.prototype,n.full=`(${t.full}) __Init()`,t.children=Ie(2,t,i+_.content+"."),t.range=t.prototype.range=$e(c,te-c),_.semantic={type:f.class,modifier:p.definition|p.readonly},ve(t),Re.addSymbolFolding(t,A.offset),o.push(t),!0}L=!1,M.type="TK_WORD",te=M.offset+M.length,A=M,M=h;break;case"global":case"static":case"local":if(ke(),2===e&&!A.topofline&&t.allIdentifierChar.test(A.content)&&(A.type="TK_WORD"),A.topofline)2===e?Re.addDiagnostic(l.diagnostic.propdeclaraerr(),M.offset,M.length):"local"===a||o.some((e=>e.kind===r.SymbolKind.Variable))?Re.addDiagnostic(l.diagnostic.declarationerr(),M.offset,M.length):n.assume="static"===a?d.STATIC:d.GLOBAL;else if("TK_WORD"===A.type||"TK_RESERVED"===A.type){if(0===e){L=!1,"global"!==a&&Re.addDiagnostic(l.diagnostic.declarationerr(),M.offset,M.length);break}if(2===e&&"static"!==a){Re.addDiagnostic(l.diagnostic.propdeclaraerr(),M.offset,M.length),L=!1;break}if("([".includes(G.charAt(te))||Re.get_token(te,!0).content.match(/^(\{|=>)$/))A.topofline=2;else{let t,i=o.length,r=n;2===e&&(A.topofline=2,n=n.property.__INIT);let s=n;if(L=!1,t=ce("global"===a?"":a),"global"===a)t.forEach((e=>s.global[e.name.toUpperCase()]??=e));else if(2===e){s.children.push(...o.splice(i)),n=r;for(const e of t)e.static=!0,e.full=e.full.replace(") ",") static "),e.parent=r}else{let e="static"===a;t.forEach((t=>{s.local[t.name.toUpperCase()]??=t,t.static=e,t.decl=!0}))}o.push(...t)}}else"TK_EQUALS"===A.type&&(te=M.offset+M.length,M.type="TK_WORD",A=M,M=h,2!==e&&Re.addDiagnostic(l.diagnostic.reservedworderr(A.content),A.offset,A.length));L=!1;break;case"loop":if(2===e){s=Re.get_token(te),L=!1,A.type="TK_WORD",":="!==s.content&&Re.addDiagnostic(l.diagnostic.propdeclaraerr(),A.offset,A.length);break}ke(),"TK_COMMA"===A.type&&Me(M);let v,T=0,S=1,w="loop";if("TK_EQUALS"===A.type){te=M.offset+M.length,M.type="TK_WORD",A=M,M=h,L=!1,2!==e&&Re.addDiagnostic(l.diagnostic.reservedworderr(A.content),A.offset,A.length);break}if(2===e){Re.addDiagnostic(l.diagnostic.propdeclaraerr(),M.offset,M.length);break}if(h=M,(L=" \t,".includes(G.charAt(te)||"\0")&&"TK_WORD"===A.type&&["parse","files","read","reg"].includes(v=A.content.toLowerCase()))&&(T=1,S="parse"===v?3:2,A.type="TK_RESERVED",w+=" "+v,M.hover_word=A.hover_word=w,ke(),"TK_COMMA"===A.type&&ke()&&(A.topofline=0),L=!1),A.topofline&&"TK_COMMA"!==A.type||"TK_START_BLOCK"===A.type?T&&Re.addDiagnostic(l.diagnostic.acceptparams(w,`${T}~${S}`),h.offset,h.length):o.push(...se("{",w,T,S)),re(!1,c,!0))return;"TK_RESERVED"===A.type&&"until"===A.content.toLowerCase()&&(L=!0,R=A.offset,o.push(...se(void 0,"until",1)));break;case"for":{let t=[],n=[],i=0;for(nt("(")&&(s=ot());ke();)switch(A.type){case"TK_COMMA":i++;break;case"TK_RESERVED":if(!("class"===A.content.toLowerCase()&&1&e)){Re.addDiagnostic(l.diagnostic.reservedworderr(A.content),A.offset,A.length);break}A.type="TK_WORD";case"TK_WORD":let r=_e(A,0);r&&(r.def=r.assigned=!0,r.for_index=i,r.returns=t,r.data=n);break;case"TK_OPERATOR":return"in"===A.content.toLowerCase()?(t.push(A.offset+2),o.push(...le(void 0,void 0,"{")),t.push(M.offset+M.length),s&&(")"!==A.content?Re.addDiagnostic(l.diagnostic.missing(")"),s.offset,s.length):(L=!0,ke())),n.push(A.offset),re(!1,c,!0)||"TK_RESERVED"!==A.type||"until"!==A.content.toLowerCase()||(L=!0,R=A.offset,o.push(...se(void 0,"until",1))),void n.push(A.offset,i+1)):(Re.addDiagnostic(l.diagnostic.unknownoperatoruse(),A.offset,A.length),void(L=!1));default:L=!1;case"TK_END_EXPR":return void Re.addDiagnostic(l.diagnostic.unexpected(A.content),A.offset,A.length);case"TK_EQUALS":return void Re.addDiagnostic(l.diagnostic.reservedworderr(M.content),M.offset,M.length)}break}case"continue":case"break":case"goto":if(2===e){L=!1,A.type="TK_WORD",":="!==Re.get_token(te,!0).content&&Re.addDiagnostic(l.diagnostic.propdeclaraerr(),A.offset,A.length);break}if(ke(),xe||"goto"===a||Re.addDiagnostic(l.diagnostic.outofloop(),M.offset),"TK_COMMA"===A.type&&(Me(M),Re.addDiagnostic(l.diagnostic.unexpected(","),A.offset,1)),A.topofline)L=!1,"goto"===a&&Re.addDiagnostic(l.diagnostic.acceptparams(a,1),M.offset,M.length);else{if(t.allIdentifierChar.test(A.content))"TK_NUMBER"===A.type&&"goto"!==a?A.content.match(/[^\d]/)&&Re.addDiagnostic(l.diagnostic.unexpected(A.content),A.offset,A.length):(A.ignore=!0,A.type="TK_WORD",y(A),delete A.semantic),ke(),L=!1;else if("("===G.charAt(M.offset+M.length)){let e=[];pe("(",")",void 0,void 0,e),e.forEach((e=>{e.content.indexOf("\n")<0&&y({content:e.content.slice(1,-1),offset:e.offset+1,length:e.length-2,type:"",topofline:0,next_token_offset:-1})})),ke(),L=!1}else{if("TK_STRING"!==A.type){te=M.offset+M.length,M.type="TK_WORD",A=M,M=h,L=!1,Re.addDiagnostic(l.diagnostic.reservedworderr(A.content),A.offset,A.length);break}Re.addDiagnostic(l.diagnostic.unexpected(A.content),A.offset,A.length),ke(),L=!1}A.topofline||Re.addDiagnostic(l.diagnostic.unexpected(A.content),A.offset,A.length)}break;case"as":case"catch":case"else":case"finally":case"until":Re.addDiagnostic(l.diagnostic.unexpected(A.content),A.offset,A.length);break;case"super":if(3===e){if("("!==G[te]){let e=Re.get_token(te,!0);"TK_DOT"===e.type||"["===e.content||e.topofline&&A.topofline||Re.addDiagnostic(l.diagnostic.syntaxerror(A.content),A.offset,A.length)}}else Re.addDiagnostic(l.diagnostic.invalidsuper(),A.offset,A.length);A.type="TK_WORD",L=!1;break;case"case":if($.length&&A.topofline){let e=$.pop();$.push(A.offset),e&&Re.addFoldingRange(e,M.offset,"case"),ke(),L=!1,":"===A.content||A.topofline?(L=":"===A.content,Re.addDiagnostic(l.diagnostic.unexpected(A.content),A.offset,A.length)):(o.push(...se(":","case",1,20)),":"!==A.content?(Re.addDiagnostic(l.diagnostic.unexpected(A.content),A.offset,A.length),L=!1):(L=!0,ke(),L=!1,"TK_START_BLOCK"===A.type?A.previous_pair_pos=c:A.topofline||=-1))}else A.type="TK_WORD",Re.addDiagnostic(l.diagnostic.reservedworderr(A.content),A.offset,A.length);break;case"try":if(ke(),L=!1,"TK_COMMA"===A.type&&Me(M),re(!0,c),"TK_RESERVED"===A.type&&"else"!==A.content.toLowerCase()){for(;"catch"===A.content.toLowerCase();)L=!0,R=A.offset,ee();for(let e of["else","finally"])A.content.toLowerCase()===e&&(L=!0,R=A.offset,ke(),L=!1,re(!0,M.offset))}break;case"isset":he(G.charAt(A.offset+5));break;case"throw":if(u.ahk_version>=u.alpha_3){A.semantic={type:f.keyword},A.ignore=!0,A.type="TK_WORD",L=!1;break}default:if(s=it(),"TK_EQUALS"===s.type||s.content.match(/^([<>]=?|~=|&&|\|\||[.|?:^]|\*\*?|\/\/?|<<|>>|!?==?)$/))A.type="TK_WORD",te=g,Re.addDiagnostic(l.diagnostic.reservedworderr(A.content),A.offset,A.length);else if(M=A,A=s,L=!1,"return"===a||"throw"===a){"TK_COMMA"===A.type&&Me(M);let t=A.offset;o.push(...se(void 0,a)),1&e&&"return"===a&&t<=M.offset&&(n.returns??=[]).push(t,M.offset+M.length)}else if("switch"===a)if(o.push(...se("{",a,0,2)),"{"===A.content){A.previous_pair_pos=c,L=!0,F.push(te-1),$.push(0),X(++I);let e=$.pop();e&&Re.addFoldingRange(e,M.offset,"case"),ke(),L=!1}else Re.addDiagnostic(l.diagnostic.unexpected(A.content),A.offset,A.length);else"if"!==a&&"while"!==a||("TK_COMMA"===A.type&&Me(M),o.push(...se("{",a,1)),re(!1,c,"while"===a))}function y(e){let t=n.labels;if(t){t[a=e.content.toUpperCase()]??=[];let n=$e(e.offset,e.length);t[a].push(e.symbol=S=r.DocumentSymbol.create(e.content,void 0,r.SymbolKind.Field,n,n)),S.data=F.at(-1)}}}function ee(){let e,n,i=A.offset;if(R=i,M=n=A,e=it(),e.topofline||"("!==e.content?(A=e,e=void 0):A=it(),A.topofline||"TK_WORD"!==A.type&&!t.allIdentifierChar.test(A.content))e?(te=e.offset-1,Re.addDiagnostic(l.diagnostic.unexpected(A.content),A.offset,A.length)):(L=!1,A.topofline||"{"===A.content?re(null,i):Re.addDiagnostic(l.diagnostic.unexpected(A.content),A.offset,A.length));else{let o=[];if(L=!0,"as"!==A.content.toLowerCase()){for(;;){let e="";if("TK_WORD"!==A.type?Re.addDiagnostic(l.diagnostic.unexpected(A.content),A.offset,A.length):(_e(A),e+=A.content),M=A,A=it(),"TK_DOT"===A.type)for(ke();;){if("TK_WORD"===A.type)be(A),e+="."+A.content,ke();else{if("%"!==A.content)break;Re.addDiagnostic(l.diagnostic.unexpected(A.content),A.offset,A.length),pe("%","%"),ke(),e="@"}if("TK_DOT"!==A.type)break;ke()}if(!e.startsWith("@")&&o.push(e),","!==A.content)break;if(M=A,A=it(),!t.allIdentifierChar.test(A.content))break}if(e){if("{"===A.content)return Re.addDiagnostic(l.diagnostic.missing(")"),e.offset,1),re(null,i);if(")"===A.content)return ke(),L=!1,re(null,i)}else if("{"===A.content||A.topofline)return L=!1,re(null,i)}if("as"===A.content.toLowerCase())if(M=A,A=it(),L=!1,"TK_WORD"===A.type||t.allIdentifierChar.test(A.content))if("TK_WORD"!==A.type)Re.addDiagnostic(l.diagnostic.reservedworderr(A.content),A.offset,A.length),A.type="TK_WORD";else{let t=it();if(te=A.offset+A.length,t.topofline||"{"===t.content||e&&")"===t.content){let n=_e(A);n&&(L=!0,n.def=n.assigned=!0,!o.length&&o.push("Error"),n.type_annotations=o),e&&(")"===t.content?(te=t.offset+1,L=!0):Re.addDiagnostic(l.diagnostic.missing(")"),e.offset,1)),L&&(ke(),L=!1,re(null,i))}else Re.addDiagnostic(l.diagnostic.unexpected(n.content),n.offset,n.length),L=!1}else Re.addDiagnostic(l.diagnostic.unexpected(n.content),n.offset,n.length);else e&&(")"===A.content?(M=A,A=it()):Re.addDiagnostic(l.diagnostic.missing(")"),e.offset,1)),A.topofline?(L=!1,re(null,i)):Re.addDiagnostic(l.diagnostic.unexpected(A.content),A.offset,A.length)}}function ne(e){let t=e.previous_extra_tokens;t&&(t.i=0)}function ie(){let e,t="";if(L=!0,ke(),L=!1,(e=A.ignore&&"?"===A.content)&&(A=ot()),"TK_EQUALS"===A.type||/^(=[=>]?|\?\??|:)$/.test(A.content)||"TK_DOT"!==A.type&&!", \t\r\n".includes(t=G.charAt(M.offset+M.length))){let e,t;/^=>?$/.test(A.content)&&(e=A.content,t=A.offset),ne(A),A=M,M=C,L=!1,te=A.skip_pos??A.offset+A.length,o.push(...se(void 0,e,t))}else if("TK_DOT"===A.type){let n=_e(M);for(L=!0,e&&n&&(n.returns=null);ke();){if("TK_WORD"===A.type){if("%"===G.charAt(te));else if(be(A),ke(),":="===A.content)me(M);else if(A.ignore&&"?"===A.content&&(A=ot()),"TK_DOT"===A.type)continue;L=!1,"TK_EQUALS"!==A.type&&!"=??".includes(A.content||" ")&&", \t\r\n".includes(t=G.charAt(M.offset+M.length))?oe(r.SymbolKind.Method,t):o.push(...se())}else L=!1,o.push(...se());break}}else _e(M),oe(r.SymbolKind.Function,t)}function oe(e,t){let n,i,a,u=M,d={offset:u.offset,miss:[],comma:[],count:0,unknown:!1,name:u.content};if(","===t){if(e===r.SymbolKind.Function&&c.builtin_ahkv1_commands.includes(u.content.toLowerCase())&&Me(u,!0))return;Re.addDiagnostic(l.diagnostic.funccallerr(),A.offset,1)}if("TK_OPERATOR"!==(a=A.type)||A.content.match(/^(not|\+\+?|--?|!|~|%|&)$/i)||Re.addDiagnostic(l.diagnostic.unexpected(A.content),A.offset,A.length),u.paraminfo=d,i=se(void 0,void 0,void 0,void 0,d),o.push(...i),e===r.SymbolKind.Method&&(u.semantic=void 0),u.ignore||(u.semantic??={type:e===r.SymbolKind.Function?f.function:(d.method=!0,f.method)}),n=r.DocumentSymbol.create(u.content,void 0,e,$e(u.offset,M.offset+M.length-u.offset),$e(u.offset,u.length)),n.paraminfo=d,n.offset=u.offset,u.callsite=n,M===u){let e=G.indexOf("\n",u.offset);n.range.end=s.positionAt(e<0?z:e)}e===r.SymbolKind.Method&&me(u,!0),!b||!0!==b&&"TK_START_EXPR"!==a||Re.diagnostics.push({message:l.warn.callwithoutparentheses(),range:n.selectionRange,severity:r.DiagnosticSeverity.Warning})}function re(e,t,n=!1){let i=xe;if(xe||=n,we=!1,"TK_START_BLOCK"===A.type)A.previous_pair_pos=t,L=!0,F.push(te-1),X(++I),ke(),L="TK_RESERVED"===A.type&&"else"===A.content.toLowerCase();else{if("TK_RESERVED"===A.type&&T.includes(A.content.toLowerCase())){let t=A;if(L=!0,J())return e;t!==A&&(t!==M||L||A.topofline)||(t===A&&"TK_WORD"===t.type?ie():o.push(...se()))}else"TK_WORD"===A.type?ie():"TK_EOF"!==A.type&&(M=C,L=!1,o.push(...se()));void 0!==R&&(Re.linepos[(M.pos??=s.positionAt(M.offset)).line]=R),L="TK_RESERVED"===A.type&&"else"===A.content.toLowerCase()}if(xe=i,"boolean"==typeof e){if(e)L=!1;else if(L)return R=A.offset,ke(),L=!1,re(!0,M.offset),!0}else L=!1;return!1}function se(e,t,n=0,i=1,o){let r,s,a,c=[],u=0,d=0,f=o??{offset:0,count:0,comma:[],miss:[],unknown:!1};if(we=!1,L){let e=Re.get_token(te,!0);r=e.content?e.offset:te+1,"TK_COMMA"===e.type?f.miss.push(f.count++):e.topofline&&!ye(A,e)||(++f.count,s=e)}else r=A.content?A.offset:M.offset+M.length+1,"TK_COMMA"===A.type?f.miss.push(f.count++):A.topofline&&!ye(M,A)||(++f.count,s=A);for(;;){if(c.push(...le(void 0,0,e)),a??=A.offset,"TK_COMMA"===A.type)L=!0,++u,++f.count,"TK_COMMA"===M.type||"TK_START_EXPR"===M.type?f.miss.push(f.comma.length):"TK_OPERATOR"!==M.type||M.ignore||M.content.match(/(--|\+\+|%)/)||Re.addDiagnostic(l.diagnostic.unexpected(","),A.offset,1),f.comma.push(A.offset),o&&(A.paraminfo=o);else{if(A.topofline){L=!1;break}if(e===A.content)break;d!==te&&(Re.addDiagnostic(l.diagnostic.unexpected(A.content),A.offset,A.length),L=!1)}if(d===te&&(!K||A.length))break;d=te}if("="===t||"=>"===t){let e=Re.find_token(r),i=!0,o=Re.tokens;if(e.offset<a){for(;e&&e.offset<a;){if(!e.ignore&&"?"===e.content){i=!1;break}e=e.symbol?Re.find_token(Re.document.offsetAt(e.symbol.range.end),!0):o[e.next_pair_pos??e.next_token_offset]}i&&("="===t&&Me(o[s.next_token_offset]),Re.addDiagnostic(`${l.diagnostic.unexpected(t)}, ${l.diagnostic.didyoumean(":=").toLowerCase()}`,n,t.length))}}else t&&(u>=i||f.count-(A===s?1:0)<n)&&Re.addDiagnostic(l.diagnostic.acceptparams(t,i===n?n:`${n}~${i}`),r,M.offset+M.length-r);return"*"===M.content&&(f.unknown=!0,f.count--),c}function ae(){let t,n=!1,i=A.data??{content:"",offset:A.offset+A.length,length:0};switch(t=A.content.toLowerCase()){case"#dllload":n=!0;case"#include":case"#includeagain":qe(i.content.replace(/`;/g,";"),i,e,n);break;case"#dllimport":if(w=i.content.match(/^((\w|[^\x00-\x7f])+)/i)){let e,t=$e(i.offset,w[0].length),n=r.Range.create(0,0,0,0),s={t:"ptr",i:"int",s:"str",a:"astr",w:"wstr",h:"short",c:"char",f:"float",d:"double",I:"int64"},a=w[0],c=[],u="",d=0,f="i";De=!0,w=i.content.substring(w[0].length).match(/^\s*,[^,]+,([^,]*)/),w=w?.[1].replace(/\s/g,"").toLowerCase().replace(/i6/g,"I")??"";for(let t of w.replace(/^(\w*)[=@]?=/,((e,t)=>(f=t||f,""))))if("u"===t)u="u";else if(s[t])c.push(e=g.create(`p${++d}_${u+s[t]}`,r.SymbolKind.Variable,n)),e.defaultVal=null,u="";else{if(!e||"*"!==t&&"p"!==t)return void Re.addDiagnostic(l.diagnostic.invalidparam(),i.offset,i.length);e.name+="p",e=void 0}let p=m.create(a,r.SymbolKind.Function,t,t,c);p.type_annotations=["fd".includes(f)?"Float":"asw".includes(f)?"String":"Integer"],o.push(p)}break;case"#requires":t=i.content.toLowerCase(),De||=t.startsWith("autohotkey_h"),(w=t.match(/^\w+\s+v(1|2)/))&&("2"===w[1]?Ee=!0:(Re.maybev1=3,Me(i,!0,l.diagnostic.requirev1())||Re.addDiagnostic(l.diagnostic.unexpected(i.content),i.offset,i.length)));break;case"#hotif":0!==e?Re.addDiagnostic(l.diagnostic.invalidscope(A.content),A.offset,A.length):(void 0!==D&&Re.addFoldingRange(D,A.offset),ke(),L=!1,D=A.topofline?void 0:M.offset);break;case"#hotstring":t=i.content?.trim().toLowerCase()??"","nomouse"!==t&&"endchars"!==t&&(Re.hotstringExecuteAction=/x(?!0)/.test(t));break;default:t.match(/^#(if|hotkey|(noenv|persistent|commentflag|escapechar|menumaskkey|maxmem|maxhotkeysperinterval|keyhistory)\b)/i)&&!Me(A,!0)&&Re.addDiagnostic(l.diagnostic.unexpected(A.content),A.offset,A.length)}}function ce(i){let a,c,d=[];we=!1;e:for(;ke();){if(1===A.topofline&&!ye(M,A,n)){L=!1;break}switch(A.type){case"TK_WORD":if(a=M,ke(),"TK_EQUALS"===A.type){let r,u=A.content,f=te;"TK_DOT"===a.type?be(M):(r=_e(M,e,d))?(c=O[r.selectionRange.start.line])&&je(r,c):i&&Re.addDiagnostic(l.diagnostic.conflictserr(i,"built-in variable",M.content),M.offset,M.length),o.push(...le(void 0));let p=[f,M.offset+M.length];n.ranges?.push(p),r&&(":="===u||"??="===u&&(r.assigned??=1)?r.returns=p:r.cached_types=[".="===u?t.STRING:P],r.assigned??=!0,r.def=!0,r.range.end=s.positionAt(M.offset+M.length),r.def=!0)}else{if(2===e){let e=M,s=A,a=l.diagnostic.propnotinit(),c=_e(M,2,d);if(c.def=!1,"TK_DOT"===A.type)for(;ke()&&"TK_WORD"===A.type&&ke();){if("TK_EQUALS"===A.type){let e=te;be(M),o.push(...le()),n.ranges?.push([e,M.offset+M.length]);continue e}if("TK_DOT"!==A.type){if(A.topofline&&(t.allIdentifierChar.test(A.content)||"}"===A.content)){M=C,L=!1;break e}a=","!==A.content?l.diagnostic.propdeclaraerr():"";break}be(M)}else if(!i&&":"===A.content){let i,d=A.offset+1,p=M,h="",m=n,g=j.property.__INIT,y=g.children.length,_=!1;if(delete c.def,c.typed=!0,u.ahk_version<u.alpha_3&&Re.addDiagnostic(l.diagnostic.requireversion("2.1-alpha.3"),M.offset,M.length,r.DiagnosticSeverity.Warning),M=A,A=ot(),a="",t.allIdentifierChar.test(A.content))i=A,h+=A.content,ke();else if("TK_START_EXPR"===A.type){let e=o.length;n=g,_=!0,pe(A.content,"("===A.content?")":"]"),g.children.push(...o.splice(e)),n=m,ke()}else":="===A.content||"TK_COMMA"===A.type||A.topofline&&t.allIdentifierChar.test(A.content)?(Re.addDiagnostic(l.diagnostic.unexpected(A.content),A.offset,A.length),L=!1):a=l.diagnostic.propdeclaraerr();if(!a){for(;;)if("."===A.content&&"TK_OPERATOR"!==A.type)"TK_DOT"!==A.type&&Re.addDiagnostic(l.diagnostic.unexpected("."),A.offset,A.length),ke()&&"TK_WORD"===A.type&&(h+="."+A.content,be(A),ke());else{if("TK_START_EXPR"!==A.type||A.prefix_is_whitespace||!t.allIdentifierChar.test(M.content))break;{let e,t=o.length,i=M,s=A,a="TK_DOT"===M.previous_token?.type;if(n=g,_=!0,pe(A.content,"("===A.content?")":e="]"),g.children.push(...o.splice(t)),!e){let e=r.DocumentSymbol.create(i.content,void 0,a?r.SymbolKind.Method:r.SymbolKind.Function,$e(i.offset,te-i.offset),$e(i.offset,i.length));Object.assign(s.paraminfo??{},{name:i.content}),e.paraminfo=s.paraminfo,e.offset=i.offset,i.callsite=e,i.semantic??={type:a?f.method:f.function}}n=m,ke()}}if(i&&(A.previous_token===i&&/^([iu](8|16|32|64)|f(32|64)|[iu]ptr)$/i.test(i.content)?c.type_annotations=[/^f/i.test(i.content)?"Float":"Integer"]:"TK_WORD"===i.type&&_e(i,3,g.children)),c.type_annotations??=_||!h?["Any"]:[h],":="===A.content){g.ranges?.push([d,A.offset-1]),d=A.offset+2,o.push(...le()),n.ranges?.push([d,M.offset+M.length]);continue e}if("TK_COMMA"===A.type||A.topofline&&(t.allIdentifierChar.test(A.content)||"}"===A.content)&&!(L=!1)){g.ranges?.push([d,A.offset-1]);continue e}Re.addDiagnostic(l.diagnostic.propdeclaraerr(),p.offset,p.length),g.children?.splice(y),e=A.previous_token??C,s=A,c.def=!1}}if(a&&Re.addDiagnostic(a,M.offset,M.length),A.topofline&&t.allIdentifierChar.test(A.content)){M=C,L=!1;break e}A.topofline||"TK_COMMA"===A.type||(L=!1,M=e,A=s,te=A.offset+A.length,le(",")),L=!1;break}if("TK_COMMA"===A.type||A.topofline&&(!["TK_COMMA","TK_OPERATOR","TK_EQUALS"].includes(A.type)||A.content.match(/^(!|~|not)$/i))){let t=_e(M,e,d);if(t?(c=O[t.selectionRange.start.line])&&je(t,c):i&&Re.addDiagnostic(l.diagnostic.conflictserr(i,"built-in variable",M.content),M.offset,M.length),"TK_COMMA"!==A.type)break e}}break;case"TK_COMMA":continue;case"TK_UNKNOWN":Re.addDiagnostic(l.diagnostic.unknowntoken(A.content),A.offset,A.length);break;case"TK_RESERVED":2!==e&&Re.addDiagnostic(l.diagnostic.reservedworderr(A.content),A.offset,A.length),L=!1,A.type="TK_WORD";break;case"TK_END_BLOCK":L=!1;break e;case"TK_END_EXPR":Re.addDiagnostic(l.diagnostic.unexpected(A.content),A.offset,1);default:break e}}return d}function le(i,a=1,c){let d,h=o.length,y=[],b=(L&&(ke(),L=!1),A.offset);for(we=!1;ke();){if(1===A.topofline){if(!(i&&","!==i||ye(M,A,n))){"TK_WORD"===M.type&&"."===G.charAt(M.offset-1)&&be(M),L=!1;break}M!==C&&(A.topofline=-1)}switch(A.type){case"TK_WORD":let T="."===G.charAt(A.offset-1);if("("===G.charAt(te))break;if(ke(),"TK_COMMA"===A.type){if(T)be(M);else if("%"!==G.charAt(M.offset-1)){let e=_e(M);e&&void 0!==d&&(e.def=e.assigned=!0,d?e.pass_by_ref=!0:e.cached_types=[P])}else M.ignore=!0;return L=!1,o.splice(h)}if("=>"===A.content){let t=o.length,s=M,l=e,u=te;e=1;let d=$e(s.offset,s.length),f=le(i,a||1,c??(y.length?":":void 0));e=l;let p=m.create("",r.SymbolKind.Function,$e(s.offset,M.offset+M.length-s.offset),$e(s.offset,0),[g.create(s.content,r.SymbolKind.Variable,d)],o.splice(t));p.children.push(...f),p.returns=[u,M.offset+M.length],0!==e&&(p.parent=n),ve(p),o.push(p);break}if(!("TK_OPERATOR"!==A.type||A.topofline&&A.content.match(/^(!|~|not|\+\+|--)$/i))){let e=!A.topofline&&["++","--"].includes(A.content);if("%"!==G.charAt(M.offset-1)&&"%"!==G.charAt(M.offset+M.length))if(T)be(M);else{let t=_e(M);t&&(void 0!==d&&(t.def=t.assigned=!0,d?t.pass_by_ref=!0:t.cached_types=[P]),e?(t.def=t.assigned=!0,t.cached_types=[P]):("??"===A.content||A.ignore)&&(t.returns=null))}else T?(me(M,null),A=M,M=A.previous_token??C,de(i),ke(),e||=!A.topofline&&["++","--"].includes(A.content)):M.ignore=!0;L=!1;continue}if(A.topofline&&"TK_EQUALS"!==A.type&&"TK_DOT"!==A.type){if(L=!1,T)"%"!==G.charAt(M.offset-1)?be(M):M.ignore=!0;else if("%"!==G.charAt(M.offset-1)){let e=_e(M);e&&void 0!==d&&(e.def=e.assigned=!0,d?e.pass_by_ref=!0:e.cached_types=[P])}else M.ignore=!0;return v(),o.splice(h)}if(T)(L="TK_EQUALS"===A.type)&&":="===A.content&&me(M),be(M);else{let e;if("%"!==G.charAt(M.offset-1)&&(e=_e(M)))if(d?e.def=e.pass_by_ref=e.assigned=!0:!1===d&&"TK_DOT"!==A.type&&(e.def=e.assigned=!0,e.cached_types=[P]),"TK_EQUALS"===A.type){(k=O[e.selectionRange.start.line])&&je(e,k);let n=A.content,r=te;L=!0,o.push(...le(i,a||1,c??(y.length?":":void 0))),e.range.end=s.positionAt(M.offset+M.length),":="===n||"??="===n&&(e.assigned??=1)?e.returns=[r,M.offset+M.length]:e.cached_types=[".="===n?t.STRING:P],e.assigned??=!0,e.def=!0}else L=!1,e.pass_by_ref&&"TK_DOT"===A.type&&Re.addDiagnostic(l.diagnostic.requirevariable(),M.previous_token.offset,1);else L=!1,M.ignore=!0}break;case"TK_START_EXPR":if("["===A.content)pe("[","]");else{let t,d,h,g=A.offset,b=!M.type||"("===G.charAt(M.offset+M.length),v=o.length,k=A,T={offset:A.offset,count:0,comma:[],miss:[],unknown:!1};if("TK_WORD"===M.type&&b){if("."===G.charAt(M.offset-1)){let e,t=M;pe("(",")",void 0,T),t.semantic={type:f.method},e=r.DocumentSymbol.create(t.content,void 0,r.SymbolKind.Method,$e(t.offset,te-t.offset),$e(t.offset,t.length)),Object.assign(k.paraminfo??{},{name:t.content,method:!0}),e.paraminfo=T,e.offset=t.offset,t.callsite=e,me(t,!0);continue}t=M}let R=!t||"%"!==G.charAt(t.offset-1)||void 0===t.previous_token?.previous_pair_pos;if(pe("(",")",void 0,T),d=te,R&&("=>"===(h=Re.get_token(te,!0)).content||!h.topofline&&"{"!==c&&"{"===h.content)){o.splice(v),M=(A=k).previous_token??C,te=A.offset+1;let b="=>"===h.content,T=(A.offset,ue(!0)),R=o.splice(v),S=t?t.offset:g;d=te,ke(),t&&(t.content.match(/^\d/)&&Re.addDiagnostic(l.diagnostic.invalidsymbolname(t.content),t.offset,t.length),t.semantic={type:f.function,modifier:p.definition|p.readonly}),T||(T=[],Re.addDiagnostic(l.diagnostic.invalidparam(),S,d-S));let w=m.create(t?.content??"",r.SymbolKind.Function,$e(S,0),$e(S,t?.length??0),T),D=n,x=e;n=w,e=1,t??=k,o.push(t.symbol=t.definition=w),b?(w.children=R,R.push(...le(i,t?.topofline?2:a||1,c??(y.length?":":void 0))),w.range.end=Re.document.positionAt(M.offset+M.length),w.returns=[h.offset+h.length,M.offset+M.length]):(u.ahk_version<u.alpha_3&&Re.addDiagnostic(l.diagnostic.requireversion("2.1-alpha.3"),t.offset,te-t.offset,r.DiagnosticSeverity.Warning),A.in_expr=S,w.children=R,R.push(...Ie(1,w)),w.range.end=s.positionAt(te),A=Re.tokens[A.next_pair_pos]??Re.find_token(te-1),A.in_expr=S,_=!1),n=D,e=x,Re.addFoldingRangePos(w.range.start,w.range.end,b?"line":void 0),0!==e&&(w.parent=n),ve(w)}else if(t)if("%"!==G.charAt(t.offset-1)||void 0===t.previous_token?.previous_pair_pos){let e;_e(t),t.semantic??={type:f.function},e=r.DocumentSymbol.create(t.content,void 0,r.SymbolKind.Function,$e(t.offset,d-t.offset),$e(t.offset,t.length)),Object.assign(k.paraminfo??{},{name:t.content}),e.paraminfo=T,e.offset=t.offset,t.callsite=e}else t.ignore=!0,delete t.semantic}break;case"TK_START_BLOCK":if(b<A.offset&&("TK_OPERATOR"!==M.type||1===M.op_type)&&"TK_EQUALS"!==M.type)return L=!1,v(),o.splice(h);{let e=Re.diagnostics.length,t=!1;if(A.offset,"TK_RESERVED"===M.type&&"switch"===M.content.toLowerCase()){let e;if(L=!1,A.topofline||(e=Re.get_token(te)).topofline||e.type.endsWith("COMMENT"))return v(),o.splice(h);L=t=!0}else"TK_EQUALS"===M.type?":=??=".includes(M.content)||Re.addDiagnostic(l.diagnostic.unknownoperatoruse(M.content),M.offset,M.length):1===a&&("TK_WORD"===M.type||"TK_OPERATOR"===M.type&&"=>"!==M.content||M.type.startsWith("TK_END"))&&(a=0);if(fe(a>0||t))break;return Re.diagnostics.splice(e),v(),L=!1,o.splice(h)}case"TK_NUMBER":case"TK_STRING":case"TK_EQUALS":break;case"TK_END_BLOCK":case"TK_END_EXPR":case"TK_COMMA":return L=!1,v(),o.splice(h);case"TK_LABEL":Re.addDiagnostic(l.diagnostic.unexpected(A.content),A.offset,A.length);break;case"TK_UNKNOWN":Re.addDiagnostic(l.diagnostic.unknowntoken(A.content),A.offset,A.length);break;case"TK_RESERVED":{let e=G.charAt(A.offset+A.length);if("%"===e||"%"===G.charAt(A.offset-1)){L=!1,A.type="TK_WORD",A.semantic={type:f.variable};break}if(/^(class|super|isset)$/i.test(A.content)){if("isset"===A.content.toLowerCase()&&he(e))break;L=!1,A.type="TK_WORD";break}if(u.ahk_version>=u.alpha_3&&"throw"===A.content.toLowerCase()){A.semantic={type:f.keyword},L=!1,A.type="TK_WORD",A.ignore=!0;break}Re.addDiagnostic(l.diagnostic.reservedworderr(A.content),A.offset,A.length);break}case"TK_OPERATOR":if("%"===A.content){let e=G.charAt(A.offset-1);if("%"===i)return L=!1,v(),o.splice(h);"."===e?(me(A,null),de()):pe("%","%")}else if("=>"===A.content&&"TK_WORD"===M.type){o.length&&o.at(-1).name===M.content&&o.pop();let t=m.create("",r.SymbolKind.Function,$e(M.offset,M.length),$e(M.offset,0),[g.create(M.content,r.SymbolKind.Variable,$e(M.offset,M.length))]);t.returns=[te,0],t.children=le(i,1,c??(y.length?":":void 0)),t.range.end=s.positionAt(t.returns[1]=M.offset+M.length),0!==e&&(t.parent=n),o.push(t),ve(t)}else{if(t.allIdentifierChar.test(A.content)&&("%"===G[A.offset-1]||"%"===G[A.offset+A.length])){L=!1,A.type="TK_WORD",A.semantic={type:f.variable};break}if(":"===A.content){if(void 0===y.pop()){if(":"===c)return L=!1,o.splice(h);Re.addDiagnostic(l.diagnostic.unexpected(":"),A.offset,1)}}else"?"===A.content&&(A.ignore||y.push(A.offset));if(-1===H(A)){if("&"===A.content){d=!0;continue}if(["++","--"].includes(A.content)){d=!1;continue}}}}d=void 0}return v(),o.splice(h);function v(){let e;for(;void 0!==(e=y.pop());)Re.addDiagnostic(l.diagnostic.missing(":"),e,1)}}function ue(e=!1,t=")"){let n,i=!0,s=te-1,a=[],c=[",",")"===t?"(":"["],u=!1,d=te,f=A,p=!1,h={offset:s,count:0,comma:[],miss:[],unknown:!1};for(we=!1,f.paraminfo=h,"TK_WORD"===M.type&&void 0===f.prefix_is_whitespace&&(h.name=M.content);ke();){if(1===A.topofline&&(A.topofline=-1),A.content===t){if("TK_COMMA"===M.type){if(e){Re.addDiagnostic(l.diagnostic.unexpected(t),A.offset,A.length);break}return A.previous_pair_pos=s,M.paraminfo=h,h.miss.push(h.count++),void o.push(...a)}break}if("TK_WORD"!==A.type){if(c.includes(M.content)){if("*"===A.content){let e,n=A;if(ke(),A.content===t){a.push(e=g.create("",r.SymbolKind.Variable,$e(n.offset,0))),e.arr=!0;break}Re.addDiagnostic(l.diagnostic.unexpected("*"),n.offset,1)}else if("&"===A.content){let e=A;if(A=it(),"TK_WORD"===A.type){u=!0,L=!1;continue}Re.addDiagnostic(l.diagnostic.unexpected("&"),e.offset,1)}i=!1;break}i=!1;break}if(ge(A.content.toLowerCase())){i=!1;break}if(h.count++,!c.includes(M.content)&&M!==C){i=!1,h.count--;break}if(ke(),","!==A.content&&A.content!==t){if(":="===A.content||e&&"="===A.content){"="===A.content&&(Me(M),Re.addDiagnostic(`${l.diagnostic.unexpected("=")}, ${l.diagnostic.didyoumean(":=").toLowerCase()}`,A.offset,A.length));let e=A;M.content.match(/^\d/)&&Re.addDiagnostic(l.diagnostic.invalidsymbolname(M.content),M.offset,M.length);let n=g.create(M.content,r.SymbolKind.Variable,$e(M.offset,M.length));if((k=O[n.selectionRange.start.line])&&!k.symbol&&je(n,k),n.def=!0,n.defaultVal=null,a.push(n),o.push(...le(",",2)),L=!0,d=te,f=A,M!==e){n.returns=[e.offset+e.length,M.offset+M.length],n.range.end=Re.document.positionAt(M.offset+M.length);let t=A.previous_token,i=[];for(;t&&t!==e;)i.unshift(t),t=t.previous_token;1===i.length?"unset"!==i[0].content.toLowerCase()&&(n.defaultVal=i[0].content):2===i.length&&"-+".includes(i[0].content)?n.defaultVal=`${i[0].content}${i[1].content}`:(n.range_offset=[e.offset,A.offset],p=!0)}if(u&&(u=!1,n.pass_by_ref=n.assigned=!0),"TK_COMMA"===A.type){h.comma.push(A.offset),A.paraminfo=h;continue}i=A.content===t;break}if("TK_OPERATOR"===A.type){if("*"===A.content){let e=M;if(ke(),A.content===t){let t=g.create(e.content,r.SymbolKind.Variable,$e(e.offset,e.length));a.push(t),t.arr=!0,h.unknown=!0,d=te,f=A;break}i=!1,h.count--;break}if("?"===A.content&&A.ignore){let e=M,n=g.create(M.content,r.SymbolKind.Variable,$e(M.offset,M.length));if(n.def=!0,n.defaultVal=null,a.push(n),u&&(u=!1,n.pass_by_ref=n.assigned=!0),ke(),"TK_COMMA"===A.type){e.content.match(/^\d/)&&Re.addDiagnostic(l.diagnostic.invalidsymbolname(e.content),e.offset,e.length),h.comma.push(A.offset),d=te,f=A;continue}(i=A.content===t)||(a.pop(),h.count--);break}i=!1,h.count--;break}if(e&&"TK_WORD"===M.type&&"byref"===M.content.toLowerCase()&&"TK_WORD"===A.type){Me(M),Re.addDiagnostic(l.diagnostic.deprecated("&","ByRef"),M.offset,A.topofline?M.length:A.offset-M.offset),L=!1,M=C;continue}i=!1,h.count--;break}{M.content.match(/^\d/)&&Re.addDiagnostic(l.diagnostic.invalidsymbolname(M.content),M.offset,M.length);let e=g.create(M.content,r.SymbolKind.Variable,$e(M.offset,M.length));if((k=O[e.selectionRange.start.line])&&e.selectionRange.start.line>(n??=Re.document.positionAt(s).line)&&je(e,k),u&&(u=!1,e.pass_by_ref=e.def=e.assigned=!0),a.push(e),d=te,f=A,","!==A.content)break;h.comma.push(A.offset),A.paraminfo=h}}return h.comma.forEach((e=>Re.tokens[e].paraminfo=h)),i?(p&&(a.format=Ae.bind(void 0,Re.tokens)),A.previous_pair_pos=s,Re.tokens[s].next_pair_pos=A.offset,Re.addFoldingRange(s,te,"block"),a):(o.push(...a),te=d,A=f,void pe(")"===t?"(":"[",t,s,h))}function de(e){for(L=!1,te=A.offset+A.length;ke();)switch(A.type){case"TK_OPERATOR":if("%"===A.content){if("%"===e)return L=!1;if(pe("%","%"),y(G.charCodeAt(te)))break;return}case"TK_NUMBER":if(!t.allIdentifierChar.test(A.content))return L=!1;case"TK_RESERVED":case"TK_WORD":if(A.type="TK_WORD",A.semantic={type:f.property},"%"===G.charAt(te))break;return;default:return L=!1}}function fe(e=!1){let n,i,s=M,c=A,u=o.length,d=!0,p={},h=[];for(we=!1,L=!0,A.data=N;d;)if(!m()||_()){if(e&&!d){for(i=M,d=!0;!",}".includes(A.content);)le("}",2),L=!0;if(L=!0,Re.addDiagnostic(l.diagnostic.objectliteralerr(),i.offset,M.offset+M.length-i.offset),","===A.content)continue}break}if(d||e)for(let e of h)(n=a[e]).type="TK_WORD",n.semantic={type:f.property};if(!d)return M=s,A=c,o.splice(u),te=A.skip_pos??A.offset+A.length,L=!1;if(":"!==M.content&&"TK_LABEL"!==M.type||Re.addDiagnostic(l.diagnostic.unexpected(A.content),A.offset,A.length),c.data=N,"TK_END_BLOCK"===A.type){if(Re.addFoldingRange(A.previous_pair_pos=c.offset,A.offset),c.next_pair_pos=A.offset,Object.keys(p).length){let e=r.DocumentSymbol.create("",void 0,r.SymbolKind.Class,x,x);c.data=e,e.property=p,e.name=e.full=e.extends=""}A.data=c.data}else Re.addDiagnostic(l.diagnostic.missing("}"),c.offset,1);return!0;function m(){for(;ke();)switch(n=void 0,1===A.topofline&&(A.topofline=-1),A.type){case"TK_OPERATOR":if("%"===A.content){if(pe("%","%"),y(G.charCodeAt(te)))break;return ke(),":"===A.content||(d=!1)}case"TK_NUMBER":if(!t.allIdentifierChar.test(A.content))return d=!1;case"TK_RESERVED":case"TK_WORD":if(h.push(A.offset),"%"===G.charAt(te))break;let e=M;return ke(),":"===A.content?("%"!==e.content&&(n=M),!0):d=!1;case"TK_STRING":return ke(),":"===A.content?(n={...M},n.content=n.content.slice(1,-1),n.offset++,n.length-=2,!De&&Re.addDiagnostic(l.diagnostic.invalidpropname(),M.offset,M.length),!0):d=!1;case"TK_LABEL":return A.content.match(/^(\w|[^\x00-\x7f])+:$/)?(n={...A},n.content=n.content.slice(0,-1),n.length--,!0):d=!1;case"TK_END_BLOCK":if("TK_START_BLOCK"===M.type||"TK_COMMA"===M.type)return!1;case"TK_START_EXPR":return d=!1;case"TK_COMMA":if("TK_COMMA"===M.type||"TK_START_BLOCK"===M.type)return!0;default:return d=!1}return!1}function _(){let e=A,t=le(",");return o.push(...t),n&&(be(n),(p[n.content.toUpperCase()]=g.create(n.content,r.SymbolKind.Property,$e(n.offset,n.length))).returns=[e.offset+1,M.offset+M.length]),"TK_COMMA"===A.type?!(L=!0):"TK_END_BLOCK"===A.type?L=!0:"TK_EOF"===A.type||!(d=!1)}}function pe(i,c,d,h,y){let b,v=0,T=o.length,R=te,S=M,w=[d??=A.offset],C=0,D=Re.tokens[d],x=[],E=h??{offset:d,count:0,comma:[],miss:[],unknown:!1},K=!1;if("%"!==i){let e=D.previous_token;D.paraminfo=E,(E.name||!D.topofline&&e&&void 0===D.prefix_is_whitespace&&(void 0!==(e.previous_pair_pos??e.in_expr)||"TK_WORD"===e.type||"TK_DOT"===e.type))&&(K=!0)}else D.op_type=-1;for(;ke();){if(A.topofline){if("%"===i&&(!["TK_COMMA","TK_OPERATOR","TK_EQUALS"].includes(A.type)||A.content.match(/^(!|~|not)$/i)))return Me(D),D.next_pair_pos=-1,Re.addDiagnostic(l.diagnostic.missing("%"),d,1),L=!1,void I();1===A.topofline&&(A.topofline=-1)}if("("!==i&&"("===A.content)T=o.length,R=te,C=1,S=M,pe("(",")");else if(A.content===c){if(a[A.previous_pair_pos=w.pop()].next_pair_pos=A.offset,"%"!==c?Re.addFoldingRange(A.previous_pair_pos,A.offset+1,"block"):A.op_type=1,--v<0)break;")"===c&&C++}else if(A.content===i){if("("===i){if(")"===G.charAt(A.offset-1)){pe("(",")");continue}T=o.length,R=te,C=0}v++,w.push(te-1),S=M}else if("=>"===A.content||1===C&&")"===M.content&&"{"===A.content){let t,i,a=o.splice(T),d=A,f=-1,p=A.content;if(")"===M.content){if(1!==C){Re.addDiagnostic(l.diagnostic.unknownoperatoruse(),A.offset,2),L=!0;continue}M=S,te=R-1,A=ot(),f=A.offset,a=[],t=ue(!0),t||(t=[],Re.addDiagnostic(l.diagnostic.invalidparam(),f,A.offset-f+1)),i=it()}else{if("TK_WORD"!==M.type||"."===G.charAt(M.offset-1)){Re.addDiagnostic(l.diagnostic.unknownoperatoruse(),A.offset,2),L=!0;continue}i=A,f=M.offset,t=[g.create(M.content,r.SymbolKind.Variable,$e(M.offset,M.length))]}if(i.content!==p){A=d,te=d.offset+d.length,L=!0,o.push(...a),Re.addDiagnostic(l.diagnostic.unexpected(A.content),A.offset,A.length);continue}a.push(...o.splice(T));let h=m.create("",r.SymbolKind.Function,$e(f,0),$e(f,0),t,a);Re.tokens[f].symbol=h,"=>"===i.content?(a.push(...le(c,1,x.length?":":void 0)),h.range.end=Re.document.positionAt(M.offset+M.length),h.returns=[i.offset+2,M.offset+M.length]):(u.ahk_version<u.alpha_3&&Re.addDiagnostic(l.diagnostic.requireversion("2.1-alpha.3"),R-1,te-R,r.DiagnosticSeverity.Warning),i.in_expr=f,a.push(...Ie(1,h)),h.range.end=s.positionAt(te),A=Re.tokens[A.next_pair_pos]??Re.find_token(te-1),A.in_expr=f,_=!1),0!==e&&(h.parent=n),T=o.length,o.push(h),ve(h),"=>"===p&&",:)]}".includes(A.content)&&(A.fat_arrow_end=!0)}else if("TK_WORD"===A.type)if("."!==G.charAt(A.offset-1))if("("!==G.charAt(te))if("%"===i||"%"!==G.charAt(A.offset-1)&&"%"!==G.charAt(A.offset+A.length)){let e=_e(A);if(e){if(ke(),L=!1,"TK_EQUALS"===A.type){(k=O[e.selectionRange.start.line])&&je(e,k);let n=A.content,i=te;L=!0,o.push(...le(c,2,x.length?":":void 0)),e.range.end=s.positionAt(M.offset+M.length),":="===n||"??="===n&&(e.assigned??=1)?e.returns=[i,M.offset+M.length]:e.cached_types=[".="===n?t.STRING:P],e.assigned??=!0,e.def=!0}else b||("TK_DOT"===A.type?b||=void 0:!A.topofline&&["++","--"].includes(A.content)&&(b=!1));void 0!==b?(e.def=e.assigned=!0,b?e.pass_by_ref=!0:e.cached_types=[P]):("??"===A.content||A.ignore&&"?"===A.content)&&(e.returns=null)}}else A.ignore=!0;else{M=A,A=ot();let t,i=M,a=A,d=o.length,h=ue(),g=te,y="%"!==G.charAt(i.offset-1)||void 0===i.previous_token?.previous_pair_pos;if(ke(),y&&((t="=>"===A.content)||"{"===A.content)){let a=n,g=te;h||Re.addDiagnostic(l.diagnostic.invalidparam(),i.offset,A.offset-i.offset+1);let y=m.create(i.content,r.SymbolKind.Function,$e(i.offset,te-i.offset),$e(i.offset,i.length),h||[]);i.content.match(/^\d/)&&Re.addDiagnostic(l.diagnostic.invalidsymbolname(i.content),i.offset,i.length),i.symbol=i.definition=n=y,t?((y.children=o.splice(d)).push(...le(c,2,x.length?":":void 0)),y.range.end=s.positionAt(M.offset+M.length),y.returns=[g,M.offset+M.length]):(u.ahk_version<u.alpha_3&&Re.addDiagnostic(l.diagnostic.requireversion("2.1-alpha.3"),i.offset,te-i.offset,r.DiagnosticSeverity.Warning),A.in_expr=i.offset,(y.children=o.splice(d)).push(...Ie(1,y)),y.range.end=s.positionAt(te),A=Re.tokens[A.next_pair_pos]??Re.find_token(te-1),A.in_expr=i.offset,_=!1),i.semantic={type:f.function,modifier:p.definition|p.readonly},n=a,0!==e&&(y.parent=n),ve(y),o.push(y),Re.addFoldingRangePos(y.range.start,y.range.end,t?"line":void 0)}else{if(y){let e;_e(i),e=r.DocumentSymbol.create(i.content,void 0,r.SymbolKind.Function,$e(i.offset,g-i.offset),$e(i.offset,i.length)),Object.assign(a.paraminfo??{},{name:i.content}),e.paraminfo=a.paraminfo,e.offset=i.offset,i.callsite=e,i.semantic??={type:f.function}}else i.ignore=!0,delete i.semantic;if(L=!1,h)for(const e of h)ge(e.name.toLowerCase())||(o.push(e),(e.pass_by_ref||e.returns)&&(e.def=!0))}}else if("("===G.charAt(te)){let e,t,n=A;e=A=ot(),n.semantic={type:f.method},pe("(",")"),n.semantic={type:f.method},t=r.DocumentSymbol.create(n.content,void 0,r.SymbolKind.Method,$e(n.offset,te-n.offset),$e(n.offset,n.length)),Object.assign(e.paraminfo??{},{name:n.content,method:!0}),t.paraminfo=e.paraminfo,t.offset=n.offset,n.callsite=t,me(n,!0)}else"%"!==i&&"%"===G.charAt(te)?(me(A,null),de(),ke(),L=!1):(be(A),ke(),L=!1,"TK_EQUALS"===A.type&&me(M));else if("TK_START_BLOCK"===A.type)["TK_WORD","TK_STRING","TK_NUMBER"].includes(M.type)&&Re.addDiagnostic(l.diagnostic.unexpected("{"),A.offset,A.length),fe(!0);else if("TK_STRING"===A.type)y?.push(A),"["===i&&nt("]")&&!A.content.match(/\n|`n/)&&(N=A.content.substring(1,A.content.length-1),Re.texts[N.toUpperCase()]=N);else if("["===A.content)pe("[","]");else if("%"===A.content)"."===G.charAt(A.offset-1)?(me(A,null),de(c)):pe("%","%");else{if(A.type.startsWith("TK_END_"))return Re.addDiagnostic(l.diagnostic.unexpected(A.content),A.offset,1),q(),L=!1,void I();if("TK_RESERVED"===A.type){let e=G.charAt(A.offset+A.length);if("%"!==i&&("%"===e||"%"===G.charAt(A.offset-1))){L=!1,A.type="TK_WORD",A.semantic={type:f.variable};continue}if(/^(class|super|isset)$/i.test(A.content)){if("isset"===A.content.toLowerCase()&&he(e))continue;L=!1,A.type="TK_WORD";continue}if(u.ahk_version>=u.alpha_3&&"throw"===A.content.toLowerCase()){A.semantic={type:f.keyword},L=!1,A.type="TK_WORD",A.ignore=!0;continue}Re.addDiagnostic(l.diagnostic.reservedworderr(A.content),A.offset,A.length)}else if("TK_COMMA"===A.type)K&&(A.paraminfo=E),0===v&&"%"!==i&&(++E.count,"TK_COMMA"===M.type||"TK_START_EXPR"===M.type?E.miss.push(E.comma.length):M.ignore||"TK_OPERATOR"!==M.type||M.content.match(/(--|\+\+|%)/)||Re.addDiagnostic(l.diagnostic.unexpected(","),A.offset,1),E.comma.push(A.offset));else if("TK_OPERATOR"===A.type){if(t.allIdentifierChar.test(A.content)&&("%"===G[A.offset-1]||"%"===G[A.offset+A.length])){L=!1,A.type="TK_WORD",A.semantic={type:f.variable};continue}if(":"===A.content?void 0===x.pop()&&Re.addDiagnostic(l.diagnostic.unexpected(":"),A.offset,1):"?"===A.content&&(A.ignore||x.push(A.offset)),-1===H(A)){if("&"===A.content){b=!0;continue}if(["++","--"].includes(A.content)){b=!1;continue}}}}b=void 0}var N;function I(){let e;for(;void 0!==(e=x.pop());)Re.addDiagnostic(l.diagnostic.missing(":"),e,1)}function q(){let e;for(;void 0!==(e=w.pop());)Re.addDiagnostic(l.diagnostic.missing(c),e,1)}"TK_EOF"===A.type&&v>-1?("%"===c&&Me(D),q()):a[A.previous_pair_pos].next_pair_pos=A.offset,"%"!==i&&(","===M.content?E.miss.push(E.count++):"TK_START_EXPR"!==M.type&&(E.count++,"*"===M.content&&(E.unknown=!0,E.count--))),I()}function he(e){let t=o.length;if(A.definition=u.ahkvars.ISSET,A.ignore=!0,A.type="TK_WORD",A.semantic={type:f.operator},"("===e){let e=A;_e(A),ke(),pe("(",")");let n=a[A.previous_pair_pos]?.paraminfo?.count??0;if(1!==n)u.extsettings.Diagnostics.ParamsCheck&&Re.addDiagnostic(l.diagnostic.paramcounterr(1,n),e.offset,te-e.offset);else if(o.length>t&&"TK_WORD"===M.type){let e=o.at(-1);M.content===e.name&&M.offset===Re.document.offsetAt(e.range.start)&&(e.assigned??=1,e.returns??=null)}return!0}Re.addDiagnostic(l.diagnostic.missing("("),A.offset,5)}function me(e,t=!1){if(""===i)return;let o,s=e.previous_token?.previous_token;if(!s||"."===G.charAt(s.offset-1))return;if(q=s.content.toLowerCase(),"this"!==q&&"super"!==q)return;let c=n,l=!1;if(t){let t=e.callsite?.paraminfo;if(t&&"defineprop"===e.content.toLowerCase()&&t.count>1&&0!==t.miss[0]){if(u(),!c?.cache)return;let n=t.comma[0],s=a[e.next_token_offset];if("("===G.charAt(e.offset+e.length)&&(s=a[s.next_token_offset]),"TK_STRING"!==s.type||s.next_token_offset!==n)c.checkmember=!1;else{let e,t,u=a[a[n].next_token_offset],d=s.content.slice(1,-1);o=$e(s.offset+1,d.length),("TK_START_BLOCK"!==u.type||!(t=u.data?.property)||t.GET||t.VALUE||t.SET)&&(e=g.create(d,r.SymbolKind.Property,o),e.full=`(${i.slice(0,-1)}) ${(e.static=l)?"static ":""}${d}`,c.cache.push(e),e.parent=l?c:c.prototype,(e.returns=t?.GET?.returns)?e.alias=!0:e.returns=t?.VALUE?.returns),(t=t?.CALL)&&(e=g.create("",r.SymbolKind.Variable,$e(0,0)),e.arr=!0,e=m.create(d,r.SymbolKind.Method,o,o,[e],void 0,l),e.full=`(${i.slice(0,-1)}) `+e.full,e.returns=t.returns,e.alias=!0,c.cache.push(e),e.parent=l?c:c.prototype)}}}else{if(u(),!c?.cache)return;if(null===t)return void(c.checkmember=!1);let n=g.create(e.content,r.SymbolKind.Property,o=$e(e.offset,e.length));n.static=l,c.cache.push(n),n.def=!1,n.parent=l?c:c.prototype}return;function u(){if(c.kind===r.SymbolKind.Method||c.kind===r.SymbolKind.Function)for(;c&&c.kind!==r.SymbolKind.Class;)c.static&&c.kind===r.SymbolKind.Method&&(l=!0),c=c.parent;c?.kind===r.SymbolKind.Property&&(l=!!c.static,c=c.parent)}}function ge(e,t=0){return 2!==t&&!!(c.builtin_variable.includes(e)||De&&c.builtin_variable_h.includes(e))}function _e(e,t=0,n){let s=e.content.toLowerCase();if(e.ignore||ge(s,t)&&(e.ignore=!0))return void((e.definition=u.ahkvars[s.toUpperCase()])?.uri&&(n??o).push(g.create(e.content,r.SymbolKind.Variable,$e(e.offset,e.length))));if(!e.length)return;let a=$e(e.offset,e.length),c=g.create(e.content,r.SymbolKind.Variable,a);return 2===t?(c.kind=r.SymbolKind.Property,be(e,c),i&&(c.full=`(${i.slice(0,-1)}) ${c.name}`,e.symbol=c)):s.match(/^\d/)&&Re.addDiagnostic(l.diagnostic.invalidsymbolname(e.content),e.offset,e.length),(n??o).push(c),c}function be(e,t){let n=Re.object.property[e.content.toUpperCase()]??=[];e.semantic??={type:f.property},t?n.unshift(t):n[0]??=g.create(e.content,r.SymbolKind.Property,$e(e.offset,e.length))}function ve(e){let n,i=r.DiagnosticSeverity.Error,o=Re.diagnostics,c=!1,u={};if(e.kind===r.SymbolKind.Class){let t=e,c=t.$property,u=t.property??={},d=t.children??=[],f=[u.__INIT],p=t.prototype;ve(u.__INIT),c.__INIT?.ranges?.length?(ve(c.__INIT),f.push(c.__INIT)):delete c.__INIT,u.PROTOTYPE={...p,children:void 0,name:"Prototype",kind:r.SymbolKind.Property,full:`(${t.full}) Prototype`,selectionRange:x,type_annotations:[t.full]},d.forEach((e=>{if(q=e.name.toUpperCase(),E.includes(q)&&delete(a[s.offsetAt(e.selectionRange.start)]??{}).semantic,e.children){let t=e.static||e.kind===r.SymbolKind.Class?u:(e.parent=p,c);if(n=t[q])if(n.kind!==r.SymbolKind.Property||n.children?.length){if(n.kind!==e.kind&&![e.kind,n.kind].includes(r.SymbolKind.Class)){let i,o=n.kind===r.SymbolKind.Property?(i=e,n):(i=n,e);if(!o.call)return o.call=i,t[q]=o}o.push({message:l.diagnostic.dupdeclaration(),range:e.selectionRange,severity:i})}else(e.children.length||e.kind!==r.SymbolKind.Property)&&(t[q]=e);else t[q]=e}})),d.forEach((e=>{if(e.children)return;let t=e.static?u:(e.parent=p,c);if(!(n=t[q=e.name.toUpperCase()]))return!1===e.def||(t[q]=e);if(!0!==n.typed||!(e.typed||!e.children&&(n.typed=1))){if(n.children&&(!e.typed||e.range.start.line<n.range.start.line)){let t=n;if(!t.val)return t.val=e}!1!==e.def&&o.push({message:l.diagnostic.dupdeclaration(),range:e.selectionRange,severity:i})}})),d.push(...f,...t.cache??[]),t.cache?.forEach((e=>(e.static?u:c)[q=e.name.toUpperCase()]??=e)),delete t.cache}else{let s,a=e,f=a.declaration,p={},h={},m=a.has_this_param,g=[];m&&(u.THIS=f.THIS=t.THIS,u.SUPER=f.SUPER=t.SUPER,a.kind!==r.SymbolKind.Method&&(g=void 0));for(let e of a.params??[])e.def=e.assigned=e.is_param=!0,e.name&&(g?.push(e),void 0!==e.defaultVal||e.arr?c=!0:c&&o.push({message:l.diagnostic.defaultvalmissing(e.name),range:e.selectionRange,severity:i}),(n=u[q=e.name.toUpperCase()])?o.push({message:l.diagnostic.conflictserr("parameter","parameter",n.name),range:e.selectionRange,severity:i}):u[q]=f[q]=p[q]=e);for(let[e,t]of Object.entries(a.local??{}))(n=u[e])?o.push({message:l.diagnostic.conflictserr(t.static?"static":"local","parameter",n.name),range:t.selectionRange,severity:i}):(f[e]=t,t.assigned||=Boolean(t.returns));for(let[e,t]of Object.entries(a.global??{})){if(n=f[e]){if(u[e]){o.push({message:l.diagnostic.conflictserr("global","parameter",n.name),range:t.selectionRange,severity:i});continue}let r=t.static?"static":"local";if(o.push({message:l.diagnostic.conflictserr(...n.selectionRange.start.line<t.selectionRange.start.line?(n=t,["global",r]):[r,"global"],n.name),range:n.selectionRange,severity:i}),t!==n)continue;delete a.local[e]}f[e]??=t,Re.declaration[e]??=t,t.assigned||=Boolean(t.returns),t.is_global=!0}for(let e of a.children??=[])if(q=e.name.toUpperCase(),e.kind===r.SymbolKind.Function){let t=e;if(t.static||(t.closure=!0),!q)continue;if(f[q]){if(n=u[q]){o.push({message:l.diagnostic.conflictserr("function","parameter",n.name),range:e.selectionRange,severity:i});continue}if(n=a.global[q]){if(o.push({message:l.diagnostic.conflictserr(...n.selectionRange.start.line<e.selectionRange.start.line||n.selectionRange.start.line===e.selectionRange.start.line&&n.selectionRange.start.character<e.selectionRange.start.character?(n=e,["function","global"]):["global","function"],n.name),range:n.selectionRange,severity:i}),e===n)continue;delete a.global[q],delete n.is_global,Re.declaration[q]===n&&delete Re.declaration[q]}else if(n=a.local[q]){if(n.selectionRange.start.line<e.selectionRange.start.line||n.selectionRange.start.line===e.selectionRange.start.line&&n.selectionRange.start.character<e.selectionRange.start.character){o.push({message:l.diagnostic.conflictserr("function",n.kind===r.SymbolKind.Function?"Func":n.static?"static":"local",e.name),range:e.selectionRange,severity:i});continue}n.static&&o.push({message:l.diagnostic.conflictserr(n.kind===r.SymbolKind.Function?"function":"static",e.kind===r.SymbolKind.Function?"Func":"static",n.name),range:n.selectionRange,severity:i})}}f[q]=a.local[q]=e}else e.kind===r.SymbolKind.Variable&&(((s=e).def?p:h)[q]??=(s.assigned||=Boolean(s.returns),e));if(a.children.unshift(...g??[]),a.parent?.assume===d.GLOBAL&&(a.assume??=d.GLOBAL),a.assume===d.GLOBAL){for(let[e,t]of Object.entries(p={...h,...p}))(n=f[e])?n.kind===r.SymbolKind.Function&&t.def?1!==t.assigned&&o.push({message:l.diagnostic.assignerr("Func",n.name),range:t.selectionRange,severity:i}):n.kind===r.SymbolKind.Variable&&t.def&&t.kind===n.kind&&(n.def=!0,n.assigned||=Boolean(t.returns)):(Re.declaration[e]??=a.global[e]=t,t.is_global=!0);h={}}else{let e=a.assume===d.STATIC,t=a.kind===r.SymbolKind.Method||!a.parent;for(let[s,c]of Object.entries(p))delete h[s],(n=f[s])?n.kind===r.SymbolKind.Function?1!==c.assigned&&o.push({message:l.diagnostic.assignerr("Func",n.name),range:c.selectionRange,severity:i}):n.kind===r.SymbolKind.Variable&&c.def&&c.kind===n.kind&&(n.def=!0,n.assigned||=Boolean(c.returns)):(f[s]=c,t?(a.local[s]=c,c.static=e):e&&(c.static=null))}p=h,h={};for(let e in p)f[e]||((h[e]=p[e]).def=!1);a.unresolved_vars=h;for(let e in p=a.local)p[e].def=!0;u=Object.assign(a.local,u),m&&(delete u.THIS,delete u.SUPER,delete f.THIS,delete f.SUPER)}}function ke(){return L?(M=A,L="TK_EOF"!==(A=it()).type):L="TK_EOF"!==A.type}}function Le(e,t){e.extends=t.trim().replace(/^(.+[\\/])?/,(t=>{if(t=t.slice(0,-1)){let n;if((t=t.replace(/\\/g,"/").toLowerCase()).endsWith(".ahk")||(t+=".d.ahk"),t.startsWith("~/"))n=u.isBrowser?a.URI.parse(u.rootdir+t.slice(1)):a.URI.file(u.rootdir+t.slice(1));else if(/^([a-z]:)?\//.test(t))n=a.URI.file(t);else if(t.includes(":"))n=a.URI.parse(t);else{let e=(Ke.path+"/../"+t).split("/"),i=[];e.shift();for(let t of e)if(".."!==t)i.push(t);else if(!i.pop())return"";n=Ke.with({path:i.join("/")})}e.extendsuri=n.toString().toLowerCase()}return""}))}function qe(e,t,n=0,o=!1){let s,a,c=!1,d=e[0];if("'\"".includes(d)&&e.endsWith(d)&&(e=e.slice(1,-1)),s=e.match(/^(\*[iI]\s)?(.*)$/))if(a=s[2],c=Boolean(s[1]),s=a.replace(/%(a_scriptdir|a_workingdir)%/i,Re.scriptdir).replace(/%a_linefile%/i,Re.fsPath),t&&Re[o?"dlldir":"includedir"].set((t.pos??=Re.document.positionAt(t.offset)).line,o?V:B),s.trim()){if(!u.isBrowser)if(o)(0,i.existsSync)(s)&&(0,i.statSync)(s).isDirectory()?V=s.endsWith("/")||s.endsWith("\\")?s:s+"\\":(s.match(/\.\w+$/)||(s+=".dll"),s=$(s,[],V,!0)?.path??s,s.includes(":")?Re.dllpaths.push(s.replace(/\\/g,"/")):Re.dllpaths.push((V&&(0,i.existsSync)(V+s)?V+s:s).replace(/\\/g,"/")));else if(t){if(s.startsWith("*")){let e=u.utils.get_RCDATA(t.content.substring(1));e?(H[e.uri]=e.path,t.data=[void 0,e.uri]):Re.addDiagnostic(l.diagnostic.resourcenotfound(),t.offset,t.length,r.DiagnosticSeverity.Warning)}else(s=$(s,Re.libdirs,B))&&(0,i.existsSync)(s.path)?(0,i.statSync)(s.path).isDirectory()?Re.includedir.set(t.pos.line,B=s.path):(H[s.uri]=s.path,t.data=[s.path,s.uri]):c||Re.addDiagnostic(s?l.diagnostic.filenotexist(s.path):l.diagnostic.pathinvalid(),t.offset,t.length);0!==n&&Re.addDiagnostic(l.diagnostic.unsupportinclude(),t.offset,t.length,r.DiagnosticSeverity.Warning)}else(s=$(s.replace(/(\.d)?>$/i,".d>"),Re.libdirs,Re.scriptpath))&&(0,i.existsSync)(s.path)&&!(0,i.statSync)(s.path).isDirectory()&&(H[s.uri]=s.path)}else o?V="":t&&Re.addDiagnostic(l.diagnostic.pathinvalid(),t.offset,t.length);else e&&t&&Re.addDiagnostic(l.diagnostic.pathinvalid(),t.offset,t.length)}function Fe(e,t){return t?(e&&e+"\n\n")+t:e}function je(e,t){let n=t.content;if(n.startsWith(";"))e.detail=t.data??=n.replace(/^[ \t]*; ?/gm,"");else if(/^\/\*\*(?!\/)/.test(n))if(t.data){let{detail:n,ignore:i,tags:o,vars:r}=t.data,s=r&&(r[e.name.toUpperCase()]??r[""]);i&&(e.ignore=i),o&&(e.tags=o),e.markdown_detail=Fe(s?.detail??"",n),s&&(e.type_annotations=s.type_annotations??=ae(s.type_str))}else t.data=We(Re,n,e);else e.detail=t.data??=n.replace(new RegExp(`^${G.substring(G.lastIndexOf("\n",t.offset)+1,t.offset)}`,"gm"),"").replace(/^\/\*\s*\n|\s*\*+\/$/g,"")}function We(e,t,n){if(n.detail=t,!(t=t.replace(/^[ \t]*(\*?[ \t]*(?=@)|\* ?)/gm,"").replace(/^\/\*+\s*|\s*\**\/$/g,"")))return{detail:n.markdown_detail=n.detail=""};let i,o,s,a,c,l=[],u=[],d="",f={},p={},h=n,m=e=>{},g={[r.SymbolKind.Variable]:"var",[r.SymbolKind.Property]:"prop"}[n.kind];if(h.params){let e=h.params;m=t=>{if(!/^d/.test(t))return p[t]??=e.find((e=>t===e.name.toUpperCase()&&!(e.markdown_detail="")))??((h.overload_params??={})[t]={type_annotations:!1,markdown_detail:""})}}for(let p of t.split(/\n(?=@)/))if(s=p.match(/^@(\w*)/)){switch(o=s[1].toLowerCase(),p=p.substring(o.length+1),c&&!o.startsWith("prop")&&(c=void 0),o){case"arg":case"argument":o="param";case"param":case"prop":case"property":case"var":if(p=T(p),s=p.match(/^\s*(\[(\w|[^\x00-\x7f]|(\[\])?\.)*.*?\]|(\w|[^\x00-\x7f]|(\[\])?\.)*)/)){let e="",t=s[1]??="";if(p=p.substring(s[0].length),t.startsWith("[")&&t.slice(1,-1).replace(/^((\w|[^\x00-\x7f]|(\[\])?\.)*)(.*)$/,((...n)=>((t=n[4].trimLeft()).startsWith("=")&&(e=t.substring(1).trim()),t=n[1]))),"param"===o){if(a=m(t.replace(/(\[\])?\..*$/,"").toUpperCase()),a?.name?.length===t.length)a.type_annotations??=ae(d);else if(a?.name){let e=t.split(".");k(v(a,e.shift()),e,d,`*@param* \`${t}\`${d&&`: *\`${d}\`*`}${p.trim()&&`\n___\n${p}`}`),a.markdown_detail||(a=void 0)}o=`*@param* \`${t}\`${d&&`: *\`${d}\`*`}${e&&` := \`${e}\``}${y(p)}`,l.push(o),a&&(a.markdown_detail+=`${o}\n\n`);continue}if(o.startsWith("prop"))o="property",c??=f[""]??=_(),k(v(c,c.name),t.split("."),d,`*@${o}* \`${t}\`${d&&`: *\`${d}\`*`}${e&&` := \`${e}\``}${p.trim()&&`\n___\n${p}`}`);else if("var"===g){p=p.trimLeft(),n.name.toLowerCase()===t.toLowerCase()?(n.type_annotations??=ae(d),(i??={})[t.toUpperCase()]??={detail:p,type_annotations:n.type_annotations},n.markdown_detail??=p):(i??={})[t.toUpperCase()]??={detail:p,type_str:d};continue}p=y(p),l.push(o=`*@${o}* \`${t}\`${d&&`: *\`${d}\`*`}${e&&` := \`${e}\``}${p}`)}continue;case"return":case"returns":case"type":p=T(p),l.push(`*@${o}*${d&&` *\`${d}\`*`}${y(p)}`),!g||n.get?(g||"type"!==o)&&(n.type_annotations??=ae(d)):"type"===o&&((i??={})[""]??={detail:p,type_annotations:ae(d)},l.pop());continue;case"enum":case"throws":p=T(p),l.push(`*@${o}*${d&&` *\`${d}\`*`}${y(p)}`);continue;case"typedef":p=T(p),s=p.match(/^\s*(\$?(\w|[^\x00-\x7f])*)/),(o=s[1])&&(e.typedef[o.toUpperCase()]??=c={name:o,kind:r.SymbolKind.TypeParameter,range:x,selectionRange:x,type_annotations:ae(d)}),l.push(`*@typedef* \`${o}\`: *\`${d||"Any"}\`*${y(p.substring(s[0].length))}`);continue;case"overload":if(!(s=p.match(/^\s*(\w|[^\x00-\x7f])*(?=[(\[])/)))break;u.push(`${n.name||"_"}${p.substring(s[0].length)}`);continue;case"example":l.push("*@example*"),(p=p.replace(/^\s*<caption>(.*?)<\/caption>/,((e,t)=>(l.push(t),""))).replace(/^[ \t\n]+/,""))&&l.push("```ahk2\n"+p+"\n```");continue;case"extends":o="*@extends* ",(s=p.match(/^\s*{([^{}]+)}/))&&(n.kind===r.SymbolKind.Class&&Le(n,s[1]),o+=`\`${s[1]}\``,p=p.substring(s[0].length)),l.push(`${o}${y(p)}`);continue;case"ignore":n.ignore=!0;break;case"deprecated":n.tags??=[1]}l.push(`*@${o}*${y(p)}`)}else l.push(p);if(g){let e=i?.[""]?.type_annotations;!e&&(o=f[""])&&(((i??={})[""]??={detail:""}).type_annotations=e=[o]),n.type_annotations??=e}else h.params&&(o=u.join("\n"))&&(n.overloads=o);return t=l.join("\n\n"),n.markdown_detail=Fe(n.markdown_detail??"",t),{detail:t,ignore:n.ignore,tags:n.tags,vars:i};function y(e){e=e.replace(/^[ \t]*[-—]/,"");let t=0,n=0,i=0;for(let o of e)switch(i++,o){case"\n":if(t>1||2==++n)return e;case"\t":t=0;break;case" ":t++;break;case"\r":break;default:if(n){let t=!1;if("|"===o||">"===o||"-+*".includes(o)&&" \t".includes(e[i])||"```"===e.substring(i-1,i+2))t=!0;else if("#"===o){for(;"#"===e[i];i++);t=" \t".includes(e[i])}else if("."!==o){for(;o>="0"&&o<="9";o=e[i++]);t="."===o&&" \t".includes(e[i])}if(t)return`\n${e}`}return` — ${e}`}return""}function _(e=""){return{kind:r.SymbolKind.Class,name:e,full:"",extends:"",uri:"",property:{},range:x,selectionRange:x}}function b(e,t,n){for(let n=e.length-1;n>=0;n--)t.includes(e[n])&&e.splice(n,1);return n&&e.push(n),n}function v(e,t){let n,i=t.endsWith("]")&&(t=t.slice(0,-2),!0);return n=f[t=t.toUpperCase()]??=b(e.type_annotations||=[],[N],_(e.name)),i?f[`${t}[]`]??=(n.extends||="Array",b(e.type_annotations||[],[A]),b((n.generic_types??=[])[0]??=[],[N],_())):n}function k(e,t,n,i){let o=e.name.toUpperCase(),s=t.length;for(let n of t){let t,i=0;for(;n.endsWith("]");)n=n.slice(0,-2),i++;if(o+=`.${t=n.toUpperCase()}`,s--,e=f[o]??=e.property[t]??={kind:r.SymbolKind.Property,name:n,range:x,selectionRange:x},i||s)do{e=f[o+"."]??=b(e.type_annotations||=[],[N],_()),i&&(e=f[o+="[]"]??=(e.extends||="Array",b((e.generic_types??=[])[0]??=[],i>1?[N,A]:[N],_())),i--)}while(i)}e.property||(e.markdown_detail??=i,e.type_annotations??=ae(n))}function T(e){let t=e.match(/^\s*\{/);if(d="",!t)return e;let n=1,i=t[0].length,o=i;for(;n;)switch(e[i++]){case"{":n++;continue;case"}":n--;continue;case void 0:return e;case'"':case"'":{let t,n=e[i-1];for(;(t=e[i++])!==n;)if("`"===t)i++;else if(!t||"\n"===t)return e;break}}return d=e.substring(o,i-1).trim(),e.substring(i)}}function $e(e,t){return r.Range.create(Re.document.positionAt(e),Re.document.positionAt(e+t))}function Ue(e,t,n,i,o){let r=G.charAt(n-1),s={content:e,type:t,offset:n,length:i,topofline:o,previous_token:Z,next_token_offset:-1,prefix_is_whitespace:v.includes(r)?r:void 0};return Re.tokens[n]=s,Z.next_token_offset=n,s}function Ve(e,t){let n,i,o,r=0,s=0,a="",c="",l=[S.ArrayLiteral,S.Expression,S.ObjectLiteral].includes(t);return e&&(r=e.indentation_level,s=e.had_comment,a=e.last_text,c=e.last_word,l||=e.in_expression,n=e.ternary_depth,i=e.array_style,o=e.object_style),{array_style:i,case_body:!1,catch_block:!1,declaration_statement:!1,else_block:!1,finally_block:!1,had_comment:s,if_block:!1,in_case_statement:!1,in_case:!1,in_expression:l,indentation_level:r,last_text:a,last_word:c,loop_block:0,mode:t,object_style:o,parent:e,start_line_index:ie.length,ternary_depth:n,try_block:!1}}function Be(){if(!1!==K)return;let e=ie.pop();for(;0===e?.text.length;)e=ie.pop();e&&ie.push(e),oe.had_comment&&ie.push({text:[],indent:0})}function He(){return 0===ie.at(-1).text.length}function Ge(e=!1){if(le.wrap_line_length&&!e){let t=ie.at(-1),n=0;t.text.length>0&&(n=t.text.join("").length+he.length+(ke?1:0),n>=le.wrap_line_length&&(e=!0))}(le.preserve_newlines&&X||e)&&!He()&&ze(!0)}function ze(e=!1){if(!(e||null!==e&&ye(pe.previous_token??C,C))){for(;oe.mode===S.Statement;)Ze();oe.if_block=oe.loop_block=oe.try_block=oe.catch_block=0}He()||ie.push({text:[],indent:0})}function Ye(e){let t=ie.at(-1);t.text.length?ke&&t.text.push(" "):(ue&&t.text.push(ue),oe.indentation_level=function(e){if(e){for(let t=ie.length-2;t>=0;t--)if(ie[t].text.length){e=Math.min(ie[t].indent+1,e);break}t.text.push(de.repeat(t.indent=e))}return e}(oe.indentation_level)),ke=void 0,t.text.push(e??he)}function Xe(){oe.indentation_level+=1}function Je(){oe.indentation_level>0&&(!oe.parent||oe.indentation_level>oe.parent.indentation_level)&&(oe.indentation_level-=1)}function Qe(e){oe?(ce.push(oe),re=oe):re=Ve(null,e),oe=Ve(re,e)}function Ze(){ce.length>0&&(re=oe,oe=ce.pop())}function et(){return oe.parent.mode===S.ObjectLiteral&&oe.mode===S.Statement&&":"===oe.last_text&&!oe.ternary_depth}function tt(){if("TK_RESERVED"===be&&["try","else","finally"].includes(oe.last_text)||"TK_END_EXPR"===be&&re.mode===S.Conditional||"TK_WORD"===be&&oe.mode===S.BlockStatement&&(!X&&pe.previous_token?.callsite||!oe.in_case&&!["TK_WORD","TK_RESERVED","TK_START_EXPR"].includes(_e)&&!["--","++","%"].includes(he))||oe.declaration_statement||oe.mode===S.ObjectLiteral&&":"===oe.last_text&&!oe.ternary_depth){switch(Qe(S.Statement),Xe(),oe.last_word){case"if":case"for":case"loop":case"while":case"catch":ze(!0);case"try":case"finally":case"else":oe.declaration_statement=!0}return!0}return!1}function nt(e){let t=te,n=G.charAt(t);for(;n!==e&&v.includes(n)&&++t<z;)n=G.charAt(t);return n===e?t:0}function it(e=0){let t;do{t=ot(e)}while(t.type.endsWith("COMMENT"));return t}function ot(e=0){let t,n,i,o=0,a=te;for(ee=0;v.includes(n=G.charAt(te++));)if("\n"===n)Q=te-1,ee+=1,_=!0;else if(te>=z)return h(),p(),Re.tokens[-1]??={content:"",type:"TK_EOF",offset:z,length:0,topofline:ye(Z,C)?-1:1,next_token_offset:-1,previous_token:Z};let c=te-1,d=Re.tokens[c];if(d&&d.length){let e=!1;if((_=Boolean(d.topofline&&d.type.endsWith("_BLOCK")))&&(Q=c),te=d.skip_pos??c+d.length,Z=d,d.ignore?"TK_START_EXPR"===d.type?(K=!0,e=!Ce):"TK_END_EXPR"===d.type?(K=null,e=!Ce):d.type.endsWith("COMMENT")&&(Z=d.previous_token??C):d.type.endsWith("COMMENT")&&(Z=d.previous_token??C),!Ce){let t=d.previous_extra_tokens,n=d;if(t&&(a<c&&(t.i=0),t.i<t.len?(d=t.tokens[t.i++],te=c):t.i=0),e&&n===d)return ot()}return d}if(_){_=!1,o=1;let t=G.indexOf("\n",te);t<0&&(t=z);let r=G.substring(Q+1,t).trim().replace(/(^|\s+);.*$/,"");if(r.includes("::")&&(we||!"\"'".includes(r[0])||!["TK_EQUALS","TK_COMMA","TK_START_EXPR"].includes(Z.type))){if(i=r.match(/^(:([^:]*):(`.|[^`])*?::)(.*)$/i)){let n;if((n=/x(?!0)/i.test(i[2]))||/^\s*\{?$/.test(i[4])||(n=Re.hotstringExecuteAction&&!/x0/i.test(i[2]))?(te+=i[1].length-1,Z=Ue(i[1],"TK_HOT",c,i[1].length,1)):(Q=t,te=c+i[0].length,Z=Ue(i[1],"TK_HOTLINE",c,i[1].length,1),c+=i[1].length,Z.skip_pos=te,Z.data={content:G.substring(c,te),offset:c,length:te-c},Re.tokenranges.push({start:c,end:te,type:3,previous:Z.offset})),Z.ignore=!0,p(),i[3]||Re.addDiagnostic(l.diagnostic.invalidhotdef(),Z.offset,Z.length),"TK_HOTLINE"===Z.type||!n&&!/^\s*\{/.test(i[4])){if(e>5)return delete Re.tokens[Z.offset],Z;Oe=n=!0;let t,o=Z,r=it(e+1);for(;r.ignore&&"TK_STRING"===r.type;){if((te=G.indexOf("\n",t=te))<0&&(te=z),t<te){let e=G.substring(t,te).trimRight();r.content+=e,r.length+=e.length}Re.tokenranges.push({start:r.offset,end:r.offset+r.length,type:3}),n=!1,r=it(e+1)}Oe=!1,Z=o,n||"TK_HOT"!==Z.type?te=o.skip_pos??o.offset+o.length:(Z.type="TK_HOTLINE",Z.skip_pos=te=c+i[0].length,c+=i[1].length,Z.data={content:G.substring(c,te),offset:c,length:te-c},Re.tokenranges.push({start:c,end:te,type:3,previous:Z.offset}))}return Z}if(i=r.match(/^(((([<>$~*!+#^]*?)(`?;|[\x21-\x3A\x3C-\x7E]|[^\x00-\x2f\x3a-\x40\x5b-\x5e\x60\x7b-\x7f]+))|~?(`?;|[\x21-\x3A\x3C-\x7E]|[^\x00-\x2f\x3a-\x40\x5b-\x5e\x60\x7b-\x7f]+)\s*&\s*~?(`?;|[\x21-\x3A\x3C-\x7E]|[^\x00-\x2f\x3a-\x40\x5b-\x5e\x60\x7b-\x7f]+))(\s+up)?\s*::)(.*)$/i)){let e=i[9].match(/^(\s*)(([<>~*!+#^]*?)(`[{;]|[a-z]\w+|[^{]))$/i);if(p(),e){let n=e[4].toLowerCase();if(1===n.length||!/^joy|^pause$/.test(n)&&w.test(n))return Q=t,te=c+i[0].length,Z=Ue(i[1].replace(/\s+/g," "),"TK_HOTLINE",c,i[1].length,1),c+=Z.length+e[1].length,Z.skip_pos=te,Z.data={content:i[9].trim(),offset:c,length:te-c,data:e[2]},Re.tokenranges.push({start:c,end:te,type:4,previous:Z.offset}),Z}return te=G.indexOf("::",te)+2,Z=Ue(i[1].replace(/\s+/g," "),"TK_HOT",c,i[1].length,1)}}"#"!==n&&p()}if(y(n.charCodeAt(0))||"$"===n&&Se){for(;te<z&&y(G.charCodeAt(te));)n+=G.charAt(te),te+=1;if("."!==G.charAt(c-1)){if(i=n.match(/^(\d+[Ee](\d+)?|(0[Xx][\da-fA-F]+)|(\d+))$/)){if(i[2]||i[3])return Z=Ue(n,"TK_NUMBER",c,n.length,o),Z.data=!!i[2],Z.semantic={type:f.number},Z;if(i[4]){let e;if(te<z&&"."===G.charAt(te)){let t="",i="",r=te+1;for(;r<z&&y(G.charCodeAt(r));)t+=G.charAt(r),r+=1;if(t.match(/^\d*([Ee]\d+)?$/))return n+="."+t,te=r,Z=Ue(n,"TK_NUMBER",c,n.length,o),Z.data=!0,Z.semantic={type:f.number},Z;if(t.match(/^\d*[Ee]$/)&&r<z&&"-+".includes(G.charAt(r))){for(t+=G.charAt(r),r+=1;r<z&&y(G.charCodeAt(r));)i+=G.charAt(r),r+=1;i.match(/^\d+$/)&&(n+="."+t+i,te=r)}e=!0}return Z=Ue(n,"TK_NUMBER",c,n.length,o),Z.data=e,Z.semantic={type:f.number},Z}if(te<z&&"-+".includes(G.charAt(te))){let t,i=G.charAt(te),r=te;if(te+=1,t=ot(e+1),delete Re.tokens[t.offset],"TK_NUMBER"===t.type&&t.content.match(/^\d+$/))return n+=i+t.content,Z=Ue(n,"TK_NUMBER",c,n.length,o),Z.data=!0,Z.semantic={type:f.number},Z;te=r}}if(R.includes(t=n.toLowerCase())){if(/^(and|or|not|in|is|contains)$/.test(t))return Z=Ue(n,"TK_OPERATOR",c,n.length,o);if(o||"class"!==t)return Z=Ue(n,"TK_RESERVED",c,n.length,o)}}return Z=Ue(n,"TK_WORD",c,n.length,o)}if("("===n||"["===n){if("("===n&&o&&!K){let e,i=te;for(;i<z;){if("\n"===(e=G.charAt(i++))){if(Oe){let e=Q+1,n=G.indexOf("\n",i),o=null,r=[];for(;n>0&&!(o=G.substring(i,n).match(/^[ \t]*\)/));)r.push(n-i),n=G.indexOf("\n",i=n+1);return n<0&&(r.push(z-i),o=G.substring(i,z).match(/^[ \t]*\)/)),te=o?i+o[0].length:z,r.push(te-i),t=G.substring(c,te).trimRight(),Z=Ue(G.substring(e,c)+t,"TK_STRING",c,t.length,1),Re.addFoldingRange(e,te,"block"),Z.data=r,Z.ignore=!0,Z}{let e=!Z.type||"TK_START_BLOCK"===Z.type&&Z.topofline>0;for(Z=Ue(n,"TK_START_EXPR",c,1,1),Z.ignore=!0,te=i-1,K=!0;" \t".includes(G.charAt(++c)||"\0");)continue;let t=G.substring(c,te).trimRight();Z.data={content:t,offset:c,length:te-c},Z.skip_pos=te,Re.tokenranges.push({start:c,end:te,type:4,previous:Z.offset});let o,r=t.match(/(^|[ \t])join([^ \t]*)/i),a=/(^|[ \t])[Cc]/.test(t),l=Z,u=Z,d=!1,f=Ce,p=te,h=0,m=(e,t)=>{};if(r){let e=r[2].replace(/`[srn]/g,"  "),t=!1,n=new F(s.TextDocument.create("","ahk2",-10,e));n.parseScript(),delete n.tokens[-1];let i=Object.values(n.tokens);c+=4+r[1].length+r.index,i.length&&(t=v.includes(e.charAt(e.length-1)),i.forEach((e=>{e.offset+=c,e.length=0,e.next_token_offset=-1})),m=(e,n)=>{let o=[];for(let t=0;t<e;t++){n=G.indexOf("\n",n+1);for(let e of i)e={...e},e.offset=n,o.push(e)}return{i:0,len:o.length,tokens:o,suffix_is_whitespace:t}},",)]}".includes(i[0].content)&&(d=!0))}for(Ce=!0,o=ot(),K&&"TK_EOF"!==o.type&&(a&&o.topofline&&o.type.endsWith("COMMENT")?h=ee-2:(ee>1&&(o.previous_extra_tokens=m(ee-1,p)),o.topofline=e?1:0),p=Q,u=o,o=ot());K&&"TK_EOF"!==o.type;)o.topofline&&(a&&o.type.endsWith("COMMENT")?h+=ee-1:((h+=ee)&&(o.previous_extra_tokens=m(h,p)),o.topofline=h=0,d&&"?"===u.content&&(u.ignore=!0)),p=Q),u=o,o=ot();return o.ignore&&"TK_END_EXPR"===o.type&&(ee>1&&(o.previous_extra_tokens=m(ee-1,p)),l.next_pair_pos=o.offset,o.previous_pair_pos=l.offset,Re.addFoldingRange(l.offset,o.offset,"block")),te=l.skip_pos,Z=(Ce=f)?l:ot()}}if((")"===e||"("===e)&&!G.substring(i-6,i-1).match(/[(\s]join\S*$/i))break}}return Z=Ue(n,"TK_START_EXPR",c,1,o)}if(")"===n||"]"===n)return Z=Ue(n,"TK_END_EXPR",c,1,o),")"===n&&o&&K?(K=!1,Z.ignore=!0,Ce?Z:ot()):Z;if("{"===n&&(t="TK_START_BLOCK")||"}"===n&&(t="TK_END_BLOCK"))return o&&(Q=c,_=!0),Z=Ue(n,t,c,1,o);if('"'===n||"'"===n){let i,r,s=n,a=c,u=!1,d={type:f.string};for(t="",/^[\s+\-*/%:?~!&|^=<>[({,.]$/.test(n=G.charAt(c-1))||(s===n&&'"'===n&&Me(Z),Re.addDiagnostic(l.diagnostic.missingspace()+", "+l.diagnostic.didyoumean(`\`${n}`),c,1));n=G.charAt(te++);)if("`"===n)te++;else{if(n===s)return t+=G.substring(c,te),Z=Ue(t,"TK_STRING",c,te-c,o),Re.tokenranges.push({start:c,end:te,type:2}),u&&(Z.data=null,Z.semantic=d),i&&(Z=i,te=Z.offset+Z.length),y(G.charCodeAt(te))&&Re.addDiagnostic(l.diagnostic.missingspace(),te),Z;if(K){if("\n"===n){let e=te-1;for(;" \t".includes(n=G.charAt(te)||"\0");)te++;if(")"===n){t=G.substring(c,e).trimRight(),Z=Ue(t,"TK_STRING",c,t.length,o=0),i??=Z,t="",Re.tokenranges.push({start:c,end:c+Z.length,type:2});let r=Z.previous_token;for(;r&&(!r.ignore||"("!==r.content);)r=r.previous_token;for(Re.addFoldingRange(c,e,"string"),Z=Ue(")","TK_END_EXPR",te,1,1),Z.ignore=!0,r&&(r.next_pair_pos=te,Z.previous_pair_pos=r.offset),K=!1,u=!0,c=++te;" \t".includes(n=G.charAt(te)||"\0");)te++;t=G.substring(c,te),c=te}}}else if("\n"===n||";"===n&&" \t".includes(G.charAt(te-2))){t=(t+G.substring(c,te-(";"===n?2:1))).trimRight(),--te,t&&(Z=Ue(t,"TK_STRING",c,t.trimLeft().length,o),Re.tokenranges.push({start:c,end:c+Z.length,type:2}),u&&(Z.data=null,Z.semantic=d),i??=Z,t="");break}}if(n){if(e>5)return Z=i,te=Z.offset+Z.length,delete Re.tokens[Z.offset],Z;Oe=we=!0;let t=it(e+1);e:for(;t.ignore&&"TK_STRING"===t.type;){let i=te,o=t.data;for(u&&(t.semantic=d);n=G.charAt(te++);)if("`"===n)te++;else{if(n===s){let e=G.substring(i,te);t.content+=e,t.length+=e.length,o[o.length-1]+=e.length,Re.tokenranges.push({start:t.offset,end:t.offset+t.length,type:2}),y(G.charCodeAt(te))&&Re.addDiagnostic(l.diagnostic.missingspace(),te);break e}if("\n"===n||";"===n&&" \t".includes(G.charAt(te-2))){let e=G.substring(i,te-(";"===n?2:1)).trimRight();e&&(t.content+=e,t.length+=e.length,o[o.length-1]+=e.length),Re.tokenranges.push({start:t.offset,end:t.offset+t.length,type:2}),te--;break}}if(!n){let e=G.substring(i,--te);e&&(t.content+=e,t.length+=e.length),Re.tokenranges.push({start:t.offset,end:t.offset+t.length,type:2})}t=it(e+1)}return t.ignore&&"TK_STRING"===t.type||((r=t.previous_token)?Re.addDiagnostic(l.diagnostic.unterminated(),r.offset+r.length,1):Re.addDiagnostic(l.diagnostic.missing(s),a,1)),Oe=!1,Z=i,te=Z.offset+Z.length,Z}return Re.addDiagnostic(l.diagnostic.unterminated(),z,1),t+=G.substring(c,z),Z=Ue(t,"TK_STRING",c,z-c,o),Re.tokenranges.push({start:c,end:z,type:2}),u&&(Z.data=null,Z.semantic=d),K&&(Re.addFoldingRange(c,z,"string"),K=!1),Z}if("."===n){let e=G.charAt(te);if("="===e)return te++,Z=Ue(".=","TK_EQUALS",c,2,o);if(v.includes(G.charAt(te-2))&&v.includes(e))return Z=Ue(n,"TK_OPERATOR",c,1,o);if(e.match(/\d/)&&["TK_EQUALS","TK_OPERATOR","TK_COMMA","TK_START_EXPR"].includes(Z.type)){let t=te+1,i="";for(;t<z&&y(G.charCodeAt(t));)e+=G.charAt(t),t+=1;if(e.match(/^\d+([Ee]\d+)?$/))return te=t,n+=e,Z=Ue("0"+n,"TK_NUMBER",c,n.length,o),Z.data=!0,Z.semantic={type:f.number},Z;if(t<z&&e.match(/^\d+[Ee]$/)&&"-+".includes(G.charAt(t))){for(e+=G.charAt(t),t+=1;t<z&&y(G.charCodeAt(t));)i+=G.charAt(t),t+=1;if(i.match(/^\d+$/))return te=t,n+=e+i,Z=Ue("0"+n,"TK_NUMBER",c,n.length,o),Z.data=!0,Z.semantic={type:f.number},Z}}return Z=Ue(n,/[%([]|[^\x00-\x2f\x3a-\x40\x5b-\x5e\x60\x7b-\x7f]/.test(e)?"TK_DOT":"TK_UNKNOWN",c,1,o)}if(";"===n){let e,t,n,i,s="",a=o&&"\n".includes(G.charAt(Q))?"TK_COMMENT":(o=0,"TK_INLINE_COMMENT"),d=c-1,f=0,p=!0;for(;;){if(te=d,d=G.indexOf("\n",te+1),i=G.substring(te+1,d=d<0?z:d).trim(),i.startsWith(";")){if(f++,e=i.match(/^;\s*@/)){let t=i.substring(e[0].length);"include-winapi"===(t=t.toLowerCase())?De&&(e=u.lexers[u.ahkuris.winapi])&&Object.defineProperty(H,u.ahkuris.winapi,{value:e.fsPath,enumerable:!1}):(e=t.match(/^include\s+(.*)/i))?qe(e[1].replace(/\s+;.*$/,"").trim()):(e=t.match(/^lint-(enable|disable)\b\s*(\S*)/))&&"class-static-member-check"===e[2]&&("enable"===e[1]?delete(j??Re).checkmember:(j??Re).checkmember=!1),n=!0}else if(e=i.match(/^;+\s*([{}])/)){if(p=!1,"{"===e[1]?U.bracket.push(te+1):void 0!==(e=U.bracket.pop())&&Re.addFoldingRange(e,te+1,"block"),1===f&&(n=!0),o&&!n)continue;te=d;break}if((e=i.match(/^;\s*(~?\s*|@)(todo|fixme)(:?\s*)(.*)/i))&&(Re.children.push(r.DocumentSymbol.create(`${e[2].toUpperCase()}: ${e[4].trim()}`,void 0,r.SymbolKind.Module,t=$e(te+1,d-te-1),t)),o))continue;if(o){if(e=i.match(/^;\s*[@#](end)?region\b/i))n=!0,p=!1,h(),e[1]?void 0!==(e=U.region.pop())&&Re.addFoldingRange(e,te+1,"region"):(U.region.push(te+1),(i=i.substring(e[0].length).trim())&&Re.children.push(r.DocumentSymbol.create(i,void 0,r.SymbolKind.Module,t=$e(te+1,d-te-1),t)));else if(e=i.match(M)){let i=e.groups;if(i){for(let t in i)if(t.startsWith("tag")&&(e=i[t]?.trim()))break}else e=e[1]?.trim();e&&(Re.children.push(r.DocumentSymbol.create(e,void 0,r.SymbolKind.Module,t=$e(te+1,d-te-1),t)),n=!0)}if(!n)continue}te=d}break}s=G.substring(c,te).trimRight(),Re.tokenranges.push({start:c,end:te,type:1});let m=Re.tokens[c]={type:a,content:s,offset:c,length:s.length,next_token_offset:-1,topofline:o,ignore:n,skip_pos:te,previous_token:Z};if(o){let e=Re.document.positionAt(te).line;Oe||n||!i[0]||i.startsWith("/*")||(O[e+1]=m),J&&(Z.pos??=Re.document.positionAt(Z.offset)).line>J.endLine&&h(),J?J.endLine=e:p&&(J=r.FoldingRange.create(Re.document.positionAt(c).line,e,void 0,void 0,"comment"))}else v.includes(G.charAt(c-1))||Re.addDiagnostic(l.diagnostic.unexpected(m.content),c,m.length);return m}if("/"===n&&o&&"*"===G.charAt(te)){let e=G.indexOf("\n",--te),t=0,r="";for(;!(i=G.substring(te,e>0?e:z).match(/(^[ \t]*\*\/)|\*\/([ \t]*\r?)$/))&&e>0;)Q=e,e=G.indexOf("\n",te=e+1),t++;i?.[1]?(te=G.indexOf("*/",Q)+2,_=!0,Q=te-1):te=(e<0?z:e)-(i?.[2].length??(r="*/",0)),Re.tokenranges.push({start:c,end:te,type:1});let s={type:"TK_BLOCK_COMMENT",content:G.substring(c,te)+r,offset:c,length:te-c,next_token_offset:-1,previous_token:Z,topofline:o,skip_pos:te};if(!Oe){let e=te,t=0;for(;" \t\r".includes(n=G[e]??"\0")||"\n"===n&&++t<2;e++);("*"!==G[c+2]||"/"===G[c+3]||(s.data=null))&&"\n\0".includes(n)||(O[Re.document.positionAt(e).line]=s)}return h(),Re.tokens[c]=s,t&&Re.addFoldingRange(c,te,"comment"),s}if(k.includes(n)){if(Se&&"<>".includes(n))return Z=Ue(n,"<"===n?"TK_START_EXPR":"TK_END_EXPR",c,n.length,o);for(;te<z&&k.includes(n+G.charAt(te))&&(n+=G.charAt(te),te+=1,!(te>=z)););if(","===n)return Z=Ue(n,"TK_COMMA",c,1,o);if("?"===n){Z=Ue(n,"TK_OPERATOR",c,1,o);let t=te,i=Z,s=it(e+1);return te=t,(")]},:??".includes(s.content)||"."===s.content&&"TK_OPERATOR"!==s.type)&&(i.ignore=!0,!")]},:".includes(s.content)&&u.ahk_version<u.alpha_3-1&&Re.addDiagnostic(l.diagnostic.requireversion("2.1-alpha.2"),i.offset,i.length,r.DiagnosticSeverity.Warning)),Z=i}return"??="===n&&u.ahk_version<u.alpha_3-1&&Re.addDiagnostic(l.diagnostic.requireversion("2.1-alpha.2"),c,n.length,r.DiagnosticSeverity.Warning),Z=Ue(n,n.match(/([:.+\-*/|&^]|\/\/|>>|<<|\?\?)=/)?"TK_EQUALS":"TK_OPERATOR",c,n.length,o)}if("#"===n){let e="#";for(;y((n=G.charAt(te)).charCodeAt(0));)e+=n,te++;if(ne.push(c),Z=Ue(e,"TK_SHARP",c,e.length,o),me=e.toLowerCase(),o&&v.includes(n)&&("#hotif"===me||De&&"#initexec"===me))return Z;if(Q=G.indexOf("\n",c=te),te=Q<0?z:Q,o&&v.includes(n)){if(" "===n||"\t"===n){for(;" \t".includes(G.charAt(c)||"\0");)c++;let e=G.substring(c,te).trimRight().replace(/(^|\s+);.*$/,"");Z.data={content:e,offset:c,length:e.length},te=c+e.length,e&&(Z.skip_pos=te,Re.tokenranges.push({start:c,end:c+e.length,type:3,previous:Z.offset}))}}else Z.type="TK_UNKNOWN",Z.content+=G.substring(c,te).trimRight(),Z.length+=te-c;return Z}return Z=Ue(n,"TK_UNKNOWN",c,n.length,o);function p(){ne.length>1&&Re.addFoldingRange(ne[0],ne.pop(),"imports"),ne.length=0}function h(){J&&(J.endLine>J.startLine&&Re.foldingranges.push(J),J=void 0)}}function rt(){let e=ie[oe.start_line_index-1];return e?.text.length?e.indent:oe.indentation_level}function st(){return oe.mode===S.ObjectLiteral?oe.object_style??le.object_style:oe.mode===S.ArrayLiteral?oe.array_style??le.array_style:void 0}function at(){let e=!1;if(ke||=/^(TK_NUMBER|TK_WORD|TK_RESERVED|TK_STRING|TK_END_)/.test(be),tt()&&(e=oe.declaration_statement,!X&&["try","else","finally"].includes(oe.last_word)&&["if","while","loop","for","try","switch"].includes(me)&&Je()),"TK_RESERVED"===_e){if(void 0!==le.keyword_start_with_uppercase&&(he=le.keyword_start_with_uppercase?me.replace(/^./,(e=>e.toUpperCase())):me),["break","continue","global","goto","local","return","static","throw"].includes(me))X&&ze(e);else{let t=!1;switch(me){case"else":for(;oe.mode===S.Statement&&!oe.if_block&&!oe.loop_block&&(!oe.catch_block||oe.else_block);)Ze();break;case"finally":for(;!(oe.mode!==S.Statement||oe.catch_block||oe.try_block||oe.else_block&&oe.catch_block);)Ze();break;case"catch":for(;oe.mode===S.Statement&&!oe.try_block&&(!oe.catch_block||oe.else_block);)Ze();break;case"until":for(;oe.mode===S.Statement&&1!==oe.loop_block;)Ze();break;case"case":case"class":for(;oe.mode===S.Statement;)Ze();break;case"if":case"for":case"loop":case"while":case"try":case"switch":if(!e)if(!X||oe.mode!==S.Statement||oe.declaration_statement||oe.is_expression)for(;oe.mode===S.Statement&&oe.declaration_statement;)Ze();else ze(!1)}if(oe.if_block?"else"===me?(oe.if_block=!1,oe.else_block=!0,t=!0):oe.if_block=!1:oe.loop_block?1===oe.loop_block&&"until"===me?(oe.loop_block=0,t=!0):"else"===me?(oe.else_block=!0,oe.loop_block=0,t=!0):oe.loop_block=0:oe.try_block?"catch"===me?(oe.try_block=!1,oe.catch_block=!0,t=!0):"finally"===me?(oe.try_block=!1,oe.finally_block=!0,t=!0):oe.try_block=!1:oe.catch_block?"finally"===me?(oe.catch_block=oe.else_block=!1,oe.finally_block=!0,t=!0):"else"===me?(oe.else_block=!0,t=!0):"catch"===me?t=!0:oe.catch_block=oe.else_block=!1:oe.else_block=oe.finally_block=!1,"class"===me)return ze(),Ye(),oe.last_word=me,Qe(S.Statement),void(Te=!0);if("case"===me&&(oe.in_case_statement||"BlockStatement"===oe.mode&&"switch"===oe.last_word))return ze(),oe.case_body&&(Je(),oe.case_body=!1),Ye(),oe.in_case=!0,void(oe.in_case_statement=!0);switch(t?(Be(),"}"!==oe.last_text||le.brace_style<1||X&&le.preserve_newlines&&!le.brace_style?ze(!0):ke=fe):X&&("else"===ve&&!le.preserve_newlines&&["if","for","loop","while","try","switch"].includes(me)?Je():ze(e)),me){case"loop":oe.loop_block=1;break;case"while":case"for":oe.loop_block=2;break;case"if":oe.if_block=!0;break;case"try":oe.try_block=!0}}oe.last_word=me}else!X||oe.mode!==S.Statement||oe.is_expression||ye(pe.previous_token??C,pe)?X&&(le.preserve_newlines||pe.symbol)?(pe.symbol||st()!==D.collapse)&&ze(!pe.symbol):["TK_COMMA","TK_START_EXPR","TK_EQUALS","TK_OPERATOR"].includes(be)&&(et()||Ge()):ze(e),!Te&&oe.mode===S.BlockStatement&&pe.symbol?.children&&(Qe(S.Statement),Te=!0),oe.last_word="_",le.symbol_with_same_case&&(he=pe.definition?.name||he);Ye()}function ct(e){let t=e.match(/^;\s*@format\b/i);if(t){e=e.substring(t[0].length);for(let t of e.split(",")){let e,n=t.indexOf(":");switch(e=t.substring(0,n).trim()){case"array_style":case"object_style":oe[e]=D[t.substring(n+1).trim()]}}}}function lt(){if(ze(),le.symbol_with_same_case&&"TK_SHARP"===_e&&(he=u.hoverCache[me]?.[0]||he),"#hotif"===me&&le.indent_between_hotif_directive)return oe.hotif_block&&(Je(),oe.hotif_block=!1),Ye(),0===Re.tokens[pe.next_token_offset]?.topofline&&(Xe(),oe.hotif_block=!0),void(ke=!0);Ye();let e=pe.data?.content;e?Ye("TK_HOTLINE"===_e?e:" "+e):ke="TK_HOT"===_e?!!le.space_after_double_colon:fe||"TK_SHARP"===_e}function ut(){return X&&(oe.parent.mode===S.BlockStatement&&["TK_END_EXPR","TK_START_BLOCK","TK_END_BLOCK","TK_WORD","TK_STRING"].includes(be)||"TK_OPERATOR"===be&&/^(\+\+|--|%)$/.test(ve)||"TK_RESERVED"===be&&/^(break|continue|goto|global|local|loop|return|static|throw)$/.test(ve))}this.document=e,e.uri&&(Se=!1,this.uri=e.uri.toLowerCase(),this.setWorkspaceFolder(),this.scriptpath=(this.fsPath=Ke.fsPath).replace(/[\\/][^\\/]+$/,""),this.initLibDirs(n)),this.get_token=function(e,t=!1){let n,i,o;for(void 0!==e&&(n=te,o=Z,te=e);(i=ot()).type.endsWith("COMMENT")&&t;);return void 0!==e&&(te=n,Z=o),i},this.find_token=function(e,t=!1){let n,i=e,o=G.charAt(e),r=Re.tokens,s={...C,offset:z};if(!o)return s;if(v.includes(o)){for(;v.includes((o=G.charAt(++i))||"\0");)continue;if(n=r[i])return n;if(!o&&(n=r[Re.tokenranges[Re.tokenranges.length-1]?.start])){if(n.offset<=e&&e<n.offset+n.length)return n;n=void 0}}else{if(y(o.charCodeAt(0)))for(;y(G.charCodeAt(--i));)continue;else for(;!v.includes(o=G.charAt(--i))&&!y(o.charCodeAt(0)););if(!(n=r[++i]??r[i-1])&&"."===G.charAt(i)){for(;y(G.charCodeAt(--i));)continue;n=r[i+1]}}if(!n&&G.slice(i=G.lastIndexOf("\n",i)+1,e).trim()&&(n=Re.find_token(i)),n){if(n.offset<=e&&e<n.offset+n.length)return n;for(;(n=r[n.next_token_offset])&&!(n.offset>e);)if(e<n.offset+n.length)return n}return!t&&Re.findStrOrComment(e)||s},this.beautify=function(e,t){let n,i;for(!Re.isparsed&&Re.parseScript(),le={break_chained_methods:!1,ignore_comment:!1,indent_string:"\t",max_preserve_newlines:3,preserve_newlines:!0,space_before_conditional:!0,space_after_double_colon:!0,space_in_empty_paren:!1,space_in_other:!0,space_in_paren:!1,wrap_line_length:0,...e},be=ve="",_=!0,Z={...C},Q=-1,i=z,pe=Re.get_token(0),ue=G.substring(G.lastIndexOf("\n",te=pe.offset)+1,te),Te=ke=!1,Ce=!0,de=le.indent_string??"\t",fe=le.space_in_other??!0,ie=[{text:[],indent:0}],ce=[],oe=null,Qe(S.BlockStatement),le.symbol_with_same_case&&(0,u.symbolProvider)({textDocument:Re.document}),t&&(i=Re.document.offsetAt(t.end),pe=Re.find_token(Re.document.offsetAt(t.start)),t.start=Re.document.positionAt(te=pe.offset),ue=G.substring(G.lastIndexOf("\n",te)+1,te).replace(/\S.*$/,""));;){if(_e=(pe=ot()).type,me=(he=pe.content).toLowerCase(),pe.fat_arrow_end){for(;!oe.in_fat_arrow;)Ze();Je()}if(pe.offset>=i){if(t){let e=pe.previous_token,n=te;if("TK_RESERVED"===be&&["try","else","finally"].includes(ve)&&Xe(),oe.declaration_statement&&He()||ze(),e?.type){for(;(pe=Re.find_token(e.skip_pos??e.offset+e.length)).offset<i;)e=pe;for(n=e.offset+e.length;" \t".includes(G.charAt(n)||"\0");n++);for(v.includes(G.charAt(n))||(n=e.offset+e.length);He();)ie.pop()}t.end=Re.document.positionAt(n),t.indent_string=ue+de.repeat(oe.indentation_level)}for(;oe.mode===S.Statement;)Ze();break}if(Te&&!(Te=ee?!o(pe):"TK_START_BLOCK"!==_e||pe.data))Ze(),be="TK_END_EXPR",oe.last_text=")",X=ee>0;else if(X=ee>0)if(!1!==K){ze();for(let e=1;e<ee;e++)ie.push({text:[],indent:0})}else if(!Te&&!oe.in_expression&&(pe.type.endsWith("COMMENT")||!ye(oe.mode===S.Statement?pe.previous_token??C:{},pe))&&("TK_RESERVED"!==be||!["catch","else","finally","until"].includes(ve))){le.max_preserve_newlines&&ee>le.max_preserve_newlines&&(ee=le.max_preserve_newlines),He()||ie.push({text:[],indent:0});for(let e=1;e<ee;e++)ie.push({text:[],indent:0})}Pe[_e](),_e.endsWith("COMMENT")||(!Te&&"TK_RESERVED"===_e&&["if","for","while","loop","catch","switch"].includes(me)&&(Te=!0,Qe(S.Conditional),"switch"!==me&&Xe()),oe.last_text=me,oe.had_comment=0,be=_e,ve=me)}return n=ie.map((e=>e.text.join(""))).join("\n"),ie=[],Ce=!1,n;function o(e){if(![S.Conditional,S.Statement].includes(oe.mode)||oe.parent.mode===S.ObjectLiteral)return!1;switch(e.type){case"TK_DOT":case"TK_COMMA":case"TK_EQUALS":case"TK_COMMENT":case"TK_INLINE_COMMENT":case"TK_BLOCK_COMMENT":return!1;case"TK_OPERATOR":return Boolean(e.content.match(/^(!|~|not|%|\+\+|--)$/i));case"TK_STRING":return!e.ignore;default:let t=e.previous_token;switch(t.type){case"TK_COMMA":case"TK_EQUALS":return!1;case"TK_OPERATOR":return Boolean(t.content.match(/^(\+\+|--|%)$/))}}return!0}},o||e.uri.match(/\.d\.(ahk2?|ah2)(?=(\?|$))/i)?(this.d=o||1,Se||=!0,this.parseScript=function(){let e,t,n,i="",o=0,s=0,a=0,c=0,h=!1,y=$e(0,0),b=this.uri,v=r.DocumentSymbol.create("",void 0,r.SymbolKind.Namespace,y,y,this.children),k=[],T=[],R=[];for(this.clear(),U={region:[],bracket:[]},O={},ne=[],G=this.document.getText(),z=G.length,B=this.scriptpath,Z={...C},_=!0,te=0,Q=-1,j=J=void 0,H=this.include,v.property=v.$property=this.declaration;ot().length;);for(R=Object.values(this.tokens),a=R.length;o<a;)switch((e=R[o]).type){case"TK_WORD":if(!e.topofline&&!h){o++;break}if(s=o+1,s<a)if(c&&((t=R[s]).topofline||["=>","?",":","[","{"].includes(t.content))){let o=g.create(e.content,r.SymbolKind.Property,y=$e(e.offset,e.length)),a=o,c="=>"===t.content;e.symbol=e.definition=o,a.parent=v,a.has_this_param=!0;let l=[],u={type:f.property,modifier:p.definition|h};if(E.includes(i=o.name.toUpperCase())||(e.semantic=u),v.children?.push(o),o.static=h,o.full=`(${T.join(".")}) ${h?"static ":""}`+o.name,(h?v.property:v.$property)[i]??=o,(n=O[o.selectionRange.start.line])&&je(n.symbol=o,n),(this.object.property[i]??=[]).push(o),"["===t.content){if(l=w("]"),l.length){a.children=a.params=l,a.full+=`[${l.full}]`,a.param_offsets=l.offset,a.param_def_len=l.full.length+2,a.declaration=a.local={};for(let e of l)a.local[i=e.name.toUpperCase()]??=e}if(!(t=R[++s]))break}if("{"===t.content){let n=o;for(;"}"!==(e=R[++s]).content;)if("=>"===e.content){let e=m.create(t.content,r.SymbolKind.Function,y=$e(t.offset,t.length),{...y},l);i=t.content.toLowerCase(),e.parent=o,t.symbol=t.definition=e,S(e),"get"!==i&&"set"!==i||(e.has_this_param=!0,n[i]=e)}else t=e;o.type_annotations=n.get?.type_annotations,c=Boolean(n.get&&!n.set),o.range.end=this.document.positionAt(e.offset+e.length)}else if("=>"===t.content){let e=m.create("get",r.SymbolKind.Function,y=$e(t.offset,t.length),{...y},l);e.parent=o,o.get=e,c=!0,e.has_this_param=!0,S(e),o.type_annotations=e.type_annotations,o.range.end=e.range.end}else"?"===t.content&&(t.ignore=!0,t=R[++s],o.defaultVal=null),":"===t?.content?S(o):(t=R[--s],o.range.end=this.document.positionAt(t.offset+t.length));c&&(u.modifier|=p.readonly)}else if("("===(t=R[s]).content){let o=w(),a=D(e.content,o,$e(e.offset,e.length),h);"=>"===R[s+1]?.content?(++s,S(a)):a.range.end=this.document.positionAt(t.offset+t.length),a.full+=` => ${se(a.type_annotations)||"void"}`,e.symbol=e.definition=a,E.includes(i=a.name.toUpperCase())||(e.semantic={type:c?f.method:f.function,modifier:p.definition|p.readonly|h}),c&&(a.has_this_param=!0,a.kind=r.SymbolKind.Method,a.full=`(${T.join(".")}) ${a.full}`,a.parent=v,(this.object.method[i]??=[]).push(a)),(n=O[a.selectionRange.start.line])&&je(n.symbol=a,n),v.children?.push(a);let l=h?v.property:v.$property;l[i]?l[i].call=a:l[i]=a}else if(!c&&(["=>",":",","].includes(t.content)||t.topofline)){let i=g.create(e.content,r.SymbolKind.Variable,y=$e(e.offset,e.length));e.symbol=e.definition=i,e.semantic={type:f.variable,modifier:p.definition|("=>"===t.content?p.readonly:0)},i.assigned=i.def=!0,(n=O[i.selectionRange.start.line])&&je(n.symbol=i,n),["=>",":"].includes(t.content)?S(i):","!==t.content&&--s,v.children.push(i),v.property[i.name.toUpperCase()]??=i}o=s+1,h=!1;break;case"TK_RESERVED":if(h=!1,1!==e.topofline)e.type="TK_WORD";else if("static"===(i=e.content.toLowerCase()))h=!0,o++;else if(o<a-4&&"class"===i){let i="",l=r.DocumentSymbol.create((e=R[++o]).content,void 0,r.SymbolKind.Class,$e(R[o-1].offset,0),$e(e.offset,e.length),[]);if(s=o+1,T.push(l.name),e.semantic={type:f.class,modifier:p.definition|p.readonly},e.symbol=e.definition=l,l.extends="",l.uri??=this.uri,"<"===(t=R[s])?.content&&!t.topofline){let e={},n=0;for(;"TK_WORD"===(t=R[++s])?.type;){let i=$e(t.offset,t.length),o={name:t.content,data:n,kind:r.SymbolKind.TypeParameter,range:i,selectionRange:i};if(n++,e[t.content.toUpperCase()]??=o,"="===(t=R[++s])?.content&&(S(o),t=R[++s]),","!==t?.content)break}">"===t?.content?(l.type_params=e,t=R[++s]):P(">")}if("extends"===t?.content.toLowerCase()){for("TK_WORD"===(t=R[s+1])?.type&&this.children.push(g.create(t.content,r.SymbolKind.Variable,$e(t.offset,t.length)));++s<a&&"{"!==(t=R[s]).content;)i+=t.content;l.extends=i}(n=O[l.selectionRange.start.line])&&je(n.symbol=l,n),l.full=T.join("."),l.property={},l.prototype={...l,detail:void 0,property:l.$property={}},(!c&&l.name.startsWith("$")?Re.typedef:v.property)[l.name.toUpperCase()]??=l,v.children.push(l),c++,k.push(v),v=l,l.type_annotations=[l.full],o=s+1}else"global"===i&&"TK_WORD"===R[o+1].type?o++:e.type="TK_WORD";break;case"TK_END_BLOCK":c&&(v.range.end=v.prototype.range.end=this.document.positionAt(e.offset+e.length),v.property.PROTOTYPE={...v.prototype,children:void 0,name:"Prototype",kind:r.SymbolKind.Property,full:`(${v.full}) Prototype`,selectionRange:x,type_annotations:[v.full]},v.uri=b,(v=v.prototype).uri=b,this.addFoldingRangePos(v.range.start,v.range.end),Object.values(v.property).forEach((e=>e.parent=v)),c--,T.pop(),v=k.pop());default:o++,h=!1}if(!(this.d<0)){if(2&this.d){let e,t,n=b.endsWith("/ahk2_h.d.ahk")?1:0;for(let[t,i]of Object.entries(this.declaration))switch(i.kind){case r.SymbolKind.Function:i.def=!1,i.uri=b;case r.SymbolKind.Class:i.overwrite??=n,i.def??=!0,(!(e=u.ahkvars[t])||n>=(e.overwrite??0))&&(u.ahkvars[t]=i);break;case r.SymbolKind.Variable:i.def&&(u.ahkvars[t]=i,i.uri=b)}n&&(u.ahk_version>u.alpha_3?["STRUCT","SIZEOF","OBJDUMP","OBJLOAD","A_ZIPCOMPRESSIONLEVEL"].forEach((e=>delete u.ahkvars[e])):(t=this.declaration.STRUCT)?.kind===r.SymbolKind.Class&&(t.def=!1));for(let e in I)I[e]=u.ahkvars[e]?.prototype}Ne(),ge({},this.children,this.diagnostics),this.diags=this.diagnostics.length,this.isparsed=!0,U.region.forEach((e=>this.addFoldingRange(e,te-1,"region")))}function S(e){let i=function i(){let o,c,l,u,d=[];e:for(;t=R[++s];){switch(t.type){case"TK_WORD":for(l=t.content,u="TK_WORD",(c="typeof"===l)&&R[s+1]?.type===u&&!R[s+1].topofline&&(t.semantic={type:f.operator},t=R[++s],l=t.content),("this"!==l.toLowerCase()||e.kind===r.SymbolKind.Function&&e.parent?.kind!==r.SymbolKind.Property)&&(t.semantic={type:f.class});(t=R[++s])&&!t.topofline&&t.type!==u&&(/^[.#~]$/.test(t.content)||"TK_WORD"===t.type&&(t.semantic={type:f.class}));)l+=t.content,u=t.type;if("<"!==t?.content||t.topofline)l&&d.push(c?`typeof ${l}`:L[l.toUpperCase()]??l);else{let e=[];for(;;){if(e.push(i()),!t||">"===t.content){let n={name:l,kind:"comobject"===l.toLowerCase()?r.SymbolKind.Interface:r.SymbolKind.Class,extends:l,full:`${l}<${e.map((e=>se(e))).join(", ")}>`,range:x,selectionRange:x};n.generic_types=e,c?n.prototype={...n}:n.data=L[l.toUpperCase()],d.push(n),t=R[++s];break}if(","!==t.content){P(">"),t=R[++s];break}}}break;case"TK_NUMBER":case"TK_STRING":d.push(t.content),t=R[++s];break;case"TK_START_BLOCK":{let e={},i=t,o="";for(;"TK_WORD"===(t=K())?.type;){let i=g.create(t.content,r.SymbolKind.Property,$e(t.offset,t.length));if(e[t.content.toUpperCase()]??=i,t.semantic={type:f.property},o+=", "+t.content,n&&n===O[i.selectionRange.start.line]&&je(i,n),"?"===(t=R[++s])?.content&&(t.ignore=!0,t=R[++s],i.defaultVal=null,o+="?"),":"===t?.content&&(S(i),t=R[++s],o+=`: ${se(i.type_annotations)||"unknown"}`),","!==t?.content)break;n=void 0}if("}"===t?.content){let n=r.DocumentSymbol.create("",void 0,r.SymbolKind.Class,x,x);n.property=e,n.name=n.extends="",n.uri=Re.uri,d.push(i.data=t.data=n),n.full=(o=o.substring(2))&&`{ ${o} }`}else P("}"),i.data=N,"}"===t?.content&&(t.data=N);t=R[++s];break}case"TK_COMMENT":case"TK_BLOCK_COMMENT":n=t;case"TK_INLINE_COMMENT":continue;default:if("("===t.content)if(",:=?&*)[".includes((o=R[s+2])?.content??"\0")||"=>"===o?.content){let e=t.offset,i=D("",w(),$e(e,0));if(s>=a)break e;"=>"===R[s+1]?.content?(++s,S(i)):i.range.end=Re.document.positionAt(t.offset+t.length),i.full+=` => ${se(i.type_annotations)||"void"}`,d.push(i),i.uri=Re.uri,n&&n===O[i.selectionRange.start.line]&&je(n.symbol=i,n)}else d.push(...i()),")"===t?.content&&(t=R[++s]);else{if("-"!==t.content||"TK_NUMBER"!==(t=R[++s])?.type){"throw"===t.content.toLowerCase()&&"=>"===t.previous_token?.content&&(t=R[++s]);break e}d.push(`-${t.content}`),t=R[++s]}}if("|"!==t?.content)break;n=void 0}return d}();if((t=R[--s])||(t=R[s=R.length-1]),i.length){let t=new Set(i);t.delete("void"),e.type_annotations=Array.from(t)}return e.range.end=Re.document.positionAt(t.offset+t.length),s}function w(e=")"){let n,i,o=[],a=!0,c=0,l="",u=o.offset??=[];e:for(;(t=R[++s])&&t.content!==e;)if("TK_WORD"===t.type){if(!a){P(e);break e}if(n=g.create(t.content,r.SymbolKind.Variable,$e(t.offset,t.length)),1===a&&(o.hasref=n.pass_by_ref=!0,l+="&",a=!0),n.assigned=n.def=n.is_param=!0,o.push(n),t.semantic={type:f.parameter,modifier:p.definition},u.push(l.length),l+=t.content,t=R[++s],c&&(n.defaultVal=!1),"*"===t?.content?(o.variadic=n.arr=!0,t=R[++s],l+="*"):"?"===t?.content&&(n.defaultVal=null,t.ignore=!0,t=R[++s],l+="?"),":"===t?.content&&(t=R[s=S(n)+1],l+=`: ${se(n.type_annotations)||"unknown"}`),!t)break e;if(":="===t.content){if(!(t=R[++s])||t.content===e)break e;if(n.defaultVal=t.content,"-+".includes(t.content)&&"TK_NUMBER"===R[s+1]?.type&&(n.defaultVal+=R[++s].content),l+=` := ${n.defaultVal}`,!(t=R[++s]))break e}"["===t.content?(c++,t.ignore=!0,t=R[++s],l+=" ["):c&&"]"===t.content&&(c--,t.ignore=!0,t=R[++s],l+="]"),","===t?.content?l+=", ":(s--,a=!1)}else if(","===t.content){if(a){P(e);break e}l+=", ",a=!0}else if("*"===t.content){if(!a){P(e);break e}n=g.create("",r.SymbolKind.Variable,$e(t.offset,0)),i??=n,o.variadic=n.arr=n.assigned=n.def=n.is_param=!0,c&&(n.defaultVal=!1),a=!1,u.push(l.length),l+="*"}else if("["===t.content)c++,t.ignore=!0,l+="[";else if(c&&"]"===t.content)c--,t.ignore=!0,l=l.trimRight()+"] ";else{if(!0!==a||"&"!==t.content){P(e);break e}a=1,t.op_type=-1}return o.full=l,i&&o.push(i),o}function D(e,t,n,i=!1){let o={assume:d.DEFAULT,children:[],declaration:{},full:`${i?"static ":""}${e}(${t.full})`,global:{},hasref:t.hasref,kind:r.SymbolKind.Function,labels:{},name:e,param_def_len:t.full.length+2,param_offsets:t.offset,params:t,range:n,selectionRange:{...n},static:i,variadic:t.variadic};o.local=o.declaration;for(let e of t)o.local[e.name.toUpperCase()]=e;return delete o.local[""],o}function K(){for(;(t=R[++s])?.type.endsWith("COMMENT")&&(n=t););return t}function P(e){let n=1,i={">":"<",")":"(","]":"[","}":"{"}[e];for(t??=R.at(-1),Re.addDiagnostic(l.diagnostic.unexpected(t.content),t.offset,t.length);(t=R[++s])&&(t.content!==e||--n);){if(t.topofline>0)return s--;t.content===i&&++n}}}):(this.fsPath.replace(/^(.*)\.(ahk2?|ah2)$/i,((e,t)=>{let n=t+".d.ahk",i=this.d_uri=a.URI.file(n).toString().toLowerCase();if(!u.isBrowser&&!u.lexers[this.d_uri]){let e=(0,u.openFile)((0,u.restorePath)(n),!1);e&&(u.lexers[i]=new F(e,void 0,1)).parseScript()}return""})),this.parseScript=function(){G=this.document.getText(),z=G.length,B=this.scriptpath,V="",_=!0,Ee=!1,Z={...C},j=J=void 0,te=0,Q=-1,U={region:[],bracket:[]},K=!1,De=u.isahk2_h,this.clear(),H=this.include,O={},ne=[],b=u.extsettings.Warn?.CallWithoutParentheses;try{let e=u.utils.get_RCDATA("#2");e&&(H[e.uri]=e.path),this.children.push(...Ie())}catch(e){xe=Ee=Oe=!1,e instanceof q?e.message&&this.addDiagnostic(e.message,e.token.offset,e.token.length,r.DiagnosticSeverity.Warning):console.error(e)}Ne(),ge(this.declaration,this.children,this.diagnostics),this.diags=this.diagnostics.length,this.isparsed=!0,U.region.forEach((e=>this.addFoldingRange(e,te-1,"region"))),this.actived&&(this.actionwhenv1??="Continue")})}clear(){this.texts={},this.declaration={},this.include={},this.tokens={},this.linepos={},this.labels={},this.typedef={},this.object={method:{},property:{}},this.diagnostics.length=this.foldingranges.length=0,this.children.length=this.dllpaths.length=this.tokenranges.length=0,this.includedir.clear(),this.dlldir.clear(),this.hotstringExecuteAction=this.isparsed=!1,delete this.maybev1,delete this.checkmember,delete this.symbolInformation}get included(){return fe[this.uri]??{}}get relevance(){const e=this.uri,t={...de[e]};for(const n in fe[e])Object.assign(t,de[n]);return delete t[e],t}findSymbol(e,t,n){let i,o,s=this.uri;if(t===r.SymbolKind.Field){let t,r=this.tokens,a=n?this.document.offsetAt(n):-1;for(i of(o=n&&this.searchScopedNode(n),(o??this).labels?.[e.endsWith(":")?e.slice(0,-1):e]??[])){if(!i.def)break;if(-1===(t=i.data)||t<a&&(!(t=r[r[t].next_pair_pos]?.offset)||a<t))return{node:i,uri:s,scope:o}}return o&&null}let a,c,l=!0;if(e.startsWith("$"))return(i=p(this.d?s:this.d_uri))&&{node:i,uri:s,is_global:!0};if(o=n&&this.searchScopedNode(n))if(o.kind===r.SymbolKind.Class)o=void 0;else if(o.kind===r.SymbolKind.Property&&"THIS"===e)return{node:o.parent,uri:s,scope:o,is_this:!0};let f=o;for(;f?.local;){if(a=f.local[e]){i=a,c=f,l=!1,i.is_param&&f.parent?.kind===r.SymbolKind.Property&&(c=f.parent);break}if(f.has_this_param&&("THIS"===e||"SUPER"===e)){for(i=f;i.kind!==r.SymbolKind.Class;)if(!(i=i.parent))return null;if("THIS"===e)return{node:i,uri:s,scope:o,is_this:!0};V(i,this);let t=i,n=!t.prototype;return t=i=z(this,t.extends||(n?"object":"class"),t.extendsuri),!i||n&&!(i=t.prototype)?null:{node:i,uri:s,scope:o,is_this:!1}}if(((a=f.global?.[e])&&(i=a)||f.assume===d.GLOBAL)&&(l=!0))break;if((a=f.declaration?.[e])?(i=a,c=f,l=!1):i??=(c=f,f.unresolved_vars?.[e]),f.static&&f.kind===r.SymbolKind.Function){(a=f.parent?.local[e])?.static&&(i=a,c=f.parent),i?.def&&(l=!1);break}f=f.parent}return l&&(i=p(this.d_uri)??this.declaration[e]??(l=1,i)??(l=!0,this.typedef[e])),i&&{node:i,uri:s,scope:o,is_global:l,parent:c};function p(t){let n=u.lexers[t];if(!n)return;let i=n.declaration[e]??n.typedef[e];return i&&(s=i.uri=t,i)}}getContext(e,t=!1){let n,i,o,s,a,c=this.document,l=this.tokens,{line:u,character:d}=e,p=c.getText(r.Range.create(u,0,u+1,0)).trimRight();for(s=d;--s>=0&&y(p.charCodeAt(s)););if(!t)for(;y(p.charCodeAt(d));d++);let h=r.Range.create(u,s+=this.d&&"$"===p[s]?0:1,u,d),m=p.slice(s,d),g=m,_=c.offsetAt(h.start),b=(o=l[_])?o.previous_token:l[_-1];if("."===b?.content&&!o?.prefix_is_whitespace&&"TK_OPERATOR"!==b.type||(a=b&&Y(b)&&"TK_START_EXPR"===o?.type&&o.topofline<1&&("["===o.content||void 0===o.prefix_is_whitespace))){let e=b,t=a?b:b.previous_token,i=Boolean(o?.paraminfo)||"("===p[d];for(;t;)switch(t.type){case"TK_DOT":e=t,t=t.previous_token;break;case"TK_END_EXPR":if(!(t=l[t.previous_pair_pos]))break;e=t,!t.next_pair_pos||t.topofline>0?t=void 0:void 0===t.prefix_is_whitespace||"["===t.content&&!t.previous_token?.callsite?(t=t.previous_token)&&("TK_NUMBER"===t.type||"TK_STRING"===t.type||"%"===t.content&&(t=C)?(e=t,t=void 0):"TK_WORD"===t.type||"TK_DOT"===t.type||t.type.startsWith("TK_END_")||(t=void 0)):t=void 0;break;case"TK_START_BLOCK":case"TK_START_EXPR":break;case"TK_END_BLOCK":if(void 0!==t.in_expr){e=l[t.in_expr],t=void 0;break}if(e=t,!(t=l[t.previous_pair_pos]))break;case"TK_START_BLOCK":e=t.data?t:C,t=void 0;break;case"TK_NUMBER":case"TK_STRING":e=t,t=void 0;break;case"TK_WORD":if(e=t,t=t.previous_token){if("TK_DOT"===t.type)break;if("TK_START_BLOCK"===t.type){t=void 0;break}void 0===e.prefix_is_whitespace&&void 0!==t.previous_pair_pos&&"%"===t.content&&(e=C),t=void 0}break;case"TK_OPERATOR":if(t.ignore&&"?"===t.content){e=t,t=t.previous_token;break}default:t=void 0}/TK_WORD|TK_NUMBER|TK_STRING|TK_START_/.test(e.type)?(o=e,h.start=c.positionAt(e.offset),h.end=c.positionAt(b.offset+(a?1:0))):(o=C,n=r.SymbolKind.Null),g="",n??=a?r.SymbolKind.Variable:i?r.SymbolKind.Method:r.SymbolKind.Property}else if(o)if("TK_WORD"===o.type){let e,t=o.semantic,s=(i=o.symbol)??o.definition;if(s)n=s.kind,e=s,n===r.SymbolKind.Class?g=e.full:n!==r.SymbolKind.Property&&n!==r.SymbolKind.Method||(g=e.full.replace(/^\((\S+)\).*$/,((...t)=>`${t[1]}${e.static?".":"#"}${e.name}`)));else if(t)switch(t.type){case f.function:n=r.SymbolKind.Function;break;case f.method:n=r.SymbolKind.Method;break;case f.class:n=r.SymbolKind.Class;break;case f.property:n=r.SymbolKind.Property;break;case f.variable:if(o.ignore)break;case f.parameter:n=r.SymbolKind.Variable}else n=r.SymbolKind.Variable}else"TK_LABEL"===o.type&&(n=r.SymbolKind.Field);else if(b?.content.startsWith("#"))o=b,g=b.content;else if(g=(o=this.find_token(h.start.character===p.length?_-1:_)).content,o.type.endsWith("COMMENT")){let e=p.substring(0,d),t=e.match(/(@see|\{@link(code|plain)?|@param(\s+\{[^}]*\})?)\s+((\[\s*)?\S+)$/);if(t){if(e=t[4],t[1].startsWith("@param")){e=e.replace(/^\[\s*/,"");let t=o.symbol;t?.params&&(e=`${oe(t)}~${e}`)}else":"===p[d]&&/^[a-zA-Z]+$/.test(e)&&(e="");(t=e.match(/^(([\w.$#~]|[^\x00-\x7f])+)(\(\))?$/))&&(g=t[1],n=g.includes(".")?t[3]?r.SymbolKind.Method:r.SymbolKind.Property:t[3]?r.SymbolKind.Function:r.SymbolKind.Class)}}return n??=r.SymbolKind.Null,{text:g,word:m,range:h,kind:n,linetext:p,token:o,symbol:i}}searchScopedNode(e,t){let n,i,o,s,{line:a,character:c}=e;for(let l of t??this.children)if(!(!(n=l.children)||a>l.range.end.line||a<l.selectionRange.start.line||a===l.selectionRange.start.line&&c<l.selectionRange.start.character||a===l.range.end.line&&c>l.range.end.character)){if(e.line>l.selectionRange.start.line||e.character>l.selectionRange.end.character){switch(l=this.searchScopedNode(e,n)??l,l.kind){case r.SymbolKind.Property:return this.searchScopedNode(e,[l.get,l.set].filter(Boolean))??l;case r.SymbolKind.Class:for(o of(s=this.document.offsetAt(e),i=l,[i.property.__INIT,i.$property?.__INIT]))for(let t of o?.ranges??[]){if(s<=t[0])break;if(s<=t[1])return this.searchScopedNode(e,o.children)??o}}return l}return}}getScopeSymbols(e){if(!e||e.kind===r.SymbolKind.Class||e.kind===r.SymbolKind.Property)return{};let n=e,i=[n];for(;(n=n.parent)&&n.kind!==r.SymbolKind.Class;)i.push(n);let o=n?.kind===r.SymbolKind.Class?{THIS:t.THIS,SUPER:t.SUPER}:{};for(;n=i.pop();)n.kind!==r.SymbolKind.Property&&(n.assume===d.GLOBAL?o={}:n.assume===d.STATIC&&Object.entries(o).forEach((([e,t])=>!t.static&&null!==t.static&&delete o[e])),Object.assign(o,n.local??{}),Object.entries(n.declaration??{}).forEach((([e,t])=>o[e]??=t)),Object.entries(n.unresolved_vars??{}).forEach((([e,t])=>o[e]??=t)),Object.keys(n.global??{}).forEach((e=>delete o[e])));return o}initLibDirs(e){if(u.isBrowser)return;let t;for(t of u.extsettings.WorkingDirs)if(this.uri.startsWith(t)){e=a.URI.parse(t).fsPath.replace(/[\\/]$/,"");break}e?this.scriptdir=(0,u.restorePath)(e):(t=(0,o.resolve)()).toLowerCase()!==this.scriptpath.toLowerCase()&&t.toLowerCase()!==process.argv0.toLowerCase()&&this.scriptpath.toLowerCase().startsWith(t)&&!/\\lib(\\.+)?$/i.test(this.scriptpath)?(0,i.existsSync)(this.scriptpath+"\\Lib")&&(0,i.statSync)(this.scriptpath+"\\Lib").isDirectory()?this.scriptdir=this.scriptpath:this.scriptdir=t:this.scriptdir=this.scriptpath.replace(/\\Lib(\\.+)?$/i,""),this.libdirs=[e=this.scriptdir+"\\Lib\\"],e=e.toLowerCase();for(const e of u.libdirs)this.libdirs[0]!==e.toLowerCase()&&this.libdirs.push(e)}getColors(){let e=this.tokenranges,t=this.document,n=t.getText(),i=[];for(let o of e)if(2===o.type){let e,s=o.start,a=o.end,c=_.exec(n.substring(s,a)),l="";if(!c||!c[1]&&a-s!==c[2].length+2)continue;e=r.Range.create(t.positionAt(s+=c.index+1+(c[1]?.length??0)),t.positionAt(s+c[2].length)),l=c[5]?b[c[5].toLowerCase()]:void 0===c[3]?c[2]:c[2].substring(2);let u={red:0,green:0,blue:0,alpha:1},d=["red","green","blue"];void 0!==c[4]&&d.unshift("alpha");for(const e of d)u[e]=parseInt("0x"+l.substring(0,2))/255,l=l.slice(2);i.push({range:e,color:u})}return i}addDiagnostic(e,t,n,i=r.DiagnosticSeverity.Error,o){let s=this.document.positionAt(t),a=s;void 0!==n&&(a=this.document.positionAt(t+n)),(o||this.diagnostics).push({range:r.Range.create(s,a),message:e,severity:i})}addFoldingRange(e,t,n="block"){let i=this.document.positionAt(e).line,o=this.document.positionAt(t).line-("block"===n?1:0);i<o&&this.foldingranges.push(r.FoldingRange.create(i,o,void 0,void 0,n))}addFoldingRangePos(e,t,n="block"){let i=e.line,o=t.line-("block"===n?1:0);i<o&&this.foldingranges.push(r.FoldingRange.create(i,o,void 0,void 0,n))}addSymbolFolding(e,t){let n=u.extsettings.SymbolFoldingFromOpenBrace?this.document.positionAt(t).line:e.range.start.line,i=e.range.end.line-1,o=this.foldingranges;n<i&&(o[o.length-1]?.startLine===n&&o.pop(),o.push(r.FoldingRange.create(n,i,void 0,void 0,"block")))}update(){const e=this.uri,t=this.include;this.parseScript(),u.libfuncs[e]&&(u.libfuncs[e].length=0,u.libfuncs[e].push(...Object.values(this.declaration).filter((e=>e.kind===r.SymbolKind.Class||e.kind===r.SymbolKind.Function))));let n=this.include,i=0,o=Object.keys(n).length;for(const e in t)if(!n[e]){i=2;break}if(!i&&(o>Object.keys(t).length||!o&&""===t[""]&&Object.keys(fe[e]??{}).length)&&(i=1),!i)return this.sendDiagnostics(!0);if(U(this,this.scriptdir),1===i){const e=he(this);for(const t in this.included)Object.assign(de[t],e)}else pe();let s=this.scriptpath,a=Object.keys(de[e]).length;for(const t in fe[e])o=Object.keys(de[t]).length,(o>a||o===a&&u.lexers[t].scriptpath.length<s.length)&&(s=u.lexers[t].scriptpath,a=o);let c,l=s.toLowerCase();const d=this.relevance;(l+"\\").startsWith(this.scriptdir.toLowerCase()+"\\lib\\")?(s=this.scriptdir,l=s.toLowerCase()):l!==this.scriptdir.toLowerCase()&&this.initLibDirs(s);for(const e in d)delete t[e],(c=u.lexers[e]).scriptdir.toLowerCase()!==l&&c.initLibDirs(s);for(const e in t){const t=u.lexers[e];t&&!t.actived&&t.close()}this.sendDiagnostics(!0,!0)}clearDiagnostics(){this.last_diags&&(this.include={},this.last_diags=0,u.connection.sendDiagnostics({uri:this.document.uri,diagnostics:[]}))}sendDiagnostics(e=!1,t=!1){let n=this.last_diags;if((n!==this.diagnostics.length||e&&n)&&(u.connection.sendDiagnostics({uri:this.document.uri,diagnostics:this.diagnostics}),this.last_diags=this.diagnostics.length),t)for(let t in this.relevance)u.lexers[t]?.sendDiagnostics(e)}setWorkspaceFolder(){let e=this.uri;for(const t of u.workspaceFolders)if(e.startsWith(t))return this.workspaceFolder=t;return this.workspaceFolder=""}keepAlive(){if(this.actived)return!0;let e,{uri:t,d:n}=this;if(!u.lexers[t])return!1;if(n){if(n>2&&!t.includes("?"))return!0;if(u.lexers[t.slice(0,-5)+"ahk"]?.keepAlive())return!0}for(const n in this.relevance)if((e=u.lexers[n])?.actived&&e.relevance[t])return!0;return!1}close(e=!1,t=!0){if(this.actived=!1,!e&&this.keepAlive())return;this.clearDiagnostics();const n=this.relevance;if(!e&&this.workspaceFolder||(delete u.lexers[this.uri],delete de[this.uri],!this.actived&&u.lexers[this.d_uri]?.close(!1,!1)),!t)return;let i=!0;for(const e in n)i=!1,u.lexers[e]?.close(!1,!1);i?u.lexers[this.uri]||delete fe[this.uri]:pe()}findStrOrComment(e){let t,n=this.tokenranges,i=0,o=n.length-1,r=0;for(;i<=o;)if(t=n[r=i+o>>1],e<t.start)o=r-1;else{if(!(e>=t.end))break;i=r+1}if(i<=o&&t)return this.tokens[t.start]??((t=this.tokens[t.previous])?.data&&{...t.data,previous_token:t,type:""})}}function j(e,t=0,n=""){return{name:e,full:e,kind:t,extends:n,range:x,selectionRange:x,uri:""}}function W(e){let t=e.match(/^((([<>$~*!+#^]*?)(`?;|[\x21-\x3A\x3C-\x7E]|\w+|[^\x00-\x7f]))|~?(`?;|[\x21-\x3A\x3C-\x7E]|\w+|[^\x00-\x7f])\s+&\s+~?(`?;|[\x21-\x3A\x3C-\x7E]|\w+|[^\x00-\x7f]))(\s+up)?::$/i);if(!t)return!1;for(let e=4;e<7;e++)if((t[e]??"").length>1&&!w.test(t[e]))return!1;return!0}function $(e,t,n="",r=!1){let s,c="",l=e;if(!e.startsWith("<")||!e.endsWith(">")){for(;s=e.match(/%a_(\w+)%/i);){let t=s[1].toLowerCase();if(!u.a_vars[t])return;e=e.replace(s[0],u.a_vars[t])}if(e.indexOf(":")<0?e=(0,o.resolve)(n,e):e.includes("..")&&(e=(0,o.resolve)(e)),r&&!(0,i.existsSync)(e))return;return c=a.URI.file(e).toString().toLowerCase(),{uri:c,path:u.lexers[c]?.fsPath??e,raw:l}}{if(!(e=e.slice(1,-1)))return;let n=[e+".ahk"];(s=e.match(/^((\w|[^\x00-\x7f])+)_.*/))&&n.push(s[1]+".ahk");for(const o of t)for(const t of n)if((0,i.existsSync)(e=o+t))return c=a.URI.file(e).toString().toLowerCase(),{uri:c,path:u.lexers[c]?.fsPath??e,raw:l}}}function U(e,t){let n=e.include;for(const e in n){let o=n[e];if(!u.lexers[e]&&(0,i.existsSync)(o)){let n=(0,u.openFile)((0,u.restorePath)(o));if(!n)continue;let i=new F(n,t);u.lexers[e]=i,i.parseScript(),U(i,t)}}}function V(e,t){switch(e.kind){case r.SymbolKind.Method:case r.SymbolKind.Function:return I.FUNC;case r.SymbolKind.Number:return I[e.name.toUpperCase()];case r.SymbolKind.String:return I.STRING;default:if(!e.property)return;case r.SymbolKind.Class:let n,i,o=e;if(n=o.base)return n;if(i=!!o.prototype,o.extends)return o=z(t??u.lexers[o.uri],o.extends,o.extendsuri),i?o:o?.prototype;switch(o){case I.ANY:return;case u.ahkvars.ANY:return I.CLASS;default:return i?u.ahkvars.OBJECT:I.OBJECT}}}function B(e,t,n,i,o){let s,a,c,l,u=t,d=0,f=o??=[];for(n=n.toUpperCase();;){if(d===f.length){if(f.includes(u))break;f.push(u)}if(c=u.property?.[n]){if(c.kind===r.SymbolKind.Method===i)return c.uri??=u.uri,c;if(i&&((l=c).kind===r.SymbolKind.Class||(l=c.call)))return l.uri??=u.uri,l;i?s??=(c.uri??=u.uri,c):a??=(c.uri??=u.uri,c)}if(null===(l=f[++d]))break;if(!(u=l??V(u,e))){f.push(null);break}}if(s??=a)return s}function H(e,t){let n=B(t??=u.lexers[e.uri],e,"call",!0);return n?.full?.startsWith("(Object) static Call(")?B(t,e.prototype,"__new",!0)??n:n}function G(e,t,n){let i,o=[];do{if(i=t.property?.[n])return i.uri??=t.uri,i}while(t=(i=t.extends?.toLowerCase())&&[i,`(${i}) prototype`].includes(t.full.toLowerCase())&&!o.includes(t)&&o.push(t)?V(t,e):void 0)}function z(e,t,n){let i=t.toUpperCase().split("."),o=i.shift(),r=n?u.lexers[n]?.declaration[o]:le(e,o)?.node;if(r?.property&&!1!==r.def){for(o of(n??=r.uri,i))if(!(r=G(e,r,o)))return;return r.uri??=n,r}}function Y(e){switch(e.type){case"TK_DOT":return!0;case"TK_END_BLOCK":return Boolean(e.data??void 0!==e.in_expr);case"TK_END_EXPR":case"TK_NUMBER":case"TK_STRING":return!0;case"TK_WORD":return!e.paraminfo;case"TK_OPERATOR":if(1===e.op_type)return!0;switch(e.content){case"?":return Boolean(e.ignore);case"%":return void 0!==e.previous_pair_pos;case"++":case"--":return!e.topofline&&Y(e.previous_token??C)}default:return!1}}function X(e,n,i,o){let s,a,c,l=e.tokens,d=C,f=[],p=[],h=[0];s="object"==typeof i?e.document.offsetAt(i):i;e:for(;n&&n.offset<s;){switch(n.type){case"TK_STRING":case"TK_NUMBER":if(b())break e;f.push(n),d=n;break;case"TK_WORD":if(b())break e;if(f.push(n),d=n,n.symbol){n=e.find_token(e.document.offsetAt(n.symbol.range.end),!0);continue}if(n.callsite){if(n.next_token_offset>=s)break e;if(f.push(a={content:"",type:"TK_FUNC",paraminfo:n.callsite.paraminfo??n.paraminfo}),n=l[n.next_token_offset],a.data="("===n?.content,!n||!(n=l[n.next_pair_pos])){f.length=0;break e}}break;case"TK_DOT":if("TK_WORD"===(n=l[n.next_token_offset])?.type){if(a=l[n.next_token_offset],"["===a?.content&&a.topofline<1||"("===a?.content&&!a.prefix_is_whitespace){let e={content:n.content,type:"TK_FUNC"};if(f.push(e),a.offset>=s)break e;if(e.data="("===a.content,e.paraminfo=a.paraminfo,!(n=l[a.next_pair_pos])){f.length=0;break e}break}"%"!==a?.content||a.prefix_is_whitespace||void 0!==a.previous_pair_pos?f.push({content:n.content,type:"TK_FUNC"}):v()}else if("TK_START_EXPR"===n?.type){if(n.offset>=s)break e;if(f.push({content:"",type:"TK_FUNC",data:"("===n.content,paraminfo:n.paraminfo}),!(n=l[n.next_pair_pos])){f.length=0;break e}}else v();break;case"TK_OPERATOR":if("%"===n.content&&void 0===n.previous_pair_pos){if(n.prefix_is_whitespace){if(b())break e;v()}else v();break}case"TK_EQUALS":if(_(n))break e;break;case"TK_START_EXPR":if(!(n=l[(a=n).next_pair_pos])){f.length=0;break e}if(!a.symbol&&(!a.prefix_is_whitespace||"["===a.content&&a.topofline<1)&&(1===d.op_type||["TK_WORD","TK_NUMBER","TK_STRING","TK_END_EXPR"].includes(d.type)||"TK_END_BLOCK"===d.type&&(c=l[d.previous_pair_pos])&&(c.data??void 0!==c.in_expr)))f.push({content:"",type:"TK_FUNC",paraminfo:a.paraminfo,data:"("===a.content});else if("["===a.content)f.push({symbol:A});else{if(b())break e;if(f.push(a),a.symbol){d=n,n=e.find_token(e.document.offsetAt(a.symbol.range.end),!0);continue}}d=n;break;case"TK_START_BLOCK":if(!(n=l[(a=n).next_pair_pos])){f.length=0;break e}f.push(a);break;case"TK_COMMENT":case"TK_INLINE_COMMENT":case"TK_BLOCK_COMMENT":break;case"TK_COMMA":f.length=p.length=0,d=C,h=[0];break;case"TK_END_BLOCK":case"TK_END_EXPR":if(n.offset===s-1)break e;default:f.length=0;break e}n=l[n.next_token_offset]}if(!f.length)return[];for(;n=p.pop();)y(n);let m=new Set,g=[];for(n of f)if(n.symbol)if(n.symbol.kind===r.SymbolKind.Property){let t=n.symbol,i=t.parent;g=(t=i?.property?.[t.name.toUpperCase()])?ie(t,u.lexers[i.uri]??e,i):[]}else g=[n.symbol],n.symbol.uri??=e.uri;else switch(n.type){case"TK_FUNC":let i=!!n.data;g=J(e,g,n.content.toLowerCase()||(i?"call":"__item"),i,n.paraminfo);break;case"TK_WORD":let s=e.document.positionAt(n.offset),u=le(e,n.content,r.SymbolKind.Variable,s);if(!u)continue;g=new Set;let d=u.node;if(d.kind===r.SymbolKind.Variable)for(let t of Z(d,e,s,u.scope,o))g.add(t);else g.add(d);break;case"TK_NUMBER":g=/^[-+]?(\d+$|0[xX])/.test(n.content)?[K]:/^[-+]?\d+[.eE]/.test(n.content)?[O]:[P];break;case"TK_STRING":g=[t.STRING];break;case"TK_START_BLOCK":if(!(a=n.data))break;if(g=[a],a.uri??=e.uri,c=!a.extends&&a.property?.BASE){let t=ie(c,e,o);if(t.length<2)a.base=t[0];else{g=[];for(let e of t)g.push({...a,base:e})}}break;case"TK_START_EXPR":let f=(a=n.paraminfo?.comma)?.length?a.at(-1):n.next_token_offset;g=X(e,l[f],n.next_pair_pos-1,o);break;default:if("||"===n.content)for(let e of g)m.add(e);g=[]}for(let e of g)m.add(e);return[...m];function y(e){let n=h.pop(),i=f.splice(n??0),o={content:"",type:"TK_NUMBER"};if(void 0===n||!i.length)return f.length=0,!0;switch(e.op_type??("TK_EQUALS"===e.type&&0)){case-1:"&"===e.content&&1===i.length&&"TK_WORD"===i[0].type&&i[0].offset&&(o={symbol:t.VARREF});case 1:break;case 0:let r,s=f.splice((n=h.pop())??0);if(void 0===n||!s.length)return f.length=0,!0;if(e.content.startsWith("."))o.type="TK_STRING";else{if(":="===e.content)return h.push(f.length),void f.push(...i);if(["&&","and"].includes(r=e.content.toLowerCase()))return h.push(f.length),f.push(o),f.push({type:"TK_OPERATOR",content:"||",op_type:0}),void f.push(...i);if(["||","or","??","??=",":"].includes(r))return h.push(f.length),f.push(...s),f.push({type:"TK_OPERATOR",content:"||",op_type:0}),void f.push(...i)}break;default:return f.length=0,!0}h.push(f.length),f.push(o)}function _(e){let t=k(e,!1),n=p.length?k(p[p.length-1]):-1;for(;t<=n;){if(y(p.pop()))return!0;n=p.length?k(p[p.length-1]):-1}"?"===e.content?e.ignore||f.splice(h[h.length-1]??0):(p.push(e),!e.op_type&&h.push(f.length)),d=e}function b(){if(Y(d))return _(d={content:".",type:"TK_OPERATOR",op_type:0})}function v(){let e=n;f.splice(h[h.length-1]),f.push({symbol:t.ANY});do{for(;n;)if("TK_WORD"===n.type){if(e=n,!(n=l[n.next_token_offset])||"%"!==n.content||n.prefix_is_whitespace)break}else{if("%"!==n.content||void 0!==n.previous_pair_pos)break;if(e=l[n.next_pair_pos],!(n=l[e?.next_token_offset])||"TK_WORD"!==n.type||n.prefix_is_whitespace)break}if(n&&("["===n.content||"("===n.content&&!n.prefix_is_whitespace)){if(e=n,!(n=l[n.next_pair_pos]))break;e=n,n=l[n.next_token_offset]}}while("TK_DOT"===n?.type&&n.offset<s);d=n=e}function k(e,t=!0){if("TK_OPERATOR"===e.type)switch(e.content.toLowerCase()){case"++":case"--":return-1===e.op_type?77:82;case"||":case"or":return 17;case"&&":case"and":return 21;case"is":return 28;case">":case"<":case">=":case"<=":return 34;case"=":case"==":case"!=":case"!==":return 30;case"~=":return 36;case".":return 38;case"|":return 42;case"^":return 46;case"&":return-1===e.op_type?67:50;case"<<":case">>":case"<<<":return 54;case"//":case"*":case"/":return 62;case"+":case"-":return-1===e.op_type?67:58;case"**":return 73;case"not":return 25;case"!":return 67;case"?":return e.ignore?85:11;case":":return 11;default:return 0}return"TK_DOT"===e.type?86:"TK_EQUALS"===e.type?t?7:99:"TK_COMMA"===e.type?6:0}}function J(e,n,i,o,s){let a=new Set;for(let l of n){let n=l;switch(l.kind){case 0:return[t.ANY];case r.SymbolKind.Class:if(o&&"call"===i){if(!(l=B(e,n,i,o))){if(c(n))break;continue}let t=l.full??"";if(t.startsWith("(Object)"))l=n;else if(t.startsWith("(ComObject)")){let t=e.tokens,n=t[t[s?.offset]?.next_token_offset],i=[];"TK_STRING"===n?.type&&(i.push(n.content),","===(n=t[n.next_token_offset])?.content&&(n=t[n.next_token_offset],"TK_STRING"===n?.type&&(i.push(n.content),n=t[n.next_token_offset])),")"===n?.content&&a.add({kind:r.SymbolKind.Interface,name:"ComObject",full:`ComObject<${i.join(", ")}>`,generic_types:[i],range:x,selectionRange:x}));continue}break}case r.SymbolKind.Function:case r.SymbolKind.Method:if(o&&"call"===i)break;default:if(!(l=B(e,n,i,o))){if(l=c(n))break;continue}if(l.kind!==r.SymbolKind.Property){if(l.alias){if(s)continue;let t=ie(l,u.lexers[l.uri]??e,n);for(let n of o?J(e,t,"call",!0):t)a.add(n);continue}if(o)break;if(s)for(let t of J(e,[l],"__item",!1,s))a.add(t);else a.add(l);continue}if(l.alias){let t=J(e,ie(l,u.lexers[l.uri]??e,n),"call",!0);for(let n of o?J(e,t,"call",!0):t)a.add(n);continue}if(o||s&&!l.get?.params.length){for(let t of J(e,ie(l,u.lexers[l.uri]??e,n),o?"call":"__item",o,s))a.add(t);continue}}for(let t of ie(l,u.lexers[l.uri]??e,n))a.add(t)}return a;function c(t){let n=B(e,t,o?"__call":"__get",o);if(!n)return;if(n.kind===r.SymbolKind.Method&&!n.alias)return n;let i=n.kind===r.SymbolKind.Class?[n]:n.children?void 0:ie(n,u.lexers[n.uri]??e,t);if(i?.length)for(let t of J(e,i,"call",!0,s))a.add(t)}}function Q(e,t){if(!t||t.children)return t;let n=le(e,t.full.replace(/<.+/,""))?.node;return n?.prototype?n:void 0}function Z(e,n,i,o,s){let a,c,l=e.name.toUpperCase(),d=e,f=e.type_annotations?[e]:[];if(!o)for(const e in n?.relevance){let t=u.lexers[e]?.declaration?.[l];t?.type_annotations&&(f.includes(t)||f.push(t))}for(let e of f){if((c=e.returns)&&(e.returns=void 0),a=ie(e,n,s),c&&(e.returns=c),e.is_param&&e.pass_by_ref){let e=new Set;for(let i of a){if(i===t.VARREF)return[t.ANY];i.data===t.VARREF?ne(i.generic_types?.[1]??[t.ANY],e,n,s):e.add(i)}a=[...e]}if(a.includes(t.ANY)&&(a=[t.ANY])||!a.includes(N))return a;break}a??=[],c=void 0;for(const t of(o??n).children??[])if(l===t.name.toUpperCase()){if(t.kind!==r.SymbolKind.Variable)return[t];if(t.range.end.line>i.line||t.range.end.line===i.line&&t.range.end.character>i.character)break;(t.pass_by_ref||t.returns&&(void 0===t.for_index||ee(t,c??=n.document.offsetAt(i))))&&(e=t)}if(void 0!==e.for_index){if(e===d&&!ee(e,c??=n.document.offsetAt(i)))return[];let o=ie(e,n,s);for(let e of o)if(l(e))return[t.ANY];return a=[...new Set(a)],a.includes(t.ANY)?[t.ANY]:a;function l(i,o=!0){let s,d=0;switch(i.kind){case r.SymbolKind.Class:{let e=[];if(o&&(c=B(n,i,"__enum",!0,e))){if(c.kind!==r.SymbolKind.Method)break;for(let e of ie(c,u.lexers[c.uri]??n,i))l(e,!1);break}if((c=B(n,i,"call",!0,e))?.kind!==r.SymbolKind.Method)break;d=-1,s=i,i=c}case r.SymbolKind.Method:d++;case r.SymbolKind.Function:let f,p=i.params?.[e.for_index+d];if(!p||!(f=p.type_annotations))break;for(let e of f){if(e===t.VARREF)return!0;e.data===t.VARREF&&a.push(...te(e.generic_types?.[0]??[],n,s,Q(n,s)?.type_params))}}}}return e.pass_by_ref&&!e.is_param?function(e,n,i,o){let s=ue(n,e.selectionRange.start);if(!s||s.index<0)return[];let{pos:a,index:c,kind:l}=s,d=n.getContext(a),f=!0,p=X(n,d.token,d.range.end);if(p.includes(t.ANY))return[t.ANY];if(!p.length)return[];let h=d.text?"":d.word.toLowerCase();l===r.SymbolKind.Property?(h||="__item",f=!1):h||="call";for(let e of p)if(m(e,h,i))return[t.ANY];return(i=[...new Set(i)]).includes(t.ANY)?[t.ANY]:i;function m(e,i,s,a=0){switch(e.kind){case r.SymbolKind.Method:a++;case r.SymbolKind.Function:if(!f||"call"!==i)break;case r.SymbolKind.Property:let l,d=e.params?.[c+a];if(!d||!(l=d.type_annotations))break;for(let e of l){if(e===t.VARREF)return!0;e.data===t.VARREF&&s.push(...te(e.generic_types?.[0]??[],n,o,Q(n,o)?.type_params))}break;case r.SymbolKind.Class:let p=B(n,e,i,f),h=e;if(!p)break;if(f){if(p.kind===r.SymbolKind.Class)p=H(p);else if(p.full?.startsWith("(Object) static Call("))p=B(n,h.prototype,"__new",!0)??p;else if(p.kind===r.SymbolKind.Property||p.alias){let e=ie(p,u.lexers[p.uri]??n,h);return p.kind===r.SymbolKind.Property&&p.alias&&(e=J(n,e,"call",!0)),void e.forEach((e=>m(e,"call",s,-1)))}return void(p?.kind===r.SymbolKind.Method&&m(p,"call",s,-1))}if(p.kind===r.SymbolKind.Class)p=B(n,p,"__item",!1);else{if(p.kind!==r.SymbolKind.Property)return;if(!p.params){for(let e of ie(p,u.lexers[p.uri]??n,h))(e=B(n,e,"__item",!1))&&m(e,"",s);return}}p&&m(p,"",s)}}}(e,n,a,s):(a.push(...ie(e,n,s)),a=[...new Set(a)],a.includes(t.ANY)?[t.ANY]:a)}function ee(e,t){let n=e.data;return n[0]<=t&&t<n[1]}function te(e,n,i,o){let r,s=new Set;for(let n of e)"object"!=typeof n?((r=n.startsWith("typeof "))&&(n=n.substring(7)),"'\"".includes(n[0])?s.add(t.STRING):/^[-+]?(\d+$|0[xX])/.test(n)?s.add(K):/^[-+]?\d+[.eE]/.test(n)?s.add(O):s.add(`${r?"typeof ":""}${n}`)):s.add(n);let a=new Set;return ne([...s],a,n,i,o),[...a]}function ne(e,t,n,i,o){let s,a,c,l,u,d,f=-1;for(let s of e)f++,"string"==typeof s?((c=s.startsWith("typeof "))&&(s=s.substring(7)),(u=o?.[s.toUpperCase()])?ne(i.generic_types?.[u.data]??(u.type_annotations||[]),t,n,i,o):(l=(a="this"===s)&&i||le(n,s)?.node)&&(l.kind===r.SymbolKind.TypeParameter?(d=!0,e[f]="",e.push(...te(l.type_annotations||[],n))):l.kind!==r.SymbolKind.Variable&&(t.add(l=!c&&l.prototype||l),!a&&(e[f]=l)))):s.kind===r.SymbolKind.TypeParameter?(d=!0,e[f]="",e.push(...te(s.type_annotations||[],n))):t.add(o?p(s):s);function p(e){let t=e.generic_types;return t?(s??=new RegExp(`[< ](${Object.keys(o).join("|")})[,>]`,"i"),s.test(e.full)?(t=t.map((e=>e.flatMap((e=>"object"==typeof e?[p(e)]:(u=o[e.toUpperCase()])?i.generic_types?.[u.data]??(u.type_annotations||[]):[e])))),t.length||(t=void 0),{...e,generic_types:t,full:e.full.replace(/<.+/,t?`<${t.map((e=>se(e))).join(", ")}>`:"")}):e):e}d&&e.push(...new Set(e.splice(0).filter(Boolean)))}function ie(e,n,i){let o,r,s,a,c;switch(!e.cached_types){case!0:let c=e.type_annotations;if(!c)break;o=new Set;for(let e of c)"object"!=typeof e?((s=e.startsWith("typeof "))&&(e=e.substring(7)),"'\"".includes(e[0])?o.add(t.STRING):/^[-+]?(\d+$|0[xX])/.test(e)?o.add(K):/^[-+]?\d+[.eE]/.test(e)?o.add(O):o.add(`${s?"typeof ":""}${e}`)):o.add(e);if(o.has(t.ANY))return e.cached_types=[t.ANY];e.cached_types=[...o],a=o.has(N);default:if(ne(r=e.cached_types,o=new Set,n,i,i&&e.parent?.type_params),!a)return[...o]}if(e.returns){e.cached_types=[t.ANY],c=[];for(let t=0,o=e.returns,r=o.length;t<r;t+=2)c.push(...X(n,n.find_token(o[t],!0),o[t+1],i));if(o){for(let e of new Set(c))!e.property||e.name||o.has(e)||(o.add(e),r.push(e));c=[...o],e.cached_types=r}else o=new Set(c),e.cached_types=c=[...o]}else c=o?[...o]:[];return c}function oe(e){let t;switch(e.kind){case r.SymbolKind.Interface:return e.full;case r.SymbolKind.Class:return t=e,t.prototype?`typeof ${t.full}`:t.full||"Object";case r.SymbolKind.Function:if(e.name){let t=e,n=[e],i=[e.name];for(;t.parent?.params;)n.push(t=t.parent),i.push(t.name);if(!i.includes("")&&t.kind!==r.SymbolKind.Property)return t.kind!==r.SymbolKind.Function&&i.splice(-1,1,oe(t)),i.reverse().join("~")}let n=e;return t=n.full.replace(/^[^()]+/,""),t.length===n.param_def_len&&(n.params.some((e=>e.range_offset))&&(t=`(${n.params.map((e=>`${e.pass_by_ref?"&":""}${e.name}${null===e.defaultVal||e.range_offset?"?":e.defaultVal?` := ${e.defaultVal}`:e.arr?"*":""}`)).join(", ")})`),t+=` => ${re(e)||"void"}`),t;case r.SymbolKind.String:case r.SymbolKind.Number:return(e.data??e.name).toString();case r.SymbolKind.Null:return"unset";case r.SymbolKind.Method:case r.SymbolKind.Property:if(t=e.full?.match(/^\((.+?)\)/)?.[1])return`${t}${e.static?".":"#"}${e.name}`;default:return"unknown"}}function re(e,t){return se(e.type_annotations||ie(e,u.lexers[e.uri]??t))}function se(e){if(!e)return"";let t=[...new Set(e.map((e=>"string"==typeof e?e:oe(e))))],n=t.pop();return n?((t=t.map((e=>e.includes("=>")&&!"\"'".includes(e[0])?`(${e})`:e))).push(n),t.join(" | ")):""}function ae(e){if(e){let t=new F(s.TextDocument.create("","ahk2",0,`$:${e}`),void 0,-1);return t.parseScript(),t.declaration.$?.type_annotations??!1}return!1}t.Lexer=F,t.find_include_path=$,t.parse_include=U,t.get_class_base=V,t.get_class_member=B,t.get_class_members=function(e,t,n){let i=t,o=n??[],r=[];for(;i&&!o.includes(i);)o.push(i),r.push(i.property),i=V(i,e);if(!n)for(let e;i=o.pop();e=i.checkmember??=e);return Object.assign({},...r.reverse())},t.get_class_constructor=H,t.find_class=z,t.decltype_expr=X,t.decltype_invoke=J,t.decltype_returns=ie,t.generate_type_annotation=re,t.join_types=se;const ce=[r.SymbolKind.Variable,r.SymbolKind.Function,r.SymbolKind.Field];function le(e,t,n,i){let o,s,a=t.toUpperCase().split(/[.#~]/),c=a.shift(),l=a.length,d=!0,f=e.findSymbol(c,n,!l&&ce.includes(n)?i:void 0);if(null===f)return;let p=f?.scope;if(f&&1!==f.is_global?f.is_global&&f.node.kind===r.SymbolKind.Variable&&(s=y(e.relevance,c),s&&(s.node.kind!==r.SymbolKind.Variable||s.node.def&&!f.node.def)&&(f=s)):f=y(e.relevance,c)??f,n===r.SymbolKind.Field)return f;if((!f||f.node.kind===r.SymbolKind.Variable&&((d=!f.node.def)||f.is_global))&&(s=function(e){if(s=u.ahkvars[e])return s;for(let t of[u.ahkuris.ahk2_h,u.ahkuris.ahk2])if(s=u.lexers[t]?.typedef[e])return s.uri??=t,s;return d&&!l&&(s=u.lexers[o=u.ahkuris.winapi]?.declaration[e])?(s.uri??=o,s):void 0}(c))?f={uri:s.uri,node:s,is_global:!0}:p&&(p.uri??=e.uri,f.scope=p),!f)return;let h,m=c.length,g=f.node;for(c of(g.uri??=f.uri,a)){switch(t[m]){default:return;case"#":if(!(g=g.prototype))return;case".":if(!(g=G(e,g,c)))return;break;case"~":if(!(g=(h=g).declaration?.[c]))return;g.uri??=h.uri}m+=c.length+1}return l&&(n===r.SymbolKind.Method&&(s=g.call)&&(s.uri??=g.uri,g=s),f={node:g,uri:g.uri,parent:h}),f;function y(e,t){let i,o;for(const s in e)if(o=(u.lexers[s]??(0,u.openAndParse)((0,u.restorePath)(e[s]),!1))?.findSymbol(t,n)){if(o.node.kind!==r.SymbolKind.Variable)return o;(!i||o.node.def&&!i.node.def)&&(i=o)}return i}}function ue(e,t,n){let i,o,s,a=e.tokens,c=e.document.offsetAt(t);function l(t){let n=a[t.offset];if(i=e.document.positionAt(t.offset),"TK_WORD"===n.type)o=c>t.offset+n.content.length?0:-1;else{if(n.previous_token?.symbol)return;if(o=0,"["===n.content){if(1===n.topofline||!Y(n.previous_token))return;s=r.SymbolKind.Property}else if(n.prefix_is_whitespace||!Y(n.previous_token))return}if(-1!==o)for(let e of t.comma){if(!(c>e))break;++o}return s??=t.method?r.SymbolKind.Method:r.SymbolKind.Function,{name:t.name??"",pos:i,index:o,kind:s}}if(n)return l(n);let u=e.find_token(c),d=u.previous_token;if(!(c<=u.offset)||(u=d)){if(u.callsite&&c>u.offset+u.length&&t.line<=u.callsite.range.end.line)return l(u.paraminfo);if(!(u.topofline>0||t.line>e.document.positionAt(u.offset+u.length).line&&!ye(u,C)))for(;u.topofline<=0;){switch(u.type){case"TK_END_BLOCK":u=a[u.previous_pair_pos];break;case"TK_END_EXPR":u=a[(d=u).previous_pair_pos],u=u?.previous_token;break;case"TK_START_EXPR":case"TK_COMMA":if(d=u,u.paraminfo)return l(u.paraminfo);if("TK_COMMA"===d.type)return;break;case"TK_OPERATOR":"%"!==u.content||u.next_pair_pos||(u=a[u.previous_pair_pos])}if(!(u=u?.previous_token))break;if(u.callsite&&u.paraminfo)return l(u.paraminfo)}}}t.find_symbol=le,t.find_symbols=function(e,t){let n,{text:i,word:o,range:s,kind:a}=t;if(i)return(n=le(e,i,a,s.end))&&[n];let c=[],l=a===r.SymbolKind.Method,u=X(e,t.token,s.end);if(!o&&u.length){for(let e of u)c.push({node:e,uri:e.uri});return c}for(let t of u)(n=B(e,t,o,l))&&c.push({node:n,uri:n.uri,parent:t});return c.length?c:void 0},t.get_callinfo=ue;let de={},fe={};function pe(){de={},fe={};for(const e of Object.values(u.lexers))he(e)}function he(e,t){let{uri:n,include:i}=e,o=!0,r=de[n]??=(o=!1,{[n]:e.fsPath});(t=(t??=fe[n])?{...t}:{})[n]=e.fsPath;for(const s in i)if(Object.assign(fe[s]??={},t),e=u.lexers[s])if(r[s])t[s]||he(e,t);else{if(o&&t[s])continue;let i=he(e,t);i[n]?r=de[n]=Object.assign(i,r):Object.assign(r,i)}return r}function me(e,t){if(e.kind===t.kind)return e.kind===r.SymbolKind.Class?l.diagnostic.conflictserr("class","Class",e.name):e.kind===r.SymbolKind.Function?l.diagnostic.conflictserr("function","Func",e.name):l.diagnostic.dupdeclaration();switch(t.kind){case r.SymbolKind.Variable:return l.diagnostic.assignerr(e.kind===r.SymbolKind.Function?"Func":"Class",e.name);case r.SymbolKind.Function:return e.kind===r.SymbolKind.Variable?l.diagnostic.assignerr("Func",e.name):l.diagnostic.conflictserr("function","Class",e.name);case r.SymbolKind.Class:return e.kind===r.SymbolKind.Function?l.diagnostic.conflictserr("class","Func",e.name):e.kind===r.SymbolKind.Property||e.kind===r.SymbolKind.Method?l.diagnostic.dupdeclaration():l.diagnostic.assignerr("Class",e.name);case r.SymbolKind.Property:case r.SymbolKind.Method:return l.diagnostic.dupdeclaration()}return""}function ge(e,t,n){let i,o,s="";for(const a of t)if(a.name&&a.selectionRange.end.character)switch((i=a).kind){case r.SymbolKind.Variable:i.assigned||=Boolean(i.returns);case r.SymbolKind.Class:case r.SymbolKind.Function:if(o=e[s=a.name.toUpperCase()])if(o.is_global){if(i.kind===r.SymbolKind.Variable){if(i.def&&o.kind!==r.SymbolKind.Variable){1!==i.assigned&&n.push({message:l.diagnostic.assignerr(o.kind===r.SymbolKind.Function?"Func":"Class",a.name),range:a.selectionRange,severity:r.DiagnosticSeverity.Error});continue}}else if(o.def)1!==o.assigned&&n.push({message:l.diagnostic.assignerr(a.kind===r.SymbolKind.Function?"Func":"Class",a.name),range:o.selectionRange,severity:r.DiagnosticSeverity.Error});else if(o.kind===r.SymbolKind.Function){n.push({message:me(o,a),range:a.selectionRange,severity:r.DiagnosticSeverity.Error});continue}e[s]=a}else i.kind===r.SymbolKind.Variable?o.kind===r.SymbolKind.Variable?i.def&&!o.def?e[s]=a:o.assigned||=i.assigned:i.def&&(delete i.def,1!==i.assigned&&n.push({message:me(o,a),range:a.selectionRange,severity:r.DiagnosticSeverity.Error})):o.kind===r.SymbolKind.Variable?(o.def&&(delete o.def,1!==o.assigned&&n.push({message:me(a,o),range:o.selectionRange,severity:r.DiagnosticSeverity.Error})),e[s]=a):!1!==o.def?n.push({message:me(o,a),range:a.selectionRange,severity:r.DiagnosticSeverity.Error}):!1!==i.def&&(e[s]=a);else e[s]=a}}function ye(e,n,i){switch(e.type){case"":case"TK_COMMA":case"TK_EQUALS":case"TK_START_EXPR":return!0;case"TK_OPERATOR":if(e.ignore)return!1;if(!e.content.match(/^(%|\+\+|--)$/))return!0;default:switch(n.type){case"TK_DOT":case"TK_COMMA":case"TK_EQUALS":return!0;case"TK_OPERATOR":return!(n.content.match(/^(!|~|not|%|\+\+|--)$/i)||i?.ranges&&t.allIdentifierChar.test(n.content));case"TK_STRING":if(n.ignore)return!0;default:return!1}}}t.update_include_cache=pe,t.traverse_include=he,t.get_detail=function(e,t,n){let i=e.markdown_detail;return i?(n&&(i=i.replace(n,"")),i=i.replace(/\{@link(code|plain)?\b([^{}\n]*)\}/gm,((...e)=>{let n,i=e[2]?.trim()??"",o="";const s=i.search(/[|\s]/);if(-1!==s&&(o=i.substring(s+1).trim(),i=i.slice(0,s).trim()),t&&(n=i.match(/^(([\w.$#~]|[^\x00-\x7f])+)(\(\))?$/)?.[1])){const e=le(t,n,n.includes(".")?i.endsWith(")")?r.SymbolKind.Method:r.SymbolKind.Property:i.endsWith(")")?r.SymbolKind.Function:r.SymbolKind.Class);if(e&&(t=u.lexers[e.uri])){const{start:{line:n,character:r}}=e.node.selectionRange,s=encodeURIComponent(JSON.stringify([a.URI.parse(t.document.uri).toJSON(),[-1,{selection:{startLineNumber:n+1,startColumn:r+1}}]]));o||=i,i=`command:_workbench.open?${s}`}}return/^[a-z]+:/.test(i)?`[${"code"===e[1]?`\`${o}\``:o}](${i})`:` ${i} ${o} `})),i?{kind:"markdown",value:i}:""):e.detail??""},t.make_same_name_error=me,t.check_same_name_error=ge,t.is_line_continue=ye,t.update_comment_tags=function(e){let t=M;try{M=new RegExp(e,"i")}catch(e){throw M=t,e}}},701:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.searchAndOpenPEFile=t.getFileVersion=t.PEFile=t.RESOURCE_TYPE=t.DIRECTORY_ENTRY=void 0;const i=n(7147);var o,r;!function(e){e[e.IMAGE_DIRECTORY_ENTRY_EXPORT=0]="IMAGE_DIRECTORY_ENTRY_EXPORT",e[e.IMAGE_DIRECTORY_ENTRY_IMPORT=1]="IMAGE_DIRECTORY_ENTRY_IMPORT",e[e.IMAGE_DIRECTORY_ENTRY_RESOURCE=2]="IMAGE_DIRECTORY_ENTRY_RESOURCE",e[e.IMAGE_DIRECTORY_ENTRY_EXCEPTION=3]="IMAGE_DIRECTORY_ENTRY_EXCEPTION",e[e.IMAGE_DIRECTORY_ENTRY_SECURITY=4]="IMAGE_DIRECTORY_ENTRY_SECURITY",e[e.IMAGE_DIRECTORY_ENTRY_BASERELOC=5]="IMAGE_DIRECTORY_ENTRY_BASERELOC",e[e.IMAGE_DIRECTORY_ENTRY_DEBUG=6]="IMAGE_DIRECTORY_ENTRY_DEBUG",e[e.IMAGE_DIRECTORY_ENTRY_COPYRIGHT=7]="IMAGE_DIRECTORY_ENTRY_COPYRIGHT",e[e.IMAGE_DIRECTORY_ENTRY_GLOBALPTR=8]="IMAGE_DIRECTORY_ENTRY_GLOBALPTR",e[e.IMAGE_DIRECTORY_ENTRY_TLS=9]="IMAGE_DIRECTORY_ENTRY_TLS",e[e.IMAGE_DIRECTORY_ENTRY_LOAD_CONFIG=10]="IMAGE_DIRECTORY_ENTRY_LOAD_CONFIG",e[e.IMAGE_DIRECTORY_ENTRY_BOUND_IMPORT=11]="IMAGE_DIRECTORY_ENTRY_BOUND_IMPORT",e[e.IMAGE_DIRECTORY_ENTRY_IAT=12]="IMAGE_DIRECTORY_ENTRY_IAT",e[e.IMAGE_DIRECTORY_ENTRY_DELAY_IMPORT=13]="IMAGE_DIRECTORY_ENTRY_DELAY_IMPORT",e[e.IMAGE_DIRECTORY_ENTRY_COM_DESCRIPTOR=14]="IMAGE_DIRECTORY_ENTRY_COM_DESCRIPTOR",e[e.IMAGE_DIRECTORY_ENTRY_RESERVED=15]="IMAGE_DIRECTORY_ENTRY_RESERVED"}(o||(t.DIRECTORY_ENTRY=o={})),function(e){e[e.CURSOR=1]="CURSOR",e[e.BITMAP=2]="BITMAP",e[e.ICON=3]="ICON",e[e.MENU=4]="MENU",e[e.DIALOG=5]="DIALOG",e[e.STRING=6]="STRING",e[e.FONTDIR=7]="FONTDIR",e[e.FONT=8]="FONT",e[e.ACCELERATOR=9]="ACCELERATOR",e[e.RCDATA=10]="RCDATA",e[e.MESSAGETABLE=11]="MESSAGETABLE",e[e.GROUP_CURSOR=12]="GROUP_CURSOR",e[e.GROUP_ICON=14]="GROUP_ICON",e[e.VERSION=16]="VERSION",e[e.DLGINCLUDE=17]="DLGINCLUDE",e[e.PLUGPLAY=19]="PLUGPLAY",e[e.VXD=20]="VXD",e[e.ANICURSOR=21]="ANICURSOR",e[e.ANIICON=22]="ANIICON",e[e.HTML=23]="HTML",e[e.MANIFEST=24]="MANIFEST"}(r||(t.RESOURCE_TYPE=r={}));class s{close=()=>{};is_bit64;reader;resource={};dataDirectory=[];sectionTable=[];constructor(e){const t=Buffer.alloc(4096);let n,o,r,s;async function a(e,t){return(await r.read(Buffer.alloc(t),0,t,e)).buffer}async function c(e){return await r.read(t,0,2,e),t.readUInt16LE(0)}async function l(e){return await r.read(t,0,4,e),t.readUInt32LE(0)}this.is_bit64=new Promise((async(t,s)=>{try{if(r=await i.promises.open(e,"r"),this.close=()=>r?.close(),23117!==await c(0))throw Error("no MS-DOS stub");if(n=await l(60),17744!==await l(n))throw Error("no PE file");o=n+24,t(523===await c(o))}catch(e){return r?.close(),s(e)}})),this.reader=()=>s??=new Promise((async(e,i)=>{try{let i=await this.is_bit64,s=o+(i?112:96),u=await l(s-4),d=await c(n+6),f=await c(n+20),p=Buffer.alloc(40*d),{dataDirectory:h,sectionTable:m}=this;if((await r.read(p,0,p.length,o+f)).bytesRead!==p.length)throw Error("bad PE file");for(let e=0,t=0;e<d;e++,t+=40){let e=p.readUInt32LE(t+12),n=p.readUInt32LE(t+16),i=p.readUInt32LE(t+20);m.push({virtualAddress:e,sizeOfRawData:n,pointerToRawData:i})}if(this.sectionTable=m=m.sort(((e,t)=>t.virtualAddress-e.virtualAddress)),p=Buffer.alloc(8*u),(await r.read(p,0,p.length,s)).bytesRead!==p.length)throw Error("bad PE file");for(let e=0,t=0;e<u;e++,t+=8)h.push({virtualAddress:p.readUInt32LE(t),size:p.readUInt32LE(t+4)});function g(e){let t=m.find((t=>e>=t.virtualAddress));if(!t||e>=t.virtualAddress+t.sizeOfRawData)throw Error("out of range");return e-t.virtualAddress+t.pointerToRawData}async function y(e){return await r.read(t,0,t.length,g(e)),t.subarray(0,t.indexOf(Buffer.alloc(1))).toString()}e({readUInt16LE:c,readUInt32LE:l,RVA2Offset:g,read:a,readString:y})}catch(e){return this.close(),i(e)}}))}async getExport(){const e=await this.reader(),t=this.dataDirectory[o.IMAGE_DIRECTORY_ENTRY_EXPORT];if(!t?.virtualAddress)return;if(t.data)return t.data;const n=t.virtualAddress,i=n+t.size;let r=await e.read(e.RVA2Offset(n),40),s=r.readUInt32LE(12),a=r.readUInt32LE(16),c=r.readUInt32LE(20),l=r.readUInt32LE(24),u=e.RVA2Offset(r.readUInt32LE(28)),d=e.RVA2Offset(r.readUInt32LE(32)),f=e.RVA2Offset(r.readUInt32LE(36));const p={Module:await e.readString(s),Functions:[],OrdinalBase:a},h={};for(let t=0;t<l;t++){let t=await e.readUInt32LE(d),o=await e.readUInt16LE(f),r=await e.readUInt32LE(u+4*o);d+=4,f+=2,h[o]=!0;let s=r>n&&r<i?await e.readString(r):"0x"+(r+4294967296).toString(16).substring(1);p.Functions.push({Name:await e.readString(t),EntryPoint:s,Ordinal:a+o})}for(let t=0;l<c;t++,l++){for(;h[t];)t++;let o=await e.readUInt32LE(u+4*t),r=o>n&&o<i?await e.readString(o):"0x"+(o+4294967296).toString(16).substring(1);h[t]=!0,p.Functions.splice(t,0,{Name:"",EntryPoint:r,Ordinal:a+t})}return t.data=p}async getImport(){const e=await this.reader(),t=this.dataDirectory[o.IMAGE_DIRECTORY_ENTRY_IMPORT];if(!t?.virtualAddress)return;if(t.data)return t.data;const n=e.RVA2Offset(t.virtualAddress);let i,r,s,a=await e.readUInt32LE(n+12),c=await e.readUInt32LE(n+16),l=4,u=n;await this.is_bit64?(l=8,r=BigInt(65535),s=BigInt("0x8000000000000000"),i=async t=>(await e.read(t,8)).readBigUInt64LE()):(r=65535,s=2147483648,i=e.readUInt32LE);const d={};for(;c;){let t,n=d[await e.readString(a)]=[];for(let o=0;t=await i(e.RVA2Offset(c+o*l));o++)n.push(t&s?"Ordinal#"+(t&r):await e.readString(Number(t)+2));u+=20,a=await e.readUInt32LE(u+12),c=await e.readUInt32LE(u+16)}return t.data=d}async getResource(...e){const t=await this.reader(),n=this.dataDirectory[o.IMAGE_DIRECTORY_ENTRY_RESOURCE];if(!n?.virtualAddress)return;if(1===e.length&&this.resource[e[0]])return this.resource[e[0]];const i=t.RVA2Offset(n.virtualAddress),s=[i],a={};return e.forEach((e=>this.resource[e]??=a[e]=[])),a[r.RCDATA]&&=this.resource[r.RCDATA]={},await async function e(n,o=0){const u={NumberOfNamedEntries:await t.readUInt16LE(n+12),NumberOfIdEntries:await t.readUInt16LE(n+14)},d=[],f=u.NumberOfIdEntries+u.NumberOfNamedEntries;n+=16;for(let u=0;u<f;u++,n+=8){let u=await t.readUInt32LE(n);if(0===o&&!a[65535&u])continue;let f,p,h=await t.readUInt32LE(n+4),m={name:u,id:65535&u,pad:4294901760&u,nameOffset:2147483647&u,offsetToData:h,dataIsDirectory:Boolean((2147483648&h)>>31),offsetToDirectory:2147483647&h};if((2147483648&u)>>31){const e=i+m.nameOffset,n=await t.readUInt16LE(e);f=(await t.read(e+2,2*n)).toString("utf16le")}else p=u;if(m.dataIsDirectory){if(s.includes(i+m.offsetToDirectory))break;s.push(i+m.offsetToDirectory);let t=await e(i+m.offsetToDirectory,o+1);if(void 0===t)break;d.push({struct:m,id:p,name:f,directory:t})}else{let e=i+m.offsetToDirectory,n={struct:{offsetToData:await t.readUInt32LE(e),size:await t.readUInt32LE(e+4),codePage:await t.readUInt32LE(e+8),reserved:await t.readUInt32LE(e+12)},lang:1023&m.name,subLang:m.name>>10};d.push({struct:m,id:p,name:f,data:n})}if(0===o){const e=d[d.length-1];if(m.id===r.VERSION){const t=e.directory?.entries[0].directory?.entries??[];for(const e of t){const t=e.data?.struct;t&&await c(a[16],t)}}else if(m.id===r.MANIFEST){const t=e.directory?.entries[0].directory?.entries??[];for(const e of t){const t=e.data?.struct;t?.size&&a[24].push(await l(t))}}else{if(m.id!==r.RCDATA)throw Error("not handled");{a[10]instanceof Array&&(a[10]={});let n=a[10];for(let i of e.directory?.entries??[]){const e=i.name??`#${i.id}`,o=i.directory?.entries?.pop()?.data?.struct;o&&(n[e.toLowerCase()]=await t.read(t.RVA2Offset(o.offsetToData),o.size))}}}}}return{struct:u,entries:d}}(i),e.forEach((e=>a[e]??=this.resource[e])),1===e.length?a[e[0]]:a;async function c(e,n){let i=0,o=0,r=n.offsetToData;const s=await t.read(t.RVA2Offset(r),n.size);f(o),o=u(2+i,r),s.readUInt32LE(o),s.readUInt32LE(o+4);const a=s.readUInt32LE(o+8),c=s.readUInt32LE(o+12),l=(s.readUInt32LE(o+16),s.readUInt32LE(o+20),s.readUInt32LE(o+24),s.readUInt32LE(o+28),s.readUInt32LE(o+32),s.readUInt32LE(o+36),s.readUInt32LE(o+40),s.readUInt32LE(o+44),s.readUInt32LE(o+48),{StringTable:[],Version:[a>>16,65535&a,c>>16,65535&c].join(".")});e.push(l),o=u(o+52,r);let d=f(o);if("StringFileInfo"===d.Key&&[0,1].includes(d.Type)&&0===d.ValueLength){let e=u(2+i,r);for(;;){const t=f(e),n={};for(l.StringTable.push(n),o=u(2+i,r);o<e+t.Length;){let s=o,a=f(o);o=u(2+i,r);let c=f(o,!1);o=0===a.Length?e+t.Length:u(s+a.Length,r),n[a.Key]=c.Key}if(o=u(t.Length+e,r),o===e||o>=d.Length)break;e=o}}function f(e,t=!0){let n={};return t&&(n={Length:s.readUInt16LE(e),ValueLength:s.readUInt16LE(e+2),Type:s.readUInt16LE(e+4)},e+=6),i=2*(s.indexOf(Buffer.alloc(2),e)+1>>1),{...n,Key:s.subarray(e,i).toString("utf16le")}}}async function l(e){return(await t.read(t.RVA2Offset(e.offsetToData),e.size)).toString()}function u(e,t){return(e+t+3&4294967292)-(4294967292&t)}}}t.PEFile=s,t.getFileVersion=function(e){return new s(e).getResource(r.VERSION)},t.searchAndOpenPEFile=async function(e,t){let n,o,r="",a=[""];for(;;)try{if(!(0,i.existsSync)(e))throw Error();n=new s(e);let o=await n.is_bit64;if(r&&void 0!==t&&o!==t)throw n.close(),Error();return n}catch(n){if(n instanceof Error||-4058===n.errno){if(!o){if(e.includes(":")||!(o=process.env.Path?.split(";")))return;!1===t&&o.unshift("C:\\Windows\\SysWOW64\\"),r=e,r.toLowerCase().endsWith(".dll")||a.push(".dll")}let n;e:for(;void 0!==(n=o.pop());)for(let t of a)if(n&&(0,i.existsSync)(e=(n.endsWith("/")||n.endsWith("\\")?n:n+"\\")+r+t))break e;if(!n)return}}}},7955:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.get_ahkProvider=void 0;const i=n(433),o=n(2081),r=n(9770),s=n(3939);let a;t.get_ahkProvider=async function(){if(void 0!==a)return a;let e=0;return s.isWindows&&(e=await async function(){return new Promise((async e=>{let t=(0,r.resolvePath)(s.ahkpath_cur);if(!t)return e(0);let n,a=1200;for(;;)try{n=await(0,i.createClientSocketTransport)(a);break}catch(e){a++}let c=(0,o.spawn)(t,[`${s.rootdir}/server/dist/ahkProvider.ahk`,a.toString()]);if(!c||!c.pid)return e(0);let l=t=>{if(l=void 0,!t)return e(0);t.onNotification("initialized",(n=>(t.dispose(),e(n)))),t.listen()};c.on("close",(()=>l&&l(null))),n.onConnected().then((e=>l&&l((0,i.createMessageConnection)(...e))),(e=>l&&l(null)))}))}()),e?new Promise((t=>{let n=!1;a=(0,i.createMessageConnection)(...(0,i.createServerSocketTransport)(e)),a.onNotification("initialized",(()=>{n=!0,t(a??(a=void 0,null))})),a.onClose((()=>a=void 0)),a.listen(),setTimeout((()=>{n||(a?.dispose(),t(a=null))}),500)})):a=null}},6487:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.codeActionProvider=void 0;const i=n(7147),o=n(2374),r=n(7994),s=n(3939);t.codeActionProvider=async function(e,t){let n=e.textDocument.uri,a=s.lexers[n.toLowerCase()];if(!a||t.isCancellationRequested)return;let c,l=new RegExp("^"+r.diagnostic.filenotexist().replace("{0}","(.+?)\\*(\\.\\w+)")),u="",d=new RegExp(`${r.diagnostic.unexpected("(.+)")}, ${r.diagnostic.didyoumean(":=").toLowerCase()}`.replace("?","\\?")+"$|^"+r.diagnostic.deprecated("([^'\"]+)","([^'\"]+)")),f=[],p={};for(const e of a.diagnostics)if(c=d.exec(e.message))(p[c[3]?`${c[3]} ${u=c[2]}`:`${c[1]} ${u=":="}`]??=[]).push({range:e.range,newText:u});else if(c=l.exec(e.message)){u=a.document.getText(e.range);let t=(0,s.restorePath)(c[1]),l=new RegExp(c[2]+"$","i"),d=[],p=Object.assign({},e.range);p.start=Object.assign({},p.start),p.start.character=0;for(const e of(0,i.readdirSync)(t))try{l.test(e)&&d.push(`#Include '${t}${e}'`)}catch{}let h={range:p,newText:d.join("\n")},m={title:r.codeaction.include(t+"*"+c[2]),kind:o.CodeActionKind.QuickFix};m.edit={changes:{[n]:[h]}},f.push(m)}for(let[e,t]of Object.entries(p))f.push({title:e.replace(/(\S+) (\S+)/,"Replace '$1' with '$2'"),edit:{changes:{[n]:t}},kind:o.CodeActionKind.QuickFix});return f.length?f:void 0}},4104:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.colorProvider=t.colorPresentation=void 0;const i=n(3939);t.colorPresentation=async function(e,t){let n,o="RGB: ",r={range:e.range,newText:""},s=e.color,a=i.lexers[e.textDocument.uri.toLowerCase()]?.document.getText(e.range),c="";if(a&&!t.isCancellationRequested){for(const e of[s.alpha,s.red,s.green,s.blue])c+=("00"+Math.round(255*e).toString(16)).slice(-2);return(n=a.match(/^(0x)?([\da-f]{6}([\da-f]{2})?)/i))?r.newText=(n[1]||"")+c.slice(-n[2].length):r.newText=c.substring(2),o+=r.newText,[{label:o,textEdit:r}]}},t.colorProvider=async function(e,t){if(!t.isCancellationRequested)return i.lexers[e.textDocument.uri.toLowerCase()]?.getColors()}},6129:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.diagnosticFull=t.exportSymbols=t.generateComment=t.generate_fn_comment=t.setTextDocumentLanguage=t.insertSnippet=void 0;const i=n(2374),o=n(3939);function r(e){return!!o.extsettings.commands?.includes(e)||(o.connection.console.warn(`Command '${e}' is not implemented!`),!1)}function s(e){return e?.replace(/^[ \t]*(\*?[ \t]*(?=@)|\* ?)/gm,"").replace(/^\/\*+\s*|\s*\**\/$/g,"")??""}function a(e,t){r("ahk2.insertSnippet")&&o.connection.sendRequest("ahk2.insertSnippet",[e,t])}function c(e,t,n){let i,r,s=n?.replace(/\$/g,"\\$").split("\n"),a=[],c=[],l=["/**"],u={},d=0,f=!0;if(s?.forEach((e=>{(r=e.match(/^@(param|arg)\s+(({[^}]*}\s)?\s*(\[.*?\]|\S+).*)$/i))?(i=u[r[4].replace(/^\[?((\w|[^\x00-\x7f])+).*$/,"$1").toUpperCase()]??=[]).push("@param "+r[2].trim()):(r=e.match(/^@(returns?)([\s:]\s*(.*))?$/i))?(i=a,a.push(`@${r[1].toLowerCase()} ${r[3]}`)):i&&!e.startsWith("@")?i.push(e):(i=void 0,c.push(e))})),c.join("").trim()?c.forEach((e=>l.push(" * "+e))):(l.push(" * $0"),f=!1),t.params.forEach((t=>{if(i=u[t.name.toUpperCase()])i.forEach((e=>l.push(" * "+e)));else if(t.name){let n=(0,o.generate_type_annotation)(t,e);n?l.push(` * @param \${${++d}:{${n}\\}} ${t.name} $${++d}`):l.push(` * @param ${t.name} $${++d}`)}})),a.length)a.forEach((e=>l.push(" * "+e)));else{let n=(0,o.generate_type_annotation)(t,e);n&&l.push(` * @returns \${${++d}:{${n}\\}} $${++d}`)}l.push(" */");let p=l.join("\n");return f&&(p=p.replace(new RegExp(`\\$${d}\\b`),"$0")),p}t.insertSnippet=a,t.setTextDocumentLanguage=function(e,t){if(r("ahk2.setTextDocumentLanguage"))return o.connection.sendRequest("ahk2.setTextDocumentLanguage",[e,t])},t.generate_fn_comment=c,t.generateComment=async function(){if(!r("ahk2.getActiveTextEditorUriAndPosition")||!r("ahk2.insertSnippet"))return;let{uri:e,position:t}=await o.connection.sendRequest("ahk2.getActiveTextEditorUriAndPosition"),n=o.lexers[e=e.toLowerCase()],l=n.searchScopedNode(t),u=l?.children||n.children;for(const e of u)if((e.kind===i.SymbolKind.Function||e.kind===i.SymbolKind.Method)&&e.selectionRange.start.line===t.line&&e.selectionRange.start.character<=t.character&&t.character<=e.selectionRange.end.character){l=e;break}if(!l||!l.params)return;let d,f,p,h=l.selectionRange.start;if(void 0===l.markdown_detail)d=`${c(n,l)}\n`,f=n.tokens[n.document.offsetAt(h)],2===f.topofline&&(f=f.previous_token),h=n.document.positionAt(f.offset),p={start:h,end:h};else{if(f=n.find_token(n.document.offsetAt({line:h.line-1,character:0})),"TK_BLOCK_COMMENT"!==f.type)return;d=c(n,l,s(l.detail)),p={start:n.document.positionAt(f.offset),end:n.document.positionAt(f.offset+f.length)}}a(d,p)},t.exportSymbols=function(e){let t=o.lexers[e.toLowerCase()],n={},r={};if(t){(0,o.update_include_cache)();for(let e of[t.uri,...Object.keys(t.relevance)]){if(!(t=o.lexers[e]))continue;let n;n=Object.entries(t.include).map((e=>o.lexers[e[0]]?.fsPath??(0,o.restorePath)(e[1]))),!n.length&&(n=void 0),a(Object.values(t.declaration),r[t.fsPath||t.document.uri]={includes:n})}return r}function a(e,r){let c,l,u,d;for(let t of e)if(t.selectionRange.end.character)switch(c=t.kind){case i.SymbolKind.Class:u=t,(r.classes??=[]).push(d={name:t.name,label:u.full,extends:p(u),detail:h(t)}),a(Object.values(u.property??{}),d),a(Object.values(u.$property??{}),d);break;case i.SymbolKind.Property:if(l=t,(r.properties??=[]).push({name:t.name,label:l.full,static:l.static??!1,variadic:l.variadic??!1,params:m(l.params),readonly:l.params&&!t.set||!1,detail:h(t)}),!(t=t.call))break;case i.SymbolKind.Function:case i.SymbolKind.Method:l=t,(r[c===i.SymbolKind.Function?"functions":"methods"]??=[]).push({name:t.name,label:l.full,static:l.static??!1,variadic:l.variadic??!1,params:m(l.params),detail:h(t)})}function f(e){switch(e.defaultVal){case!1:return null;case null:return"unset";default:return e.defaultVal}}function p(e){let i;if(i=e.extends)return n[`${e.extendsuri},${i}`]??=(0,o.find_class)(t,i,e.extendsuri)?.full||i}function h(e){return e.markdown_detail?s(e.detail):e.detail??""}function m(e){return e?.map((e=>({name:e.name,defval:f(e),byref:e.pass_by_ref??!1,variadic:e.arr??!1,type:(0,o.join_types)(e.type_annotations)})))}}},t.diagnosticFull=async function(){if(!r("ahk2.getActiveTextEditorUriAndPosition")||!r("ahk2.insertSnippet"))return;let{uri:e}=await o.connection.sendRequest("ahk2.getActiveTextEditorUriAndPosition");const t=o.lexers[e.toLowerCase()];if(t){(0,o.update_include_cache)();for(let e in t.relevance)(e=o.lexers[e]?.document.uri)&&(0,o.semanticTokensOnFull)({textDocument:{uri:e}});(0,o.semanticTokensOnFull)({textDocument:{uri:e}})}}},3939:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,o)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.sleep=t.set_WorkspaceFolders=t.set_version=t.set_locale=t.set_dirname=t.set_Connection=t.set_ahkpath=t.set_ahk_h=t.clearLibfuns=t.arrayEqual=t.enumNames=t.make_search_re=t.sendAhkRequest=t.update_settings=t.enum_ahkfiles=t.loadahk2=t.initahk2cache=t.getwebfile=t.getlocalefile=t.getlocalefilepath=t.restorePath=t.openAndParse=t.openFile=t.completionItemCache=t.workspaceFolders=t.libdirs=t.hoverCache=t.libfuncs=t.ahkvars=t.ahkuris=t.ahk_version=t.isahk2_h=t.rootdir=t.locale=t.ahkpath_cur=t.connection=t.utils=t.extsettings=t.alpha_3=t.lexers=t.winapis=void 0;const r=n(1017),s=n(7237),a=n(7147),c=n(8952),l=n(8329),u=n(6169),d=n(7994),f=n(4780);var p;function h(e,n=!0){if(f.isBrowser){let t=y(e);return t?c.TextDocument.create(t.url,"ahk2",-10,t.text):void 0}{let i;try{i=(0,a.readFileSync)(e)}catch(t){return void(n&&(delete t.stack,t.path=e,console.log(t)))}if(255===i[0]&&254===i[1])i=i.toString("utf16le");else if(239===i[0]&&187===i[1]&&191===i[2])i=i.toString("utf8").substring(1);else try{i=new TextDecoder("utf8",{fatal:!0}).decode(i)}catch{return void(n&&t.connection.window.showErrorMessage(d.diagnostic.invalidencoding(e)))}return c.TextDocument.create(s.URI.file(e).toString(),"ahk2",-10,i)}}function m(e){if(f.isBrowser||!(0,a.existsSync)(e))return e;e.includes("..")&&(e=(0,r.resolve)(e));let t=e.toLowerCase().split(/[/\\]/),n=1,i=t[0],o=e.split(/[/\\]/);for(;n<t.length;){try{for(const e of(0,a.readdirSync)(i+r.sep))if(e.toLowerCase()===t[n]){i+=r.sep+e;break}}catch{i+=r.sep+o[n]}n++}return i}function g(e){let n,i=e.match(/<>./);if(i){if((0,a.existsSync)(n=e.replace("<>",t.locale)))return n;if("zh-tw"===t.locale.toLowerCase()&&(0,a.existsSync)(n=e.replace("<>","zh-cn")))return n;if((0,a.existsSync)(n=e.replace(i[0],"")))return n}else if((0,a.existsSync)(e))return e}function y(e){let n,i=e.match(/<>./),o=[],r=new XMLHttpRequest;if(i?(o.push(e.replace("<>",t.locale)),"zh-tw"===t.locale.toLowerCase()&&o.unshift(e.replace("<>","zh-cn")),o.unshift(e.replace(i[0],""))):o.push(e),n=o.pop())return function e(t){return r.open("GET",t,!1),r.send(),200===r.status?{url:t,text:r.responseText}:(n=o.pop())?e(n):void 0}(n)}o(n(6487),t),o(n(4104),t),o(n(6129),t),o(n(6810),t),o(n(4780),t),o(n(3113),t),o(n(2793),t),o(n(9541),t),o(n(6169),t),o(n(7994),t),o(n(6658),t),o(n(5932),t),o(n(6001),t),o(n(5373),t),o(n(5116),t),function(e){e[e.Disabled=0]="Disabled",e[e.Local=1]="Local",e[e["User and Standard"]=2]="User and Standard",e[e.All=3]="All"}(p||(p={})),t.winapis=[],t.lexers={},t.alpha_3=b("2.1.0.3"),t.extsettings={ActionWhenV1IsDetected:"Warn",AutoLibInclude:0,CommentTags:"^;;\\s*(.*)",CompleteFunctionParens:!1,CompletionCommitCharacters:{Class:".(",Function:"("},Diagnostics:{ClassStaticMemberCheck:!0,ParamsCheck:!0},Files:{Exclude:[],MaxDepth:2},FormatOptions:{},InterpreterPath:"C:\\Program Files\\AutoHotkey\\v2\\AutoHotkey.exe",SymbolFoldingFromOpenBrace:!1,Warn:{VarUnset:!0,LocalSameAsGlobal:!1,CallWithoutParentheses:!1},WorkingDirs:[]},t.utils={get_DllExport:(e,t=!1)=>Promise.resolve([]),get_RCDATA:e=>{},get_ahkProvider:async()=>null},t.ahkpath_cur="",t.locale="en-us",t.rootdir="",t.isahk2_h=!1,t.ahk_version=b("3.0.0.0"),t.ahkuris={},t.ahkvars={},t.libfuncs={},t.hoverCache={},t.libdirs=[],t.workspaceFolders=[],t.openFile=h,t.openAndParse=function(e,n=!0,i=!0){let o=h(e,n);if(o){let e=new u.Lexer(o);return e.parseScript(),i&&(t.lexers[e.uri]=e),e}},t.restorePath=m,t.getlocalefilepath=g,t.getlocalefile=function(e,t){let n=g(e);if(n)return(0,a.readFileSync)(n,t?{encoding:t}:void 0)},t.getwebfile=y,t.initahk2cache=function(){let e=l.CompletionItemKind.Keyword;t.ahkvars={},t.ahkuris={},t.completionItemCache={constant:[],directive:{"#":[],"@":f.jsDocTagNames.map((t=>({label:t,kind:e,data:"*"})))},key:[],keyword:[],snippet:[],text:[],option:{ahk_criteria:[],hotstring:[]},static:{label:"static",insertText:"static",kind:l.CompletionItemKind.Keyword}}},t.loadahk2=function(e="ahk2",n=3){let i;const o=`${t.rootdir}/syntaxes/<>/${e}`;if(f.isBrowser){let i,s=h(o+".d.ahk");if(s){let i=new u.Lexer(s,void 0,n);i.parseScript(),t.lexers[i.uri]=i,t.ahkuris[e]=i.uri}"ahk2"===e&&(i=y(`${t.rootdir}/syntaxes/ahk2_common.json`))&&r(JSON.parse(i.text)),(i=y(o+".json"))&&r(JSON.parse(i.text))}else{const s=t.extsettings.Syntaxes&&(0,a.existsSync)(t.extsettings.Syntaxes)?t.extsettings.Syntaxes:"",c=s?`${s}/<>/${e}`:o;let l;if((i=d(".d.ahk"))&&(l=h(m(i)))){let i=new u.Lexer(l,void 0,n);i.parseScript(),t.lexers[i.uri]=i,t.ahkuris[e]=i.uri}if((i=d(".json"))&&r(JSON.parse((0,a.readFileSync)(i,{encoding:"utf8"}))),"ahk2"===e&&(t.completionItemCache.static=t.completionItemCache.keyword.find((e=>"static"===e.label))??t.completionItemCache.static,r(JSON.parse((0,a.readFileSync)(`${t.rootdir}/syntaxes/ahk2_common.json`,{encoding:"utf8"}))),s))for(let e of(0,a.readdirSync)(s))e.toLowerCase().endsWith(".snippet.json")&&!(0,a.statSync)(e=`${i}/${e}`).isDirectory()&&r(JSON.parse((0,a.readFileSync)(e,{encoding:"utf8"})));function d(e){return g(c+e)||(c!==o?g(o+e):void 0)}}function r(e){let n,i,o,r=l.Range.create(0,0,0,0);for(const c in e){let u=e[c];switch(c){case"constants":for(o of(i=l.CompletionItemKind.Constant,n=l.InsertTextFormat.Snippet,u))t.completionItemCache.constant.push({label:o.prefix,kind:i,insertTextFormat:n,insertText:`\${1:${o.prefix} := }${o.body}$0`,detail:o.description??o.body});break;case"directives":let e="";for(o of(i=l.CompletionItemKind.Keyword,n=l.InsertTextFormat.Snippet,u))o.prefix??=o.body.trim(),"@#".includes(e=o.prefix.charAt(0))&&(t.completionItemCache.directive[e].push({label:o.prefix.replace(/^[^#\w]/,""),insertText:o.body.replace(/^\W+/,""),kind:i,insertTextFormat:n,documentation:o.description&&{kind:"markdown",value:o.description},data:o.body.charAt(0)}),"#"===e&&(t.hoverCache[o.prefix.toLowerCase()]=[o.prefix,{contents:{kind:"markdown",value:"```ahk2\n"+(o.syntax??a(o.body))+"\n```\n\n"+(o.description??"")}}]));break;case"keys":for(o of(i=l.CompletionItemKind.Keyword,u))t.completionItemCache.key.push({label:o.body,kind:i,documentation:o.description});break;case"keywords":for(o of(i=l.CompletionItemKind.Keyword,n=l.InsertTextFormat.Snippet,u))o.prefix??=o.body.trim(),t.completionItemCache.keyword.push({label:o.prefix,kind:i,insertTextFormat:n,insertText:o.body,documentation:o.description,preselect:!0}),t.hoverCache[o.prefix.toLowerCase()]=[o.prefix,{contents:{kind:"markdown",value:"```ahk2\n"+(o.syntax??a(o.body))+"\n```\n\n"+(o.description??"")}}];break;case"snippet":for(o of(i=l.CompletionItemKind.Snippet,n=l.InsertTextFormat.Snippet,u))t.completionItemCache.snippet.push({label:o.prefix,insertText:(s=o.body,"object"==typeof s?s.join("\n"):s),documentation:o.description,kind:i,insertTextFormat:n});break;case"variables":for(o of u)t.ahkvars[o.body.toUpperCase()]={name:o.body,kind:l.SymbolKind.Variable,range:r,selectionRange:r,detail:o.description};break;case"texts":for(o of(i=l.CompletionItemKind.Text,u))t.completionItemCache.text.push({label:o.body,kind:i});break;case"options":i=l.CompletionItemKind.Text;for(let e in u){let n=t.completionItemCache.option[e]??=[];for(o of u[e])n.push({label:o.body,kind:i,documentation:o.description&&{kind:"markdown",value:o.description}})}}}var s;function a(e){return e.replace(/\$\{\d+((\|)|:)([^}]*)\2\}|\$\d/g,((...e)=>e[2]?e[3].replace(/,/g,"|"):e[3]||""))}}};let _={};function b(e){let t=(e.replace(/-\w+/,".0")+".0").split("."),n=0;for(let e=0;e<4;e++)n+=parseInt(t[e])*2**(10*(3-e));return n}function v(e){let t,n,i="",o=!1;(t=e.startsWith("!"))&&(e=e.slice(1));for(let r=0,s=e.length;r<s;r++)switch(n=e[r]){case"/":case"\\":i+="[\\x5c/]";break;case"$":case"^":case"+":case".":case"(":case")":case"=":case"|":i+="\\"+n;break;case"?":i+=".";break;case"!":r?i.endsWith("[")?i+="^":i+="\\"+n:t=!0;break;case"{":o=!0,i+="(";break;case"}":o=!1,i+=")";break;case",":i+=o?"|":",";break;case"*":let s=r;for(;"*"===e[r+1];)r++;r>s&&/^[\x5c/]?\*+[\x5c/]?$/.test(e.substring(s-1,r+2))?(i+="((?:[^\\x5c/]*(?:[\\x5c/]|$))*)",r++):i+="([^\\x5c/]*)";break;default:i+=n}return/^([a-zA-Z]:|\*\*)/.test(e)?i="^"+i:/[\\/]/.test(e[0])||(i="[\\x5c/]"+i),/[\\/]$/.test(e)||(i+="$"),t&&(i=i.startsWith("^")?`^(?!${i})`:`(?!${i})`),new RegExp(i,"i")}t.enum_ahkfiles=function(e){let n=t.extsettings.Files.MaxDepth,{file:i,folder:o}=_;return async function*e(t,s){try{let c=await a.promises.opendir(t);for await(let a of c)if(a.isDirectory()&&s<n){let n=(0,r.resolve)(t,a.name);o?.some((e=>e.test(n)))||(yield*e(n,s+1))}else if(a.isFile()&&/\.(ahk2?|ah2)$/i.test(a.name)){let e=(0,r.resolve)(t,a.name);i?.some((t=>t.test(e)))||(yield e)}}catch(e){}}(m(e),0)},t.update_settings=function(e){if("string"==typeof e.AutoLibInclude?e.AutoLibInclude=p[e.AutoLibInclude]:"boolean"==typeof e.AutoLibInclude&&(e.AutoLibInclude=e.AutoLibInclude?3:0),"string"==typeof e.Warn?.CallWithoutParentheses&&(e.Warn.CallWithoutParentheses={On:!0,Off:!1,Parentheses:1}[e.Warn.CallWithoutParentheses]),"string"==typeof e.FormatOptions?.brace_style)switch(e.FormatOptions.brace_style){case"0":case"Allman":e.FormatOptions.brace_style=0;break;case"1":case"One True Brace":e.FormatOptions.brace_style=1;break;case"-1":case"One True Brace Variant":e.FormatOptions.brace_style=-1;break;default:delete e.FormatOptions.brace_style}for(let t of["array_style","object_style"])"string"==typeof e.FormatOptions?.[t]&&(e.FormatOptions[t]={collapse:2,expand:1,none:0}[e.FormatOptions[t]]);try{(0,u.update_comment_tags)(e.CommentTags)}catch(t){delete t.stack,delete e.CommentTags,console.log(t)}if(e.WorkingDirs instanceof Array?e.WorkingDirs=e.WorkingDirs.map((e=>(e=s.URI.file(e.includes(":")?e:(0,r.resolve)(e)).toString().toLowerCase()).endsWith("/")?e:e+"/")):e.WorkingDirs=[],_={},e.Files){let t=[],n=[];for(let i of e.Files.Exclude??[])try{(/[\\/]$/.test(i)?n:t).push(v(i))}catch(e){console.log(`[Error] Invalid glob pattern: ${i}`)}t.length&&(_.file=t),n.length&&(_.folder=n),(e.Files.MaxDepth??=2)<0&&(e.Files.MaxDepth=1/0)}e.Syntaxes&&(e.Syntaxes=(0,r.resolve)(e.Syntaxes).toLowerCase()),Object.assign(t.extsettings,e)},t.sendAhkRequest=async function(e,n){if(!f.isBrowser)return t.utils.get_ahkProvider().then((t=>t?.sendRequest(e,...n)))},t.make_search_re=function(e){let t;return e=e.replace(/([*.?+^$|\\/\[\](){}])|([^\x00-\x7f])|(.)/g,((e,n,i,o)=>`${o||(t??=i)||`\\${n}`}.*`)),new RegExp(t?e:`([^\\x00-\\x7f]|${e})`,"i")},t.enumNames=function(e){return Object.values(e).filter((e=>"string"==typeof e))},t.arrayEqual=function(e,t){return e.length===t.length&&(e.sort(),t.sort(),!e.some(((e,n)=>e!==t[n])))},t.clearLibfuns=function(){t.libfuncs={}},t.set_ahk_h=function(e){t.isahk2_h=e},t.set_ahkpath=function(e){t.ahkpath_cur=e},t.set_Connection=function(e){return t.connection=e},t.set_dirname=function(e){t.rootdir=e.replace(/[/\\]$/,"")},t.set_locale=function(e){e&&(t.locale=e.toLowerCase())},t.set_version=function(e){t.ahk_version=b(e)},t.set_WorkspaceFolders=function(e){let n=t.workspaceFolders;if(t.workspaceFolders=[...e],t.extsettings.WorkingDirs.forEach((n=>!e.has(n)&&t.workspaceFolders.push(n))),t.workspaceFolders.sort().reverse(),n.length!==t.workspaceFolders.length||n.some(((e,n)=>t.workspaceFolders[n]!==e)))for(const e of Object.values(t.lexers))t.lexers[e.uri]&&!e.setWorkspaceFolder()&&!e.actived&&e.close()},t.sleep=async function(e){return new Promise((t=>setTimeout(t,e)))}},6810:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.completionProvider=void 0;const i=n(7147),o=n(1017),r=n(2374),s=n(7237),a=n(3939);t.completionProvider=async function(e,t){let{position:n,textDocument:{uri:c}}=e,l=a.lexers[c=c.toLowerCase()];if(!l||t.isCancellationRequested)return;let u,d,f,p,h,m=[],g={},y=m.pop(),{triggerKind:_,triggerCharacter:b}=e.context??{};if("*"===b){let e=l.tokens[l.document.offsetAt(n)-3];if("TK_BLOCK_COMMENT"===e?.type){e.previous_token?.type||m.push({label:"/** */",detail:"File Doc",kind:r.CompletionItemKind.Text,insertTextFormat:r.InsertTextFormat.Snippet,textEdit:r.TextEdit.replace({start:l.document.positionAt(e.offset),end:l.document.positionAt(e.offset+e.length)},["/************************************************************************"," * @description ${1:}"," * @file $TM_FILENAME"," * @author ${2:}"," * @date ${3:$CURRENT_YEAR/$CURRENT_MONTH/$CURRENT_DATE}"," * @version ${4:0.0.0}"," ***********************************************************************/","$0"].join("\n"))});let t=q(e);if(t){let n=t;m=[{label:"/** */",detail:"JSDoc Comment",kind:r.CompletionItemKind.Snippet,insertTextFormat:r.InsertTextFormat.Snippet,textEdit:r.TextEdit.replace({start:l.document.positionAt(e.offset),end:l.document.positionAt(e.offset+e.length)},"/**\n * $0\n */")}],n.params&&(m[0].textEdit.newText=(0,a.generate_fn_comment)(l,n))}}return m}if("@"===b){let e=l.findStrOrComment(l.document.offsetAt(n)-1);if(e?.type.endsWith("COMMENT")){let t=l.document.positionAt(e.offset).line===n.line,i="TK_BLOCK_COMMENT"===e.type?"/*":";";return a.completionItemCache.directive["@"].filter((e=>i.includes(u=e.data)&&(t||"/"!==u)))}return}let v=Object.fromEntries(Object.entries(a.extsettings.CompletionCommitCharacters??{}).map((e=>(e[1]=(e[1]||void 0)?.split(""),e)))),{text:k,word:T,token:R,range:S,linetext:w,kind:C,symbol:D}=l.getContext(n,!0),x=l.relevance,{line:E,character:O}=n,K=!1,P=(0,a.make_search_re)(T);switch(R.type){case"TK_UNKNOWN":if("."===R.content)break;if("#"!==R.content)return;case"TK_SHARP":return 1===R.topofline?a.completionItemCache.directive["#"]:[];case"TK_HOT":case"TK_HOTLINE":if(!R.ignore)return a.completionItemCache.key.filter((e=>!e.label.toLowerCase().includes("alttab")));let e=l.document.offsetAt(n)-R.offset;return 0<e&&e<=k.indexOf(":",1)?a.completionItemCache.option.hotstring:void 0;case"":case"TK_EOF":if("TK_SHARP"===(f=R.previous_token)?.type){let e=!1;switch(f.content.toLowerCase()){case"#dllload":e=!0;case"#include":case"#includeagain":{if(a.isBrowser)return;let t,s=l.document.offsetAt(n)-R.offset,c=(k=R.content).slice(0,s),u=c[0],d=!1,f="";if("'\"".includes(u)?c=c.slice(1):u="",c=c.replace(/^\*i\s/i,""),c.startsWith("*")){P=(0,a.make_search_re)(c.slice(1));for(let e in a.utils.get_RCDATA()??{})P.test(e)&&j(e,r.CompletionItemKind.File);return m}if("<"===c[0]&&(u=">"+u,c=c.slice(1)),/["<>*?|]/.test(c)||e&&u.startsWith(">"))return;if(c=c.replace(/`;/g,";").replace(/[^\\/]+$/,(e=>(f=e,""))),!u.startsWith(">")&&k.includes("%")){if("\0"===k.replace(/%[^%]+%/g,(e=>"\0".repeat(e.length)))[s])return Object.values(a.ahkvars).filter((e=>e.kind===r.SymbolKind.Variable&&P.test(e.name))).map($);let e={...a.a_vars,scriptdir:l.scriptdir,linefile:l.fsPath};if(c=c.replace(/%a_(\w+)%/i,((t,n)=>{let i=e[n.toLowerCase()];return"string"==typeof i?i:"\0"})),c.includes("\0"))return}if(e)t=[(h=l.dlldir.get(n.line))?h:l.scriptpath,"C:\\Windows\\System32"];else if(u.startsWith(">"))t=l.libdirs,d=!0;else{let e=l.scriptpath,i=n.line;for(let[t,n]of l.includedir){if(!(t<i))break;e=n}t=[e]}u&&(k.endsWith(u)||k.endsWith(">")?u="":2===u.length&&k.endsWith(u[1])&&(u=u[0]));let p,g=c.endsWith("/")?"/":"\\",_=(0,a.make_search_re)(f),b=e?/\.(dll|ocx|cpl)$/i:d?/\.ahk$/i:/\.(ahk2?|ah2)$/i;a.allIdentifierChar.test(f)||(p=r.TextEdit.replace({start:{line:n.line,character:n.character-f.length},end:n},""));for(let e of t)if((0,i.existsSync)(e=(0,o.resolve)(e,c)+"\\")&&(0,i.statSync)(e).isDirectory()){for(let t of(0,i.readdirSync)(e))try{(0,i.statSync)(e+t).isDirectory()?_.test(t)&&j(t.replace(/(\s);/g,"$1`;"),r.CompletionItemKind.Folder)&&(y.command={title:"Trigger Suggest",command:"editor.action.triggerSuggest"},p?y.textEdit=Object.assign({},p,{newText:y.label+g}):y.insertText=y.label+g):b.test(t)&&_.test(d?t=t.replace(b,""):t)&&j(t.replace(/(\s);/g,"$1`;"),r.CompletionItemKind.File)&&(p?y.textEdit=Object.assign({},p,{newText:y.label+u}):y.insertText=y.label+u)}catch{}if(c.includes(":"))break}return m}default:return}}else if("TK_HOTLINE"!==f?.type)return;if(f.ignore)return F(),m;m.push(...a.completionItemCache.key),C=r.SymbolKind.Event;break;case"TK_COMMENT":case"TK_BLOCK_COMMENT":case"TK_INLINE_COMMENT":return;default:if(R.callsite||R.topofline>0)break;let t,s=["TK_COMMA","TK_DOT","TK_EQUALS","TK_NUMBER","TK_OPERATOR","TK_RESERVED","TK_STRING","TK_WORD"],c="TK_STRING"===R.type?0:3,d=0,_=(f=R).callsite,b=l.tokens,v=_?.paraminfo;for(;(f=(t=b[f.previous_pair_pos])??f.previous_token)&&++d!==c;)if(t){if(K=!0,f.topofline>0||(d++,!(f=t.previous_token))||f.topofline>0){f=void 0;break}}else{if(K||=void 0!==f.next_pair_pos||s.includes(f.type),v??=f.paraminfo){f=b[v.offset]?.previous_token,d++,K=!0;break}if((_??=f.callsite)||f.topofline>0)break}if((_??v)&&(v??=_?.paraminfo,K=!0),"TK_RESERVED"===f?.type)switch(u=f.content.toLowerCase()){case"class":if(2===d)return[{label:"extends",kind:r.CompletionItemKind.Keyword,preselect:!0}];if(3!==d||"extends"!==R.previous_token?.content.toLowerCase())return;d=1;case"catch":if(1!==d)return;if(!k){let e=R,t=l.document.offsetAt(S.end);for(k=R.content;(e=b[e.next_token_offset])&&e.offset<t;k+=e.content);if(a.allIdentifierChar.test(k.replace(/\./g,"")))for(let e of Object.values((0,a.find_class)(l,k)?.property??{}))e.kind===r.SymbolKind.Class&&!g[u=e.name.toUpperCase()]&&P.test(u)&&(m.push($(e)),g[u]=!0);return m}let e=[a.ahkvars,l.declaration];for(const n in x)(t=a.lexers[n])&&e.push(t.declaration);for(const n of e)for(const e in n)(t=n[e]).kind===r.SymbolKind.Class&&!g[e]&&P.test(e)&&(m.push($(t)),g[e]=!0);return m;case"break":case"continue":case"goto":if(1===d&&"TK_WORD"!==R.type)return;p=l.searchScopedNode(n);let i,o=(p??l).labels,s=l.document.offsetAt(n);for(let e in o)if(P.test(e))for(let t of o[e]){if(!t.def)break;if(-1===(i=t.data)||i<s&&(!(i=b[b[i].next_pair_pos]?.offset)||s<i)){m.push($(t));break}}if(!p)for(let e in x)for(let t in o=a.lexers[e]?.labels)if(P.test(t))for(let e of o[t]){if(!e.def)break;if(-1===e.data){m.push($(e));break}}if(1===d||2===d&&!c)return m;if(c)for(let e of m)e.insertText=`'${e.insertText}'`}else if(!c){let e=v&&(0,a.get_callinfo)(l,n,v);if(e){let o,s,c,u,d,f,p,h,g=k.substring(1).endsWith(k[0])?"":k[0],_=g?e=>({label:e,kind:o,insertText:`${e}${g}`}):e=>({label:e,kind:o,command:s}),T=(0,a.find_symbols)(l,c=l.getContext(e.pos))??[],R=Object.values(a.ahkuris),S=[],w=[];for(h of T){if(u=h.node,w.includes(u))continue;switch(w.push(u),p=R.includes(u.uri),f=e.index,d=u.name.toLowerCase(),o=r.CompletionItemKind.Value,s={title:"cursorRight",command:"cursorRight"},p&&e.kind){case r.SymbolKind.Method:switch(d){case"deleteprop":case"getmethod":case"getownpropdesc":case"hasownprop":case"hasmethod":case"hasprop":if(0!==f||!h.parent)continue;let e=d.endsWith("method")?e=>e!==r.SymbolKind.Method:void 0;for(let t of Object.values((0,a.get_class_members)(l,h.parent,S)))P.test(t.name)&&!e?.(t.kind)&&j(t.name,t.kind===r.SymbolKind.Method?r.CompletionItemKind.Method:r.CompletionItemKind.Property);continue;case"bind":case"call":if(![r.SymbolKind.Function,"call"===d&&r.SymbolKind.Class].includes(h.parent?.kind))break;T.push({node:h.parent,uri:""});continue}break;case r.SymbolKind.Function:switch(d){case"dynacall":if(0!==f)continue;case"dllcall":if(0===f){if(a.isBrowser)continue;let o=b[l.document.offsetAt(e.pos)],s=l.document.offsetAt(n);if(!o)continue;for(;(o=b[o.next_token_offset])&&"("===o.content;)continue;if(o&&"TK_STRING"===o.type&&s>o.offset&&s<=o.offset+o.length){let e=o.content.substring(1,s-o.offset),n=[l],c={};for(let e in x)(t=a.lexers[e])&&n.push(t);if(e.match(/[\\/]/)){let t={},i=!0;d=e.replace(/[\\/][^\\/]*$/,"").replace(/\\/g,"/").toLowerCase(),d.match(/\.\w+$/)||(d+=".dll"),d.includes(":")?(i=!1,t[d]=1):d.includes("/")?d.startsWith("/")?t[l.scriptpath+d]=1:t[l.scriptpath+"/"+d]=1:n.forEach((e=>{e.dllpaths.forEach((e=>{e.toLowerCase().endsWith(d)&&(t[e]=1,i&&e.includes("/")&&(i=!1))})),i&&(t[d]=t[e.scriptpath+"/"+d]=1)})),(await a.utils.get_DllExport(Object.keys(t),!0)).forEach((e=>P.test(e)&&j(e,r.CompletionItemKind.Function)))}else n.forEach((e=>e.dllpaths.forEach((e=>{e=e.replace(/^.*[\\/]/,"").replace(/\.dll$/i,""),c[d=e.toLowerCase()]||(c[d]=!0,j(e+"\\",r.CompletionItemKind.File))})))),(0,i.readdirSync)("C:\\Windows\\System32").forEach((e=>{e.toLowerCase().endsWith(".dll")&&P.test(e=e.slice(0,-4))&&j(e+"\\",r.CompletionItemKind.File)})),a.winapis.forEach((e=>{P.test(e)&&j(e,r.CompletionItemKind.Function)}))}continue}f++;case"comcall":if(f>1&&f%2==0)for(const e of["cdecl"].concat(a.dllcalltpe))j(e,r.CompletionItemKind.TypeParameter)&&(y.commitCharacters=["*"]);continue;case"comobject":0===f&&m.push(...(await(0,a.sendAhkRequest)("GetProgID",[]))?.filter((e=>P.test(e))).map(_)??[]);continue;case"numget":if(2!==f&&1!==f)continue;f=0;case"numput":if(f%2==0)for(const e of a.dllcalltpe.filter((e=>!/str$/i.test(e))))j(e,r.CompletionItemKind.TypeParameter);continue;case"hotkey":f<2&&m.push(...a.completionItemCache.key.filter((e=>P.test(e.label))));continue;case"objbindmethod":case"hasmethod":case"objhasownprop":case"hasprop":if(1===f){let e=v.comma[0];if(!e)continue;let t=d.endsWith("method")?e=>e!==r.SymbolKind.Method:void 0;for(let n of(0,a.decltype_expr)(l,l.find_token(v.offset+1,!0),e))for(let e of Object.values((0,a.get_class_members)(l,n,S)))P.test(e.name)&&!t?.(e.kind)&&j(e.name,e.kind===r.SymbolKind.Method?r.CompletionItemKind.Method:r.CompletionItemKind.Property)}continue}}u.kind===r.SymbolKind.Class&&(u=e.kind===r.SymbolKind.Property?(0,a.get_class_member)(a.lexers[u.uri],u,"__item",!1):(0,a.get_class_constructor)(u));let c=u?.params?.[f];if(!c)continue;if(p){if("Keys"===c.name){o=r.CompletionItemKind.Text,s=void 0,d.includes("send")&&m.push(_("Blind")),m.push(...a.completionItemCache.key.filter((e=>P.test(e.label))));continue}if("WinTitle"===c.name){m.push(...a.completionItemCache.option.ahk_criteria.filter((e=>P.test(e.label))));continue}}let g=c.type_annotations||[];g.includes(a.STRING)&&(o=r.CompletionItemKind.Text,s=void 0);for(let e of g)"string"==typeof e&&/['"]/.test(e[0])&&e.endsWith(e[0])&&P.test(e=e.slice(1,-1))&&m.push(_(e))}}return!m.length&&F(),m}}let A="([".includes(w[S.end.character]||"\0"),N=0===a.extsettings.FormatOptions.brace_style?"\n":" ";if(D){if(!D.children&&(p??=l.searchScopedNode(n))?.kind===r.SymbolKind.Class){let e=p,t=["__Init()","__Call(${1:Name}, ${2:Params})","__Delete()","__Enum(${1:NumberOfVars})","__Get(${1:Key}, ${2:Params})","__Item[$1]","__New($1)","__Set(${1:Key}, ${2:Params}, ${3:Value})"];if(m.push(...a.completionItemCache.snippet),1===R.topofline&&m.push(a.completionItemCache.static,{label:"class",insertText:["class $1","{\n\t$0\n}"].join(N),kind:r.CompletionItemKind.Snippet,insertTextFormat:r.InsertTextFormat.Snippet}),0===l.tokens[R.next_token_offset]?.topofline)return 1===R.topofline?(m.pop(),m):void 0;(D.static??!1)&&t.splice(0,1),R.topofline&&t.forEach((e=>{let t=e.replace(/[(\[].*$/,"");m.push({label:t,kind:r.CompletionItemKind.Snippet,insertTextFormat:r.InsertTextFormat.Snippet,insertText:e+N+"{\n\t$0\n}"})}));for(let t of Object.values((0,a.get_class_members)(l,e)))j(t.name,t.kind===r.SymbolKind.Method?r.CompletionItemKind.Method:r.CompletionItemKind.Property);return m}return}if(C===r.SymbolKind.Null)return;if(C===r.SymbolKind.Property||C===r.SymbolKind.Method){if(!R.symbol&&R.semantic?.type===a.SemanticTokenTypes.property)return;let e={},t=(0,a.decltype_expr)(l,R,S.end),n=t.includes(a.ANY),i=[];"."===w[S.end.character]&&(A="([".includes(w.charAt(S.end.character+T.length+1)||"\0")),n&&(t=[]);for(const n of t){if(n.kind===r.SymbolKind.Interface){let e=n.generic_types?.[0]?.map((e=>"'\"".includes(e[0])?e.slice(1,-1):e));if(!e?.length)continue;let t=await(0,a.sendAhkRequest)("GetDispMember",e)??{};Object.entries(t).forEach((e=>P.test(e[0])&&j(e[0],1===e[1]?r.CompletionItemKind.Method:r.CompletionItemKind.Property)));continue}let t=(0,a.get_class_members)(l,n,i);for(const[n,i]of Object.entries(t))P.test(n)&&((h=e[n])?h.detail?.endsWith(i.full??"")||(h.detail="(...) "+(h.insertText=i.name),h.commitCharacters=h.command=h.documentation=void 0):m.push(e[n]=$(i)))}if(!n&&(1!==_||T.length<3))return m;let o=new Set([l.object,a.lexers[a.ahkuris.ahk2]?.object,a.lexers[a.ahkuris.ahk2_h]?.object]);o.delete(void 0);for(const e in x)o.add(a.lexers[e].object);for(const e in h=l.object.property){let t=h[e];1===t.length&&!t[0].full&&W(t[0])&&delete h[e]}for(const t of o)for(const n of Object.values(t))for(const[t,i]of Object.entries(n))if(P.test(t)){if(h=e[t]){if(h.detail?.endsWith(i[0].full??""))continue}else if(m.push(e[t]=h=$(i[0])),1===i.length)continue;h.detail="(...) "+h.label,h.insertText?.endsWith(")")&&i.some((e=>e.kind===r.SymbolKind.Property))&&(h.insertText=h.label,h.kind=r.CompletionItemKind.Property),h.commitCharacters=h.command=h.documentation=void 0}return m}if(m.push(...a.completionItemCache.snippet),p??=l.searchScopedNode(n),p?.children&&p.kind===r.SymbolKind.Property){if(1!==R.topofline)return;return[{label:"get",kind:r.CompletionItemKind.Function},{label:"set",kind:r.CompletionItemKind.Function}]}let M=a.extsettings.FormatOptions?.keyword_start_with_uppercase,I=M?function(e){m.push(e=Object.assign({},e)),e.insertText=(e.insertText??e.label).replace(/(?<=^(loop\s)?)[a-z]/g,(e=>e.toUpperCase()))}:e=>m.push(e);if(K)for(let e of a.completionItemCache.keyword){if("break"===e.label)break;P.test(e.label)&&I(e)}else{let e=r.CompletionItemKind.Snippet,t=r.InsertTextFormat.Snippet,n=e=>e,i=n;M&&(n=e=>e.replace(/\b[a-z](?=\w)/g,(e=>e.toUpperCase()))),a.extsettings.FormatOptions?.switch_case_alignment&&(i=e=>e.replace(/^\t/gm,""));for(let[o,r]of[["switch",["switch ${1:[SwitchValue, CaseSense]}",i("{\n\tcase ${2:}:\n\t\t${3:}\n\tdefault:\n\t\t$0\n}")]],["trycatch",["try","{\n\t$1\n}","catch ${2:Error} as ${3:e}","{\n\t$0\n}"]],["class",["class $1","{\n\t$0\n}"]]])m.push({label:o,kind:e,insertTextFormat:t,insertText:n(r.join(N))});for(let e of a.completionItemCache.keyword)P.test(e.label)&&I(e)}!p&&(h=w.match(/^\s*(((([<>$~*!+#^]*?)(`?;|[a-z]\w+|[\x21-\x3A\x3C-\x7E]|[^\x00-\x7f]))|~?(`?;|[\x21-\x3A\x3C-\x7E]|[a-z]\w+|[^\x00-\x7f])\s*&\s*~?(`?;|[\x21-\x3A\x3C-\x7E]|[a-z]\w+|[^\x00-\x7f]))\s*(\s(up?)?)?)$/i))&&(m=m.concat(h[8]?{label:"Up",kind:r.CompletionItemKind.Keyword}:a.completionItemCache.key.filter((e=>!e.label.toLowerCase().includes("alttab")))));for(const e in a.ahkvars)P.test(e)&&(g[e]=$(a.ahkvars[e]));for(let e of Object.values(l.declaration))!P.test(u=e.name.toUpperCase())||W(e)||g[u]&&e.kind===r.SymbolKind.Variable||(g[u]=$(e));let L=Object.keys(x);for(let e of[l.d_uri,...L.map((e=>a.lexers[e]?.d_uri)),...L]){if(!(h=a.lexers[e]?.declaration))continue;d=a.lexers[e].fsPath;let t=!!x[e];for(const e in h){let n=h[e];t&&P.test(e)&&(!g[e]||g[e].kind===r.CompletionItemKind.Variable&&n.kind!==r.SymbolKind.Variable)&&(g[e]=y=$(n),y.detail=`${a.completionitem.include(d)}\n\n${y.detail??""}`)}}if(p&&(n=S.end,Object.entries(l.getScopeSymbols(p)).forEach((([e,t])=>{!P.test(e)||!1===t.def&&(g[e]||W(t))||(g[e]=$(t))}))),a.extsettings.AutoLibInclude){let e,t,c=0,f=-1,p=l.libdirs,h=l.workspaceFolder,m={};h=(h?s.URI.parse(h).fsPath:l.scriptdir).toLowerCase(),l.includedir.forEach(((e,t)=>f=t));for(const e in a.libfuncs)if(!x[e]&&(d=a.libfuncs[e].fsPath)&&(a.extsettings.AutoLibInclude>1&&a.libfuncs[e].islib||1&a.extsettings.AutoLibInclude&&d.toLowerCase().startsWith(h))){for(let t of a.libfuncs[e])P.test(u=t.name)&&(g[u.toUpperCase()]??=(y=$(t),c++,y.additionalTextEdits=m[d]??=_(d),y.detail=`${a.completionitem.include(d)}\n\n${y.detail??""}`,y));if(c>300)break}function _(s){let a=(s=s.replace(/(\s);/g,"$1`;")).toLowerCase(),c=0,u=-1,d=l.scriptpath,h=[];for(const e of p)if(++c,a.startsWith(e.toLowerCase())){let t=(0,o.basename)(s);a.endsWith(".ahk")&&!p.slice(0,c-1).some((e=>(0,i.existsSync)(e+t)))?h.push(`#Include <${(0,o.relative)(e,s.slice(0,-4))}>`):1===c?h.push(`#Include %A_MyDocuments%\\AutoHotkey\\Lib\\${t}`):2===c?h.push(`#Include %A_AhkPath%\\..\\Lib\\${t}`):h.push(`#Include %A_ScriptDir%\\Lib\\${t}`)}l.includedir.forEach(((e,t)=>{a.startsWith(e.toLowerCase()+"\\")?e.length>=d.length&&(u=t,d=e):d||(u=t)})),-1===u&&(u=f),d.charAt(0)===a.charAt(0)&&h.push(`#Include ${(0,o.relative)(d,s)}`);let m,g={line:l.document.lineCount,character:0},y=`#Include ${s}`;return h.forEach((e=>e.length<y.length&&(y=e))),y="\n"+y,-1!==u?(m=l.document.getText({start:{line:u,character:0},end:{line:u+1,character:0}}),g={line:u,character:m.length}):n.line===g.line-1&&((e??=(t=l.find_token(0))?.type.endsWith("COMMENT")&&!q(t))?(g=l.document.positionAt(t.offset+t.length),y="\n"+y):(g.line=0,y=y.trimLeft()+"\n")),[r.TextEdit.insert(g,y)]}}if(L.unshift(l.uri),!L.includes(a.ahkuris.winapi)&&L.some((e=>a.lexers[e]?.include[a.ahkuris.winapi])))for(const e in h=a.lexers[a.ahkuris.winapi]?.declaration)P.test(e)&&(g[e]??=$(h[e]));if(!K&&C!==r.SymbolKind.Event&&(1===_&&k.length>2&&k.includes("_")||/[A-Z]{2,}/.test(k)))for(const e of a.completionItemCache.constant)P.test(e.label)&&m.push(e);return m.concat(Object.values(g));function q(e){if(e.symbol)return e.symbol;let t,n=l.tokens[e.next_token_offset];return n&&void 0!==((t=n.symbol)?.detail??(t=l.tokens[n.next_token_offset]?.symbol)?.detail)?t:void 0}function F(){for(let e of a.completionItemCache.text)P.test(e.label)&&(g[e.label.toUpperCase()]=!0,m.push(e));for(const e in h=l.texts)P.test(e)&&j(h[e],r.CompletionItemKind.Text);for(const e in x)for(const t in h=a.lexers[e]?.texts)P.test(t)&&j(h[t],r.CompletionItemKind.Text)}function j(e,t){return!g[u=e.toUpperCase()]&&(m.push(y={label:e,kind:t}),g[u]=!0)}function W(e){return e.selectionRange.end.line===E&&O===e.selectionRange.end.character}function $(e){let t=r.CompletionItem.create(e.name);switch(e.kind){case r.SymbolKind.Function:case r.SymbolKind.Method:if(t.kind=e.kind===r.SymbolKind.Method?r.CompletionItemKind.Method:r.CompletionItemKind.Function,a.extsettings.CompleteFunctionParens){let n=e;A?t.command={title:"cursorRight",command:"cursorRight"}:n.params.length?(t.command={title:"Trigger Parameter Hints",command:"editor.action.triggerParameterHints"},n.params[0].name.includes("|")?(t.insertText=t.label+"(${1|"+n.params[0].name.replace(/\|/g,",")+"|})",t.insertTextFormat=r.InsertTextFormat.Snippet):(t.insertText=t.label+"($0)",t.insertTextFormat=r.InsertTextFormat.Snippet)):t.insertText=t.label+"()"}else t.commitCharacters=v.Function;t.detail=e.full;break;case r.SymbolKind.Variable:if(t.kind=r.CompletionItemKind.Variable,!e.range.end.character)return t.detail=e.detail,t;break;case r.SymbolKind.Class:t.kind=r.CompletionItemKind.Class,t.commitCharacters=v.Class,t.detail="class "+(e.full||t.label);break;case r.SymbolKind.Event:return t.kind=r.CompletionItemKind.Event,t;case r.SymbolKind.Field:return t.kind=r.CompletionItemKind.Field,t.label=t.insertText=t.label.slice(0,-1),t;case r.SymbolKind.Property:t.kind=r.CompletionItemKind.Property,t.detail=e.full||t.label;let n=e;!n.call&&n.get?.params.length&&(t.insertTextFormat=r.InsertTextFormat.Snippet,t.insertText=t.label+"[$0]");break;default:return t.kind=r.CompletionItemKind.Text,t}e.tags&&(t.tags=e.tags);let n=(0,a.get_detail)(e,l);return n&&(t.documentation=n),t}}},4780:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.jsDocTagNames=t.isWindows=t.isBrowser=t.chinese_punctuations=t.dllcalltpe=t.a_vars=t.builtin_ahkv1_commands=t.builtin_variable_h=t.builtin_variable=void 0,t.builtin_variable=["true","false","unset","a_ahkpath","a_ahkversion","a_allowmainwindow","a_appdata","a_appdatacommon","a_args","a_clipboard","a_computername","a_comspec","a_controldelay","a_coordmodecaret","a_coordmodemenu","a_coordmodemouse","a_coordmodepixel","a_coordmodetooltip","a_cursor","a_dd","a_ddd","a_dddd","a_defaultmousespeed","a_desktop","a_desktopcommon","a_detecthiddentext","a_detecthiddenwindows","a_endchar","a_eventinfo","a_fileencoding","a_hotkeyinterval","a_hotkeymodifiertimeout","a_hour","a_iconfile","a_iconhidden","a_iconnumber","a_icontip","a_index","a_initialworkingdir","a_is64bitos","a_isadmin","a_iscompiled","a_iscritical","a_ispaused","a_issuspended","a_keydelay","a_keydelayplay","a_keyduration","a_keydurationplay","a_language","a_lasterror","a_linefile","a_linenumber","a_listlines","a_loopfield","a_loopfileattrib","a_loopfiledir","a_loopfileext","a_loopfilefullpath","a_loopfilename","a_loopfilepath","a_loopfileshortname","a_loopfileshortpath","a_loopfilesize","a_loopfilesizekb","a_loopfilesizemb","a_loopfiletimeaccessed","a_loopfiletimecreated","a_loopfiletimemodified","a_loopreadline","a_loopregkey","a_loopregname","a_loopregtimemodified","a_loopregtype","a_maxhotkeysperinterval","a_mday","a_menumaskkey","a_min","a_mm","a_mmm","a_mmmm","a_mon","a_mousedelay","a_mousedelayplay","a_msec","a_mydocuments","a_now","a_nowutc","a_osversion","a_priorhotkey","a_priorkey","a_programfiles","a_programs","a_programscommon","a_ptrsize","a_regview","a_screendpi","a_screenheight","a_screenwidth","a_scriptdir","a_scriptfullpath","a_scripthwnd","a_scriptname","a_sec","a_sendlevel","a_sendmode","a_space","a_startmenu","a_startmenucommon","a_startup","a_startupcommon","a_storecapslockmode","a_tab","a_temp","a_thisfunc","a_thishotkey","a_tickcount","a_timeidle","a_timeidlekeyboard","a_timeidlemouse","a_timeidlephysical","a_timesincepriorhotkey","a_timesincethishotkey","a_titlematchmode","a_titlematchmodespeed","a_traymenu","a_username","a_wday","a_windelay","a_windir","a_workingdir","a_yday","a_year","a_yweek","a_yyyy"],t.builtin_variable_h=["a_ahkdir","a_dlldir","a_dllpath","a_globalstruct","a_isdll","a_mainthreadid","a_memorymodule","a_modulehandle","a_scriptstruct","a_threadid","a_zipcompressionlevel"],t.builtin_ahkv1_commands=["autotrim","blockinput","click","clipwait","control","controlclick","controlfocus","controlget","controlgetfocus","controlgetpos","controlgettext","controlmove","controlsend","controlsendraw","controlsettext","coordmode","critical","detecthiddentext","detecthiddenwindows","drive","driveget","drivespacefree","envadd","envdiv","envget","envmult","envset","envsub","envupdate","exit","exitapp","fileappend","filecopy","filecopydir","filecreatedir","filecreateshortcut","filedelete","fileencoding","filegetattrib","filegetshortcut","filegetsize","filegettime","filegetversion","fileinstall","filemove","filemovedir","fileopen","fileread","filereadline","filerecycle","filerecycleempty","fileremovedir","fileselectfile","fileselectfolder","filesetattrib","filesettime","format","formattime","getkeystate","gosub","groupactivate","groupadd","groupclose","groupdeactivate","gui","guicontrol","guicontrolget","hotkey","ifequal","ifexist","ifgreater","ifgreaterorequal","ifless","iflessorequal","ifmsgbox","ifnotequal","ifnotexist","ifwinactive","ifwinexist","ifwinnotactive","ifwinnotexist","imagesearch","inidelete","iniread","iniwrite","input","inputbox","keywait","listlines","menu","mouseclick","mouseclickdrag","mousegetpos","mousemove","msgbox","onerror","onexit","outputdebug","pause","pixelgetcolor","pixelsearch","postmessage","process","progress","random","regdelete","regread","regwrite","run","runas","runwait","send","sendevent","sendinput","sendlevel","sendmessage","sendmode","sendplay","sendraw","setbatchlines","setcapslockstate","setcontroldelay","setdefaultmousespeed","setenv","setformat","setkeydelay","setmousedelay","setnumlockstate","setregview","setscrolllockstate","setstorecapslockmode","settimer","settitlematchmode","setwindelay","setworkingdir","shutdown","sleep","sort","soundbeep","soundget","soundgetwavevolume","soundplay","soundset","soundsetwavevolume","splashimage","splashtextoff","splashtexton","splitpath","statusbargettext","statusbarwait","stringcasesense","stringleft","stringlower","stringright","stringtrimleft","stringtrimright","stringupper","suspend","sysget","thread","tooltip","transform","traytip","urldownloadtofile","winactivate","winactivatebottom","winclose","winget","wingetactivestats","wingetactivetitle","wingetclass","wingetpos","wingettext","wingettitle","winhide","winkill","winmaximize","winmenuselectitem","winminimize","winminimizeall","winminimizeallundo","winmove","winrestore","winset","winsettitle","winshow","winwait","winwaitactive","winwaitclose","winwaitnotactive"],t.a_vars={space:" ",tab:"\t"},t.dllcalltpe=["str","astr","wstr","int64","int","uint","short","ushort","char","uchar","float","double","ptr","uptr","hresult"],t.chinese_punctuations={"，":",","。":".","；":";","‘":"'","’":"'","【":"[","】":"]","《":"<","》":">","？":"?","：":":","“":'"',"”":'"',"（":"(","）":")","！":"!"},t.isBrowser="undefined"==typeof process,t.isWindows=!t.isBrowser&&"win32"===process.platform,t.jsDocTagNames=["abstract","access","alias","argument","async","augments","author","borrows","callback","class","classdesc","constant","constructor","constructs","copyright","default","deprecated","description","emits","enum","event","example","exports","extends","external","field","file","fileoverview","fires","function","generator","global","hideconstructor","host","ignore","implements","inheritdoc","inner","instance","interface","kind","lends","license","link","linkcode","linkplain","listens","member","memberof","method","mixes","module","name","namespace","overload","override","package","param","private","prop","property","protected","public","readonly","requires","returns","satisfies","see","since","static","summary","template","this","throws","todo","tutorial","type","typedef","var","variation","version","virtual","yields"]},3113:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defintionProvider=void 0;const i=n(2374),o=n(3939),r=n(7237);t.defintionProvider=async function(e,t){if(t.isCancellationRequested)return;let n=e.textDocument.uri.toLowerCase(),s=[],a=o.lexers[n],c=a?.getContext(e.position);if(!c)return;if(!c.token.type){let t=c.token.previous_token;if(t?.content.match(/^#include/i)){let n=e.position.line,s=c.linetext.indexOf("#"),a=t.data,l=a?.data;if(l){s+=a.offset-t.offset;let e=i.Range.create(0,0,o.lexers[l[1]]?.document.lineCount??0,0),c=s+a.content.length,u=l[0]?r.URI.file((0,o.restorePath)(l[0].replace(/`;/g,";"))).toString():l[1];return[i.LocationLink.create(u,e,e,i.Range.create(n,s,n,c))]}}return}if(c.kind===i.SymbolKind.Null)return;let l=[];return(0,o.find_symbols)(a,c)?.forEach((e=>{!l.includes(e.node)&&l.push(e.node)&&e.node.selectionRange.end.character&&(n=e.node.uri??e.uri)&&s.push(i.LocationLink.create(o.lexers[n].document.uri,e.node.range,e.node.selectionRange))})),s}},2793:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.typeFormatting=t.rangeFormatting=t.documentFormatting=void 0;const i=n(2374),o=n(3939);t.documentFormatting=async function(e){let t=o.lexers[e.textDocument.uri.toLowerCase()],n=i.Range.create(0,0,t.document.lineCount,0),r=Object.assign({},o.extsettings.FormatOptions);return r.indent_string??=e.options.insertSpaces?" ".repeat(e.options.tabSize):"\t",[{range:n,newText:t.beautify(r)}]},t.rangeFormatting=async function(e){let t=o.lexers[e.textDocument.uri.toLowerCase()],n=e.range,i=Object.assign({},o.extsettings.FormatOptions);return i.indent_string=e.options.insertSpaces?" ".repeat(e.options.tabSize):"\t",[{range:n,newText:t.beautify(i,n).trim()}]},t.typeFormatting=async function(e){let t,n,r,s,a=o.lexers[e.textDocument.uri.toLowerCase()],{ch:c,position:l}=e,u=Object.assign({},o.extsettings.FormatOptions);if(u.indent_string=" ".repeat(e.options.tabSize),r=a.document.getText({start:{line:0,character:0},end:{line:0,character:1}}),("\t"===r||!e.options.insertSpaces&&" "!==r)&&(u.indent_string="\t"),"\n"===c){let e,{line:i,character:o}=l,r=a.document.getText({start:{line:i-1,character:0},end:{line:i+2,character:0}}).split(/\r?\n/),c=r[0].trimRight();if(r[1].trim()||(o=r[1].length),c.endsWith("{"))(t=d({line:i-1,character:c.length}))&&(e=t[0].range.indent_string??"",r[1].substring(0,o)!==e&&t.push({newText:e,range:{start:{line:i,character:0},end:{line:i,character:o}}}),(c=(r[2]??="").trimLeft()).startsWith("}")&&!r[2].startsWith((e=e.replace(u.indent_string,""))+"}")&&t.push({newText:e,range:{start:{line:i+1,character:0},end:{line:i+1,character:r[2].length-c.length}}}));else if(void 0!==(s=a.linepos[i-1])){let n={start:a.document.positionAt(s),end:{line:i-1,character:c.length}};t=[{range:n,newText:a.beautify(u,n).trim()}],e=n.indent_string??"",r[1].substring(0,o)!==e&&t.push({newText:e,range:{start:{line:i,character:0},end:{line:i,character:o}}})}else if(!c&&r[0]!==(r[1]=r[1].substring(0,o))){if(!r[0]){if(n=a.find_token(a.document.offsetAt(l)),"TK_STRING"===n.type||n.type.endsWith("COMMENT"))return;let e=["TK_START_EXPR","TK_START_BLOCK",""];for(;(n=n.previous_token)&&!e.includes(n.type););if(e.pop(),e.includes(n?.type))return}t=[{newText:r[0],range:{start:{line:i,character:0},end:{line:i,character:o}}}]}return t}if("}"===c)return d(l);if(r=o.chinese_punctuations[c]){let e={line:l.line,character:l.character-1};if(n=a.find_token(a.document.offsetAt(e)),"TK_WORD"===n.type)return n.length>1&&(r=n.content.replace(/./g,(e=>o.chinese_punctuations[e]??e)),e=a.document.positionAt(n.offset),l.character=e.character+n.length),[i.TextEdit.replace({start:e,end:l},r)]}function d(e){if(n=a.tokens[a.document.offsetAt({line:e.line,character:e.character-1})],s=n?.previous_pair_pos,void 0!==s){for(;void 0!==(n=a.tokens[s])?.previous_pair_pos;)s=n.previous_pair_pos;let t={start:a.document.positionAt(s),end:e};return[{range:t,newText:a.beautify(u,t).trim()}]}}}},9541:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.hoverProvider=void 0;const i=n(2374),o=n(3939);t.hoverProvider=async function(e,t){if(t.isCancellationRequested)return;let n,r=e.textDocument.uri.toLowerCase(),s=o.lexers[r],a=s?.getContext(e.position),c=[];if(!a)return;if(a.kind===i.SymbolKind.Null)return a.token.semantic?.type!==o.SemanticTokenTypes.variable&&(n=a.token,n=o.hoverCache[(n.hover_word||n.content).toLowerCase()])?n[1]:void 0;let l=(0,o.find_symbols)(s,a);if(!l?.length)return;let u=[];if(l=l.filter((e=>!u.includes(e.node)&&u.push(e.node))),l.length>1)for(n of l)(n=n.node.full)&&c.push({kind:"ahk2",value:n});else{let{node:e,is_global:t,uri:r}=l[0],s=e;if(e.kind!==i.SymbolKind.Class||s.full?.startsWith("(")){if(s.full){c.push({kind:"ahk2",value:s.full});let e=s.overloads;switch(typeof e){case"object":e=e.map((e=>e.full)).join("\n");case"string":c.at(-1).value+=`\n${e}`}}}else c.push({kind:"ahk2",value:"class "+(s.full||e.name)});let a=(0,o.get_detail)(e,o.lexers[r]);a="string"==typeof a?a&&"```plaintext\n"+a+"\n```":a.value,e.is_param?a=a.startsWith("*@param* ")?a.replace(/\n|(?<=`\*?) — /,"\n___\n"):`*@param* \`${e.name}\`${(n=(0,o.join_types)(e.type_annotations))&&`: *\`${n}\`*`}\n___\n${a}`:e.kind===i.SymbolKind.Variable&&(a=`${!0===t?"*@global*":e.static?"*@static*":"*@local*"} \`${e.name}\`${(n=(0,o.join_types)(e.type_annotations))&&`: *\`${n}\`*`}\n___\n${a}`),a&&c.push({value:(c.length?"___\n":"")+a})}return{contents:{kind:"markdown",value:c.map((e=>"ahk2"===e.kind?"```ahk2\n"+e.value+"\n```":e.value)).join("\n\n")}}}},7994:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loadlocalize=t.response=t.action=t.setting=t.warn=t.diagnostic=t.codeaction=t.completionitem=void 0;const i=n(3939);let o={};var r,s,a,c,l,u,d;function f(e,t){return(...n)=>n.length?function(e,...t){return e.replace(/\{(\d+)\}/g,((...e)=>{let n=parseInt(e[1]);return n<t.length?t[n]:" "}))}(p(e,t),...n):p(e,t)}function p(e,t){return o[e]||t}!function(e){e.author=f("completionitem.author","Add file infos about author, description, date, version."),e.comment=f("completionitem.generatecomment","Generate comment template of current function/method."),e.include=f("completionitem.include","Auto import from '{0}'"),e.prototype=f("completionitem.prototype","Retrieve or set the object on which all instances of the class are based."),e.thishotkey=f("completionitem.thishotkey","The hidden parameter to the hotkey function."),e.value=f("completionitem.value","Within the dynamic property 'set', 'Value' contains the value being assigned."),e._new=f("completionitem.new","export construct a new instance of the class."),e._this=f("completionitem.this","In the class, access other instance variables and methods of the class through 'this'."),e._super=f("completionitem.super","In the inherited class, 'super' can replace 'this' to access the superclass version of the method or property that is overridden in the derived class.")}(r||(t.completionitem=r={})),function(e){e.include=f("codeaction.include","Import '{0}'")}(s||(t.codeaction=s={})),function(e){e.acceptparams=f("diagnostic.acceptparams","'{0}' accepts {1} parameter(s)"),e.assignerr=f("diagnostic.assignerr","This {0} '{1}' cannot be used as an output variable"),e.classinfuncerr=f("diagnostic.classinfuncerr","Functions cannot contain classes"),e.classuseerr=f("diagnostic.classuseerr","This class cannot be used as an output variable"),e.conflictserr=f("diagnostic.conflictserr","This {0} '{2}' declaration conflicts with an existing {1}"),e.declarationerr=f("diagnostic.declarationerr","Unexpected declaration"),e.defaultvalmissing=f("diagnostic.defaultvalmissing","Parameter default required. Specifically: '{0}'"),e.deprecated=f("diagnostic.deprecated","Using '{0}' instead of '{1}'"),e.didyoumean=f("diagnostic.didyoumean","Did you mean to use '{0}'?"),e.dupdeclaration=f("diagnostic.dupdeclaration","Duplicate declaration"),e.duplabel=f("diagnostic.duplabel","Duplicate label"),e.filenotexist=f("diagnostic.filenotexist","'{0}' not exist"),e.funccallerr=f("diagnostic.funccallerr","Function calls require a space or '(',  use comma only between parameters"),e.funccallerr2=f("diagnostic.funccallerr2","In the expression, the function call requires parentheses"),e.globalconflicts=f("diagnostic.globalconflicts","This global declaration conflicts with an existing {0}"),e.hotdeferr=f("diagnostic.hotdeferr","Hotkeys/hotstrings cannot be defined in functions/classes"),e.hotmissbrace=f("diagnostic.hotmissbrace","Hotkey or hotstring is missing its opening brace"),e.invaliddefinition=f("diagnostic.invaliddefinition","Invalid {0} definition"),e.invalidencoding=f("diagnostic.invalidencoding","'{0}' invalid file encoding"),e.invalidhotdef=f("diagnostic.invalidhotdef","Invalid hotkey definition"),e.invalidparam=f("diagnostic.invalidparam","Invalid parameter definition"),e.invalidprop=f("diagnostic.invalidprop","Invalid dynamic property"),e.invalidpropname=f("diagnostic.invalidpropname","Invalid property name in object literal"),e.invalidsymbolname=f("diagnostic.invalidsymbolname","Invalid symbol naming '{0}'"),e.invalidsuper=f("diagnostic.invalidsuper","'super' is valid only inside a class"),e.invalidscope=f("diagnostic.invalidscope","'{0}' cannot be used in functions/classes"),e.maybehavenotmember=f("diagnostic.maybehavenotmember","Class '{0}' maybe have not member '{1}'"),e.maybev1=f("diagnostic.maybev1","This might be a v1 script, and the lexer stops parsing."),e.missing=f("diagnostic.missing","Missing '{0}'"),e.missingparam=f("diagnostic.missingparam","Missing a required parameter"),e.missingoperand=f("diagnostic.missingoperand","Missing operand"),e.missingretval=f("diagnostic.missingretval","The function missing a return value"),e.missingspace=f("diagnostic.missingspace","Missing space or operator before this"),e.objectliteralerr=f("diagnostic.objectliteralerr","Error in object literal"),e.outofloop=f("diagnostic.outofloop","Break/Continue must be enclosed by a Loop"),e.paramcounterr=f("diagnostic.paramcounterr","Expected {0} parameters, but got {1}"),e.pathinvalid=f("diagnostic.pathinvalid","Invalid file path"),e.propdeclaraerr=f("diagnostic.propdeclaraerr","Not a valid method, class or property definition"),e.propemptyparams=f("diagnostic.propemptyparams","Empty [] not permitted"),e.propnotinit=f("diagnostic.propnotinit","Property declaration is not initialized"),e.requirev1=f("diagnostic.requirev1","This script requires AutoHotkey v1, and the lexer stops parsing."),e.requireversion=f("diagnostic.requireversion","This feature requires the AutoHotkey version >= v{0}"),e.requirevariable=f("diagnostic.requirevariable","'&' requires a variable"),e.reservedworderr=f("diagnostic.reservedworderr","The following reserved word '{0}' must not be used as a variable name"),e.resourcenotfound=f("diagnostic.resourcenotfound","No resource found or could not be resolved"),e.skipline=f("diagnostic.skipline","The line is skipped and not resolved"),e.syntaxerror=f("diagnostic.syntaxerror","Syntax error. Specifically: {0}"),e.tryswitchtov1=f("diagnostic.tryswitchtov1","Try switching to AutoHotkey v1."),e.typemaybenot=f("diagnostic.typemaybenot","Type maybe not '{0}'"),e.unexpected=f("diagnostic.unexpected","Unexpected '{0}'"),e.unknown=f("diagnostic.unknown","Unknown {0}"),e.unknownoperatoruse=f("diagnostic.unknownoperatoruse","Unknown operator use"),e.unknowntoken=f("diagnostic.unknowntoken","Unknown token '{0}'"),e.unsupportinclude=f("diagnostic.unsupportinclude","#Include in functions and classes cannot correctly deduce scope and code completion"),e.unterminated=f("diagnostic.unterminated","Unterminated string text")}(a||(t.diagnostic=a={})),function(e){e.varisunset=f("warn.varisunset","Variable '{0}' appears to never be assigned a value"),e.localsameasglobal=f("warn.localsameasglobal","This local variable '{0}' has the same name as a global variable"),e.callwithoutparentheses=f("warn.callwithoutparentheses","This function or method call has no parentheses")}(c||(t.warn=c={})),function(e){e.ahkpatherr=f("setting.ahkpatherr","The AutoHotkey interpreter does not exist, re-specify in'Settings-AutoHotkey2.InterpreterPath'"),e.getenverr=f("setting.getenverr","Failed to get environment variables"),e.uialimit=f("setting.uialimit","The UIA executable does not allow redirection to stdin/stdout due to security restrictions, so some features that depend on this will not work"),e.versionerr=f("setting.versionerr","The current AutoHotkey.exe is not the v2 version, and cannot get the correct syntax analysis, completion and other functions")}(l||(t.setting=l={})),function(e){e.switchtov1=f("action.switchtov1","Switch to ahk v1"),e.skipline=f("action.skipline","Skip the line"),e.stopparsing=f("action.stopparsing","Stop parsing")}(u||(t.action=u={})),function(e){e.cannotrename=f("response.cannotrename","The element can't be renamed."),e.cannotrenamestdlib=f("response.cannotrenamestdlib","Elements defined in the standard AutoHotkey library can't be renamed.")}(d||(t.response=d={})),t.loadlocalize=function(){if(i.isBrowser){let e=(0,i.getwebfile)(`${i.rootdir}/package.nls.<>.json`);e&&(o=JSON.parse(e.text))}else{let e=(0,i.getlocalefile)(`${i.rootdir}/package.nls.<>.json`,"utf8");o=e?JSON.parse(e):{}}}},6658:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getAllReferences=t.referenceProvider=void 0;const i=n(2374),o=n(3939);function r(e,t,n=!0){if(t.kind===i.SymbolKind.Null)return;let r=(0,o.find_symbols)(e,t);if(1!==r?.length)return;let c=t.text.toUpperCase(),l={},{node:u,uri:d,scope:f,is_this:p,is_global:h}=r[0];if(d&&u.selectionRange.end.character&&!1!==p){if(!n&&(u===o.ahkvars[c]||d===o.ahkuris.winapi))return null;if(p){let e=[],t=u.property;for(let n of Object.values(t??{}))n.children?.length&&a(n,c,e,!1,!1);return e.length?{[o.lexers[d].document.uri]:e}:void 0}switch(u.kind){case i.SymbolKind.Field:if(f){let e=f.labels;e&&e[c]&&(l[o.lexers[d].document.uri]=e[c].map((e=>e.selectionRange)))}else{let t=e.labels;t[c]&&(l[e.document.uri]=t[c].map((e=>e.selectionRange)));for(const n in e.relevance)t=o.lexers[n].labels,t[c]&&(l[o.lexers[n].document.uri]=t[c].map((e=>e.selectionRange)))}break;case i.SymbolKind.Function:case i.SymbolKind.Variable:case i.SymbolKind.Class:if(u.kind!==i.SymbolKind.Class||!u.full.includes(".")){f=!0===h?void 0:r[0].parent;let t={[e.uri]:f};if(d!==e.uri&&(t[d]=void 0),!f)for(const n in e.relevance)t[n]=void 0;for(const e in t){let n=s(o.lexers[e],c,i.SymbolKind.Variable,t[e]);n.length&&(l[o.lexers[e].document.uri]=n)}break}default:if(u.kind===i.SymbolKind.Class||u.static){if(u.kind===i.SymbolKind.Class)c=u.full.toUpperCase();else{let e=u,t=e.full?.match(/^\(([^)]+)\)\sstatic\s([^(]+)($|[(\[])/);if(t)c=`${t[1]}.${t[2]}`.toUpperCase();else{if(e.parent?.kind!==i.SymbolKind.Class)return;c=`${e.parent.full}.${e.name}`.toUpperCase()}}let t=c.split("."),n=t.length,r=0,f={};for(const n of new Set([e.uri,...Object.keys(e.relevance)]))f[o.lexers[n].document.uri]=s(o.lexers[n],t[0],i.SymbolKind.Variable);for(;r<n;){let s=t.slice(0,++r).join("."),c=(0,o.find_symbol)(e,s);if(c?.node.kind===i.SymbolKind.Class)for(let e of Object.values(c.node.property??{}))e.children?.length&&a(e,"THIS",f[o.lexers[c.uri].document.uri]??=[],!1,!1);for(const e in f){let i=f[e],s=o.lexers[e.toLowerCase()],a=l[e]??=[],c=s.document,u=s.tokens;e:for(let e of i){let i=u[c.offsetAt(e.start)];if(i){for(let e=r;e<n;e++){if("TK_DOT"!==(i=u[i.next_token_offset])?.type)continue e;if("TK_WORD"!==(i=u[i.next_token_offset])?.type||i.content.toUpperCase()!==t[e])continue e}a.push({start:c.positionAt(i.offset),end:c.positionAt(i.offset+i.length)})}}l[e].length||delete l[e]}f={}}let p=u.parent,h=l[o.lexers[d].document.uri]??=[];for(;p&&p.kind!==i.SymbolKind.Class;)p=p.parent;if(p){let e=u.name.toLowerCase(),t=[];for(let n of p.children??[])n.static&&n.name.toLowerCase()===e&&t.push(n.selectionRange);h.unshift(...t)}else h.includes(u.selectionRange)||h.unshift(u.selectionRange);break}return}return Object.keys(l).length?l:void 0}}function s(e,t,n,o){let r=[];if(n===i.SymbolKind.Method||n===i.SymbolKind.Property);else{let c=o??e,l=!o,u=l,d=!c?.local?.[t]?.static;if(d&&o&&null===c.declaration?.[t]?.static&&(d=!1),u)u=!1;else{let e=c.local,n=c.declaration;e?.[t]||n?.[t]||(u=void 0)}if(c.children?.forEach((e=>{e.name.toUpperCase()===t&&r.push(e.selectionRange),e.children?.length&&a(e,t,r,l,l||e.kind===i.SymbolKind.Function?u:void 0,d)})),c.kind===i.SymbolKind.Property){let i=c;for(let o of[i.get,i.set,i.call])o?.children&&r.push(...s(e,t,n,o))}}return r}function a(e,t,n,r,s,c=!0){let l,u=e.kind===i.SymbolKind.Function&&e.static,d=u||e.closure,f=s;if(!u||!c||r){if(r&&e.has_this_param&&["THIS","SUPER"].includes(t))s=f=!1;else if(e.assume===o.FuncScope.GLOBAL||e.global?.[t]){if(!r)return;s=f=!0}else if(e.local?.[t]||(!d||r&&!s)&&e.declaration?.[t]){if(!r)return;s=f=!1}else r&&!s&&(!u||(l=e.declaration?.[t])&&(l.kind!==i.SymbolKind.Variable||l.def)?e.unresolved_vars?.[t]&&(f=!0):f=!0);c&&(c=!e?.local?.[t]?.static),f===r?e.children?.forEach((e=>{e.name.toUpperCase()===t&&e.kind!==i.SymbolKind.Property&&e.kind!==i.SymbolKind.Method&&e.kind!==i.SymbolKind.Class&&n.push(e.selectionRange),e.children?.length&&a(e,t,n,r,e.kind===i.SymbolKind.Function?s:r||void 0,c)})):e.children?.forEach((e=>{e.children?.length&&a(e,t,n,r,!r&&void 0,c)}))}}t.referenceProvider=async function(e,t){let n=[],i=o.lexers[e.textDocument.uri.toLowerCase()];if(!i||t.isCancellationRequested)return;let s=r(i,i.getContext(e.position));for(const e in s)n.push(...s[e].map((t=>({uri:e,range:t}))));return n},t.getAllReferences=r},5932:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.renameProvider=t.prepareRename=void 0;const i=n(1694),o=n(3939);let r;t.prepareRename=async function(e,t){let n=o.lexers[e.textDocument.uri.toLowerCase()];if(!n||t.isCancellationRequested)return;let s=n.getContext(e.position);return(r=(0,o.getAllReferences)(n,s,!1))?{range:s.range,placeholder:s.text.split(".").pop()||""}:new i.ResponseError(0,null===r?o.response.cannotrenamestdlib():o.response.cannotrename())},t.renameProvider=async function(e,t){if(t.isCancellationRequested)return;let n={changes:{}},i=e.newName;for(const e in r)n.changes[e]=r[e].map((e=>({range:e,newText:i})));return n}},9770:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resolvePath=t.existsSync=t.runscript=void 0;const i=n(2081),o=n(3939),r=n(7147),s=n(1017);function a(e,t=!1){if(!e)return"";let n=[];e.includes(":")||n.push((0,s.resolve)(e)),o.isWindows&&!/[\\/]/.test(e)&&n.push((0,i.execSync)(`where ${e}`,{encoding:"utf-8"}).trim()),n.push(e);for(let e of n)if(e)try{return(0,r.lstatSync)(e).isSymbolicLink()&&t&&(e=(0,s.resolve)(e,"..",(0,r.readlinkSync)(e))),e}catch{continue}return""}t.runscript=function(e){let t=a(o.ahkpath_cur,!0);if(!t)return;const n=(0,i.spawnSync)(`"${t}" /CP65001 /ErrorStdOut=utf-8 *`,[],{cwd:t.replace(/[\\/].+?$/,""),shell:!0,input:e});return n?(n.stdout??"").toString():void 0},t.existsSync=function(e){try{(0,r.lstatSync)(e)}catch(e){if("ENOENT"===e?.code)return!1}return!0},t.resolvePath=a},6001:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.semanticTokensOnRange=t.semanticTokensOnFull=void 0;const i=n(2374),o=n(3939);let r,s=new Map;function a(e,t){let n,a;if(a=e.semantic){let n=e.pos??(e.pos=t.document.positionAt(e.offset)),c=a.type;if(c===o.SemanticTokenTypes.string)if(e.ignore){let i=n.line+1,o=e.data;for(let e=0;e<o.length;e++)t.STB.push(i++,0,o[e],c,0)}else t.STB.push(n.line,n.character,e.length,c,0);else(r&&(c===o.SemanticTokenTypes.method||c===o.SemanticTokenTypes.property)&&"TK_DOT"===e.previous_token?.type||(r=void 0,c===o.SemanticTokenTypes.class))&&(c=function(e,t,n){let a=t.semantic;switch(a.type){case o.SemanticTokenTypes.class:return r=o.globalsymbolcache[e],r?.kind!==i.SymbolKind.Class&&(r=void 0),o.SemanticTokenTypes.class;case o.SemanticTokenTypes.method:case o.SemanticTokenTypes.property:if(r){let l,u=r.property[e],d=u?.kind;if(!u||!1===u.def){let t=(l=s.get(r)??(s.set(r,l=(0,o.get_class_members)(n,r)),l))[e];t?(u=t,d=t.kind):a.type===o.SemanticTokenTypes.method?l.__CALL&&(d=i.SymbolKind.Null):l.__GET&&(d=i.SymbolKind.Null)}switch(d){case i.SymbolKind.Method:if(a.modifier=(a.modifier??0)|o.SemanticTokenModifiers.readonly|o.SemanticTokenModifiers.static,t.callsite){if(r)if(u.full?.startsWith("(Object) static Call("))u=(0,o.get_class_member)(n,r.prototype,"__new",!0)??u;else if(u.full?.startsWith("(Object) DefineProp(")){let e=n.tokens[t.next_token_offset];"("===e?.content&&(e=n.tokens[e.next_token_offset]),e&&("TK_STRING"===e.type?c(r,e.content.slice(1,-1),e.offset+1):c(r,""))}(0,o.checkParams)(n,u,t.callsite)}return r=void 0,a.type=o.SemanticTokenTypes.method;case i.SymbolKind.Class:return a.modifier=(a.modifier??0)|o.SemanticTokenModifiers.readonly,r=r.property[e],t.callsite&&(0,o.checkParams)(n,r,t.callsite),a.type=o.SemanticTokenTypes.class;case i.SymbolKind.Property:let l=u.children;return 1===l?.length&&"get"===l[0].name.toLowerCase()&&(a.modifier=(a.modifier??0)|o.SemanticTokenModifiers.readonly|o.SemanticTokenModifiers.static),r=void 0,a.type=o.SemanticTokenTypes.property;case void 0:!1!==(r.checkmember??n.checkmember)&&o.extsettings.Diagnostics.ClassStaticMemberCheck&&(":="===n.tokens[t.next_token_offset]?.content?c(r,t.content,t.offset):!1!==s.get(r)?.["#checkmember"]&&((r.undefined??={})[t.content.toUpperCase()]??=[]).push(t))}}default:return r=void 0,a.type}function c(e,t,r){let a=o.lexers[e.uri];if(a&&r){let o=i.Range.create(a.document.positionAt(r),a.document.positionAt(r+t.length)),c=i.DocumentSymbol.create(t,void 0,i.SymbolKind.Property,o,o);if(c.static=c.def=!0,t=t.toUpperCase(),a===n&&a.d<2)e.children?.push(c),e.property[t]??=c;else{let n=s.get(e);n&&(n[t]??=c)}e.undefined&&delete e.undefined[t]}else if(delete e.undefined,a&&a.d<2)e.checkmember=!1;else{let t=s.get(e);t&&(t["#checkmember"]=!1)}}}(e.content.toUpperCase(),e,t)),t.STB.push(n.line,n.character,e.length,c,(a.modifier??0)|!0===e.definition?.static)}else if(r&&"TK_DOT"!==e.type&&!e.type.endsWith("COMMENT"))r=void 0;else if("TK_WORD"===e.type&&["THIS","SUPER"].includes(n=e.content.toUpperCase())&&"TK_DOT"!==e.previous_token?.type){let o=t.findSymbol(n,i.SymbolKind.Variable,t.document.positionAt(e.offset));void 0!==o?.is_this&&(r=o.node)}}function c(e){for(let t of s.keys())if(t.undefined){let n=t.name;for(let i of Object.values(t.undefined))for(let t of i)e.addDiagnostic(o.diagnostic.maybehavenotmember(n,t.content),t.offset,t.length,2);delete t.undefined}}t.semanticTokensOnFull=function(e,t){let n=o.lexers[e.textDocument.uri.toLowerCase()];return!n||t?.isCancellationRequested?{data:[]}:(n.STB.previousResult(""),r=void 0,s.clear(),(0,o.symbolProvider)({textDocument:e.textDocument},null),Object.values(n.tokens).forEach((e=>a(e,n))),c(n),s.clear(),n.STB.build())},t.semanticTokensOnRange=function(e,t){let n=o.lexers[e.textDocument.uri.toLowerCase()];if(!n||t?.isCancellationRequested)return{data:[]};let i=n.document.offsetAt(e.range.start),l=n.document.offsetAt(e.range.end);n.STB.previousResult(""),r=void 0,s.clear(),(0,o.symbolProvider)({textDocument:e.textDocument},null);for(let e of Object.values(n.tokens))if(!(e.offset<i)){if(e.offset>l)break;a(e,n)}return c(n),s.clear(),n.STB.build()}},5373:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.signatureProvider=void 0;const i=n(2374),o=n(8952),r=n(3939);t.signatureProvider=async function(e,t){if(t.isCancellationRequested)return;let n=e.textDocument.uri.toLowerCase(),s=r.lexers[n],a={activeSignature:0,signatures:[],activeParameter:0},c=(0,r.get_callinfo)(s,e.position);if(!c||c.index<0)return;let{name:l,pos:u,index:d,kind:f}=c,p=s.getContext(u),h=!0;if(p.kind===i.SymbolKind.Null||p.token.symbol)return;let m=(0,r.decltype_expr)(s,p.token,p.range.end),g=new Set,y=[];if(m.includes(r.ANY)){if(f!==i.SymbolKind.Method)return;l=l.toUpperCase(),y=[];for(const e of new Set([r.ahkuris.ahk2,r.ahkuris.ahk2_h,s.uri,...Object.keys(s.relevance)]))for(const t of r.lexers[e]?.object.method[l]??[])y.push({node:t,uri:e})}else{let e=p.text?"":p.word.toLowerCase();f===i.SymbolKind.Property?(e||="__item",h=!1):e||="call";for(let t of m)_(t,e)}function _(e,t,n=0){let o,a=e.uri;switch(e.kind){case i.SymbolKind.Method:if(!h)break;if(n++,"call"===t){y.push({node:e,needthis:n,uri:a});break}o=e,c();break;case i.SymbolKind.Function:if(!h)break;if("call"===t){y.push({node:e,needthis:n,uri:a});break}o=e;case i.SymbolKind.Class:c()}function c(){let a,c=e;if(a=(0,r.get_class_member)(s,c,t,h)){if(h)if(a.kind===i.SymbolKind.Class)a=(0,r.get_class_constructor)(a);else if(a.full?.startsWith("(Object) static Call("))a=(0,r.get_class_member)(s,c.prototype,"__new",!0)??a;else{if(a.kind===i.SymbolKind.Property||a.alias){let e=(0,r.decltype_returns)(a,r.lexers[a.uri]??s,c);return a.kind===i.SymbolKind.Property&&a.alias&&(e=(0,r.decltype_invoke)(s,e,"call",!0)),e.forEach((e=>_(e,"call",-1)))}if(o&&"bind"===t){if(g.has(o))return;g.add(o);let e=o.full.indexOf("(",o.name?1:0);o={...o,name:a.name,detail:void 0===a.markdown_detail?a.detail:void 0,full:`(Func) Bind${o.full.slice(e,e+o.param_def_len)} => BoundFunc`,markdown_detail:a.markdown_detail},a=o}}else if(a.kind===i.SymbolKind.Class)a=(0,r.get_class_member)(s,a,"__item",!1);else{if(a.kind!==i.SymbolKind.Property)return;if(!a.params){for(let e of(0,r.decltype_returns)(a,r.lexers[a.uri]??s,c))(e=(0,r.get_class_member)(s,e,"__item",!1))&&y.push({node:e,needthis:n,uri:e.uri});return}}a&&y.push({node:a,needthis:n,uri:a.uri})}}}for(let e of y){let t=e.node,n=r.lexers[e.uri],s=e.needthis??0;if(!t.params||g.has(t))continue;let c,l,u,f,p,h,m=[t],y=t.name&&t.full.match(/^(\(.+?\))?[^([]+/)?.[0].length||0,_=d-s,b=[],v=(0,r.get_detail)(t,n,/(^|\n)\*@param\*(.|\n|\r)*?(?=\n\*@|$)/g);if(t.overloads)if("string"==typeof t.overloads){let e=new r.Lexer(o.TextDocument.create("","ahk2",-10,t.kind===i.SymbolKind.Function?t.overloads:`class _ {\n${t.overloads}\n}`),void 0,-1);e.parseScript(),p=t.name||"_";let n=t.kind===i.SymbolKind.Function?e.children:e.declaration._?.children??[],s=t.full.match(/^(\(.+?\))?[^([]+/)?.[0]??p;for(let e of n)e.name===p&&e.params&&(e.full=s+e.full.replace(/^(\(.+?\))?[^([]+/,""),m.push(e));t.overloads=m.slice(1)}else m.push(...t.overloads);y+=s>0?7:1,g.add(t);for(let e of m){p=e.full,c=e.params,u=e.variadic&&c[(f=c.length)-1].arr?Math.min(_,f-1):_,h=c[u]?.name.toUpperCase()??(s&&-1===u?"this":"\0"),l=t.params.find((e=>e.name.toUpperCase()===h))??t.overload_params?.[h],b=e.param_offsets.map(((e,t)=>({label:[e+=y,e+(c[t].name.length||1)]}))),s>0&&(b.unshift({label:"this"}),u++,p=p.replace(/(?<=.)\(/,"(this"+(c.length?", ":"")));let i=l&&(0,r.get_detail)(l,n);i&&(b[u].documentation=i),a.signatures.push({label:p,parameters:b,documentation:v,activeParameter:u})}}return a}},5116:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.workspaceSymbolProvider=t.checkParams=t.symbolProvider=t.globalsymbolcache=void 0;const i=n(2374),o=n(8952),r=n(7237),s=n(3939);function a(e,n){let o=e.textDocument.uri.toLowerCase(),r=s.lexers[o];if(!r||n?.isCancellationRequested)return[];if(null!==n&&r.symbolInformation)return r.symbolInformation;let a=t.globalsymbolcache={...s.ahkvars},l=[o,...Object.keys(r.relevance)],u={};l=l.map((e=>s.lexers[e]?.d_uri)).concat(l);for(const e of l){let t=s.lexers[e];if(!t)continue;let n,o=t.d,r=t.declaration;for(let e in r)!(n=a[e])||o||r[e].kind!==i.SymbolKind.Variable&&(n.kind===i.SymbolKind.Variable||!1===n.def)?a[e]=r[e]:n.kind===i.SymbolKind.Variable&&(n.assigned||=r[e].assigned,r[e].def)&&(n.def??=!1)}if(r.symbolInformation)return r.symbolInformation;s.ahkuris.winapi&&!l.includes(s.ahkuris.winapi)&&(u=s.lexers[s.ahkuris.winapi]?.declaration??u);const d=s.extsettings.Warn?.LocalSameAsGlobal,f=[],p=new Map,h=[i.SymbolKind.Method,i.SymbolKind.Property,i.SymbolKind.Class];for(let[e,t]of Object.entries(r.declaration)){let n=a[e],o=!1;n.kind!==i.SymbolKind.Variable||n.assigned||(u[e]?(n=a[e]=u[e],o=!0):void 0===t.returns&&p.set(n,t)),n!==t&&t.kind===i.SymbolKind.Variable||(f.push(t),g(t,t,o||t===s.ahkvars[e]).definition=t)}if(function e(t,n={},o=!1){const l=[];let y,_=t.kind===i.SymbolKind.Class;t.children?.forEach((e=>{if(e.children&&l.push(e),!e.name)return;let t=e.kind;if(t===i.SymbolKind.Variable||t===i.SymbolKind.Function||!_&&t===i.SymbolKind.Class){let t=e.name.toUpperCase(),o=n[t]??a[t];if(o===e||!o)return;(y=g(e,o,o===s.ahkvars[t])).definition=o,o.selectionRange.end.character?e.kind!==i.SymbolKind.Variable?f.push(e):o.kind===i.SymbolKind.Variable?m(o,e):y.callsite&&c(r,o,y.callsite):delete y.semantic}else h.includes(t)||f.push(e)}));for(let t of l){let c,h={},y=t,_=o;switch(t.kind){case i.SymbolKind.Class:let e=t;h={THIS:s.THIS,SUPER:s.SUPER},o=!1;for(let t of[e.property,e.prototype?.property??{}])Object.values(t).forEach((e=>e.selectionRange.end.character&&f.push(e)));break;case i.SymbolKind.Method:o||=y.assume===s.FuncScope.GLOBAL;case i.SymbolKind.Function:y.has_this_param&&(h={THIS:s.THIS,SUPER:s.SUPER});case i.SymbolKind.Event:if(y.parent){if(y.kind!==i.SymbolKind.Method)if(0===n.SUPER?.range.end.character&&delete n.SUPER,y.assume!==s.FuncScope.GLOBAL)if(y.assume===s.FuncScope.STATIC&&(o=!1),y.static)for(let[e,t]of Object.entries(n))(t.static||t===a[e])&&(h[e]=t);else h={...n};else o=!0}else o||=y.assume===s.FuncScope.GLOBAL;for(let[e,t]of Object.entries(y.global??{}))c=h[e]=a[e]??=t,g(t,c,c===s.ahkvars[e]).definition=c,c.kind===i.SymbolKind.Variable&&m(c,t);for(let[e,t]of Object.entries(y.local??{})){if(g(h[e]=t,t).definition=t,t.kind===i.SymbolKind.Variable){if(t.is_param)continue;t.assigned||void 0!==t.returns?d&&!t.decl&&a[e]&&r.diagnostics.push({message:s.warn.localsameasglobal(t.name),range:t.selectionRange,severity:i.DiagnosticSeverity.Warning}):p.set(t,t)}f.push(t)}for(let[e,t]of Object.entries(y.declaration??={}))(c=h[e])?c!==t&&(g(t,c,c===s.ahkvars[e]).definition=c,c.kind===i.SymbolKind.Variable&&m(c,t)):o?(c=a[e]??=(f.push(t),t.is_global=!0,r.declaration[e]=t),g(t,c,c===s.ahkvars[e]).definition=c,c.kind===i.SymbolKind.Variable&&m(c,t)):!t.def&&(c=a[e])?g(t,c,c===s.ahkvars[e]).definition=c:(g(h[e]=y.local[e]=t,t).definition=t,f.push(t),null===t.static&&(t.static=!0),d&&t.kind===i.SymbolKind.Variable&&a[e]&&r.diagnostics.push({message:s.warn.localsameasglobal(t.name),range:t.selectionRange,severity:i.DiagnosticSeverity.Warning}));for(let[e,t]of Object.entries(y.unresolved_vars??{}))(c=h[e]??a[e]??u[e])?g(t,c,c===s.ahkvars[e]).definition=c:(g(t,t).definition=t,f.push(h[e]=t),y.assume===s.FuncScope.STATIC&&(t.static=!0),void 0===t.returns&&p.set(t,t));break;case i.SymbolKind.Property:if(t.parent?.kind===i.SymbolKind.Class){let e=t;for(let t of[e.get,e.set,e.call])t&&(l.push(t),t.selectionRange.end.character&&f.push(t))}break;default:h={...n}}e(t,h,o),o=_}}(r),s.extsettings.Warn?.VarUnset)for(let[e,t]of p)e.assigned||r.diagnostics.push({message:s.warn.varisunset(t.name),range:t.selectionRange,severity:i.DiagnosticSeverity.Warning});return r.actived&&(function(e){if(e.d)return;let t,n={...s.ahkvars},o={};Object.keys(e.labels).forEach((e=>o[e]=!0));for(const r in e.relevance)if(t=s.lexers[r]){t.diagnostics.splice(t.diags),(0,s.check_same_name_error)(n,Object.values(t.declaration).filter((e=>e.kind!==i.SymbolKind.Variable)),t.diagnostics);for(const e in t.labels)t.labels[e][0].def&&(o[e]?t.diagnostics.push({message:s.diagnostic.duplabel(),range:t.labels[e][0].selectionRange,severity:i.DiagnosticSeverity.Error}):o[e]=!0)}let r,a=Object.values(e.declaration);(0,s.check_same_name_error)(n,a,e.diagnostics);for(const o in e.relevance)(t=s.lexers[o])&&(0,s.check_same_name_error)(n,Object.values(t.declaration).filter((e=>e.kind===i.SymbolKind.Variable)),t.diagnostics);a.forEach((t=>{if(t.kind===i.SymbolKind.Class&&void 0===(r=t).extendsuri){let n=r.extends?.toUpperCase();n===t.name.toUpperCase()?c(e,r,!1):n&&!(0,s.find_class)(e,n)?.prototype&&c(e,r)}}));for(const n in e.relevance)if(t=s.lexers[n])for(const e of Object.values(t.declaration))if(e.kind===i.SymbolKind.Class&&void 0===(r=e).extendsuri){let n=r.extends?.toUpperCase();n===e.name.toUpperCase()?c(t,r,!1):n&&!(0,s.find_class)(t,n)?.prototype&&c(t,r)}function c(e,t,n=!0){let o,r=e.document.offsetAt(t.selectionRange.start),a=e.tokens;if(!(o=a[a[r].next_token_offset])||!(o=a[o.next_token_offset]))return;r=o.offset;let c={start:e.document.positionAt(r),end:e.document.positionAt(r+t.extends.length)};e.diagnostics.push({message:n?s.diagnostic.unknown("class '"+t.extends)+"'":s.diagnostic.unexpected(t.extends),range:c,severity:i.DiagnosticSeverity.Warning})}}(r),r.sendDiagnostics(!1,!0)),r.diags=r.diagnostics.length,o=r.document.uri,r.symbolInformation=f.map((e=>i.SymbolInformation.create(e.name,e.kind,e.range,o)));function m(e,t){(e.assigned||=t.assigned)||void 0!==t.returns||p.has(e)||p.set(e,t)}function g(e,t,n=!1){let o,a,c,l,u=t.kind;switch(u){case i.SymbolKind.Variable:if(t.is_param){if(!e.selectionRange.end.character)return{};c=s.SemanticTokenTypes.parameter;break}c=s.SemanticTokenTypes.variable;break;case i.SymbolKind.Class:c=s.SemanticTokenTypes.class;break;case i.SymbolKind.Function:c=s.SemanticTokenTypes.function}if((o=r.tokens[l=r.document.offsetAt(e.selectionRange.start)])&&void 0!==c&&!o.ignore){if(void 0===(a=o.semantic)){if(o.semantic=a={type:c},e.kind!==i.SymbolKind.Variable||!e.def||u!==i.SymbolKind.Class&&u!==i.SymbolKind.Function||(r.addDiagnostic((0,s.make_same_name_error)(e,{kind:u}),l,e.name.length),delete e.def),!o.callsite&&c===s.SemanticTokenTypes.function){let e=r.tokens[o.next_token_offset];e&&e.topofline<1&&!(e.op_type>=0||":?.+-*/=%<>,)]}".includes(e.content.charAt(0))||!e.data&&"{"===e.content)&&r.addDiagnostic(s.diagnostic.funccallerr2(),o.offset,o.length,2)}}else void 0!==u&&(a.type=c);c<3&&(a.modifier=(a.modifier??0)|s.SemanticTokenModifiers.readonly|(n?s.SemanticTokenModifiers.defaultLibrary:0))}return o??{}}}function c(e,t,n){let o,r,a=n.paraminfo;if(!a||!s.extsettings.Diagnostics.ParamsCheck)return;if((o=t?.kind===i.SymbolKind.Class)&&(t=(0,s.get_class_constructor)(t)),!(r=t?.params))return;let c,{max:l,min:u}=function(e){let t=e.params,n=t.length,i=n;for(e.variadic&&(i=1/0,n>0&&t[n-1].arr&&n--);n>0&&void 0!==t[n-1].defaultVal;)--n;for(let e=0;e<n;++e)!1===t[e].defaultVal&&--n;return{min:n,max:i,has_this_param:e.has_this_param}}(t),d=r.length,{count:f,miss:p}=a,h={};for(;void 0!==(c=p.pop());)if(c!==--f){f++,p.push(c);break}for(c of((f<u&&!a.unknown||f>l)&&e.diagnostics.push({message:s.diagnostic.paramcounterr(u===l?u:l===1/0?`${u}+`:`${u}-${l}`,f),range:n.range,severity:i.DiagnosticSeverity.Error}),p)){if(c>=d)break;h[c]=!0,m(r,c)&&e.addDiagnostic(s.diagnostic.missingparam(),a.comma[c]??e.document.offsetAt(n.range.end),1)}if(t.hasref&&r.forEach(((t,i)=>{if(i<f&&t.pass_by_ref&&!p[i]){let o,r;if(o=0===i?n.offset+n.name.length+1:a.comma[i-1]+1,"&"!==(r=e.find_token(o)).content&&("unset"!==r.content.toLowerCase()||void 0===t.defaultVal)&&"TK_DOT"!==e.tokens[r.next_token_offset]?.type){let t=0;if((0,s.decltype_expr)(e,r,a.comma[i]??(t=e.document.offsetAt(n.range.end)-(e.tokens[n.offset+n.name.length]?1:0))).some((e=>e===s.VARREF||e===s.ANY||e.data===s.VARREF)))return;let o=e.tokens[a.comma[i]]?.previous_token;o&&(t=o.offset+o.length),e.addDiagnostic(s.diagnostic.typemaybenot("VarRef"),r.offset,Math.max(0,t-r.offset),2)}}})),!(t.returns?.length||(t.type_annotations||null)?.length||o&&"__new"===t.name.toLowerCase())){let t=e.tokens[n.offset];if("TK_EQUALS"===t?.previous_token?.type){let i=e.get_token(e.document.offsetAt(n.range.end),!0);i&&(0,s.is_line_continue)(i.previous_token,i)&&("??"===i.content||"?"===i.content&&i.ignore)||e.addDiagnostic(s.diagnostic.missingretval(),t.offset,t.length,2)}}function m(e,t){if(void 0!==e[t].defaultVal)return!1;let n=t-1;for(;n>=0;){for(;n>=0&&!1===e[n].defaultVal;n--,t++);if(!e[t]||void 0!==e[t].defaultVal)return!1;for(;n>=0&&!1!==e[n].defaultVal;n--);}return!0}}t.globalsymbolcache={},t.symbolProvider=a,t.checkParams=c,t.workspaceSymbolProvider=async function(e,t){let n=[],i=0,c=e.query;if(t.isCancellationRequested||!c||!c.match(/^(\w|[^\x00-\x7f])+$/))return n;let l=new RegExp(c.match(/[^\w]/)?c.replace(/(.)/g,"$1.*"):"("+c.replace(/(.)/g,"$1.*")+"|[^\\w])","i");for(let e in s.lexers)if(u(e))return n;if(s.isBrowser){let e=await s.connection.sendRequest("ahk2.getWorkspaceFiles",[])||[];for(let t of e){let e,i=t.toLowerCase();if(!s.lexers[i]){let r=await s.connection.sendRequest("ahk2.getWorkspaceFileContent",[t]);if(e=new s.Lexer(o.TextDocument.create(t,"ahk2",-10,r)),e.parseScript(),s.lexers[i]=e,u(i))return n}}}else{let e,t,i;for(let o of s.workspaceFolders){o=r.URI.parse(o).fsPath;for await(let a of(0,s.enum_ahkfiles)(o))if(e=r.URI.file(a).toString().toLowerCase(),!s.lexers[e]&&(i=(0,s.openFile)(a))){if((t=new s.Lexer(i)).parseScript(),t.maybev1)continue;if(s.lexers[e]=t,u(e))return n}}}return n;function u(e){for(let t of a({textDocument:{uri:e}}))if(l.test(t.name)&&(n.push(t),++i>=1e3))return!0;return!1}}},5748:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ProgressType=t.ProgressToken=t.createMessageConnection=t.NullLogger=t.ConnectionOptions=t.ConnectionStrategy=t.AbstractMessageBuffer=t.WriteableStreamMessageWriter=t.AbstractMessageWriter=t.MessageWriter=t.ReadableStreamMessageReader=t.AbstractMessageReader=t.MessageReader=t.SharedArrayReceiverStrategy=t.SharedArraySenderStrategy=t.CancellationToken=t.CancellationTokenSource=t.Emitter=t.Event=t.Disposable=t.LRUCache=t.Touch=t.LinkedMap=t.ParameterStructures=t.NotificationType9=t.NotificationType8=t.NotificationType7=t.NotificationType6=t.NotificationType5=t.NotificationType4=t.NotificationType3=t.NotificationType2=t.NotificationType1=t.NotificationType0=t.NotificationType=t.ErrorCodes=t.ResponseError=t.RequestType9=t.RequestType8=t.RequestType7=t.RequestType6=t.RequestType5=t.RequestType4=t.RequestType3=t.RequestType2=t.RequestType1=t.RequestType0=t.RequestType=t.Message=t.RAL=void 0,t.MessageStrategy=t.CancellationStrategy=t.CancellationSenderStrategy=t.CancellationReceiverStrategy=t.ConnectionError=t.ConnectionErrors=t.LogTraceNotification=t.SetTraceNotification=t.TraceFormat=t.TraceValues=t.Trace=void 0;const i=n(5285);Object.defineProperty(t,"Message",{enumerable:!0,get:function(){return i.Message}}),Object.defineProperty(t,"RequestType",{enumerable:!0,get:function(){return i.RequestType}}),Object.defineProperty(t,"RequestType0",{enumerable:!0,get:function(){return i.RequestType0}}),Object.defineProperty(t,"RequestType1",{enumerable:!0,get:function(){return i.RequestType1}}),Object.defineProperty(t,"RequestType2",{enumerable:!0,get:function(){return i.RequestType2}}),Object.defineProperty(t,"RequestType3",{enumerable:!0,get:function(){return i.RequestType3}}),Object.defineProperty(t,"RequestType4",{enumerable:!0,get:function(){return i.RequestType4}}),Object.defineProperty(t,"RequestType5",{enumerable:!0,get:function(){return i.RequestType5}}),Object.defineProperty(t,"RequestType6",{enumerable:!0,get:function(){return i.RequestType6}}),Object.defineProperty(t,"RequestType7",{enumerable:!0,get:function(){return i.RequestType7}}),Object.defineProperty(t,"RequestType8",{enumerable:!0,get:function(){return i.RequestType8}}),Object.defineProperty(t,"RequestType9",{enumerable:!0,get:function(){return i.RequestType9}}),Object.defineProperty(t,"ResponseError",{enumerable:!0,get:function(){return i.ResponseError}}),Object.defineProperty(t,"ErrorCodes",{enumerable:!0,get:function(){return i.ErrorCodes}}),Object.defineProperty(t,"NotificationType",{enumerable:!0,get:function(){return i.NotificationType}}),Object.defineProperty(t,"NotificationType0",{enumerable:!0,get:function(){return i.NotificationType0}}),Object.defineProperty(t,"NotificationType1",{enumerable:!0,get:function(){return i.NotificationType1}}),Object.defineProperty(t,"NotificationType2",{enumerable:!0,get:function(){return i.NotificationType2}}),Object.defineProperty(t,"NotificationType3",{enumerable:!0,get:function(){return i.NotificationType3}}),Object.defineProperty(t,"NotificationType4",{enumerable:!0,get:function(){return i.NotificationType4}}),Object.defineProperty(t,"NotificationType5",{enumerable:!0,get:function(){return i.NotificationType5}}),Object.defineProperty(t,"NotificationType6",{enumerable:!0,get:function(){return i.NotificationType6}}),Object.defineProperty(t,"NotificationType7",{enumerable:!0,get:function(){return i.NotificationType7}}),Object.defineProperty(t,"NotificationType8",{enumerable:!0,get:function(){return i.NotificationType8}}),Object.defineProperty(t,"NotificationType9",{enumerable:!0,get:function(){return i.NotificationType9}}),Object.defineProperty(t,"ParameterStructures",{enumerable:!0,get:function(){return i.ParameterStructures}});const o=n(5164);Object.defineProperty(t,"LinkedMap",{enumerable:!0,get:function(){return o.LinkedMap}}),Object.defineProperty(t,"LRUCache",{enumerable:!0,get:function(){return o.LRUCache}}),Object.defineProperty(t,"Touch",{enumerable:!0,get:function(){return o.Touch}});const r=n(8159);Object.defineProperty(t,"Disposable",{enumerable:!0,get:function(){return r.Disposable}});const s=n(345);Object.defineProperty(t,"Event",{enumerable:!0,get:function(){return s.Event}}),Object.defineProperty(t,"Emitter",{enumerable:!0,get:function(){return s.Emitter}});const a=n(7770);Object.defineProperty(t,"CancellationTokenSource",{enumerable:!0,get:function(){return a.CancellationTokenSource}}),Object.defineProperty(t,"CancellationToken",{enumerable:!0,get:function(){return a.CancellationToken}});const c=n(278);Object.defineProperty(t,"SharedArraySenderStrategy",{enumerable:!0,get:function(){return c.SharedArraySenderStrategy}}),Object.defineProperty(t,"SharedArrayReceiverStrategy",{enumerable:!0,get:function(){return c.SharedArrayReceiverStrategy}});const l=n(4806);Object.defineProperty(t,"MessageReader",{enumerable:!0,get:function(){return l.MessageReader}}),Object.defineProperty(t,"AbstractMessageReader",{enumerable:!0,get:function(){return l.AbstractMessageReader}}),Object.defineProperty(t,"ReadableStreamMessageReader",{enumerable:!0,get:function(){return l.ReadableStreamMessageReader}});const u=n(9248);Object.defineProperty(t,"MessageWriter",{enumerable:!0,get:function(){return u.MessageWriter}}),Object.defineProperty(t,"AbstractMessageWriter",{enumerable:!0,get:function(){return u.AbstractMessageWriter}}),Object.defineProperty(t,"WriteableStreamMessageWriter",{enumerable:!0,get:function(){return u.WriteableStreamMessageWriter}});const d=n(5506);Object.defineProperty(t,"AbstractMessageBuffer",{enumerable:!0,get:function(){return d.AbstractMessageBuffer}});const f=n(6336);Object.defineProperty(t,"ConnectionStrategy",{enumerable:!0,get:function(){return f.ConnectionStrategy}}),Object.defineProperty(t,"ConnectionOptions",{enumerable:!0,get:function(){return f.ConnectionOptions}}),Object.defineProperty(t,"NullLogger",{enumerable:!0,get:function(){return f.NullLogger}}),Object.defineProperty(t,"createMessageConnection",{enumerable:!0,get:function(){return f.createMessageConnection}}),Object.defineProperty(t,"ProgressToken",{enumerable:!0,get:function(){return f.ProgressToken}}),Object.defineProperty(t,"ProgressType",{enumerable:!0,get:function(){return f.ProgressType}}),Object.defineProperty(t,"Trace",{enumerable:!0,get:function(){return f.Trace}}),Object.defineProperty(t,"TraceValues",{enumerable:!0,get:function(){return f.TraceValues}}),Object.defineProperty(t,"TraceFormat",{enumerable:!0,get:function(){return f.TraceFormat}}),Object.defineProperty(t,"SetTraceNotification",{enumerable:!0,get:function(){return f.SetTraceNotification}}),Object.defineProperty(t,"LogTraceNotification",{enumerable:!0,get:function(){return f.LogTraceNotification}}),Object.defineProperty(t,"ConnectionErrors",{enumerable:!0,get:function(){return f.ConnectionErrors}}),Object.defineProperty(t,"ConnectionError",{enumerable:!0,get:function(){return f.ConnectionError}}),Object.defineProperty(t,"CancellationReceiverStrategy",{enumerable:!0,get:function(){return f.CancellationReceiverStrategy}}),Object.defineProperty(t,"CancellationSenderStrategy",{enumerable:!0,get:function(){return f.CancellationSenderStrategy}}),Object.defineProperty(t,"CancellationStrategy",{enumerable:!0,get:function(){return f.CancellationStrategy}}),Object.defineProperty(t,"MessageStrategy",{enumerable:!0,get:function(){return f.MessageStrategy}});const p=n(8094);t.RAL=p.default},7770:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CancellationTokenSource=t.CancellationToken=void 0;const i=n(8094),o=n(8472),r=n(345);var s;!function(e){e.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:r.Event.None}),e.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:r.Event.None}),e.is=function(t){const n=t;return n&&(n===e.None||n===e.Cancelled||o.boolean(n.isCancellationRequested)&&!!n.onCancellationRequested)}}(s||(t.CancellationToken=s={}));const a=Object.freeze((function(e,t){const n=(0,i.default)().timer.setTimeout(e.bind(t),0);return{dispose(){n.dispose()}}}));class c{constructor(){this._isCancelled=!1}cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?a:(this._emitter||(this._emitter=new r.Emitter),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=void 0)}}t.CancellationTokenSource=class{get token(){return this._token||(this._token=new c),this._token}cancel(){this._token?this._token.cancel():this._token=s.Cancelled}dispose(){this._token?this._token instanceof c&&this._token.dispose():this._token=s.None}}},6336:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createMessageConnection=t.ConnectionOptions=t.MessageStrategy=t.CancellationStrategy=t.CancellationSenderStrategy=t.CancellationReceiverStrategy=t.RequestCancellationReceiverStrategy=t.IdCancellationReceiverStrategy=t.ConnectionStrategy=t.ConnectionError=t.ConnectionErrors=t.LogTraceNotification=t.SetTraceNotification=t.TraceFormat=t.TraceValues=t.Trace=t.NullLogger=t.ProgressType=t.ProgressToken=void 0;const i=n(8094),o=n(8472),r=n(5285),s=n(5164),a=n(345),c=n(7770);var l,u,d,f,p,h,m,g,y,_,b,v,k,T,R,S,w,C,D;!function(e){e.type=new r.NotificationType("$/cancelRequest")}(l||(l={})),function(e){e.is=function(e){return"string"==typeof e||"number"==typeof e}}(u||(t.ProgressToken=u={})),function(e){e.type=new r.NotificationType("$/progress")}(d||(d={})),t.ProgressType=class{constructor(){}},function(e){e.is=function(e){return o.func(e)}}(f||(f={})),t.NullLogger=Object.freeze({error:()=>{},warn:()=>{},info:()=>{},log:()=>{}}),function(e){e[e.Off=0]="Off",e[e.Messages=1]="Messages",e[e.Compact=2]="Compact",e[e.Verbose=3]="Verbose"}(p||(t.Trace=p={})),function(e){e.Off="off",e.Messages="messages",e.Compact="compact",e.Verbose="verbose"}(h||(t.TraceValues=h={})),function(e){e.fromString=function(t){if(!o.string(t))return e.Off;switch(t=t.toLowerCase()){default:return e.Off;case"messages":return e.Messages;case"compact":return e.Compact;case"verbose":return e.Verbose}},e.toString=function(t){switch(t){case e.Off:return"off";case e.Messages:return"messages";case e.Compact:return"compact";case e.Verbose:return"verbose";default:return"off"}}}(p||(t.Trace=p={})),function(e){e.Text="text",e.JSON="json"}(m||(t.TraceFormat=m={})),function(e){e.fromString=function(t){return o.string(t)&&"json"===(t=t.toLowerCase())?e.JSON:e.Text}}(m||(t.TraceFormat=m={})),function(e){e.type=new r.NotificationType("$/setTrace")}(g||(t.SetTraceNotification=g={})),function(e){e.type=new r.NotificationType("$/logTrace")}(y||(t.LogTraceNotification=y={})),function(e){e[e.Closed=1]="Closed",e[e.Disposed=2]="Disposed",e[e.AlreadyListening=3]="AlreadyListening"}(_||(t.ConnectionErrors=_={}));class x extends Error{constructor(e,t){super(t),this.code=e,Object.setPrototypeOf(this,x.prototype)}}t.ConnectionError=x,function(e){e.is=function(e){const t=e;return t&&o.func(t.cancelUndispatched)}}(b||(t.ConnectionStrategy=b={})),function(e){e.is=function(e){const t=e;return t&&(void 0===t.kind||"id"===t.kind)&&o.func(t.createCancellationTokenSource)&&(void 0===t.dispose||o.func(t.dispose))}}(v||(t.IdCancellationReceiverStrategy=v={})),function(e){e.is=function(e){const t=e;return t&&"request"===t.kind&&o.func(t.createCancellationTokenSource)&&(void 0===t.dispose||o.func(t.dispose))}}(k||(t.RequestCancellationReceiverStrategy=k={})),function(e){e.Message=Object.freeze({createCancellationTokenSource:e=>new c.CancellationTokenSource}),e.is=function(e){return v.is(e)||k.is(e)}}(T||(t.CancellationReceiverStrategy=T={})),function(e){e.Message=Object.freeze({sendCancellation:(e,t)=>e.sendNotification(l.type,{id:t}),cleanup(e){}}),e.is=function(e){const t=e;return t&&o.func(t.sendCancellation)&&o.func(t.cleanup)}}(R||(t.CancellationSenderStrategy=R={})),function(e){e.Message=Object.freeze({receiver:T.Message,sender:R.Message}),e.is=function(e){const t=e;return t&&T.is(t.receiver)&&R.is(t.sender)}}(S||(t.CancellationStrategy=S={})),function(e){e.is=function(e){const t=e;return t&&o.func(t.handleMessage)}}(w||(t.MessageStrategy=w={})),function(e){e.is=function(e){const t=e;return t&&(S.is(t.cancellationStrategy)||b.is(t.connectionStrategy)||w.is(t.messageStrategy))}}(C||(t.ConnectionOptions=C={})),function(e){e[e.New=1]="New",e[e.Listening=2]="Listening",e[e.Closed=3]="Closed",e[e.Disposed=4]="Disposed"}(D||(D={})),t.createMessageConnection=function(e,n,h,b){const k=void 0!==h?h:t.NullLogger;let T=0,R=0,C=0;const E="2.0";let O;const K=new Map;let P;const A=new Map,N=new Map;let M,I,L=new s.LinkedMap,q=new Map,F=new Set,j=new Map,W=p.Off,$=m.Text,U=D.New;const V=new a.Emitter,B=new a.Emitter,H=new a.Emitter,G=new a.Emitter,z=new a.Emitter,Y=b&&b.cancellationStrategy?b.cancellationStrategy:S.Message;function X(e){if(null===e)throw new Error("Can't send requests with id null since the response can't be correlated.");return"req-"+e.toString()}function J(e){}function Q(){return U===D.Listening}function Z(){return U===D.Closed}function ee(){return U===D.Disposed}function te(){U!==D.New&&U!==D.Listening||(U=D.Closed,B.fire(void 0))}function ne(){M||0===L.size||(M=(0,i.default)().timer.setImmediate((()=>{M=void 0,function(){if(0===L.size)return;const e=L.shift();try{const t=b?.messageStrategy;w.is(t)?t.handleMessage(e,ie):ie(e)}finally{ne()}}()})))}function ie(e){r.Message.isRequest(e)?function(e){if(ee())return;function t(t,i,o){const s={jsonrpc:E,id:e.id};t instanceof r.ResponseError?s.error=t.toJson():s.result=void 0===t?null:t,se(s,i,o),n.write(s).catch((()=>k.error("Sending response failed.")))}function i(t,i,o){const r={jsonrpc:E,id:e.id,error:t.toJson()};se(r,i,o),n.write(r).catch((()=>k.error("Sending response failed.")))}!function(e){if(W!==p.Off&&I)if($===m.Text){let t;W!==p.Verbose&&W!==p.Compact||!e.params||(t=`Params: ${re(e.params)}\n\n`),I.log(`Received request '${e.method} - (${e.id})'.`,t)}else ce("receive-request",e)}(e);const s=K.get(e.method);let a,c;s&&(a=s.type,c=s.handler);const l=Date.now();if(c||O){const s=e.id??String(Date.now()),u=v.is(Y.receiver)?Y.receiver.createCancellationTokenSource(s):Y.receiver.createCancellationTokenSource(e);null!==e.id&&F.has(e.id)&&u.cancel(),null!==e.id&&j.set(s,u);try{let d;if(c)if(void 0===e.params){if(void 0!==a&&0!==a.numberOfParams)return void i(new r.ResponseError(r.ErrorCodes.InvalidParams,`Request ${e.method} defines ${a.numberOfParams} params but received none.`),e.method,l);d=c(u.token)}else if(Array.isArray(e.params)){if(void 0!==a&&a.parameterStructures===r.ParameterStructures.byName)return void i(new r.ResponseError(r.ErrorCodes.InvalidParams,`Request ${e.method} defines parameters by name but received parameters by position`),e.method,l);d=c(...e.params,u.token)}else{if(void 0!==a&&a.parameterStructures===r.ParameterStructures.byPosition)return void i(new r.ResponseError(r.ErrorCodes.InvalidParams,`Request ${e.method} defines parameters by position but received parameters by name`),e.method,l);d=c(e.params,u.token)}else O&&(d=O(e.method,e.params,u.token));const f=d;d?f.then?f.then((n=>{j.delete(s),t(n,e.method,l)}),(t=>{j.delete(s),t instanceof r.ResponseError?i(t,e.method,l):t&&o.string(t.message)?i(new r.ResponseError(r.ErrorCodes.InternalError,`Request ${e.method} failed with message: ${t.message}`),e.method,l):i(new r.ResponseError(r.ErrorCodes.InternalError,`Request ${e.method} failed unexpectedly without providing any details.`),e.method,l)})):(j.delete(s),t(d,e.method,l)):(j.delete(s),function(t,i,o){void 0===t&&(t=null);const r={jsonrpc:E,id:e.id,result:t};se(r,i,o),n.write(r).catch((()=>k.error("Sending response failed.")))}(d,e.method,l))}catch(n){j.delete(s),n instanceof r.ResponseError?t(n,e.method,l):n&&o.string(n.message)?i(new r.ResponseError(r.ErrorCodes.InternalError,`Request ${e.method} failed with message: ${n.message}`),e.method,l):i(new r.ResponseError(r.ErrorCodes.InternalError,`Request ${e.method} failed unexpectedly without providing any details.`),e.method,l)}}else i(new r.ResponseError(r.ErrorCodes.MethodNotFound,`Unhandled method ${e.method}`),e.method,l)}(e):r.Message.isNotification(e)?function(e){if(ee())return;let t,n;if(e.method===l.type.method){const t=e.params.id;return F.delete(t),void ae(e)}{const i=A.get(e.method);i&&(n=i.handler,t=i.type)}if(n||P)try{if(ae(e),n)if(void 0===e.params)void 0!==t&&0!==t.numberOfParams&&t.parameterStructures!==r.ParameterStructures.byName&&k.error(`Notification ${e.method} defines ${t.numberOfParams} params but received none.`),n();else if(Array.isArray(e.params)){const i=e.params;e.method===d.type.method&&2===i.length&&u.is(i[0])?n({token:i[0],value:i[1]}):(void 0!==t&&(t.parameterStructures===r.ParameterStructures.byName&&k.error(`Notification ${e.method} defines parameters by name but received parameters by position`),t.numberOfParams!==e.params.length&&k.error(`Notification ${e.method} defines ${t.numberOfParams} params but received ${i.length} arguments`)),n(...i))}else void 0!==t&&t.parameterStructures===r.ParameterStructures.byPosition&&k.error(`Notification ${e.method} defines parameters by position but received parameters by name`),n(e.params);else P&&P(e.method,e.params)}catch(t){t.message?k.error(`Notification handler '${e.method}' failed with message: ${t.message}`):k.error(`Notification handler '${e.method}' failed unexpectedly.`)}else H.fire(e)}(e):r.Message.isResponse(e)?function(e){if(!ee())if(null===e.id)e.error?k.error(`Received response message without id: Error is: \n${JSON.stringify(e.error,void 0,4)}`):k.error("Received response message without id. No further error information provided.");else{const t=e.id,n=q.get(t);if(function(e,t){if(W!==p.Off&&I)if($===m.Text){let n;if(W!==p.Verbose&&W!==p.Compact||(e.error&&e.error.data?n=`Error data: ${re(e.error.data)}\n\n`:e.result?n=`Result: ${re(e.result)}\n\n`:void 0===e.error&&(n="No result returned.\n\n")),t){const i=e.error?` Request failed: ${e.error.message} (${e.error.code}).`:"";I.log(`Received response '${t.method} - (${e.id})' in ${Date.now()-t.timerStart}ms.${i}`,n)}else I.log(`Received response ${e.id} without active response promise.`,n)}else ce("receive-response",e)}(e,n),void 0!==n){q.delete(t);try{if(e.error){const t=e.error;n.reject(new r.ResponseError(t.code,t.message,t.data))}else{if(void 0===e.result)throw new Error("Should never happen.");n.resolve(e.result)}}catch(e){e.message?k.error(`Response handler '${n.method}' failed with message: ${e.message}`):k.error(`Response handler '${n.method}' failed unexpectedly.`)}}}}(e):function(e){if(!e)return void k.error("Received empty message.");k.error(`Received message which is neither a response nor a notification message:\n${JSON.stringify(e,null,4)}`);const t=e;if(o.string(t.id)||o.number(t.id)){const e=t.id,n=q.get(e);n&&n.reject(new Error("The received response has neither a result nor an error property."))}}(e)}e.onClose(te),e.onError((function(e){V.fire([e,void 0,void 0])})),n.onClose(te),n.onError((function(e){V.fire(e)}));const oe=e=>{try{if(r.Message.isNotification(e)&&e.method===l.type.method){const t=e.params.id,i=X(t),o=L.get(i);if(r.Message.isRequest(o)){const r=b?.connectionStrategy,s=r&&r.cancelUndispatched?r.cancelUndispatched(o,J):void 0;if(s&&(void 0!==s.error||void 0!==s.result))return L.delete(i),j.delete(t),s.id=o.id,se(s,e.method,Date.now()),void n.write(s).catch((()=>k.error("Sending response for canceled message failed.")))}const s=j.get(t);if(void 0!==s)return s.cancel(),void ae(e);F.add(t)}!function(e,t){var n;r.Message.isRequest(t)?e.set(X(t.id),t):r.Message.isResponse(t)?e.set(null===(n=t.id)?"res-unknown-"+(++C).toString():"res-"+n.toString(),t):e.set("not-"+(++R).toString(),t)}(L,e)}finally{ne()}};function re(e){if(null!=e)switch(W){case p.Verbose:return JSON.stringify(e,null,4);case p.Compact:return JSON.stringify(e);default:return}}function se(e,t,n){if(W!==p.Off&&I)if($===m.Text){let i;W!==p.Verbose&&W!==p.Compact||(e.error&&e.error.data?i=`Error data: ${re(e.error.data)}\n\n`:e.result?i=`Result: ${re(e.result)}\n\n`:void 0===e.error&&(i="No result returned.\n\n")),I.log(`Sending response '${t} - (${e.id})'. Processing request took ${Date.now()-n}ms`,i)}else ce("send-response",e)}function ae(e){if(W!==p.Off&&I&&e.method!==y.type.method)if($===m.Text){let t;W!==p.Verbose&&W!==p.Compact||(t=e.params?`Params: ${re(e.params)}\n\n`:"No parameters provided.\n\n"),I.log(`Received notification '${e.method}'.`,t)}else ce("receive-notification",e)}function ce(e,t){if(!I||W===p.Off)return;const n={isLSPMessage:!0,type:e,message:t,timestamp:Date.now()};I.log(n)}function le(){if(Z())throw new x(_.Closed,"Connection is closed.");if(ee())throw new x(_.Disposed,"Connection is disposed.")}function ue(e){return void 0===e?null:e}function de(e){return null===e?void 0:e}function fe(e){return null!=e&&!Array.isArray(e)&&"object"==typeof e}function pe(e,t){switch(e){case r.ParameterStructures.auto:return fe(t)?de(t):[ue(t)];case r.ParameterStructures.byName:if(!fe(t))throw new Error("Received parameters by name but param is not an object literal.");return de(t);case r.ParameterStructures.byPosition:return[ue(t)];default:throw new Error(`Unknown parameter structure ${e.toString()}`)}}function he(e,t){let n;const i=e.numberOfParams;switch(i){case 0:n=void 0;break;case 1:n=pe(e.parameterStructures,t[0]);break;default:n=[];for(let e=0;e<t.length&&e<i;e++)n.push(ue(t[e]));if(t.length<i)for(let e=t.length;e<i;e++)n.push(null)}return n}const me={sendNotification:(e,...t)=>{let i,s;if(le(),o.string(e)){i=e;const n=t[0];let o=0,a=r.ParameterStructures.auto;r.ParameterStructures.is(n)&&(o=1,a=n);let c=t.length;const l=c-o;switch(l){case 0:s=void 0;break;case 1:s=pe(a,t[o]);break;default:if(a===r.ParameterStructures.byName)throw new Error(`Received ${l} parameters for 'by Name' notification parameter structure.`);s=t.slice(o,c).map((e=>ue(e)))}}else{const n=t;i=e.method,s=he(e,n)}const a={jsonrpc:E,method:i,params:s};return function(e){if(W!==p.Off&&I)if($===m.Text){let t;W!==p.Verbose&&W!==p.Compact||(t=e.params?`Params: ${re(e.params)}\n\n`:"No parameters provided.\n\n"),I.log(`Sending notification '${e.method}'.`,t)}else ce("send-notification",e)}(a),n.write(a).catch((e=>{throw k.error("Sending notification failed."),e}))},onNotification:(e,t)=>{let n;return le(),o.func(e)?P=e:t&&(o.string(e)?(n=e,A.set(e,{type:void 0,handler:t})):(n=e.method,A.set(e.method,{type:e,handler:t}))),{dispose:()=>{void 0!==n?A.delete(n):P=void 0}}},onProgress:(e,t,n)=>{if(N.has(t))throw new Error(`Progress handler for token ${t} already registered`);return N.set(t,n),{dispose:()=>{N.delete(t)}}},sendProgress:(e,t,n)=>me.sendNotification(d.type,{token:t,value:n}),onUnhandledProgress:G.event,sendRequest:(e,...t)=>{let i,s,a;if(le(),function(){if(!Q())throw new Error("Call listen() first.")}(),o.string(e)){i=e;const n=t[0],o=t[t.length-1];let l=0,u=r.ParameterStructures.auto;r.ParameterStructures.is(n)&&(l=1,u=n);let d=t.length;c.CancellationToken.is(o)&&(d-=1,a=o);const f=d-l;switch(f){case 0:s=void 0;break;case 1:s=pe(u,t[l]);break;default:if(u===r.ParameterStructures.byName)throw new Error(`Received ${f} parameters for 'by Name' request parameter structure.`);s=t.slice(l,d).map((e=>ue(e)))}}else{const n=t;i=e.method,s=he(e,n);const o=e.numberOfParams;a=c.CancellationToken.is(n[o])?n[o]:void 0}const l=T++;let u;a&&(u=a.onCancellationRequested((()=>{const e=Y.sender.sendCancellation(me,l);return void 0===e?(k.log(`Received no promise from cancellation strategy when cancelling id ${l}`),Promise.resolve()):e.catch((()=>{k.log(`Sending cancellation messages for id ${l} failed`)}))})));const d={jsonrpc:E,id:l,method:i,params:s};return function(e){if(W!==p.Off&&I)if($===m.Text){let t;W!==p.Verbose&&W!==p.Compact||!e.params||(t=`Params: ${re(e.params)}\n\n`),I.log(`Sending request '${e.method} - (${e.id})'.`,t)}else ce("send-request",e)}(d),"function"==typeof Y.sender.enableCancellation&&Y.sender.enableCancellation(d),new Promise((async(e,t)=>{const o={method:i,timerStart:Date.now(),resolve:t=>{e(t),Y.sender.cleanup(l),u?.dispose()},reject:e=>{t(e),Y.sender.cleanup(l),u?.dispose()}};try{await n.write(d),q.set(l,o)}catch(e){throw k.error("Sending request failed."),o.reject(new r.ResponseError(r.ErrorCodes.MessageWriteError,e.message?e.message:"Unknown reason")),e}}))},onRequest:(e,t)=>{le();let n=null;return f.is(e)?(n=void 0,O=e):o.string(e)?(n=null,void 0!==t&&(n=e,K.set(e,{handler:t,type:void 0}))):void 0!==t&&(n=e.method,K.set(e.method,{type:e,handler:t})),{dispose:()=>{null!==n&&(void 0!==n?K.delete(n):O=void 0)}}},hasPendingResponse:()=>q.size>0,trace:async(e,t,n)=>{let i=!1,r=m.Text;void 0!==n&&(o.boolean(n)?i=n:(i=n.sendNotification||!1,r=n.traceFormat||m.Text)),W=e,$=r,I=W===p.Off?void 0:t,!i||Z()||ee()||await me.sendNotification(g.type,{value:p.toString(e)})},onError:V.event,onClose:B.event,onUnhandledNotification:H.event,onDispose:z.event,end:()=>{n.end()},dispose:()=>{if(ee())return;U=D.Disposed,z.fire(void 0);const t=new r.ResponseError(r.ErrorCodes.PendingResponseRejected,"Pending response rejected since connection got disposed");for(const e of q.values())e.reject(t);q=new Map,j=new Map,F=new Set,L=new s.LinkedMap,o.func(n.dispose)&&n.dispose(),o.func(e.dispose)&&e.dispose()},listen:()=>{le(),function(){if(Q())throw new x(_.AlreadyListening,"Connection is already listening")}(),U=D.Listening,e.listen(oe)},inspect:()=>{(0,i.default)().console.log("inspect")}};return me.onNotification(y.type,(e=>{if(W===p.Off||!I)return;const t=W===p.Verbose||W===p.Compact;I.log(e.message,t?e.verbose:void 0)})),me.onNotification(d.type,(e=>{const t=N.get(e.token);t?t(e.value):G.fire(e)})),me}},8159:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.Disposable=void 0,function(e){e.create=function(e){return{dispose:e}}}(n||(t.Disposable=n={}))},345:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Emitter=t.Event=void 0;const i=n(8094);var o;!function(e){const t={dispose(){}};e.None=function(){return t}}(o||(t.Event=o={}));class r{add(e,t=null,n){this._callbacks||(this._callbacks=[],this._contexts=[]),this._callbacks.push(e),this._contexts.push(t),Array.isArray(n)&&n.push({dispose:()=>this.remove(e,t)})}remove(e,t=null){if(!this._callbacks)return;let n=!1;for(let i=0,o=this._callbacks.length;i<o;i++)if(this._callbacks[i]===e){if(this._contexts[i]===t)return this._callbacks.splice(i,1),void this._contexts.splice(i,1);n=!0}if(n)throw new Error("When adding a listener with a context, you should remove it with the same context")}invoke(...e){if(!this._callbacks)return[];const t=[],n=this._callbacks.slice(0),o=this._contexts.slice(0);for(let r=0,s=n.length;r<s;r++)try{t.push(n[r].apply(o[r],e))}catch(e){(0,i.default)().console.error(e)}return t}isEmpty(){return!this._callbacks||0===this._callbacks.length}dispose(){this._callbacks=void 0,this._contexts=void 0}}class s{constructor(e){this._options=e}get event(){return this._event||(this._event=(e,t,n)=>{this._callbacks||(this._callbacks=new r),this._options&&this._options.onFirstListenerAdd&&this._callbacks.isEmpty()&&this._options.onFirstListenerAdd(this),this._callbacks.add(e,t);const i={dispose:()=>{this._callbacks&&(this._callbacks.remove(e,t),i.dispose=s._noop,this._options&&this._options.onLastListenerRemove&&this._callbacks.isEmpty()&&this._options.onLastListenerRemove(this))}};return Array.isArray(n)&&n.push(i),i}),this._event}fire(e){this._callbacks&&this._callbacks.invoke.call(this._callbacks,e)}dispose(){this._callbacks&&(this._callbacks.dispose(),this._callbacks=void 0)}}t.Emitter=s,s._noop=function(){}},8472:(e,t)=>{"use strict";function n(e){return"string"==typeof e||e instanceof String}function i(e){return Array.isArray(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.stringArray=t.array=t.func=t.error=t.number=t.string=t.boolean=void 0,t.boolean=function(e){return!0===e||!1===e},t.string=n,t.number=function(e){return"number"==typeof e||e instanceof Number},t.error=function(e){return e instanceof Error},t.func=function(e){return"function"==typeof e},t.array=i,t.stringArray=function(e){return i(e)&&e.every((e=>n(e)))}},5164:(e,t)=>{"use strict";var n,i;Object.defineProperty(t,"__esModule",{value:!0}),t.LRUCache=t.LinkedMap=t.Touch=void 0,function(e){e.None=0,e.First=1,e.AsOld=e.First,e.Last=2,e.AsNew=e.Last}(i||(t.Touch=i={}));class o{constructor(){this[n]="LinkedMap",this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){return this._head?.value}get last(){return this._tail?.value}has(e){return this._map.has(e)}get(e,t=i.None){const n=this._map.get(e);if(n)return t!==i.None&&this.touch(n,t),n.value}set(e,t,n=i.None){let o=this._map.get(e);if(o)o.value=t,n!==i.None&&this.touch(o,n);else{switch(o={key:e,value:t,next:void 0,previous:void 0},n){case i.None:this.addItemLast(o);break;case i.First:this.addItemFirst(o);break;case i.Last:default:this.addItemLast(o)}this._map.set(e,o),this._size++}return this}delete(e){return!!this.remove(e)}remove(e){const t=this._map.get(e);if(t)return this._map.delete(e),this.removeItem(t),this._size--,t.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");const e=this._head;return this._map.delete(e.key),this.removeItem(e),this._size--,e.value}forEach(e,t){const n=this._state;let i=this._head;for(;i;){if(t?e.bind(t)(i.value,i.key,this):e(i.value,i.key,this),this._state!==n)throw new Error("LinkedMap got modified during iteration.");i=i.next}}keys(){const e=this._state;let t=this._head;const n={[Symbol.iterator]:()=>n,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(t){const e={value:t.key,done:!1};return t=t.next,e}return{value:void 0,done:!0}}};return n}values(){const e=this._state;let t=this._head;const n={[Symbol.iterator]:()=>n,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(t){const e={value:t.value,done:!1};return t=t.next,e}return{value:void 0,done:!0}}};return n}entries(){const e=this._state;let t=this._head;const n={[Symbol.iterator]:()=>n,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(t){const e={value:[t.key,t.value],done:!1};return t=t.next,e}return{value:void 0,done:!0}}};return n}[(n=Symbol.toStringTag,Symbol.iterator)](){return this.entries()}trimOld(e){if(e>=this.size)return;if(0===e)return void this.clear();let t=this._head,n=this.size;for(;t&&n>e;)this._map.delete(t.key),t=t.next,n--;this._head=t,this._size=n,t&&(t.previous=void 0),this._state++}addItemFirst(e){if(this._head||this._tail){if(!this._head)throw new Error("Invalid list");e.next=this._head,this._head.previous=e}else this._tail=e;this._head=e,this._state++}addItemLast(e){if(this._head||this._tail){if(!this._tail)throw new Error("Invalid list");e.previous=this._tail,this._tail.next=e}else this._head=e;this._tail=e,this._state++}removeItem(e){if(e===this._head&&e===this._tail)this._head=void 0,this._tail=void 0;else if(e===this._head){if(!e.next)throw new Error("Invalid list");e.next.previous=void 0,this._head=e.next}else if(e===this._tail){if(!e.previous)throw new Error("Invalid list");e.previous.next=void 0,this._tail=e.previous}else{const t=e.next,n=e.previous;if(!t||!n)throw new Error("Invalid list");t.previous=n,n.next=t}e.next=void 0,e.previous=void 0,this._state++}touch(e,t){if(!this._head||!this._tail)throw new Error("Invalid list");if(t===i.First||t===i.Last)if(t===i.First){if(e===this._head)return;const t=e.next,n=e.previous;e===this._tail?(n.next=void 0,this._tail=n):(t.previous=n,n.next=t),e.previous=void 0,e.next=this._head,this._head.previous=e,this._head=e,this._state++}else if(t===i.Last){if(e===this._tail)return;const t=e.next,n=e.previous;e===this._head?(t.previous=void 0,this._head=t):(t.previous=n,n.next=t),e.next=void 0,e.previous=this._tail,this._tail.next=e,this._tail=e,this._state++}}toJSON(){const e=[];return this.forEach(((t,n)=>{e.push([n,t])})),e}fromJSON(e){this.clear();for(const[t,n]of e)this.set(t,n)}}t.LinkedMap=o,t.LRUCache=class extends o{constructor(e,t=1){super(),this._limit=e,this._ratio=Math.min(Math.max(0,t),1)}get limit(){return this._limit}set limit(e){this._limit=e,this.checkTrim()}get ratio(){return this._ratio}set ratio(e){this._ratio=Math.min(Math.max(0,e),1),this.checkTrim()}get(e,t=i.AsNew){return super.get(e,t)}peek(e){return super.get(e,i.None)}set(e,t){return super.set(e,t,i.Last),this.checkTrim(),this}checkTrim(){this.size>this._limit&&this.trimOld(Math.round(this._limit*this._ratio))}}},5506:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AbstractMessageBuffer=void 0,t.AbstractMessageBuffer=class{constructor(e="utf-8"){this._encoding=e,this._chunks=[],this._totalLength=0}get encoding(){return this._encoding}append(e){const t="string"==typeof e?this.fromString(e,this._encoding):e;this._chunks.push(t),this._totalLength+=t.byteLength}tryReadHeaders(e=!1){if(0===this._chunks.length)return;let t=0,n=0,i=0,o=0;e:for(;n<this._chunks.length;){const e=this._chunks[n];for(i=0;i<e.length;){switch(e[i]){case 13:switch(t){case 0:t=1;break;case 2:t=3;break;default:t=0}break;case 10:switch(t){case 1:t=2;break;case 3:t=4,i++;break e;default:t=0}break;default:t=0}i++}o+=e.byteLength,n++}if(4!==t)return;const r=this._read(o+i),s=new Map,a=this.toString(r,"ascii").split("\r\n");if(a.length<2)return s;for(let t=0;t<a.length-2;t++){const n=a[t],i=n.indexOf(":");if(-1===i)throw new Error(`Message header must separate key and value using ':'\n${n}`);const o=n.substr(0,i),r=n.substr(i+1).trim();s.set(e?o.toLowerCase():o,r)}return s}tryReadBody(e){if(!(this._totalLength<e))return this._read(e)}get numberOfBytes(){return this._totalLength}_read(e){if(0===e)return this.emptyBuffer();if(e>this._totalLength)throw new Error("Cannot read so many bytes!");if(this._chunks[0].byteLength===e){const t=this._chunks[0];return this._chunks.shift(),this._totalLength-=e,this.asNative(t)}if(this._chunks[0].byteLength>e){const t=this._chunks[0],n=this.asNative(t,e);return this._chunks[0]=t.slice(e),this._totalLength-=e,n}const t=this.allocNative(e);let n=0;for(;e>0;){const i=this._chunks[0];if(i.byteLength>e){const o=i.slice(0,e);t.set(o,n),n+=e,this._chunks[0]=i.slice(e),this._totalLength-=e,e-=e}else t.set(i,n),n+=i.byteLength,this._chunks.shift(),this._totalLength-=i.byteLength,e-=i.byteLength}return t}}},4806:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ReadableStreamMessageReader=t.AbstractMessageReader=t.MessageReader=void 0;const i=n(8094),o=n(8472),r=n(345),s=n(6791);var a,c;!function(e){e.is=function(e){let t=e;return t&&o.func(t.listen)&&o.func(t.dispose)&&o.func(t.onError)&&o.func(t.onClose)&&o.func(t.onPartialMessage)}}(a||(t.MessageReader=a={}));class l{constructor(){this.errorEmitter=new r.Emitter,this.closeEmitter=new r.Emitter,this.partialMessageEmitter=new r.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(e){this.errorEmitter.fire(this.asError(e))}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}get onPartialMessage(){return this.partialMessageEmitter.event}firePartialMessage(e){this.partialMessageEmitter.fire(e)}asError(e){return e instanceof Error?e:new Error(`Reader received error. Reason: ${o.string(e.message)?e.message:"unknown"}`)}}t.AbstractMessageReader=l,function(e){e.fromOptions=function(e){let t,n;const o=new Map;let r;const s=new Map;if(void 0===e||"string"==typeof e)t=e??"utf-8";else{if(t=e.charset??"utf-8",void 0!==e.contentDecoder&&(n=e.contentDecoder,o.set(n.name,n)),void 0!==e.contentDecoders)for(const t of e.contentDecoders)o.set(t.name,t);if(void 0!==e.contentTypeDecoder&&(r=e.contentTypeDecoder,s.set(r.name,r)),void 0!==e.contentTypeDecoders)for(const t of e.contentTypeDecoders)s.set(t.name,t)}return void 0===r&&(r=(0,i.default)().applicationJson.decoder,s.set(r.name,r)),{charset:t,contentDecoder:n,contentDecoders:o,contentTypeDecoder:r,contentTypeDecoders:s}}}(c||(c={})),t.ReadableStreamMessageReader=class extends l{constructor(e,t){super(),this.readable=e,this.options=c.fromOptions(t),this.buffer=(0,i.default)().messageBuffer.create(this.options.charset),this._partialMessageTimeout=1e4,this.nextMessageLength=-1,this.messageToken=0,this.readSemaphore=new s.Semaphore(1)}set partialMessageTimeout(e){this._partialMessageTimeout=e}get partialMessageTimeout(){return this._partialMessageTimeout}listen(e){this.nextMessageLength=-1,this.messageToken=0,this.partialMessageTimer=void 0,this.callback=e;const t=this.readable.onData((e=>{this.onData(e)}));return this.readable.onError((e=>this.fireError(e))),this.readable.onClose((()=>this.fireClose())),t}onData(e){try{for(this.buffer.append(e);;){if(-1===this.nextMessageLength){const e=this.buffer.tryReadHeaders(!0);if(!e)return;const t=e.get("content-length");if(!t)return void this.fireError(new Error(`Header must provide a Content-Length property.\n${JSON.stringify(Object.fromEntries(e))}`));const n=parseInt(t);if(isNaN(n))return void this.fireError(new Error(`Content-Length value must be a number. Got ${t}`));this.nextMessageLength=n}const e=this.buffer.tryReadBody(this.nextMessageLength);if(void 0===e)return void this.setPartialMessageTimer();this.clearPartialMessageTimer(),this.nextMessageLength=-1,this.readSemaphore.lock((async()=>{const t=void 0!==this.options.contentDecoder?await this.options.contentDecoder.decode(e):e,n=await this.options.contentTypeDecoder.decode(t,this.options);this.callback(n)})).catch((e=>{this.fireError(e)}))}}catch(e){this.fireError(e)}}clearPartialMessageTimer(){this.partialMessageTimer&&(this.partialMessageTimer.dispose(),this.partialMessageTimer=void 0)}setPartialMessageTimer(){this.clearPartialMessageTimer(),this._partialMessageTimeout<=0||(this.partialMessageTimer=(0,i.default)().timer.setTimeout(((e,t)=>{this.partialMessageTimer=void 0,e===this.messageToken&&(this.firePartialMessage({messageToken:e,waitingTime:t}),this.setPartialMessageTimer())}),this._partialMessageTimeout,this.messageToken,this._partialMessageTimeout))}}},9248:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WriteableStreamMessageWriter=t.AbstractMessageWriter=t.MessageWriter=void 0;const i=n(8094),o=n(8472),r=n(6791),s=n(345);var a,c;!function(e){e.is=function(e){let t=e;return t&&o.func(t.dispose)&&o.func(t.onClose)&&o.func(t.onError)&&o.func(t.write)}}(a||(t.MessageWriter=a={}));class l{constructor(){this.errorEmitter=new s.Emitter,this.closeEmitter=new s.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(e,t,n){this.errorEmitter.fire([this.asError(e),t,n])}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}asError(e){return e instanceof Error?e:new Error(`Writer received error. Reason: ${o.string(e.message)?e.message:"unknown"}`)}}t.AbstractMessageWriter=l,function(e){e.fromOptions=function(e){return void 0===e||"string"==typeof e?{charset:e??"utf-8",contentTypeEncoder:(0,i.default)().applicationJson.encoder}:{charset:e.charset??"utf-8",contentEncoder:e.contentEncoder,contentTypeEncoder:e.contentTypeEncoder??(0,i.default)().applicationJson.encoder}}}(c||(c={})),t.WriteableStreamMessageWriter=class extends l{constructor(e,t){super(),this.writable=e,this.options=c.fromOptions(t),this.errorCount=0,this.writeSemaphore=new r.Semaphore(1),this.writable.onError((e=>this.fireError(e))),this.writable.onClose((()=>this.fireClose()))}async write(e){return this.writeSemaphore.lock((async()=>this.options.contentTypeEncoder.encode(e,this.options).then((e=>void 0!==this.options.contentEncoder?this.options.contentEncoder.encode(e):e)).then((t=>{const n=[];return n.push("Content-Length: ",t.byteLength.toString(),"\r\n"),n.push("\r\n"),this.doWrite(e,n,t)}),(e=>{throw this.fireError(e),e}))))}async doWrite(e,t,n){try{return await this.writable.write(t.join(""),"ascii"),this.writable.write(n)}catch(t){return this.handleError(t,e),Promise.reject(t)}}handleError(e,t){this.errorCount++,this.fireError(e,t,this.errorCount)}end(){this.writable.end()}}},5285:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Message=t.NotificationType9=t.NotificationType8=t.NotificationType7=t.NotificationType6=t.NotificationType5=t.NotificationType4=t.NotificationType3=t.NotificationType2=t.NotificationType1=t.NotificationType0=t.NotificationType=t.RequestType9=t.RequestType8=t.RequestType7=t.RequestType6=t.RequestType5=t.RequestType4=t.RequestType3=t.RequestType2=t.RequestType1=t.RequestType=t.RequestType0=t.AbstractMessageSignature=t.ParameterStructures=t.ResponseError=t.ErrorCodes=void 0;const i=n(8472);var o,r;!function(e){e.ParseError=-32700,e.InvalidRequest=-32600,e.MethodNotFound=-32601,e.InvalidParams=-32602,e.InternalError=-32603,e.jsonrpcReservedErrorRangeStart=-32099,e.serverErrorStart=-32099,e.MessageWriteError=-32099,e.MessageReadError=-32098,e.PendingResponseRejected=-32097,e.ConnectionInactive=-32096,e.ServerNotInitialized=-32002,e.UnknownErrorCode=-32001,e.jsonrpcReservedErrorRangeEnd=-32e3,e.serverErrorEnd=-32e3}(o||(t.ErrorCodes=o={}));class s extends Error{constructor(e,t,n){super(t),this.code=i.number(e)?e:o.UnknownErrorCode,this.data=n,Object.setPrototypeOf(this,s.prototype)}toJson(){const e={code:this.code,message:this.message};return void 0!==this.data&&(e.data=this.data),e}}t.ResponseError=s;class a{constructor(e){this.kind=e}static is(e){return e===a.auto||e===a.byName||e===a.byPosition}toString(){return this.kind}}t.ParameterStructures=a,a.auto=new a("auto"),a.byPosition=new a("byPosition"),a.byName=new a("byName");class c{constructor(e,t){this.method=e,this.numberOfParams=t}get parameterStructures(){return a.auto}}t.AbstractMessageSignature=c,t.RequestType0=class extends c{constructor(e){super(e,0)}},t.RequestType=class extends c{constructor(e,t=a.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}},t.RequestType1=class extends c{constructor(e,t=a.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}},t.RequestType2=class extends c{constructor(e){super(e,2)}},t.RequestType3=class extends c{constructor(e){super(e,3)}},t.RequestType4=class extends c{constructor(e){super(e,4)}},t.RequestType5=class extends c{constructor(e){super(e,5)}},t.RequestType6=class extends c{constructor(e){super(e,6)}},t.RequestType7=class extends c{constructor(e){super(e,7)}},t.RequestType8=class extends c{constructor(e){super(e,8)}},t.RequestType9=class extends c{constructor(e){super(e,9)}},t.NotificationType=class extends c{constructor(e,t=a.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}},t.NotificationType0=class extends c{constructor(e){super(e,0)}},t.NotificationType1=class extends c{constructor(e,t=a.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}},t.NotificationType2=class extends c{constructor(e){super(e,2)}},t.NotificationType3=class extends c{constructor(e){super(e,3)}},t.NotificationType4=class extends c{constructor(e){super(e,4)}},t.NotificationType5=class extends c{constructor(e){super(e,5)}},t.NotificationType6=class extends c{constructor(e){super(e,6)}},t.NotificationType7=class extends c{constructor(e){super(e,7)}},t.NotificationType8=class extends c{constructor(e){super(e,8)}},t.NotificationType9=class extends c{constructor(e){super(e,9)}},function(e){e.isRequest=function(e){const t=e;return t&&i.string(t.method)&&(i.string(t.id)||i.number(t.id))},e.isNotification=function(e){const t=e;return t&&i.string(t.method)&&void 0===e.id},e.isResponse=function(e){const t=e;return t&&(void 0!==t.result||!!t.error)&&(i.string(t.id)||i.number(t.id)||null===t.id)}}(r||(t.Message=r={}))},8094:(e,t)=>{"use strict";let n;function i(){if(void 0===n)throw new Error("No runtime abstraction layer installed");return n}Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.install=function(e){if(void 0===e)throw new Error("No runtime abstraction layer provided");n=e}}(i||(i={})),t.default=i},6791:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Semaphore=void 0;const i=n(8094);t.Semaphore=class{constructor(e=1){if(e<=0)throw new Error("Capacity must be greater than 0");this._capacity=e,this._active=0,this._waiting=[]}lock(e){return new Promise(((t,n)=>{this._waiting.push({thunk:e,resolve:t,reject:n}),this.runNext()}))}get active(){return this._active}runNext(){0!==this._waiting.length&&this._active!==this._capacity&&(0,i.default)().timer.setImmediate((()=>this.doRunNext()))}doRunNext(){if(0===this._waiting.length||this._active===this._capacity)return;const e=this._waiting.shift();if(this._active++,this._active>this._capacity)throw new Error("To many thunks active");try{const t=e.thunk();t instanceof Promise?t.then((t=>{this._active--,e.resolve(t),this.runNext()}),(t=>{this._active--,e.reject(t),this.runNext()})):(this._active--,e.resolve(t),this.runNext())}catch(t){this._active--,e.reject(t),this.runNext()}}}},278:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SharedArrayReceiverStrategy=t.SharedArraySenderStrategy=void 0;const i=n(7770);var o;!function(e){e.Continue=0,e.Cancelled=1}(o||(o={})),t.SharedArraySenderStrategy=class{constructor(){this.buffers=new Map}enableCancellation(e){if(null===e.id)return;const t=new SharedArrayBuffer(4);new Int32Array(t,0,1)[0]=o.Continue,this.buffers.set(e.id,t),e.$cancellationData=t}async sendCancellation(e,t){const n=this.buffers.get(t);if(void 0===n)return;const i=new Int32Array(n,0,1);Atomics.store(i,0,o.Cancelled)}cleanup(e){this.buffers.delete(e)}dispose(){this.buffers.clear()}};class r{constructor(e){this.data=new Int32Array(e,0,1)}get isCancellationRequested(){return Atomics.load(this.data,0)===o.Cancelled}get onCancellationRequested(){throw new Error("Cancellation over SharedArrayBuffer doesn't support cancellation events")}}class s{constructor(e){this.token=new r(e)}cancel(){}dispose(){}}t.SharedArrayReceiverStrategy=class{constructor(){this.kind="request"}createCancellationTokenSource(e){const t=e.$cancellationData;return void 0===t?new i.CancellationTokenSource:new s(t)}}},1694:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,o)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.createMessageConnection=t.createServerSocketTransport=t.createClientSocketTransport=t.createServerPipeTransport=t.createClientPipeTransport=t.generateRandomPipeName=t.StreamMessageWriter=t.StreamMessageReader=t.SocketMessageWriter=t.SocketMessageReader=t.PortMessageWriter=t.PortMessageReader=t.IPCMessageWriter=t.IPCMessageReader=void 0;const r=n(3590);r.default.install();const s=n(1017),a=n(2037),c=n(6113),l=n(1808),u=n(5748);o(n(5748),t);class d extends u.AbstractMessageReader{constructor(e){super(),this.process=e;let t=this.process;t.on("error",(e=>this.fireError(e))),t.on("close",(()=>this.fireClose()))}listen(e){return this.process.on("message",e),u.Disposable.create((()=>this.process.off("message",e)))}}t.IPCMessageReader=d;class f extends u.AbstractMessageWriter{constructor(e){super(),this.process=e,this.errorCount=0;const t=this.process;t.on("error",(e=>this.fireError(e))),t.on("close",(()=>this.fireClose))}write(e){try{return"function"==typeof this.process.send&&this.process.send(e,void 0,void 0,(t=>{t?(this.errorCount++,this.handleError(t,e)):this.errorCount=0})),Promise.resolve()}catch(t){return this.handleError(t,e),Promise.reject(t)}}handleError(e,t){this.errorCount++,this.fireError(e,t,this.errorCount)}end(){}}t.IPCMessageWriter=f;class p extends u.AbstractMessageReader{constructor(e){super(),this.onData=new u.Emitter,e.on("close",(()=>this.fireClose)),e.on("error",(e=>this.fireError(e))),e.on("message",(e=>{this.onData.fire(e)}))}listen(e){return this.onData.event(e)}}t.PortMessageReader=p;class h extends u.AbstractMessageWriter{constructor(e){super(),this.port=e,this.errorCount=0,e.on("close",(()=>this.fireClose())),e.on("error",(e=>this.fireError(e)))}write(e){try{return this.port.postMessage(e),Promise.resolve()}catch(t){return this.handleError(t,e),Promise.reject(t)}}handleError(e,t){this.errorCount++,this.fireError(e,t,this.errorCount)}end(){}}t.PortMessageWriter=h;class m extends u.ReadableStreamMessageReader{constructor(e,t="utf-8"){super((0,r.default)().stream.asReadableStream(e),t)}}t.SocketMessageReader=m;class g extends u.WriteableStreamMessageWriter{constructor(e,t){super((0,r.default)().stream.asWritableStream(e),t),this.socket=e}dispose(){super.dispose(),this.socket.destroy()}}t.SocketMessageWriter=g;class y extends u.ReadableStreamMessageReader{constructor(e,t){super((0,r.default)().stream.asReadableStream(e),t)}}t.StreamMessageReader=y;class _ extends u.WriteableStreamMessageWriter{constructor(e,t){super((0,r.default)().stream.asWritableStream(e),t)}}t.StreamMessageWriter=_;const b=process.env.XDG_RUNTIME_DIR,v=new Map([["linux",107],["darwin",103]]);t.generateRandomPipeName=function(){const e=(0,c.randomBytes)(21).toString("hex");if("win32"===process.platform)return`\\\\.\\pipe\\vscode-jsonrpc-${e}-sock`;let t;t=b?s.join(b,`vscode-ipc-${e}.sock`):s.join(a.tmpdir(),`vscode-${e}.sock`);const n=v.get(process.platform);return void 0!==n&&t.length>n&&(0,r.default)().console.warn(`WARNING: IPC handle "${t}" is longer than ${n} characters.`),t},t.createClientPipeTransport=function(e,t="utf-8"){let n;const i=new Promise(((e,t)=>{n=e}));return new Promise(((o,r)=>{let s=(0,l.createServer)((e=>{s.close(),n([new m(e,t),new g(e,t)])}));s.on("error",r),s.listen(e,(()=>{s.removeListener("error",r),o({onConnected:()=>i})}))}))},t.createServerPipeTransport=function(e,t="utf-8"){const n=(0,l.createConnection)(e);return[new m(n,t),new g(n,t)]},t.createClientSocketTransport=function(e,t="utf-8"){let n;const i=new Promise(((e,t)=>{n=e}));return new Promise(((o,r)=>{const s=(0,l.createServer)((e=>{s.close(),n([new m(e,t),new g(e,t)])}));s.on("error",r),s.listen(e,"127.0.0.1",(()=>{s.removeListener("error",r),o({onConnected:()=>i})}))}))},t.createServerSocketTransport=function(e,t="utf-8"){const n=(0,l.createConnection)(e,"127.0.0.1");return[new m(n,t),new g(n,t)]},t.createMessageConnection=function(e,t,n,i){n||(n=u.NullLogger);const o=function(e){const t=e;return void 0!==t.read&&void 0!==t.addListener}(e)?new y(e):e,r=function(e){const t=e;return void 0!==t.write&&void 0!==t.addListener}(t)?new _(t):t;return u.ConnectionStrategy.is(i)&&(i={connectionStrategy:i}),(0,u.createMessageConnection)(o,r,n,i)}},3590:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(3837),o=n(5748);class r extends o.AbstractMessageBuffer{constructor(e="utf-8"){super(e)}emptyBuffer(){return r.emptyBuffer}fromString(e,t){return Buffer.from(e,t)}toString(e,t){return e instanceof Buffer?e.toString(t):new i.TextDecoder(t).decode(e)}asNative(e,t){return void 0===t?e instanceof Buffer?e:Buffer.from(e):e instanceof Buffer?e.slice(0,t):Buffer.from(e,0,t)}allocNative(e){return Buffer.allocUnsafe(e)}}r.emptyBuffer=Buffer.allocUnsafe(0);class s{constructor(e){this.stream=e}onClose(e){return this.stream.on("close",e),o.Disposable.create((()=>this.stream.off("close",e)))}onError(e){return this.stream.on("error",e),o.Disposable.create((()=>this.stream.off("error",e)))}onEnd(e){return this.stream.on("end",e),o.Disposable.create((()=>this.stream.off("end",e)))}onData(e){return this.stream.on("data",e),o.Disposable.create((()=>this.stream.off("data",e)))}}class a{constructor(e){this.stream=e}onClose(e){return this.stream.on("close",e),o.Disposable.create((()=>this.stream.off("close",e)))}onError(e){return this.stream.on("error",e),o.Disposable.create((()=>this.stream.off("error",e)))}onEnd(e){return this.stream.on("end",e),o.Disposable.create((()=>this.stream.off("end",e)))}write(e,t){return new Promise(((n,i)=>{const o=e=>{null==e?n():i(e)};"string"==typeof e?this.stream.write(e,t,o):this.stream.write(e,o)}))}end(){this.stream.end()}}const c=Object.freeze({messageBuffer:Object.freeze({create:e=>new r(e)}),applicationJson:Object.freeze({encoder:Object.freeze({name:"application/json",encode:(e,t)=>{try{return Promise.resolve(Buffer.from(JSON.stringify(e,void 0,0),t.charset))}catch(e){return Promise.reject(e)}}}),decoder:Object.freeze({name:"application/json",decode:(e,t)=>{try{return e instanceof Buffer?Promise.resolve(JSON.parse(e.toString(t.charset))):Promise.resolve(JSON.parse(new i.TextDecoder(t.charset).decode(e)))}catch(e){return Promise.reject(e)}}})}),stream:Object.freeze({asReadableStream:e=>new s(e),asWritableStream:e=>new a(e)}),console,timer:Object.freeze({setTimeout(e,t,...n){const i=setTimeout(e,t,...n);return{dispose:()=>clearTimeout(i)}},setImmediate(e,...t){const n=setImmediate(e,...t);return{dispose:()=>clearImmediate(n)}},setInterval(e,t,...n){const i=setInterval(e,t,...n);return{dispose:()=>clearInterval(i)}}})});function l(){return c}!function(e){e.install=function(){o.RAL.install(c)}}(l||(l={})),t.default=l},2659:(e,t,n)=>{"use strict";e.exports=n(1694)},559:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,o)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.LSPErrorCodes=t.createProtocolConnection=void 0,o(n(1694),t),o(n(8329),t),o(n(4742),t),o(n(7304),t);var r,s=n(7558);Object.defineProperty(t,"createProtocolConnection",{enumerable:!0,get:function(){return s.createProtocolConnection}}),function(e){e.lspReservedErrorRangeStart=-32899,e.RequestFailed=-32803,e.ServerCancelled=-32802,e.ContentModified=-32801,e.RequestCancelled=-32800,e.lspReservedErrorRangeEnd=-32800}(r||(t.LSPErrorCodes=r={}))},7558:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createProtocolConnection=void 0;const i=n(1694);t.createProtocolConnection=function(e,t,n,o){return i.ConnectionStrategy.is(o)&&(o={connectionStrategy:o}),(0,i.createMessageConnection)(e,t,n,o)}},4742:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ProtocolNotificationType=t.ProtocolNotificationType0=t.ProtocolRequestType=t.ProtocolRequestType0=t.RegistrationType=t.MessageDirection=void 0;const i=n(1694);var o;!function(e){e.clientToServer="clientToServer",e.serverToClient="serverToClient",e.both="both"}(o||(t.MessageDirection=o={})),t.RegistrationType=class{constructor(e){this.method=e}};class r extends i.RequestType0{constructor(e){super(e)}}t.ProtocolRequestType0=r;class s extends i.RequestType{constructor(e){super(e,i.ParameterStructures.byName)}}t.ProtocolRequestType=s;class a extends i.NotificationType0{constructor(e){super(e)}}t.ProtocolNotificationType0=a;class c extends i.NotificationType{constructor(e){super(e,i.ParameterStructures.byName)}}t.ProtocolNotificationType=c},2565:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CallHierarchyOutgoingCallsRequest=t.CallHierarchyIncomingCallsRequest=t.CallHierarchyPrepareRequest=void 0;const i=n(4742);var o,r,s;!function(e){e.method="textDocument/prepareCallHierarchy",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolRequestType(e.method)}(o||(t.CallHierarchyPrepareRequest=o={})),function(e){e.method="callHierarchy/incomingCalls",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolRequestType(e.method)}(r||(t.CallHierarchyIncomingCallsRequest=r={})),function(e){e.method="callHierarchy/outgoingCalls",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolRequestType(e.method)}(s||(t.CallHierarchyOutgoingCallsRequest=s={}))},5509:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ColorPresentationRequest=t.DocumentColorRequest=void 0;const i=n(4742);var o,r;!function(e){e.method="textDocument/documentColor",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolRequestType(e.method)}(o||(t.DocumentColorRequest=o={})),function(e){e.method="textDocument/colorPresentation",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolRequestType(e.method)}(r||(t.ColorPresentationRequest=r={}))},7296:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ConfigurationRequest=void 0;const i=n(4742);var o;!function(e){e.method="workspace/configuration",e.messageDirection=i.MessageDirection.serverToClient,e.type=new i.ProtocolRequestType(e.method)}(o||(t.ConfigurationRequest=o={}))},9137:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DeclarationRequest=void 0;const i=n(4742);var o;!function(e){e.method="textDocument/declaration",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolRequestType(e.method)}(o||(t.DeclarationRequest=o={}))},8338:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DiagnosticRefreshRequest=t.WorkspaceDiagnosticRequest=t.DocumentDiagnosticRequest=t.DocumentDiagnosticReportKind=t.DiagnosticServerCancellationData=void 0;const i=n(1694),o=n(9348),r=n(4742);var s,a,c,l,u;!function(e){e.is=function(e){const t=e;return t&&o.boolean(t.retriggerRequest)}}(s||(t.DiagnosticServerCancellationData=s={})),function(e){e.Full="full",e.Unchanged="unchanged"}(a||(t.DocumentDiagnosticReportKind=a={})),function(e){e.method="textDocument/diagnostic",e.messageDirection=r.MessageDirection.clientToServer,e.type=new r.ProtocolRequestType(e.method),e.partialResult=new i.ProgressType}(c||(t.DocumentDiagnosticRequest=c={})),function(e){e.method="workspace/diagnostic",e.messageDirection=r.MessageDirection.clientToServer,e.type=new r.ProtocolRequestType(e.method),e.partialResult=new i.ProgressType}(l||(t.WorkspaceDiagnosticRequest=l={})),function(e){e.method="workspace/diagnostic/refresh",e.messageDirection=r.MessageDirection.serverToClient,e.type=new r.ProtocolRequestType0(e.method)}(u||(t.DiagnosticRefreshRequest=u={}))},2235:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WillDeleteFilesRequest=t.DidDeleteFilesNotification=t.DidRenameFilesNotification=t.WillRenameFilesRequest=t.DidCreateFilesNotification=t.WillCreateFilesRequest=t.FileOperationPatternKind=void 0;const i=n(4742);var o,r,s,a,c,l,u;!function(e){e.file="file",e.folder="folder"}(o||(t.FileOperationPatternKind=o={})),function(e){e.method="workspace/willCreateFiles",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolRequestType(e.method)}(r||(t.WillCreateFilesRequest=r={})),function(e){e.method="workspace/didCreateFiles",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolNotificationType(e.method)}(s||(t.DidCreateFilesNotification=s={})),function(e){e.method="workspace/willRenameFiles",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolRequestType(e.method)}(a||(t.WillRenameFilesRequest=a={})),function(e){e.method="workspace/didRenameFiles",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolNotificationType(e.method)}(c||(t.DidRenameFilesNotification=c={})),function(e){e.method="workspace/didDeleteFiles",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolNotificationType(e.method)}(l||(t.DidDeleteFilesNotification=l={})),function(e){e.method="workspace/willDeleteFiles",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolRequestType(e.method)}(u||(t.WillDeleteFilesRequest=u={}))},5171:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FoldingRangeRefreshRequest=t.FoldingRangeRequest=void 0;const i=n(4742);var o,r;!function(e){e.method="textDocument/foldingRange",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolRequestType(e.method)}(o||(t.FoldingRangeRequest=o={})),function(e){e.method="workspace/foldingRange/refresh",e.messageDirection=i.MessageDirection.serverToClient,e.type=new i.ProtocolRequestType0(e.method)}(r||(t.FoldingRangeRefreshRequest=r={}))},2441:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ImplementationRequest=void 0;const i=n(4742);var o;!function(e){e.method="textDocument/implementation",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolRequestType(e.method)}(o||(t.ImplementationRequest=o={}))},4248:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InlayHintRefreshRequest=t.InlayHintResolveRequest=t.InlayHintRequest=void 0;const i=n(4742);var o,r,s;!function(e){e.method="textDocument/inlayHint",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolRequestType(e.method)}(o||(t.InlayHintRequest=o={})),function(e){e.method="inlayHint/resolve",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolRequestType(e.method)}(r||(t.InlayHintResolveRequest=r={})),function(e){e.method="workspace/inlayHint/refresh",e.messageDirection=i.MessageDirection.serverToClient,e.type=new i.ProtocolRequestType0(e.method)}(s||(t.InlayHintRefreshRequest=s={}))},9366:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InlineCompletionRequest=void 0;const i=n(4742);var o;!function(e){e.method="textDocument/inlineCompletion",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolRequestType(e.method)}(o||(t.InlineCompletionRequest=o={}))},1557:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InlineValueRefreshRequest=t.InlineValueRequest=void 0;const i=n(4742);var o,r;!function(e){e.method="textDocument/inlineValue",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolRequestType(e.method)}(o||(t.InlineValueRequest=o={})),function(e){e.method="workspace/inlineValue/refresh",e.messageDirection=i.MessageDirection.serverToClient,e.type=new i.ProtocolRequestType0(e.method)}(r||(t.InlineValueRefreshRequest=r={}))},7304:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WorkspaceSymbolRequest=t.CodeActionResolveRequest=t.CodeActionRequest=t.DocumentSymbolRequest=t.DocumentHighlightRequest=t.ReferencesRequest=t.DefinitionRequest=t.SignatureHelpRequest=t.SignatureHelpTriggerKind=t.HoverRequest=t.CompletionResolveRequest=t.CompletionRequest=t.CompletionTriggerKind=t.PublishDiagnosticsNotification=t.WatchKind=t.RelativePattern=t.FileChangeType=t.DidChangeWatchedFilesNotification=t.WillSaveTextDocumentWaitUntilRequest=t.WillSaveTextDocumentNotification=t.TextDocumentSaveReason=t.DidSaveTextDocumentNotification=t.DidCloseTextDocumentNotification=t.DidChangeTextDocumentNotification=t.TextDocumentContentChangeEvent=t.DidOpenTextDocumentNotification=t.TextDocumentSyncKind=t.TelemetryEventNotification=t.LogMessageNotification=t.ShowMessageRequest=t.ShowMessageNotification=t.MessageType=t.DidChangeConfigurationNotification=t.ExitNotification=t.ShutdownRequest=t.InitializedNotification=t.InitializeErrorCodes=t.InitializeRequest=t.WorkDoneProgressOptions=t.TextDocumentRegistrationOptions=t.StaticRegistrationOptions=t.PositionEncodingKind=t.FailureHandlingKind=t.ResourceOperationKind=t.UnregistrationRequest=t.RegistrationRequest=t.DocumentSelector=t.NotebookCellTextDocumentFilter=t.NotebookDocumentFilter=t.TextDocumentFilter=void 0,t.MonikerRequest=t.MonikerKind=t.UniquenessLevel=t.WillDeleteFilesRequest=t.DidDeleteFilesNotification=t.WillRenameFilesRequest=t.DidRenameFilesNotification=t.WillCreateFilesRequest=t.DidCreateFilesNotification=t.FileOperationPatternKind=t.LinkedEditingRangeRequest=t.ShowDocumentRequest=t.SemanticTokensRegistrationType=t.SemanticTokensRefreshRequest=t.SemanticTokensRangeRequest=t.SemanticTokensDeltaRequest=t.SemanticTokensRequest=t.TokenFormat=t.CallHierarchyPrepareRequest=t.CallHierarchyOutgoingCallsRequest=t.CallHierarchyIncomingCallsRequest=t.WorkDoneProgressCancelNotification=t.WorkDoneProgressCreateRequest=t.WorkDoneProgress=t.SelectionRangeRequest=t.DeclarationRequest=t.FoldingRangeRefreshRequest=t.FoldingRangeRequest=t.ColorPresentationRequest=t.DocumentColorRequest=t.ConfigurationRequest=t.DidChangeWorkspaceFoldersNotification=t.WorkspaceFoldersRequest=t.TypeDefinitionRequest=t.ImplementationRequest=t.ApplyWorkspaceEditRequest=t.ExecuteCommandRequest=t.PrepareRenameRequest=t.RenameRequest=t.PrepareSupportDefaultBehavior=t.DocumentOnTypeFormattingRequest=t.DocumentRangesFormattingRequest=t.DocumentRangeFormattingRequest=t.DocumentFormattingRequest=t.DocumentLinkResolveRequest=t.DocumentLinkRequest=t.CodeLensRefreshRequest=t.CodeLensResolveRequest=t.CodeLensRequest=t.WorkspaceSymbolResolveRequest=void 0,t.InlineCompletionRequest=t.DidCloseNotebookDocumentNotification=t.DidSaveNotebookDocumentNotification=t.DidChangeNotebookDocumentNotification=t.NotebookCellArrayChange=t.DidOpenNotebookDocumentNotification=t.NotebookDocumentSyncRegistrationType=t.NotebookDocument=t.NotebookCell=t.ExecutionSummary=t.NotebookCellKind=t.DiagnosticRefreshRequest=t.WorkspaceDiagnosticRequest=t.DocumentDiagnosticRequest=t.DocumentDiagnosticReportKind=t.DiagnosticServerCancellationData=t.InlayHintRefreshRequest=t.InlayHintResolveRequest=t.InlayHintRequest=t.InlineValueRefreshRequest=t.InlineValueRequest=t.TypeHierarchySupertypesRequest=t.TypeHierarchySubtypesRequest=t.TypeHierarchyPrepareRequest=void 0;const i=n(4742),o=n(8329),r=n(9348),s=n(2441);Object.defineProperty(t,"ImplementationRequest",{enumerable:!0,get:function(){return s.ImplementationRequest}});const a=n(8685);Object.defineProperty(t,"TypeDefinitionRequest",{enumerable:!0,get:function(){return a.TypeDefinitionRequest}});const c=n(6098);Object.defineProperty(t,"WorkspaceFoldersRequest",{enumerable:!0,get:function(){return c.WorkspaceFoldersRequest}}),Object.defineProperty(t,"DidChangeWorkspaceFoldersNotification",{enumerable:!0,get:function(){return c.DidChangeWorkspaceFoldersNotification}});const l=n(7296);Object.defineProperty(t,"ConfigurationRequest",{enumerable:!0,get:function(){return l.ConfigurationRequest}});const u=n(5509);Object.defineProperty(t,"DocumentColorRequest",{enumerable:!0,get:function(){return u.DocumentColorRequest}}),Object.defineProperty(t,"ColorPresentationRequest",{enumerable:!0,get:function(){return u.ColorPresentationRequest}});const d=n(5171);Object.defineProperty(t,"FoldingRangeRequest",{enumerable:!0,get:function(){return d.FoldingRangeRequest}}),Object.defineProperty(t,"FoldingRangeRefreshRequest",{enumerable:!0,get:function(){return d.FoldingRangeRefreshRequest}});const f=n(9137);Object.defineProperty(t,"DeclarationRequest",{enumerable:!0,get:function(){return f.DeclarationRequest}});const p=n(2964);Object.defineProperty(t,"SelectionRangeRequest",{enumerable:!0,get:function(){return p.SelectionRangeRequest}});const h=n(7450);Object.defineProperty(t,"WorkDoneProgress",{enumerable:!0,get:function(){return h.WorkDoneProgress}}),Object.defineProperty(t,"WorkDoneProgressCreateRequest",{enumerable:!0,get:function(){return h.WorkDoneProgressCreateRequest}}),Object.defineProperty(t,"WorkDoneProgressCancelNotification",{enumerable:!0,get:function(){return h.WorkDoneProgressCancelNotification}});const m=n(2565);Object.defineProperty(t,"CallHierarchyIncomingCallsRequest",{enumerable:!0,get:function(){return m.CallHierarchyIncomingCallsRequest}}),Object.defineProperty(t,"CallHierarchyOutgoingCallsRequest",{enumerable:!0,get:function(){return m.CallHierarchyOutgoingCallsRequest}}),Object.defineProperty(t,"CallHierarchyPrepareRequest",{enumerable:!0,get:function(){return m.CallHierarchyPrepareRequest}});const g=n(5402);Object.defineProperty(t,"TokenFormat",{enumerable:!0,get:function(){return g.TokenFormat}}),Object.defineProperty(t,"SemanticTokensRequest",{enumerable:!0,get:function(){return g.SemanticTokensRequest}}),Object.defineProperty(t,"SemanticTokensDeltaRequest",{enumerable:!0,get:function(){return g.SemanticTokensDeltaRequest}}),Object.defineProperty(t,"SemanticTokensRangeRequest",{enumerable:!0,get:function(){return g.SemanticTokensRangeRequest}}),Object.defineProperty(t,"SemanticTokensRefreshRequest",{enumerable:!0,get:function(){return g.SemanticTokensRefreshRequest}}),Object.defineProperty(t,"SemanticTokensRegistrationType",{enumerable:!0,get:function(){return g.SemanticTokensRegistrationType}});const y=n(903);Object.defineProperty(t,"ShowDocumentRequest",{enumerable:!0,get:function(){return y.ShowDocumentRequest}});const _=n(7323);Object.defineProperty(t,"LinkedEditingRangeRequest",{enumerable:!0,get:function(){return _.LinkedEditingRangeRequest}});const b=n(2235);Object.defineProperty(t,"FileOperationPatternKind",{enumerable:!0,get:function(){return b.FileOperationPatternKind}}),Object.defineProperty(t,"DidCreateFilesNotification",{enumerable:!0,get:function(){return b.DidCreateFilesNotification}}),Object.defineProperty(t,"WillCreateFilesRequest",{enumerable:!0,get:function(){return b.WillCreateFilesRequest}}),Object.defineProperty(t,"DidRenameFilesNotification",{enumerable:!0,get:function(){return b.DidRenameFilesNotification}}),Object.defineProperty(t,"WillRenameFilesRequest",{enumerable:!0,get:function(){return b.WillRenameFilesRequest}}),Object.defineProperty(t,"DidDeleteFilesNotification",{enumerable:!0,get:function(){return b.DidDeleteFilesNotification}}),Object.defineProperty(t,"WillDeleteFilesRequest",{enumerable:!0,get:function(){return b.WillDeleteFilesRequest}});const v=n(9219);Object.defineProperty(t,"UniquenessLevel",{enumerable:!0,get:function(){return v.UniquenessLevel}}),Object.defineProperty(t,"MonikerKind",{enumerable:!0,get:function(){return v.MonikerKind}}),Object.defineProperty(t,"MonikerRequest",{enumerable:!0,get:function(){return v.MonikerRequest}});const k=n(9970);Object.defineProperty(t,"TypeHierarchyPrepareRequest",{enumerable:!0,get:function(){return k.TypeHierarchyPrepareRequest}}),Object.defineProperty(t,"TypeHierarchySubtypesRequest",{enumerable:!0,get:function(){return k.TypeHierarchySubtypesRequest}}),Object.defineProperty(t,"TypeHierarchySupertypesRequest",{enumerable:!0,get:function(){return k.TypeHierarchySupertypesRequest}});const T=n(1557);Object.defineProperty(t,"InlineValueRequest",{enumerable:!0,get:function(){return T.InlineValueRequest}}),Object.defineProperty(t,"InlineValueRefreshRequest",{enumerable:!0,get:function(){return T.InlineValueRefreshRequest}});const R=n(4248);Object.defineProperty(t,"InlayHintRequest",{enumerable:!0,get:function(){return R.InlayHintRequest}}),Object.defineProperty(t,"InlayHintResolveRequest",{enumerable:!0,get:function(){return R.InlayHintResolveRequest}}),Object.defineProperty(t,"InlayHintRefreshRequest",{enumerable:!0,get:function(){return R.InlayHintRefreshRequest}});const S=n(8338);Object.defineProperty(t,"DiagnosticServerCancellationData",{enumerable:!0,get:function(){return S.DiagnosticServerCancellationData}}),Object.defineProperty(t,"DocumentDiagnosticReportKind",{enumerable:!0,get:function(){return S.DocumentDiagnosticReportKind}}),Object.defineProperty(t,"DocumentDiagnosticRequest",{enumerable:!0,get:function(){return S.DocumentDiagnosticRequest}}),Object.defineProperty(t,"WorkspaceDiagnosticRequest",{enumerable:!0,get:function(){return S.WorkspaceDiagnosticRequest}}),Object.defineProperty(t,"DiagnosticRefreshRequest",{enumerable:!0,get:function(){return S.DiagnosticRefreshRequest}});const w=n(5626);Object.defineProperty(t,"NotebookCellKind",{enumerable:!0,get:function(){return w.NotebookCellKind}}),Object.defineProperty(t,"ExecutionSummary",{enumerable:!0,get:function(){return w.ExecutionSummary}}),Object.defineProperty(t,"NotebookCell",{enumerable:!0,get:function(){return w.NotebookCell}}),Object.defineProperty(t,"NotebookDocument",{enumerable:!0,get:function(){return w.NotebookDocument}}),Object.defineProperty(t,"NotebookDocumentSyncRegistrationType",{enumerable:!0,get:function(){return w.NotebookDocumentSyncRegistrationType}}),Object.defineProperty(t,"DidOpenNotebookDocumentNotification",{enumerable:!0,get:function(){return w.DidOpenNotebookDocumentNotification}}),Object.defineProperty(t,"NotebookCellArrayChange",{enumerable:!0,get:function(){return w.NotebookCellArrayChange}}),Object.defineProperty(t,"DidChangeNotebookDocumentNotification",{enumerable:!0,get:function(){return w.DidChangeNotebookDocumentNotification}}),Object.defineProperty(t,"DidSaveNotebookDocumentNotification",{enumerable:!0,get:function(){return w.DidSaveNotebookDocumentNotification}}),Object.defineProperty(t,"DidCloseNotebookDocumentNotification",{enumerable:!0,get:function(){return w.DidCloseNotebookDocumentNotification}});const C=n(9366);var D,x,E,O,K,P,A,N,M,I,L,q,F,j,W,$,U,V,B,H,G,z,Y,X,J,Q,Z,ee,te,ne,ie,oe,re,se,ae,ce,le,ue,de,fe,pe,he,me,ge,ye,_e,be,ve,ke,Te,Re,Se,we,Ce,De,xe,Ee,Oe,Ke,Pe,Ae,Ne,Me,Ie,Le;Object.defineProperty(t,"InlineCompletionRequest",{enumerable:!0,get:function(){return C.InlineCompletionRequest}}),function(e){e.is=function(e){const t=e;return r.string(t)||r.string(t.language)||r.string(t.scheme)||r.string(t.pattern)}}(D||(t.TextDocumentFilter=D={})),function(e){e.is=function(e){const t=e;return r.objectLiteral(t)&&(r.string(t.notebookType)||r.string(t.scheme)||r.string(t.pattern))}}(x||(t.NotebookDocumentFilter=x={})),function(e){e.is=function(e){const t=e;return r.objectLiteral(t)&&(r.string(t.notebook)||x.is(t.notebook))&&(void 0===t.language||r.string(t.language))}}(E||(t.NotebookCellTextDocumentFilter=E={})),function(e){e.is=function(e){if(!Array.isArray(e))return!1;for(let t of e)if(!r.string(t)&&!D.is(t)&&!E.is(t))return!1;return!0}}(O||(t.DocumentSelector=O={})),function(e){e.method="client/registerCapability",e.messageDirection=i.MessageDirection.serverToClient,e.type=new i.ProtocolRequestType(e.method)}(K||(t.RegistrationRequest=K={})),function(e){e.method="client/unregisterCapability",e.messageDirection=i.MessageDirection.serverToClient,e.type=new i.ProtocolRequestType(e.method)}(P||(t.UnregistrationRequest=P={})),function(e){e.Create="create",e.Rename="rename",e.Delete="delete"}(A||(t.ResourceOperationKind=A={})),function(e){e.Abort="abort",e.Transactional="transactional",e.TextOnlyTransactional="textOnlyTransactional",e.Undo="undo"}(N||(t.FailureHandlingKind=N={})),function(e){e.UTF8="utf-8",e.UTF16="utf-16",e.UTF32="utf-32"}(M||(t.PositionEncodingKind=M={})),function(e){e.hasId=function(e){const t=e;return t&&r.string(t.id)&&t.id.length>0}}(I||(t.StaticRegistrationOptions=I={})),function(e){e.is=function(e){const t=e;return t&&(null===t.documentSelector||O.is(t.documentSelector))}}(L||(t.TextDocumentRegistrationOptions=L={})),function(e){e.is=function(e){const t=e;return r.objectLiteral(t)&&(void 0===t.workDoneProgress||r.boolean(t.workDoneProgress))},e.hasWorkDoneProgress=function(e){const t=e;return t&&r.boolean(t.workDoneProgress)}}(q||(t.WorkDoneProgressOptions=q={})),function(e){e.method="initialize",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolRequestType(e.method)}(F||(t.InitializeRequest=F={})),function(e){e.unknownProtocolVersion=1}(j||(t.InitializeErrorCodes=j={})),function(e){e.method="initialized",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolNotificationType(e.method)}(W||(t.InitializedNotification=W={})),function(e){e.method="shutdown",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolRequestType0(e.method)}($||(t.ShutdownRequest=$={})),function(e){e.method="exit",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolNotificationType0(e.method)}(U||(t.ExitNotification=U={})),function(e){e.method="workspace/didChangeConfiguration",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolNotificationType(e.method)}(V||(t.DidChangeConfigurationNotification=V={})),function(e){e.Error=1,e.Warning=2,e.Info=3,e.Log=4,e.Debug=5}(B||(t.MessageType=B={})),function(e){e.method="window/showMessage",e.messageDirection=i.MessageDirection.serverToClient,e.type=new i.ProtocolNotificationType(e.method)}(H||(t.ShowMessageNotification=H={})),function(e){e.method="window/showMessageRequest",e.messageDirection=i.MessageDirection.serverToClient,e.type=new i.ProtocolRequestType(e.method)}(G||(t.ShowMessageRequest=G={})),function(e){e.method="window/logMessage",e.messageDirection=i.MessageDirection.serverToClient,e.type=new i.ProtocolNotificationType(e.method)}(z||(t.LogMessageNotification=z={})),function(e){e.method="telemetry/event",e.messageDirection=i.MessageDirection.serverToClient,e.type=new i.ProtocolNotificationType(e.method)}(Y||(t.TelemetryEventNotification=Y={})),function(e){e.None=0,e.Full=1,e.Incremental=2}(X||(t.TextDocumentSyncKind=X={})),function(e){e.method="textDocument/didOpen",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolNotificationType(e.method)}(J||(t.DidOpenTextDocumentNotification=J={})),function(e){e.isIncremental=function(e){let t=e;return null!=t&&"string"==typeof t.text&&void 0!==t.range&&(void 0===t.rangeLength||"number"==typeof t.rangeLength)},e.isFull=function(e){let t=e;return null!=t&&"string"==typeof t.text&&void 0===t.range&&void 0===t.rangeLength}}(Q||(t.TextDocumentContentChangeEvent=Q={})),function(e){e.method="textDocument/didChange",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolNotificationType(e.method)}(Z||(t.DidChangeTextDocumentNotification=Z={})),function(e){e.method="textDocument/didClose",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolNotificationType(e.method)}(ee||(t.DidCloseTextDocumentNotification=ee={})),function(e){e.method="textDocument/didSave",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolNotificationType(e.method)}(te||(t.DidSaveTextDocumentNotification=te={})),function(e){e.Manual=1,e.AfterDelay=2,e.FocusOut=3}(ne||(t.TextDocumentSaveReason=ne={})),function(e){e.method="textDocument/willSave",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolNotificationType(e.method)}(ie||(t.WillSaveTextDocumentNotification=ie={})),function(e){e.method="textDocument/willSaveWaitUntil",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolRequestType(e.method)}(oe||(t.WillSaveTextDocumentWaitUntilRequest=oe={})),function(e){e.method="workspace/didChangeWatchedFiles",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolNotificationType(e.method)}(re||(t.DidChangeWatchedFilesNotification=re={})),function(e){e.Created=1,e.Changed=2,e.Deleted=3}(se||(t.FileChangeType=se={})),function(e){e.is=function(e){const t=e;return r.objectLiteral(t)&&(o.URI.is(t.baseUri)||o.WorkspaceFolder.is(t.baseUri))&&r.string(t.pattern)}}(ae||(t.RelativePattern=ae={})),function(e){e.Create=1,e.Change=2,e.Delete=4}(ce||(t.WatchKind=ce={})),function(e){e.method="textDocument/publishDiagnostics",e.messageDirection=i.MessageDirection.serverToClient,e.type=new i.ProtocolNotificationType(e.method)}(le||(t.PublishDiagnosticsNotification=le={})),function(e){e.Invoked=1,e.TriggerCharacter=2,e.TriggerForIncompleteCompletions=3}(ue||(t.CompletionTriggerKind=ue={})),function(e){e.method="textDocument/completion",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolRequestType(e.method)}(de||(t.CompletionRequest=de={})),function(e){e.method="completionItem/resolve",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolRequestType(e.method)}(fe||(t.CompletionResolveRequest=fe={})),function(e){e.method="textDocument/hover",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolRequestType(e.method)}(pe||(t.HoverRequest=pe={})),function(e){e.Invoked=1,e.TriggerCharacter=2,e.ContentChange=3}(he||(t.SignatureHelpTriggerKind=he={})),function(e){e.method="textDocument/signatureHelp",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolRequestType(e.method)}(me||(t.SignatureHelpRequest=me={})),function(e){e.method="textDocument/definition",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolRequestType(e.method)}(ge||(t.DefinitionRequest=ge={})),function(e){e.method="textDocument/references",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolRequestType(e.method)}(ye||(t.ReferencesRequest=ye={})),function(e){e.method="textDocument/documentHighlight",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolRequestType(e.method)}(_e||(t.DocumentHighlightRequest=_e={})),function(e){e.method="textDocument/documentSymbol",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolRequestType(e.method)}(be||(t.DocumentSymbolRequest=be={})),function(e){e.method="textDocument/codeAction",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolRequestType(e.method)}(ve||(t.CodeActionRequest=ve={})),function(e){e.method="codeAction/resolve",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolRequestType(e.method)}(ke||(t.CodeActionResolveRequest=ke={})),function(e){e.method="workspace/symbol",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolRequestType(e.method)}(Te||(t.WorkspaceSymbolRequest=Te={})),function(e){e.method="workspaceSymbol/resolve",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolRequestType(e.method)}(Re||(t.WorkspaceSymbolResolveRequest=Re={})),function(e){e.method="textDocument/codeLens",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolRequestType(e.method)}(Se||(t.CodeLensRequest=Se={})),function(e){e.method="codeLens/resolve",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolRequestType(e.method)}(we||(t.CodeLensResolveRequest=we={})),function(e){e.method="workspace/codeLens/refresh",e.messageDirection=i.MessageDirection.serverToClient,e.type=new i.ProtocolRequestType0(e.method)}(Ce||(t.CodeLensRefreshRequest=Ce={})),function(e){e.method="textDocument/documentLink",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolRequestType(e.method)}(De||(t.DocumentLinkRequest=De={})),function(e){e.method="documentLink/resolve",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolRequestType(e.method)}(xe||(t.DocumentLinkResolveRequest=xe={})),function(e){e.method="textDocument/formatting",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolRequestType(e.method)}(Ee||(t.DocumentFormattingRequest=Ee={})),function(e){e.method="textDocument/rangeFormatting",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolRequestType(e.method)}(Oe||(t.DocumentRangeFormattingRequest=Oe={})),function(e){e.method="textDocument/rangesFormatting",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolRequestType(e.method)}(Ke||(t.DocumentRangesFormattingRequest=Ke={})),function(e){e.method="textDocument/onTypeFormatting",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolRequestType(e.method)}(Pe||(t.DocumentOnTypeFormattingRequest=Pe={})),function(e){e.Identifier=1}(Ae||(t.PrepareSupportDefaultBehavior=Ae={})),function(e){e.method="textDocument/rename",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolRequestType(e.method)}(Ne||(t.RenameRequest=Ne={})),function(e){e.method="textDocument/prepareRename",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolRequestType(e.method)}(Me||(t.PrepareRenameRequest=Me={})),function(e){e.method="workspace/executeCommand",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolRequestType(e.method)}(Ie||(t.ExecuteCommandRequest=Ie={})),function(e){e.method="workspace/applyEdit",e.messageDirection=i.MessageDirection.serverToClient,e.type=new i.ProtocolRequestType("workspace/applyEdit")}(Le||(t.ApplyWorkspaceEditRequest=Le={}))},7323:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LinkedEditingRangeRequest=void 0;const i=n(4742);var o;!function(e){e.method="textDocument/linkedEditingRange",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolRequestType(e.method)}(o||(t.LinkedEditingRangeRequest=o={}))},9219:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MonikerRequest=t.MonikerKind=t.UniquenessLevel=void 0;const i=n(4742);var o,r,s;!function(e){e.document="document",e.project="project",e.group="group",e.scheme="scheme",e.global="global"}(o||(t.UniquenessLevel=o={})),function(e){e.$import="import",e.$export="export",e.local="local"}(r||(t.MonikerKind=r={})),function(e){e.method="textDocument/moniker",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolRequestType(e.method)}(s||(t.MonikerRequest=s={}))},5626:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DidCloseNotebookDocumentNotification=t.DidSaveNotebookDocumentNotification=t.DidChangeNotebookDocumentNotification=t.NotebookCellArrayChange=t.DidOpenNotebookDocumentNotification=t.NotebookDocumentSyncRegistrationType=t.NotebookDocument=t.NotebookCell=t.ExecutionSummary=t.NotebookCellKind=void 0;const i=n(8329),o=n(9348),r=n(4742);var s,a,c,l,u,d,f,p,h,m;!function(e){e.Markup=1,e.Code=2,e.is=function(e){return 1===e||2===e}}(s||(t.NotebookCellKind=s={})),function(e){e.create=function(e,t){const n={executionOrder:e};return!0!==t&&!1!==t||(n.success=t),n},e.is=function(e){const t=e;return o.objectLiteral(t)&&i.uinteger.is(t.executionOrder)&&(void 0===t.success||o.boolean(t.success))},e.equals=function(e,t){return e===t||null!=e&&null!=t&&e.executionOrder===t.executionOrder&&e.success===t.success}}(a||(t.ExecutionSummary=a={})),function(e){function t(e,n){if(e===n)return!0;if(null==e||null==n)return!1;if(typeof e!=typeof n)return!1;if("object"!=typeof e)return!1;const i=Array.isArray(e),r=Array.isArray(n);if(i!==r)return!1;if(i&&r){if(e.length!==n.length)return!1;for(let i=0;i<e.length;i++)if(!t(e[i],n[i]))return!1}if(o.objectLiteral(e)&&o.objectLiteral(n)){const i=Object.keys(e),o=Object.keys(n);if(i.length!==o.length)return!1;if(i.sort(),o.sort(),!t(i,o))return!1;for(let o=0;o<i.length;o++){const r=i[o];if(!t(e[r],n[r]))return!1}}return!0}e.create=function(e,t){return{kind:e,document:t}},e.is=function(e){const t=e;return o.objectLiteral(t)&&s.is(t.kind)&&i.DocumentUri.is(t.document)&&(void 0===t.metadata||o.objectLiteral(t.metadata))},e.diff=function(e,n){const i=new Set;return e.document!==n.document&&i.add("document"),e.kind!==n.kind&&i.add("kind"),e.executionSummary!==n.executionSummary&&i.add("executionSummary"),void 0===e.metadata&&void 0===n.metadata||t(e.metadata,n.metadata)||i.add("metadata"),void 0===e.executionSummary&&void 0===n.executionSummary||a.equals(e.executionSummary,n.executionSummary)||i.add("executionSummary"),i}}(c||(t.NotebookCell=c={})),function(e){e.create=function(e,t,n,i){return{uri:e,notebookType:t,version:n,cells:i}},e.is=function(e){const t=e;return o.objectLiteral(t)&&o.string(t.uri)&&i.integer.is(t.version)&&o.typedArray(t.cells,c.is)}}(l||(t.NotebookDocument=l={})),function(e){e.method="notebookDocument/sync",e.messageDirection=r.MessageDirection.clientToServer,e.type=new r.RegistrationType(e.method)}(u||(t.NotebookDocumentSyncRegistrationType=u={})),function(e){e.method="notebookDocument/didOpen",e.messageDirection=r.MessageDirection.clientToServer,e.type=new r.ProtocolNotificationType(e.method),e.registrationMethod=u.method}(d||(t.DidOpenNotebookDocumentNotification=d={})),function(e){e.is=function(e){const t=e;return o.objectLiteral(t)&&i.uinteger.is(t.start)&&i.uinteger.is(t.deleteCount)&&(void 0===t.cells||o.typedArray(t.cells,c.is))},e.create=function(e,t,n){const i={start:e,deleteCount:t};return void 0!==n&&(i.cells=n),i}}(f||(t.NotebookCellArrayChange=f={})),function(e){e.method="notebookDocument/didChange",e.messageDirection=r.MessageDirection.clientToServer,e.type=new r.ProtocolNotificationType(e.method),e.registrationMethod=u.method}(p||(t.DidChangeNotebookDocumentNotification=p={})),function(e){e.method="notebookDocument/didSave",e.messageDirection=r.MessageDirection.clientToServer,e.type=new r.ProtocolNotificationType(e.method),e.registrationMethod=u.method}(h||(t.DidSaveNotebookDocumentNotification=h={})),function(e){e.method="notebookDocument/didClose",e.messageDirection=r.MessageDirection.clientToServer,e.type=new r.ProtocolNotificationType(e.method),e.registrationMethod=u.method}(m||(t.DidCloseNotebookDocumentNotification=m={}))},7450:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WorkDoneProgressCancelNotification=t.WorkDoneProgressCreateRequest=t.WorkDoneProgress=void 0;const i=n(1694),o=n(4742);var r,s,a;!function(e){e.type=new i.ProgressType,e.is=function(t){return t===e.type}}(r||(t.WorkDoneProgress=r={})),function(e){e.method="window/workDoneProgress/create",e.messageDirection=o.MessageDirection.serverToClient,e.type=new o.ProtocolRequestType(e.method)}(s||(t.WorkDoneProgressCreateRequest=s={})),function(e){e.method="window/workDoneProgress/cancel",e.messageDirection=o.MessageDirection.clientToServer,e.type=new o.ProtocolNotificationType(e.method)}(a||(t.WorkDoneProgressCancelNotification=a={}))},2964:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SelectionRangeRequest=void 0;const i=n(4742);var o;!function(e){e.method="textDocument/selectionRange",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolRequestType(e.method)}(o||(t.SelectionRangeRequest=o={}))},5402:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SemanticTokensRefreshRequest=t.SemanticTokensRangeRequest=t.SemanticTokensDeltaRequest=t.SemanticTokensRequest=t.SemanticTokensRegistrationType=t.TokenFormat=void 0;const i=n(4742);var o,r,s,a,c,l;!function(e){e.Relative="relative"}(o||(t.TokenFormat=o={})),function(e){e.method="textDocument/semanticTokens",e.type=new i.RegistrationType(e.method)}(r||(t.SemanticTokensRegistrationType=r={})),function(e){e.method="textDocument/semanticTokens/full",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolRequestType(e.method),e.registrationMethod=r.method}(s||(t.SemanticTokensRequest=s={})),function(e){e.method="textDocument/semanticTokens/full/delta",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolRequestType(e.method),e.registrationMethod=r.method}(a||(t.SemanticTokensDeltaRequest=a={})),function(e){e.method="textDocument/semanticTokens/range",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolRequestType(e.method),e.registrationMethod=r.method}(c||(t.SemanticTokensRangeRequest=c={})),function(e){e.method="workspace/semanticTokens/refresh",e.messageDirection=i.MessageDirection.serverToClient,e.type=new i.ProtocolRequestType0(e.method)}(l||(t.SemanticTokensRefreshRequest=l={}))},903:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ShowDocumentRequest=void 0;const i=n(4742);var o;!function(e){e.method="window/showDocument",e.messageDirection=i.MessageDirection.serverToClient,e.type=new i.ProtocolRequestType(e.method)}(o||(t.ShowDocumentRequest=o={}))},8685:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TypeDefinitionRequest=void 0;const i=n(4742);var o;!function(e){e.method="textDocument/typeDefinition",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolRequestType(e.method)}(o||(t.TypeDefinitionRequest=o={}))},9970:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TypeHierarchySubtypesRequest=t.TypeHierarchySupertypesRequest=t.TypeHierarchyPrepareRequest=void 0;const i=n(4742);var o,r,s;!function(e){e.method="textDocument/prepareTypeHierarchy",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolRequestType(e.method)}(o||(t.TypeHierarchyPrepareRequest=o={})),function(e){e.method="typeHierarchy/supertypes",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolRequestType(e.method)}(r||(t.TypeHierarchySupertypesRequest=r={})),function(e){e.method="typeHierarchy/subtypes",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolRequestType(e.method)}(s||(t.TypeHierarchySubtypesRequest=s={}))},6098:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DidChangeWorkspaceFoldersNotification=t.WorkspaceFoldersRequest=void 0;const i=n(4742);var o,r;!function(e){e.method="workspace/workspaceFolders",e.messageDirection=i.MessageDirection.serverToClient,e.type=new i.ProtocolRequestType0(e.method)}(o||(t.WorkspaceFoldersRequest=o={})),function(e){e.method="workspace/didChangeWorkspaceFolders",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolNotificationType(e.method)}(r||(t.DidChangeWorkspaceFoldersNotification=r={}))},9348:(e,t)=>{"use strict";function n(e){return"string"==typeof e||e instanceof String}function i(e){return Array.isArray(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.objectLiteral=t.typedArray=t.stringArray=t.array=t.func=t.error=t.number=t.string=t.boolean=void 0,t.boolean=function(e){return!0===e||!1===e},t.string=n,t.number=function(e){return"number"==typeof e||e instanceof Number},t.error=function(e){return e instanceof Error},t.func=function(e){return"function"==typeof e},t.array=i,t.stringArray=function(e){return i(e)&&e.every((e=>n(e)))},t.typedArray=function(e,t){return Array.isArray(e)&&e.every(t)},t.objectLiteral=function(e){return null!==e&&"object"==typeof e}},7745:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,o)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.createProtocolConnection=void 0;const r=n(2659);o(n(2659),t),o(n(559),t),t.createProtocolConnection=function(e,t,n,i){return(0,r.createMessageConnection)(e,t,n,i)}},4057:(e,t,n)=>{"use strict";e.exports=n(7745)},8952:function(e,t,n){var i,o,r,s=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var i,o=0,r=t.length;o<r;o++)!i&&o in t||(i||(i=Array.prototype.slice.call(t,0,o)),i[o]=t[o]);return e.concat(i||Array.prototype.slice.call(t))};!function(s){if("object"==typeof e.exports){var a=s(n(8602),t);void 0!==a&&(e.exports=a)}else o=[n,t],void 0===(r="function"==typeof(i=s)?i.apply(t,o):i)||(e.exports=r)}((function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TextDocument=void 0;var n,i=function(){function e(e,t,n,i){this._uri=e,this._languageId=t,this._version=n,this._content=i,this._lineOffsets=void 0}return Object.defineProperty(e.prototype,"uri",{get:function(){return this._uri},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"languageId",{get:function(){return this._languageId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"version",{get:function(){return this._version},enumerable:!1,configurable:!0}),e.prototype.getText=function(e){if(e){var t=this.offsetAt(e.start),n=this.offsetAt(e.end);return this._content.substring(t,n)}return this._content},e.prototype.update=function(t,n){for(var i=0,o=t;i<o.length;i++){var c=o[i];if(e.isIncremental(c)){var l=a(c.range),u=this.offsetAt(l.start),d=this.offsetAt(l.end);this._content=this._content.substring(0,u)+c.text+this._content.substring(d,this._content.length);var f=Math.max(l.start.line,0),p=Math.max(l.end.line,0),h=this._lineOffsets,m=r(c.text,!1,u);if(p-f===m.length)for(var g=0,y=m.length;g<y;g++)h[g+f+1]=m[g];else m.length<1e4?h.splice.apply(h,s([f+1,p-f],m,!1)):this._lineOffsets=h=h.slice(0,f+1).concat(m,h.slice(p+1));var _=c.text.length-(d-u);if(0!==_)for(g=f+1+m.length,y=h.length;g<y;g++)h[g]=h[g]+_}else{if(!e.isFull(c))throw new Error("Unknown change event received");this._content=c.text,this._lineOffsets=void 0}}this._version=n},e.prototype.getLineOffsets=function(){return void 0===this._lineOffsets&&(this._lineOffsets=r(this._content,!0)),this._lineOffsets},e.prototype.positionAt=function(e){e=Math.max(Math.min(e,this._content.length),0);var t=this.getLineOffsets(),n=0,i=t.length;if(0===i)return{line:0,character:e};for(;n<i;){var o=Math.floor((n+i)/2);t[o]>e?i=o:n=o+1}var r=n-1;return{line:r,character:e-t[r]}},e.prototype.offsetAt=function(e){var t=this.getLineOffsets();if(e.line>=t.length)return this._content.length;if(e.line<0)return 0;var n=t[e.line],i=e.line+1<t.length?t[e.line+1]:this._content.length;return Math.max(Math.min(n+e.character,i),n)},Object.defineProperty(e.prototype,"lineCount",{get:function(){return this.getLineOffsets().length},enumerable:!1,configurable:!0}),e.isIncremental=function(e){var t=e;return null!=t&&"string"==typeof t.text&&void 0!==t.range&&(void 0===t.rangeLength||"number"==typeof t.rangeLength)},e.isFull=function(e){var t=e;return null!=t&&"string"==typeof t.text&&void 0===t.range&&void 0===t.rangeLength},e}();function o(e,t){if(e.length<=1)return e;var n=e.length/2|0,i=e.slice(0,n),r=e.slice(n);o(i,t),o(r,t);for(var s=0,a=0,c=0;s<i.length&&a<r.length;){var l=t(i[s],r[a]);e[c++]=l<=0?i[s++]:r[a++]}for(;s<i.length;)e[c++]=i[s++];for(;a<r.length;)e[c++]=r[a++];return e}function r(e,t,n){void 0===n&&(n=0);for(var i=t?[n]:[],o=0;o<e.length;o++){var r=e.charCodeAt(o);13!==r&&10!==r||(13===r&&o+1<e.length&&10===e.charCodeAt(o+1)&&o++,i.push(n+o+1))}return i}function a(e){var t=e.start,n=e.end;return t.line>n.line||t.line===n.line&&t.character>n.character?{start:n,end:t}:e}function c(e){var t=a(e.range);return t!==e.range?{newText:e.newText,range:t}:e}!function(e){e.create=function(e,t,n,o){return new i(e,t,n,o)},e.update=function(e,t,n){if(e instanceof i)return e.update(t,n),e;throw new Error("TextDocument.update: document must be created by TextDocument.create")},e.applyEdits=function(e,t){for(var n=e.getText(),i=0,r=[],s=0,a=o(t.map(c),(function(e,t){var n=e.range.start.line-t.range.start.line;return 0===n?e.range.start.character-t.range.start.character:n}));s<a.length;s++){var l=a[s],u=e.offsetAt(l.range.start);if(u<i)throw new Error("Overlapping edit");u>i&&r.push(n.substring(i,u)),l.newText.length&&r.push(l.newText),i=e.offsetAt(l.range.end)}return r.push(n.substr(i)),r.join("")}}(n||(t.TextDocument=n={}))}))},8602:e=>{function t(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=8602,e.exports=t},8329:(e,t,n)=>{var i,o,r;!function(s){if("object"==typeof e.exports){var a=s(n(3459),t);void 0!==a&&(e.exports=a)}else o=[n,t],void 0===(r="function"==typeof(i=s)?i.apply(t,o):i)||(e.exports=r)}((function(e,t){"use strict";var n,i,o,r,s,a,c,l,u,d,f,p,h,m,g,y,_,b,v,k,T,R,S,w,C,D,x,E;Object.defineProperty(t,"__esModule",{value:!0}),t.TextDocument=t.EOL=t.WorkspaceFolder=t.InlineCompletionContext=t.SelectedCompletionInfo=t.InlineCompletionTriggerKind=t.InlineCompletionList=t.InlineCompletionItem=t.StringValue=t.InlayHint=t.InlayHintLabelPart=t.InlayHintKind=t.InlineValueContext=t.InlineValueEvaluatableExpression=t.InlineValueVariableLookup=t.InlineValueText=t.SemanticTokens=t.SemanticTokenModifiers=t.SemanticTokenTypes=t.SelectionRange=t.DocumentLink=t.FormattingOptions=t.CodeLens=t.CodeAction=t.CodeActionContext=t.CodeActionTriggerKind=t.CodeActionKind=t.DocumentSymbol=t.WorkspaceSymbol=t.SymbolInformation=t.SymbolTag=t.SymbolKind=t.DocumentHighlight=t.DocumentHighlightKind=t.SignatureInformation=t.ParameterInformation=t.Hover=t.MarkedString=t.CompletionList=t.CompletionItem=t.CompletionItemLabelDetails=t.InsertTextMode=t.InsertReplaceEdit=t.CompletionItemTag=t.InsertTextFormat=t.CompletionItemKind=t.MarkupContent=t.MarkupKind=t.TextDocumentItem=t.OptionalVersionedTextDocumentIdentifier=t.VersionedTextDocumentIdentifier=t.TextDocumentIdentifier=t.WorkspaceChange=t.WorkspaceEdit=t.DeleteFile=t.RenameFile=t.CreateFile=t.TextDocumentEdit=t.AnnotatedTextEdit=t.ChangeAnnotationIdentifier=t.ChangeAnnotation=t.TextEdit=t.Command=t.Diagnostic=t.CodeDescription=t.DiagnosticTag=t.DiagnosticSeverity=t.DiagnosticRelatedInformation=t.FoldingRange=t.FoldingRangeKind=t.ColorPresentation=t.ColorInformation=t.Color=t.LocationLink=t.Location=t.Range=t.Position=t.uinteger=t.integer=t.URI=t.DocumentUri=void 0,function(e){e.is=function(e){return"string"==typeof e}}(n||(t.DocumentUri=n={})),function(e){e.is=function(e){return"string"==typeof e}}(i||(t.URI=i={})),function(e){e.MIN_VALUE=-2147483648,e.MAX_VALUE=2147483647,e.is=function(t){return"number"==typeof t&&e.MIN_VALUE<=t&&t<=e.MAX_VALUE}}(o||(t.integer=o={})),function(e){e.MIN_VALUE=0,e.MAX_VALUE=2147483647,e.is=function(t){return"number"==typeof t&&e.MIN_VALUE<=t&&t<=e.MAX_VALUE}}(r||(t.uinteger=r={})),function(e){e.create=function(e,t){return e===Number.MAX_VALUE&&(e=r.MAX_VALUE),t===Number.MAX_VALUE&&(t=r.MAX_VALUE),{line:e,character:t}},e.is=function(e){var t=e;return Oe.objectLiteral(t)&&Oe.uinteger(t.line)&&Oe.uinteger(t.character)}}(s||(t.Position=s={})),function(e){e.create=function(e,t,n,i){if(Oe.uinteger(e)&&Oe.uinteger(t)&&Oe.uinteger(n)&&Oe.uinteger(i))return{start:s.create(e,t),end:s.create(n,i)};if(s.is(e)&&s.is(t))return{start:e,end:t};throw new Error("Range#create called with invalid arguments[".concat(e,", ").concat(t,", ").concat(n,", ").concat(i,"]"))},e.is=function(e){var t=e;return Oe.objectLiteral(t)&&s.is(t.start)&&s.is(t.end)}}(a||(t.Range=a={})),function(e){e.create=function(e,t){return{uri:e,range:t}},e.is=function(e){var t=e;return Oe.objectLiteral(t)&&a.is(t.range)&&(Oe.string(t.uri)||Oe.undefined(t.uri))}}(c||(t.Location=c={})),function(e){e.create=function(e,t,n,i){return{targetUri:e,targetRange:t,targetSelectionRange:n,originSelectionRange:i}},e.is=function(e){var t=e;return Oe.objectLiteral(t)&&a.is(t.targetRange)&&Oe.string(t.targetUri)&&a.is(t.targetSelectionRange)&&(a.is(t.originSelectionRange)||Oe.undefined(t.originSelectionRange))}}(l||(t.LocationLink=l={})),function(e){e.create=function(e,t,n,i){return{red:e,green:t,blue:n,alpha:i}},e.is=function(e){var t=e;return Oe.objectLiteral(t)&&Oe.numberRange(t.red,0,1)&&Oe.numberRange(t.green,0,1)&&Oe.numberRange(t.blue,0,1)&&Oe.numberRange(t.alpha,0,1)}}(u||(t.Color=u={})),function(e){e.create=function(e,t){return{range:e,color:t}},e.is=function(e){var t=e;return Oe.objectLiteral(t)&&a.is(t.range)&&u.is(t.color)}}(d||(t.ColorInformation=d={})),function(e){e.create=function(e,t,n){return{label:e,textEdit:t,additionalTextEdits:n}},e.is=function(e){var t=e;return Oe.objectLiteral(t)&&Oe.string(t.label)&&(Oe.undefined(t.textEdit)||k.is(t))&&(Oe.undefined(t.additionalTextEdits)||Oe.typedArray(t.additionalTextEdits,k.is))}}(f||(t.ColorPresentation=f={})),function(e){e.Comment="comment",e.Imports="imports",e.Region="region"}(p||(t.FoldingRangeKind=p={})),function(e){e.create=function(e,t,n,i,o,r){var s={startLine:e,endLine:t};return Oe.defined(n)&&(s.startCharacter=n),Oe.defined(i)&&(s.endCharacter=i),Oe.defined(o)&&(s.kind=o),Oe.defined(r)&&(s.collapsedText=r),s},e.is=function(e){var t=e;return Oe.objectLiteral(t)&&Oe.uinteger(t.startLine)&&Oe.uinteger(t.startLine)&&(Oe.undefined(t.startCharacter)||Oe.uinteger(t.startCharacter))&&(Oe.undefined(t.endCharacter)||Oe.uinteger(t.endCharacter))&&(Oe.undefined(t.kind)||Oe.string(t.kind))}}(h||(t.FoldingRange=h={})),function(e){e.create=function(e,t){return{location:e,message:t}},e.is=function(e){var t=e;return Oe.defined(t)&&c.is(t.location)&&Oe.string(t.message)}}(m||(t.DiagnosticRelatedInformation=m={})),function(e){e.Error=1,e.Warning=2,e.Information=3,e.Hint=4}(g||(t.DiagnosticSeverity=g={})),function(e){e.Unnecessary=1,e.Deprecated=2}(y||(t.DiagnosticTag=y={})),function(e){e.is=function(e){var t=e;return Oe.objectLiteral(t)&&Oe.string(t.href)}}(_||(t.CodeDescription=_={})),function(e){e.create=function(e,t,n,i,o,r){var s={range:e,message:t};return Oe.defined(n)&&(s.severity=n),Oe.defined(i)&&(s.code=i),Oe.defined(o)&&(s.source=o),Oe.defined(r)&&(s.relatedInformation=r),s},e.is=function(e){var t,n=e;return Oe.defined(n)&&a.is(n.range)&&Oe.string(n.message)&&(Oe.number(n.severity)||Oe.undefined(n.severity))&&(Oe.integer(n.code)||Oe.string(n.code)||Oe.undefined(n.code))&&(Oe.undefined(n.codeDescription)||Oe.string(null===(t=n.codeDescription)||void 0===t?void 0:t.href))&&(Oe.string(n.source)||Oe.undefined(n.source))&&(Oe.undefined(n.relatedInformation)||Oe.typedArray(n.relatedInformation,m.is))}}(b||(t.Diagnostic=b={})),function(e){e.create=function(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];var o={title:e,command:t};return Oe.defined(n)&&n.length>0&&(o.arguments=n),o},e.is=function(e){var t=e;return Oe.defined(t)&&Oe.string(t.title)&&Oe.string(t.command)}}(v||(t.Command=v={})),function(e){e.replace=function(e,t){return{range:e,newText:t}},e.insert=function(e,t){return{range:{start:e,end:e},newText:t}},e.del=function(e){return{range:e,newText:""}},e.is=function(e){var t=e;return Oe.objectLiteral(t)&&Oe.string(t.newText)&&a.is(t.range)}}(k||(t.TextEdit=k={})),function(e){e.create=function(e,t,n){var i={label:e};return void 0!==t&&(i.needsConfirmation=t),void 0!==n&&(i.description=n),i},e.is=function(e){var t=e;return Oe.objectLiteral(t)&&Oe.string(t.label)&&(Oe.boolean(t.needsConfirmation)||void 0===t.needsConfirmation)&&(Oe.string(t.description)||void 0===t.description)}}(T||(t.ChangeAnnotation=T={})),function(e){e.is=function(e){var t=e;return Oe.string(t)}}(R||(t.ChangeAnnotationIdentifier=R={})),function(e){e.replace=function(e,t,n){return{range:e,newText:t,annotationId:n}},e.insert=function(e,t,n){return{range:{start:e,end:e},newText:t,annotationId:n}},e.del=function(e,t){return{range:e,newText:"",annotationId:t}},e.is=function(e){var t=e;return k.is(t)&&(T.is(t.annotationId)||R.is(t.annotationId))}}(S||(t.AnnotatedTextEdit=S={})),function(e){e.create=function(e,t){return{textDocument:e,edits:t}},e.is=function(e){var t=e;return Oe.defined(t)&&P.is(t.textDocument)&&Array.isArray(t.edits)}}(w||(t.TextDocumentEdit=w={})),function(e){e.create=function(e,t,n){var i={kind:"create",uri:e};return void 0===t||void 0===t.overwrite&&void 0===t.ignoreIfExists||(i.options=t),void 0!==n&&(i.annotationId=n),i},e.is=function(e){var t=e;return t&&"create"===t.kind&&Oe.string(t.uri)&&(void 0===t.options||(void 0===t.options.overwrite||Oe.boolean(t.options.overwrite))&&(void 0===t.options.ignoreIfExists||Oe.boolean(t.options.ignoreIfExists)))&&(void 0===t.annotationId||R.is(t.annotationId))}}(C||(t.CreateFile=C={})),function(e){e.create=function(e,t,n,i){var o={kind:"rename",oldUri:e,newUri:t};return void 0===n||void 0===n.overwrite&&void 0===n.ignoreIfExists||(o.options=n),void 0!==i&&(o.annotationId=i),o},e.is=function(e){var t=e;return t&&"rename"===t.kind&&Oe.string(t.oldUri)&&Oe.string(t.newUri)&&(void 0===t.options||(void 0===t.options.overwrite||Oe.boolean(t.options.overwrite))&&(void 0===t.options.ignoreIfExists||Oe.boolean(t.options.ignoreIfExists)))&&(void 0===t.annotationId||R.is(t.annotationId))}}(D||(t.RenameFile=D={})),function(e){e.create=function(e,t,n){var i={kind:"delete",uri:e};return void 0===t||void 0===t.recursive&&void 0===t.ignoreIfNotExists||(i.options=t),void 0!==n&&(i.annotationId=n),i},e.is=function(e){var t=e;return t&&"delete"===t.kind&&Oe.string(t.uri)&&(void 0===t.options||(void 0===t.options.recursive||Oe.boolean(t.options.recursive))&&(void 0===t.options.ignoreIfNotExists||Oe.boolean(t.options.ignoreIfNotExists)))&&(void 0===t.annotationId||R.is(t.annotationId))}}(x||(t.DeleteFile=x={})),function(e){e.is=function(e){var t=e;return t&&(void 0!==t.changes||void 0!==t.documentChanges)&&(void 0===t.documentChanges||t.documentChanges.every((function(e){return Oe.string(e.kind)?C.is(e)||D.is(e)||x.is(e):w.is(e)})))}}(E||(t.WorkspaceEdit=E={}));var O,K,P,A,N,M,I,L,q,F,j,W,$,U,V,B,H,G,z,Y,X,J,Q,Z,ee,te,ne,ie,oe,re,se,ae,ce,le,ue,de,fe,pe,he,me,ge,ye,_e,be,ve,ke,Te,Re,Se,we,Ce,De=function(){function e(e,t){this.edits=e,this.changeAnnotations=t}return e.prototype.insert=function(e,t,n){var i,o;if(void 0===n?i=k.insert(e,t):R.is(n)?(o=n,i=S.insert(e,t,n)):(this.assertChangeAnnotations(this.changeAnnotations),o=this.changeAnnotations.manage(n),i=S.insert(e,t,o)),this.edits.push(i),void 0!==o)return o},e.prototype.replace=function(e,t,n){var i,o;if(void 0===n?i=k.replace(e,t):R.is(n)?(o=n,i=S.replace(e,t,n)):(this.assertChangeAnnotations(this.changeAnnotations),o=this.changeAnnotations.manage(n),i=S.replace(e,t,o)),this.edits.push(i),void 0!==o)return o},e.prototype.delete=function(e,t){var n,i;if(void 0===t?n=k.del(e):R.is(t)?(i=t,n=S.del(e,t)):(this.assertChangeAnnotations(this.changeAnnotations),i=this.changeAnnotations.manage(t),n=S.del(e,i)),this.edits.push(n),void 0!==i)return i},e.prototype.add=function(e){this.edits.push(e)},e.prototype.all=function(){return this.edits},e.prototype.clear=function(){this.edits.splice(0,this.edits.length)},e.prototype.assertChangeAnnotations=function(e){if(void 0===e)throw new Error("Text edit change is not configured to manage change annotations.")},e}(),xe=function(){function e(e){this._annotations=void 0===e?Object.create(null):e,this._counter=0,this._size=0}return e.prototype.all=function(){return this._annotations},Object.defineProperty(e.prototype,"size",{get:function(){return this._size},enumerable:!1,configurable:!0}),e.prototype.manage=function(e,t){var n;if(R.is(e)?n=e:(n=this.nextId(),t=e),void 0!==this._annotations[n])throw new Error("Id ".concat(n," is already in use."));if(void 0===t)throw new Error("No annotation provided for id ".concat(n));return this._annotations[n]=t,this._size++,n},e.prototype.nextId=function(){return this._counter++,this._counter.toString()},e}(),Ee=function(){function e(e){var t=this;this._textEditChanges=Object.create(null),void 0!==e?(this._workspaceEdit=e,e.documentChanges?(this._changeAnnotations=new xe(e.changeAnnotations),e.changeAnnotations=this._changeAnnotations.all(),e.documentChanges.forEach((function(e){if(w.is(e)){var n=new De(e.edits,t._changeAnnotations);t._textEditChanges[e.textDocument.uri]=n}}))):e.changes&&Object.keys(e.changes).forEach((function(n){var i=new De(e.changes[n]);t._textEditChanges[n]=i}))):this._workspaceEdit={}}return Object.defineProperty(e.prototype,"edit",{get:function(){return this.initDocumentChanges(),void 0!==this._changeAnnotations&&(0===this._changeAnnotations.size?this._workspaceEdit.changeAnnotations=void 0:this._workspaceEdit.changeAnnotations=this._changeAnnotations.all()),this._workspaceEdit},enumerable:!1,configurable:!0}),e.prototype.getTextEditChange=function(e){if(P.is(e)){if(this.initDocumentChanges(),void 0===this._workspaceEdit.documentChanges)throw new Error("Workspace edit is not configured for document changes.");var t={uri:e.uri,version:e.version};if(!(i=this._textEditChanges[t.uri])){var n={textDocument:t,edits:o=[]};this._workspaceEdit.documentChanges.push(n),i=new De(o,this._changeAnnotations),this._textEditChanges[t.uri]=i}return i}if(this.initChanges(),void 0===this._workspaceEdit.changes)throw new Error("Workspace edit is not configured for normal text edit changes.");var i;if(!(i=this._textEditChanges[e])){var o=[];this._workspaceEdit.changes[e]=o,i=new De(o),this._textEditChanges[e]=i}return i},e.prototype.initDocumentChanges=function(){void 0===this._workspaceEdit.documentChanges&&void 0===this._workspaceEdit.changes&&(this._changeAnnotations=new xe,this._workspaceEdit.documentChanges=[],this._workspaceEdit.changeAnnotations=this._changeAnnotations.all())},e.prototype.initChanges=function(){void 0===this._workspaceEdit.documentChanges&&void 0===this._workspaceEdit.changes&&(this._workspaceEdit.changes=Object.create(null))},e.prototype.createFile=function(e,t,n){if(this.initDocumentChanges(),void 0===this._workspaceEdit.documentChanges)throw new Error("Workspace edit is not configured for document changes.");var i,o,r;if(T.is(t)||R.is(t)?i=t:n=t,void 0===i?o=C.create(e,n):(r=R.is(i)?i:this._changeAnnotations.manage(i),o=C.create(e,n,r)),this._workspaceEdit.documentChanges.push(o),void 0!==r)return r},e.prototype.renameFile=function(e,t,n,i){if(this.initDocumentChanges(),void 0===this._workspaceEdit.documentChanges)throw new Error("Workspace edit is not configured for document changes.");var o,r,s;if(T.is(n)||R.is(n)?o=n:i=n,void 0===o?r=D.create(e,t,i):(s=R.is(o)?o:this._changeAnnotations.manage(o),r=D.create(e,t,i,s)),this._workspaceEdit.documentChanges.push(r),void 0!==s)return s},e.prototype.deleteFile=function(e,t,n){if(this.initDocumentChanges(),void 0===this._workspaceEdit.documentChanges)throw new Error("Workspace edit is not configured for document changes.");var i,o,r;if(T.is(t)||R.is(t)?i=t:n=t,void 0===i?o=x.create(e,n):(r=R.is(i)?i:this._changeAnnotations.manage(i),o=x.create(e,n,r)),this._workspaceEdit.documentChanges.push(o),void 0!==r)return r},e}();t.WorkspaceChange=Ee,function(e){e.create=function(e){return{uri:e}},e.is=function(e){var t=e;return Oe.defined(t)&&Oe.string(t.uri)}}(O||(t.TextDocumentIdentifier=O={})),function(e){e.create=function(e,t){return{uri:e,version:t}},e.is=function(e){var t=e;return Oe.defined(t)&&Oe.string(t.uri)&&Oe.integer(t.version)}}(K||(t.VersionedTextDocumentIdentifier=K={})),function(e){e.create=function(e,t){return{uri:e,version:t}},e.is=function(e){var t=e;return Oe.defined(t)&&Oe.string(t.uri)&&(null===t.version||Oe.integer(t.version))}}(P||(t.OptionalVersionedTextDocumentIdentifier=P={})),function(e){e.create=function(e,t,n,i){return{uri:e,languageId:t,version:n,text:i}},e.is=function(e){var t=e;return Oe.defined(t)&&Oe.string(t.uri)&&Oe.string(t.languageId)&&Oe.integer(t.version)&&Oe.string(t.text)}}(A||(t.TextDocumentItem=A={})),function(e){e.PlainText="plaintext",e.Markdown="markdown",e.is=function(t){var n=t;return n===e.PlainText||n===e.Markdown}}(N||(t.MarkupKind=N={})),function(e){e.is=function(e){var t=e;return Oe.objectLiteral(e)&&N.is(t.kind)&&Oe.string(t.value)}}(M||(t.MarkupContent=M={})),function(e){e.Text=1,e.Method=2,e.Function=3,e.Constructor=4,e.Field=5,e.Variable=6,e.Class=7,e.Interface=8,e.Module=9,e.Property=10,e.Unit=11,e.Value=12,e.Enum=13,e.Keyword=14,e.Snippet=15,e.Color=16,e.File=17,e.Reference=18,e.Folder=19,e.EnumMember=20,e.Constant=21,e.Struct=22,e.Event=23,e.Operator=24,e.TypeParameter=25}(I||(t.CompletionItemKind=I={})),function(e){e.PlainText=1,e.Snippet=2}(L||(t.InsertTextFormat=L={})),function(e){e.Deprecated=1}(q||(t.CompletionItemTag=q={})),function(e){e.create=function(e,t,n){return{newText:e,insert:t,replace:n}},e.is=function(e){var t=e;return t&&Oe.string(t.newText)&&a.is(t.insert)&&a.is(t.replace)}}(F||(t.InsertReplaceEdit=F={})),function(e){e.asIs=1,e.adjustIndentation=2}(j||(t.InsertTextMode=j={})),function(e){e.is=function(e){var t=e;return t&&(Oe.string(t.detail)||void 0===t.detail)&&(Oe.string(t.description)||void 0===t.description)}}(W||(t.CompletionItemLabelDetails=W={})),function(e){e.create=function(e){return{label:e}}}($||(t.CompletionItem=$={})),function(e){e.create=function(e,t){return{items:e||[],isIncomplete:!!t}}}(U||(t.CompletionList=U={})),function(e){e.fromPlainText=function(e){return e.replace(/[\\`*_{}[\]()#+\-.!]/g,"\\$&")},e.is=function(e){var t=e;return Oe.string(t)||Oe.objectLiteral(t)&&Oe.string(t.language)&&Oe.string(t.value)}}(V||(t.MarkedString=V={})),function(e){e.is=function(e){var t=e;return!!t&&Oe.objectLiteral(t)&&(M.is(t.contents)||V.is(t.contents)||Oe.typedArray(t.contents,V.is))&&(void 0===e.range||a.is(e.range))}}(B||(t.Hover=B={})),function(e){e.create=function(e,t){return t?{label:e,documentation:t}:{label:e}}}(H||(t.ParameterInformation=H={})),function(e){e.create=function(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];var o={label:e};return Oe.defined(t)&&(o.documentation=t),Oe.defined(n)?o.parameters=n:o.parameters=[],o}}(G||(t.SignatureInformation=G={})),function(e){e.Text=1,e.Read=2,e.Write=3}(z||(t.DocumentHighlightKind=z={})),function(e){e.create=function(e,t){var n={range:e};return Oe.number(t)&&(n.kind=t),n}}(Y||(t.DocumentHighlight=Y={})),function(e){e.File=1,e.Module=2,e.Namespace=3,e.Package=4,e.Class=5,e.Method=6,e.Property=7,e.Field=8,e.Constructor=9,e.Enum=10,e.Interface=11,e.Function=12,e.Variable=13,e.Constant=14,e.String=15,e.Number=16,e.Boolean=17,e.Array=18,e.Object=19,e.Key=20,e.Null=21,e.EnumMember=22,e.Struct=23,e.Event=24,e.Operator=25,e.TypeParameter=26}(X||(t.SymbolKind=X={})),function(e){e.Deprecated=1}(J||(t.SymbolTag=J={})),function(e){e.create=function(e,t,n,i,o){var r={name:e,kind:t,location:{uri:i,range:n}};return o&&(r.containerName=o),r}}(Q||(t.SymbolInformation=Q={})),function(e){e.create=function(e,t,n,i){return void 0!==i?{name:e,kind:t,location:{uri:n,range:i}}:{name:e,kind:t,location:{uri:n}}}}(Z||(t.WorkspaceSymbol=Z={})),function(e){e.create=function(e,t,n,i,o,r){var s={name:e,detail:t,kind:n,range:i,selectionRange:o};return void 0!==r&&(s.children=r),s},e.is=function(e){var t=e;return t&&Oe.string(t.name)&&Oe.number(t.kind)&&a.is(t.range)&&a.is(t.selectionRange)&&(void 0===t.detail||Oe.string(t.detail))&&(void 0===t.deprecated||Oe.boolean(t.deprecated))&&(void 0===t.children||Array.isArray(t.children))&&(void 0===t.tags||Array.isArray(t.tags))}}(ee||(t.DocumentSymbol=ee={})),function(e){e.Empty="",e.QuickFix="quickfix",e.Refactor="refactor",e.RefactorExtract="refactor.extract",e.RefactorInline="refactor.inline",e.RefactorRewrite="refactor.rewrite",e.Source="source",e.SourceOrganizeImports="source.organizeImports",e.SourceFixAll="source.fixAll"}(te||(t.CodeActionKind=te={})),function(e){e.Invoked=1,e.Automatic=2}(ne||(t.CodeActionTriggerKind=ne={})),function(e){e.create=function(e,t,n){var i={diagnostics:e};return null!=t&&(i.only=t),null!=n&&(i.triggerKind=n),i},e.is=function(e){var t=e;return Oe.defined(t)&&Oe.typedArray(t.diagnostics,b.is)&&(void 0===t.only||Oe.typedArray(t.only,Oe.string))&&(void 0===t.triggerKind||t.triggerKind===ne.Invoked||t.triggerKind===ne.Automatic)}}(ie||(t.CodeActionContext=ie={})),function(e){e.create=function(e,t,n){var i={title:e},o=!0;return"string"==typeof t?(o=!1,i.kind=t):v.is(t)?i.command=t:i.edit=t,o&&void 0!==n&&(i.kind=n),i},e.is=function(e){var t=e;return t&&Oe.string(t.title)&&(void 0===t.diagnostics||Oe.typedArray(t.diagnostics,b.is))&&(void 0===t.kind||Oe.string(t.kind))&&(void 0!==t.edit||void 0!==t.command)&&(void 0===t.command||v.is(t.command))&&(void 0===t.isPreferred||Oe.boolean(t.isPreferred))&&(void 0===t.edit||E.is(t.edit))}}(oe||(t.CodeAction=oe={})),function(e){e.create=function(e,t){var n={range:e};return Oe.defined(t)&&(n.data=t),n},e.is=function(e){var t=e;return Oe.defined(t)&&a.is(t.range)&&(Oe.undefined(t.command)||v.is(t.command))}}(re||(t.CodeLens=re={})),function(e){e.create=function(e,t){return{tabSize:e,insertSpaces:t}},e.is=function(e){var t=e;return Oe.defined(t)&&Oe.uinteger(t.tabSize)&&Oe.boolean(t.insertSpaces)}}(se||(t.FormattingOptions=se={})),function(e){e.create=function(e,t,n){return{range:e,target:t,data:n}},e.is=function(e){var t=e;return Oe.defined(t)&&a.is(t.range)&&(Oe.undefined(t.target)||Oe.string(t.target))}}(ae||(t.DocumentLink=ae={})),function(e){e.create=function(e,t){return{range:e,parent:t}},e.is=function(t){var n=t;return Oe.objectLiteral(n)&&a.is(n.range)&&(void 0===n.parent||e.is(n.parent))}}(ce||(t.SelectionRange=ce={})),function(e){e.namespace="namespace",e.type="type",e.class="class",e.enum="enum",e.interface="interface",e.struct="struct",e.typeParameter="typeParameter",e.parameter="parameter",e.variable="variable",e.property="property",e.enumMember="enumMember",e.event="event",e.function="function",e.method="method",e.macro="macro",e.keyword="keyword",e.modifier="modifier",e.comment="comment",e.string="string",e.number="number",e.regexp="regexp",e.operator="operator",e.decorator="decorator"}(le||(t.SemanticTokenTypes=le={})),function(e){e.declaration="declaration",e.definition="definition",e.readonly="readonly",e.static="static",e.deprecated="deprecated",e.abstract="abstract",e.async="async",e.modification="modification",e.documentation="documentation",e.defaultLibrary="defaultLibrary"}(ue||(t.SemanticTokenModifiers=ue={})),function(e){e.is=function(e){var t=e;return Oe.objectLiteral(t)&&(void 0===t.resultId||"string"==typeof t.resultId)&&Array.isArray(t.data)&&(0===t.data.length||"number"==typeof t.data[0])}}(de||(t.SemanticTokens=de={})),function(e){e.create=function(e,t){return{range:e,text:t}},e.is=function(e){var t=e;return null!=t&&a.is(t.range)&&Oe.string(t.text)}}(fe||(t.InlineValueText=fe={})),function(e){e.create=function(e,t,n){return{range:e,variableName:t,caseSensitiveLookup:n}},e.is=function(e){var t=e;return null!=t&&a.is(t.range)&&Oe.boolean(t.caseSensitiveLookup)&&(Oe.string(t.variableName)||void 0===t.variableName)}}(pe||(t.InlineValueVariableLookup=pe={})),function(e){e.create=function(e,t){return{range:e,expression:t}},e.is=function(e){var t=e;return null!=t&&a.is(t.range)&&(Oe.string(t.expression)||void 0===t.expression)}}(he||(t.InlineValueEvaluatableExpression=he={})),function(e){e.create=function(e,t){return{frameId:e,stoppedLocation:t}},e.is=function(e){var t=e;return Oe.defined(t)&&a.is(e.stoppedLocation)}}(me||(t.InlineValueContext=me={})),function(e){e.Type=1,e.Parameter=2,e.is=function(e){return 1===e||2===e}}(ge||(t.InlayHintKind=ge={})),function(e){e.create=function(e){return{value:e}},e.is=function(e){var t=e;return Oe.objectLiteral(t)&&(void 0===t.tooltip||Oe.string(t.tooltip)||M.is(t.tooltip))&&(void 0===t.location||c.is(t.location))&&(void 0===t.command||v.is(t.command))}}(ye||(t.InlayHintLabelPart=ye={})),function(e){e.create=function(e,t,n){var i={position:e,label:t};return void 0!==n&&(i.kind=n),i},e.is=function(e){var t=e;return Oe.objectLiteral(t)&&s.is(t.position)&&(Oe.string(t.label)||Oe.typedArray(t.label,ye.is))&&(void 0===t.kind||ge.is(t.kind))&&void 0===t.textEdits||Oe.typedArray(t.textEdits,k.is)&&(void 0===t.tooltip||Oe.string(t.tooltip)||M.is(t.tooltip))&&(void 0===t.paddingLeft||Oe.boolean(t.paddingLeft))&&(void 0===t.paddingRight||Oe.boolean(t.paddingRight))}}(_e||(t.InlayHint=_e={})),function(e){e.createSnippet=function(e){return{kind:"snippet",value:e}}}(be||(t.StringValue=be={})),function(e){e.create=function(e,t,n,i){return{insertText:e,filterText:t,range:n,command:i}}}(ve||(t.InlineCompletionItem=ve={})),function(e){e.create=function(e){return{items:e}}}(ke||(t.InlineCompletionList=ke={})),function(e){e.Invoked=0,e.Automatic=1}(Te||(t.InlineCompletionTriggerKind=Te={})),function(e){e.create=function(e,t){return{range:e,text:t}}}(Re||(t.SelectedCompletionInfo=Re={})),function(e){e.create=function(e,t){return{triggerKind:e,selectedCompletionInfo:t}}}(Se||(t.InlineCompletionContext=Se={})),function(e){e.is=function(e){var t=e;return Oe.objectLiteral(t)&&i.is(t.uri)&&Oe.string(t.name)}}(we||(t.WorkspaceFolder=we={})),t.EOL=["\n","\r\n","\r"],function(e){function t(e,n){if(e.length<=1)return e;var i=e.length/2|0,o=e.slice(0,i),r=e.slice(i);t(o,n),t(r,n);for(var s=0,a=0,c=0;s<o.length&&a<r.length;){var l=n(o[s],r[a]);e[c++]=l<=0?o[s++]:r[a++]}for(;s<o.length;)e[c++]=o[s++];for(;a<r.length;)e[c++]=r[a++];return e}e.create=function(e,t,n,i){return new Ke(e,t,n,i)},e.is=function(e){var t=e;return!!(Oe.defined(t)&&Oe.string(t.uri)&&(Oe.undefined(t.languageId)||Oe.string(t.languageId))&&Oe.uinteger(t.lineCount)&&Oe.func(t.getText)&&Oe.func(t.positionAt)&&Oe.func(t.offsetAt))},e.applyEdits=function(e,n){for(var i=e.getText(),o=t(n,(function(e,t){var n=e.range.start.line-t.range.start.line;return 0===n?e.range.start.character-t.range.start.character:n})),r=i.length,s=o.length-1;s>=0;s--){var a=o[s],c=e.offsetAt(a.range.start),l=e.offsetAt(a.range.end);if(!(l<=r))throw new Error("Overlapping edit");i=i.substring(0,c)+a.newText+i.substring(l,i.length),r=c}return i}}(Ce||(t.TextDocument=Ce={}));var Oe,Ke=function(){function e(e,t,n,i){this._uri=e,this._languageId=t,this._version=n,this._content=i,this._lineOffsets=void 0}return Object.defineProperty(e.prototype,"uri",{get:function(){return this._uri},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"languageId",{get:function(){return this._languageId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"version",{get:function(){return this._version},enumerable:!1,configurable:!0}),e.prototype.getText=function(e){if(e){var t=this.offsetAt(e.start),n=this.offsetAt(e.end);return this._content.substring(t,n)}return this._content},e.prototype.update=function(e,t){this._content=e.text,this._version=t,this._lineOffsets=void 0},e.prototype.getLineOffsets=function(){if(void 0===this._lineOffsets){for(var e=[],t=this._content,n=!0,i=0;i<t.length;i++){n&&(e.push(i),n=!1);var o=t.charAt(i);n="\r"===o||"\n"===o,"\r"===o&&i+1<t.length&&"\n"===t.charAt(i+1)&&i++}n&&t.length>0&&e.push(t.length),this._lineOffsets=e}return this._lineOffsets},e.prototype.positionAt=function(e){e=Math.max(Math.min(e,this._content.length),0);var t=this.getLineOffsets(),n=0,i=t.length;if(0===i)return s.create(0,e);for(;n<i;){var o=Math.floor((n+i)/2);t[o]>e?i=o:n=o+1}var r=n-1;return s.create(r,e-t[r])},e.prototype.offsetAt=function(e){var t=this.getLineOffsets();if(e.line>=t.length)return this._content.length;if(e.line<0)return 0;var n=t[e.line],i=e.line+1<t.length?t[e.line+1]:this._content.length;return Math.max(Math.min(n+e.character,i),n)},Object.defineProperty(e.prototype,"lineCount",{get:function(){return this.getLineOffsets().length},enumerable:!1,configurable:!0}),e}();!function(e){var t=Object.prototype.toString;e.defined=function(e){return void 0!==e},e.undefined=function(e){return void 0===e},e.boolean=function(e){return!0===e||!1===e},e.string=function(e){return"[object String]"===t.call(e)},e.number=function(e){return"[object Number]"===t.call(e)},e.numberRange=function(e,n,i){return"[object Number]"===t.call(e)&&n<=e&&e<=i},e.integer=function(e){return"[object Number]"===t.call(e)&&-2147483648<=e&&e<=2147483647},e.uinteger=function(e){return"[object Number]"===t.call(e)&&0<=e&&e<=2147483647},e.func=function(e){return"[object Function]"===t.call(e)},e.objectLiteral=function(e){return null!==e&&"object"==typeof e},e.typedArray=function(e,t){return Array.isArray(e)&&e.every(t)}}(Oe||(Oe={}))}))},3459:e=>{function t(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=3459,e.exports=t},9936:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,o)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.ProposedFeatures=t.NotebookDocuments=t.TextDocuments=t.SemanticTokensBuilder=void 0;const r=n(7255);Object.defineProperty(t,"SemanticTokensBuilder",{enumerable:!0,get:function(){return r.SemanticTokensBuilder}});const s=n(1778);o(n(7745),t);const a=n(7086);Object.defineProperty(t,"TextDocuments",{enumerable:!0,get:function(){return a.TextDocuments}});const c=n(5083);var l;Object.defineProperty(t,"NotebookDocuments",{enumerable:!0,get:function(){return c.NotebookDocuments}}),o(n(6717),t),function(e){e.all={__brand:"features",languages:s.InlineCompletionFeature}}(l||(t.ProposedFeatures=l={}))},4225:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CallHierarchyFeature=void 0;const i=n(7745);t.CallHierarchyFeature=e=>class extends e{get callHierarchy(){return{onPrepare:e=>this.connection.onRequest(i.CallHierarchyPrepareRequest.type,((t,n)=>e(t,n,this.attachWorkDoneProgress(t),void 0))),onIncomingCalls:e=>{const t=i.CallHierarchyIncomingCallsRequest.type;return this.connection.onRequest(t,((n,i)=>e(n,i,this.attachWorkDoneProgress(n),this.attachPartialResultProgress(t,n))))},onOutgoingCalls:e=>{const t=i.CallHierarchyOutgoingCallsRequest.type;return this.connection.onRequest(t,((n,i)=>e(n,i,this.attachWorkDoneProgress(n),this.attachPartialResultProgress(t,n))))}}}}},3606:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ConfigurationFeature=void 0;const i=n(7745),o=n(6960);t.ConfigurationFeature=e=>class extends e{getConfiguration(e){return e?o.string(e)?this._getConfiguration({section:e}):this._getConfiguration(e):this._getConfiguration({})}_getConfiguration(e){let t={items:Array.isArray(e)?e:[e]};return this.connection.sendRequest(i.ConfigurationRequest.type,t).then((t=>Array.isArray(t)?Array.isArray(e)?t:t[0]:Array.isArray(e)?[]:null))}}},2473:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DiagnosticFeature=void 0;const i=n(7745);t.DiagnosticFeature=e=>class extends e{get diagnostics(){return{refresh:()=>this.connection.sendRequest(i.DiagnosticRefreshRequest.type),on:e=>this.connection.onRequest(i.DocumentDiagnosticRequest.type,((t,n)=>e(t,n,this.attachWorkDoneProgress(t),this.attachPartialResultProgress(i.DocumentDiagnosticRequest.partialResult,t)))),onWorkspace:e=>this.connection.onRequest(i.WorkspaceDiagnosticRequest.type,((t,n)=>e(t,n,this.attachWorkDoneProgress(t),this.attachPartialResultProgress(i.WorkspaceDiagnosticRequest.partialResult,t))))}}}},7695:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FileOperationsFeature=void 0;const i=n(7745);t.FileOperationsFeature=e=>class extends e{onDidCreateFiles(e){return this.connection.onNotification(i.DidCreateFilesNotification.type,(t=>{e(t)}))}onDidRenameFiles(e){return this.connection.onNotification(i.DidRenameFilesNotification.type,(t=>{e(t)}))}onDidDeleteFiles(e){return this.connection.onNotification(i.DidDeleteFilesNotification.type,(t=>{e(t)}))}onWillCreateFiles(e){return this.connection.onRequest(i.WillCreateFilesRequest.type,((t,n)=>e(t,n)))}onWillRenameFiles(e){return this.connection.onRequest(i.WillRenameFilesRequest.type,((t,n)=>e(t,n)))}onWillDeleteFiles(e){return this.connection.onRequest(i.WillDeleteFilesRequest.type,((t,n)=>e(t,n)))}}},3183:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FoldingRangeFeature=void 0;const i=n(7745);t.FoldingRangeFeature=e=>class extends e{get foldingRange(){return{refresh:()=>this.connection.sendRequest(i.FoldingRangeRefreshRequest.type),on:e=>{const t=i.FoldingRangeRequest.type;return this.connection.onRequest(t,((n,i)=>e(n,i,this.attachWorkDoneProgress(n),this.attachPartialResultProgress(t,n))))}}}}},8339:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InlayHintFeature=void 0;const i=n(7745);t.InlayHintFeature=e=>class extends e{get inlayHint(){return{refresh:()=>this.connection.sendRequest(i.InlayHintRefreshRequest.type),on:e=>this.connection.onRequest(i.InlayHintRequest.type,((t,n)=>e(t,n,this.attachWorkDoneProgress(t)))),resolve:e=>this.connection.onRequest(i.InlayHintResolveRequest.type,((t,n)=>e(t,n)))}}}},1778:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InlineCompletionFeature=void 0;const i=n(7745);t.InlineCompletionFeature=e=>class extends e{get inlineCompletion(){return{on:e=>this.connection.onRequest(i.InlineCompletionRequest.type,((t,n)=>e(t,n,this.attachWorkDoneProgress(t))))}}}},8714:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InlineValueFeature=void 0;const i=n(7745);t.InlineValueFeature=e=>class extends e{get inlineValue(){return{refresh:()=>this.connection.sendRequest(i.InlineValueRefreshRequest.type),on:e=>this.connection.onRequest(i.InlineValueRequest.type,((t,n)=>e(t,n,this.attachWorkDoneProgress(t))))}}}},7129:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LinkedEditingRangeFeature=void 0;const i=n(7745);t.LinkedEditingRangeFeature=e=>class extends e{onLinkedEditingRange(e){return this.connection.onRequest(i.LinkedEditingRangeRequest.type,((t,n)=>e(t,n,this.attachWorkDoneProgress(t),void 0)))}}},8535:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MonikerFeature=void 0;const i=n(7745);t.MonikerFeature=e=>class extends e{get moniker(){return{on:e=>{const t=i.MonikerRequest.type;return this.connection.onRequest(t,((n,i)=>e(n,i,this.attachWorkDoneProgress(n),this.attachPartialResultProgress(t,n))))}}}}},5083:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NotebookDocuments=t.NotebookSyncFeature=void 0;const i=n(7745),o=n(7086);t.NotebookSyncFeature=e=>class extends e{get synchronization(){return{onDidOpenNotebookDocument:e=>this.connection.onNotification(i.DidOpenNotebookDocumentNotification.type,(t=>{e(t)})),onDidChangeNotebookDocument:e=>this.connection.onNotification(i.DidChangeNotebookDocumentNotification.type,(t=>{e(t)})),onDidSaveNotebookDocument:e=>this.connection.onNotification(i.DidSaveNotebookDocumentNotification.type,(t=>{e(t)})),onDidCloseNotebookDocument:e=>this.connection.onNotification(i.DidCloseNotebookDocumentNotification.type,(t=>{e(t)}))}}};class r{onDidOpenTextDocument(e){return this.openHandler=e,i.Disposable.create((()=>{this.openHandler=void 0}))}openTextDocument(e){this.openHandler&&this.openHandler(e)}onDidChangeTextDocument(e){return this.changeHandler=e,i.Disposable.create((()=>{this.changeHandler=e}))}changeTextDocument(e){this.changeHandler&&this.changeHandler(e)}onDidCloseTextDocument(e){return this.closeHandler=e,i.Disposable.create((()=>{this.closeHandler=void 0}))}closeTextDocument(e){this.closeHandler&&this.closeHandler(e)}onWillSaveTextDocument(){return r.NULL_DISPOSE}onWillSaveTextDocumentWaitUntil(){return r.NULL_DISPOSE}onDidSaveTextDocument(){return r.NULL_DISPOSE}}r.NULL_DISPOSE=Object.freeze({dispose:()=>{}}),t.NotebookDocuments=class{constructor(e){e instanceof o.TextDocuments?this._cellTextDocuments=e:this._cellTextDocuments=new o.TextDocuments(e),this.notebookDocuments=new Map,this.notebookCellMap=new Map,this._onDidOpen=new i.Emitter,this._onDidChange=new i.Emitter,this._onDidSave=new i.Emitter,this._onDidClose=new i.Emitter}get cellTextDocuments(){return this._cellTextDocuments}getCellTextDocument(e){return this._cellTextDocuments.get(e.document)}getNotebookDocument(e){return this.notebookDocuments.get(e)}getNotebookCell(e){const t=this.notebookCellMap.get(e);return t&&t[0]}findNotebookDocumentForCell(e){const t="string"==typeof e?e:e.document,n=this.notebookCellMap.get(t);return n&&n[1]}get onDidOpen(){return this._onDidOpen.event}get onDidSave(){return this._onDidSave.event}get onDidChange(){return this._onDidChange.event}get onDidClose(){return this._onDidClose.event}listen(e){const t=new r,n=[];return n.push(this.cellTextDocuments.listen(t)),n.push(e.notebooks.synchronization.onDidOpenNotebookDocument((e=>{this.notebookDocuments.set(e.notebookDocument.uri,e.notebookDocument);for(const n of e.cellTextDocuments)t.openTextDocument({textDocument:n});this.updateCellMap(e.notebookDocument),this._onDidOpen.fire(e.notebookDocument)}))),n.push(e.notebooks.synchronization.onDidChangeNotebookDocument((e=>{const n=this.notebookDocuments.get(e.notebookDocument.uri);if(void 0===n)return;n.version=e.notebookDocument.version;const i=n.metadata;let o=!1;const r=e.change;void 0!==r.metadata&&(o=!0,n.metadata=r.metadata);const s=[],a=[],c=[],l=[];if(void 0!==r.cells){const e=r.cells;if(void 0!==e.structure){const i=e.structure.array;if(n.cells.splice(i.start,i.deleteCount,...void 0!==i.cells?i.cells:[]),void 0!==e.structure.didOpen)for(const n of e.structure.didOpen)t.openTextDocument({textDocument:n}),s.push(n.uri);if(e.structure.didClose)for(const n of e.structure.didClose)t.closeTextDocument({textDocument:n}),a.push(n.uri)}if(void 0!==e.data){const t=new Map(e.data.map((e=>[e.document,e])));for(let e=0;e<=n.cells.length;e++){const i=t.get(n.cells[e].document);if(void 0!==i){const o=n.cells.splice(e,1,i);if(c.push({old:o[0],new:i}),t.delete(i.document),0===t.size)break}}}if(void 0!==e.textContent)for(const n of e.textContent)t.changeTextDocument({textDocument:n.document,contentChanges:n.changes}),l.push(n.document.uri)}this.updateCellMap(n);const u={notebookDocument:n};o&&(u.metadata={old:i,new:n.metadata});const d=[];for(const e of s)d.push(this.getNotebookCell(e));const f=[];for(const e of a)f.push(this.getNotebookCell(e));const p=[];for(const e of l)p.push(this.getNotebookCell(e));(d.length>0||f.length>0||c.length>0||p.length>0)&&(u.cells={added:d,removed:f,changed:{data:c,textContent:p}}),void 0===u.metadata&&void 0===u.cells||this._onDidChange.fire(u)}))),n.push(e.notebooks.synchronization.onDidSaveNotebookDocument((e=>{const t=this.notebookDocuments.get(e.notebookDocument.uri);void 0!==t&&this._onDidSave.fire(t)}))),n.push(e.notebooks.synchronization.onDidCloseNotebookDocument((e=>{const n=this.notebookDocuments.get(e.notebookDocument.uri);if(void 0!==n){this._onDidClose.fire(n);for(const n of e.cellTextDocuments)t.closeTextDocument({textDocument:n});this.notebookDocuments.delete(e.notebookDocument.uri);for(const e of n.cells)this.notebookCellMap.delete(e.document)}}))),i.Disposable.create((()=>{n.forEach((e=>e.dispose()))}))}updateCellMap(e){for(const t of e.cells)this.notebookCellMap.set(t.document,[t,e])}}},3787:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.attachPartialResult=t.ProgressFeature=t.attachWorkDone=void 0;const i=n(7745),o=n(7867);class r{constructor(e,t){this._connection=e,this._token=t,r.Instances.set(this._token,this)}begin(e,t,n,o){let r={kind:"begin",title:e,percentage:t,message:n,cancellable:o};this._connection.sendProgress(i.WorkDoneProgress.type,this._token,r)}report(e,t){let n={kind:"report"};"number"==typeof e?(n.percentage=e,void 0!==t&&(n.message=t)):n.message=e,this._connection.sendProgress(i.WorkDoneProgress.type,this._token,n)}done(){r.Instances.delete(this._token),this._connection.sendProgress(i.WorkDoneProgress.type,this._token,{kind:"end"})}}r.Instances=new Map;class s extends r{constructor(e,t){super(e,t),this._source=new i.CancellationTokenSource}get token(){return this._source.token}done(){this._source.dispose(),super.done()}cancel(){this._source.cancel()}}class a{constructor(){}begin(){}report(){}done(){}}class c extends a{constructor(){super(),this._source=new i.CancellationTokenSource}get token(){return this._source.token}done(){this._source.dispose()}cancel(){this._source.cancel()}}var l;t.attachWorkDone=function(e,t){if(void 0===t||void 0===t.workDoneToken)return new a;const n=t.workDoneToken;return delete t.workDoneToken,new r(e,n)},t.ProgressFeature=e=>class extends e{constructor(){super(),this._progressSupported=!1}initialize(e){super.initialize(e),!0===e?.window?.workDoneProgress&&(this._progressSupported=!0,this.connection.onNotification(i.WorkDoneProgressCancelNotification.type,(e=>{let t=r.Instances.get(e.token);(t instanceof s||t instanceof c)&&t.cancel()})))}attachWorkDoneProgress(e){return void 0===e?new a:new r(this.connection,e)}createWorkDoneProgress(){if(this._progressSupported){const e=(0,o.generateUuid)();return this.connection.sendRequest(i.WorkDoneProgressCreateRequest.type,{token:e}).then((()=>new s(this.connection,e)))}return Promise.resolve(new c)}},function(e){e.type=new i.ProgressType}(l||(l={}));class u{constructor(e,t){this._connection=e,this._token=t}report(e){this._connection.sendProgress(l.type,this._token,e)}}t.attachPartialResult=function(e,t){if(void 0===t||void 0===t.partialResultToken)return;const n=t.partialResultToken;return delete t.partialResultToken,new u(e,n)}},7255:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SemanticTokensBuilder=t.SemanticTokensDiff=t.SemanticTokensFeature=void 0;const i=n(7745);t.SemanticTokensFeature=e=>class extends e{get semanticTokens(){return{refresh:()=>this.connection.sendRequest(i.SemanticTokensRefreshRequest.type),on:e=>{const t=i.SemanticTokensRequest.type;return this.connection.onRequest(t,((n,i)=>e(n,i,this.attachWorkDoneProgress(n),this.attachPartialResultProgress(t,n))))},onDelta:e=>{const t=i.SemanticTokensDeltaRequest.type;return this.connection.onRequest(t,((n,i)=>e(n,i,this.attachWorkDoneProgress(n),this.attachPartialResultProgress(t,n))))},onRange:e=>{const t=i.SemanticTokensRangeRequest.type;return this.connection.onRequest(t,((n,i)=>e(n,i,this.attachWorkDoneProgress(n),this.attachPartialResultProgress(t,n))))}}}};class o{constructor(e,t){this.originalSequence=e,this.modifiedSequence=t}computeDiff(){const e=this.originalSequence.length,t=this.modifiedSequence.length;let n=0;for(;n<t&&n<e&&this.originalSequence[n]===this.modifiedSequence[n];)n++;if(n<t&&n<e){let i=e-1,o=t-1;for(;i>=n&&o>=n&&this.originalSequence[i]===this.modifiedSequence[o];)i--,o--;(i<n||o<n)&&(i++,o++);const r=i-n+1,s=this.modifiedSequence.slice(n,o+1);return 1===s.length&&s[0]===this.originalSequence[i]?[{start:n,deleteCount:r-1}]:[{start:n,deleteCount:r,data:s}]}return n<t?[{start:n,deleteCount:0,data:this.modifiedSequence.slice(n)}]:n<e?[{start:n,deleteCount:e-n}]:[]}}t.SemanticTokensDiff=o,t.SemanticTokensBuilder=class{constructor(){this._prevData=void 0,this.initialize()}initialize(){this._id=Date.now(),this._prevLine=0,this._prevChar=0,this._data=[],this._dataLen=0}push(e,t,n,i,o){let r=e,s=t;this._dataLen>0&&(r-=this._prevLine,0===r&&(s-=this._prevChar)),this._data[this._dataLen++]=r,this._data[this._dataLen++]=s,this._data[this._dataLen++]=n,this._data[this._dataLen++]=i,this._data[this._dataLen++]=o,this._prevLine=e,this._prevChar=t}get id(){return this._id.toString()}previousResult(e){this.id===e&&(this._prevData=this._data),this.initialize()}build(){return this._prevData=void 0,{resultId:this.id,data:this._data}}canBuildEdits(){return void 0!==this._prevData}buildEdits(){return void 0!==this._prevData?{resultId:this.id,edits:new o(this._prevData,this._data).computeDiff()}:this.build()}}},6717:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createConnection=t.combineFeatures=t.combineNotebooksFeatures=t.combineLanguagesFeatures=t.combineWorkspaceFeatures=t.combineWindowFeatures=t.combineClientFeatures=t.combineTracerFeatures=t.combineTelemetryFeatures=t.combineConsoleFeatures=t._NotebooksImpl=t._LanguagesImpl=t.BulkUnregistration=t.BulkRegistration=t.ErrorMessageTracker=void 0;const i=n(7745),o=n(6960),r=n(7867),s=n(3787),a=n(3606),c=n(2268),l=n(4225),u=n(7255),d=n(9283),f=n(7695),p=n(7129),h=n(7350),m=n(8714),g=n(3183),y=n(8339),_=n(2473),b=n(5083),v=n(8535);function k(e){if(null!==e)return e}t.ErrorMessageTracker=class{constructor(){this._messages=Object.create(null)}add(e){let t=this._messages[e];t||(t=0),t++,this._messages[e]=t}sendErrors(e){Object.keys(this._messages).forEach((t=>{e.window.showErrorMessage(t)}))}};class T{constructor(){}rawAttach(e){this._rawConnection=e}attach(e){this._connection=e}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}fillServerCapabilities(e){}initialize(e){}error(e){this.send(i.MessageType.Error,e)}warn(e){this.send(i.MessageType.Warning,e)}info(e){this.send(i.MessageType.Info,e)}log(e){this.send(i.MessageType.Log,e)}debug(e){this.send(i.MessageType.Debug,e)}send(e,t){this._rawConnection&&this._rawConnection.sendNotification(i.LogMessageNotification.type,{type:e,message:t}).catch((()=>{(0,i.RAL)().console.error("Sending log message failed")}))}}const R=(0,d.ShowDocumentFeature)((0,s.ProgressFeature)(class{constructor(){}attach(e){this._connection=e}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(e){}fillServerCapabilities(e){}showErrorMessage(e,...t){let n={type:i.MessageType.Error,message:e,actions:t};return this.connection.sendRequest(i.ShowMessageRequest.type,n).then(k)}showWarningMessage(e,...t){let n={type:i.MessageType.Warning,message:e,actions:t};return this.connection.sendRequest(i.ShowMessageRequest.type,n).then(k)}showInformationMessage(e,...t){let n={type:i.MessageType.Info,message:e,actions:t};return this.connection.sendRequest(i.ShowMessageRequest.type,n).then(k)}}));var S,w;!function(e){e.create=function(){return new C}}(S||(t.BulkRegistration=S={}));class C{constructor(){this._registrations=[],this._registered=new Set}add(e,t){const n=o.string(e)?e:e.method;if(this._registered.has(n))throw new Error(`${n} is already added to this registration`);const i=r.generateUuid();this._registrations.push({id:i,method:n,registerOptions:t||{}}),this._registered.add(n)}asRegistrationParams(){return{registrations:this._registrations}}}!function(e){e.create=function(){return new D(void 0,[])}}(w||(t.BulkUnregistration=w={}));class D{constructor(e,t){this._connection=e,this._unregistrations=new Map,t.forEach((e=>{this._unregistrations.set(e.method,e)}))}get isAttached(){return!!this._connection}attach(e){this._connection=e}add(e){this._unregistrations.set(e.method,e)}dispose(){let e=[];for(let t of this._unregistrations.values())e.push(t);let t={unregisterations:e};this._connection.sendRequest(i.UnregistrationRequest.type,t).catch((()=>{this._connection.console.info("Bulk unregistration failed.")}))}disposeSingle(e){const t=o.string(e)?e:e.method,n=this._unregistrations.get(t);if(!n)return!1;let r={unregisterations:[n]};return this._connection.sendRequest(i.UnregistrationRequest.type,r).then((()=>{this._unregistrations.delete(t)}),(e=>{this._connection.console.info(`Un-registering request handler for ${n.id} failed.`)})),!0}}class x{attach(e){this._connection=e}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(e){}fillServerCapabilities(e){}register(e,t,n){return e instanceof C?this.registerMany(e):e instanceof D?this.registerSingle1(e,t,n):this.registerSingle2(e,t)}registerSingle1(e,t,n){const s=o.string(t)?t:t.method,a=r.generateUuid();let c={registrations:[{id:a,method:s,registerOptions:n||{}}]};return e.isAttached||e.attach(this.connection),this.connection.sendRequest(i.RegistrationRequest.type,c).then((t=>(e.add({id:a,method:s}),e)),(e=>(this.connection.console.info(`Registering request handler for ${s} failed.`),Promise.reject(e))))}registerSingle2(e,t){const n=o.string(e)?e:e.method,s=r.generateUuid();let a={registrations:[{id:s,method:n,registerOptions:t||{}}]};return this.connection.sendRequest(i.RegistrationRequest.type,a).then((e=>i.Disposable.create((()=>{this.unregisterSingle(s,n).catch((()=>{this.connection.console.info(`Un-registering capability with id ${s} failed.`)}))}))),(e=>(this.connection.console.info(`Registering request handler for ${n} failed.`),Promise.reject(e))))}unregisterSingle(e,t){let n={unregisterations:[{id:e,method:t}]};return this.connection.sendRequest(i.UnregistrationRequest.type,n).catch((()=>{this.connection.console.info(`Un-registering request handler for ${e} failed.`)}))}registerMany(e){let t=e.asRegistrationParams();return this.connection.sendRequest(i.RegistrationRequest.type,t).then((()=>new D(this._connection,t.registrations.map((e=>({id:e.id,method:e.method}))))),(e=>(this.connection.console.info("Bulk registration failed."),Promise.reject(e))))}}const E=(0,f.FileOperationsFeature)((0,c.WorkspaceFoldersFeature)((0,a.ConfigurationFeature)(class{constructor(){}attach(e){this._connection=e}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(e){}fillServerCapabilities(e){}applyEdit(e){let t=(n=e)&&n.edit?e:{edit:e};var n;return this.connection.sendRequest(i.ApplyWorkspaceEditRequest.type,t)}})));class O{constructor(){this._trace=i.Trace.Off}attach(e){this._connection=e}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(e){}fillServerCapabilities(e){}set trace(e){this._trace=e}log(e,t){this._trace!==i.Trace.Off&&this.connection.sendNotification(i.LogTraceNotification.type,{message:e,verbose:this._trace===i.Trace.Verbose?t:void 0}).catch((()=>{}))}}class K{constructor(){}attach(e){this._connection=e}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(e){}fillServerCapabilities(e){}logEvent(e){this.connection.sendNotification(i.TelemetryEventNotification.type,e).catch((()=>{this.connection.console.log("Sending TelemetryEventNotification failed")}))}}class P{constructor(){}attach(e){this._connection=e}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(e){}fillServerCapabilities(e){}attachWorkDoneProgress(e){return(0,s.attachWorkDone)(this.connection,e)}attachPartialResultProgress(e,t){return(0,s.attachPartialResult)(this.connection,t)}}t._LanguagesImpl=P;const A=(0,g.FoldingRangeFeature)((0,v.MonikerFeature)((0,_.DiagnosticFeature)((0,y.InlayHintFeature)((0,m.InlineValueFeature)((0,h.TypeHierarchyFeature)((0,p.LinkedEditingRangeFeature)((0,u.SemanticTokensFeature)((0,l.CallHierarchyFeature)(P)))))))));class N{constructor(){}attach(e){this._connection=e}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(e){}fillServerCapabilities(e){}attachWorkDoneProgress(e){return(0,s.attachWorkDone)(this.connection,e)}attachPartialResultProgress(e,t){return(0,s.attachPartialResult)(this.connection,t)}}t._NotebooksImpl=N;const M=(0,b.NotebookSyncFeature)(N);function I(e,t){return function(n){return t(e(n))}}function L(e,t){return function(n){return t(e(n))}}function q(e,t){return function(n){return t(e(n))}}function F(e,t){return function(n){return t(e(n))}}function j(e,t){return function(n){return t(e(n))}}function W(e,t){return function(n){return t(e(n))}}function $(e,t){return function(n){return t(e(n))}}function U(e,t){return function(n){return t(e(n))}}t.combineConsoleFeatures=I,t.combineTelemetryFeatures=L,t.combineTracerFeatures=q,t.combineClientFeatures=F,t.combineWindowFeatures=j,t.combineWorkspaceFeatures=W,t.combineLanguagesFeatures=$,t.combineNotebooksFeatures=U,t.combineFeatures=function(e,t){function n(e,t,n){return e&&t?n(e,t):e||t}return{__brand:"features",console:n(e.console,t.console,I),tracer:n(e.tracer,t.tracer,q),telemetry:n(e.telemetry,t.telemetry,L),client:n(e.client,t.client,F),window:n(e.window,t.window,j),workspace:n(e.workspace,t.workspace,W),languages:n(e.languages,t.languages,$),notebooks:n(e.notebooks,t.notebooks,U)}},t.createConnection=function(e,t,n){const r=n&&n.console?new(n.console(T)):new T,a=e(r);r.rawAttach(a);const c=n&&n.tracer?new(n.tracer(O)):new O,l=n&&n.telemetry?new(n.telemetry(K)):new K,u=n&&n.client?new(n.client(x)):new x,d=n&&n.window?new(n.window(R)):new R,f=n&&n.workspace?new(n.workspace(E)):new E,p=n&&n.languages?new(n.languages(A)):new A,h=n&&n.notebooks?new(n.notebooks(M)):new M,m=[r,c,l,u,d,f,p,h];let g,y,_,b={listen:()=>a.listen(),sendRequest:(e,...t)=>a.sendRequest(o.string(e)?e:e.method,...t),onRequest:(e,t)=>a.onRequest(e,t),sendNotification:(e,t)=>{const n=o.string(e)?e:e.method;return a.sendNotification(n,t)},onNotification:(e,t)=>a.onNotification(e,t),onProgress:a.onProgress,sendProgress:a.sendProgress,onInitialize:e=>(y=e,{dispose:()=>{y=void 0}}),onInitialized:e=>a.onNotification(i.InitializedNotification.type,e),onShutdown:e=>(g=e,{dispose:()=>{g=void 0}}),onExit:e=>(_=e,{dispose:()=>{_=void 0}}),get console(){return r},get telemetry(){return l},get tracer(){return c},get client(){return u},get window(){return d},get workspace(){return f},get languages(){return p},get notebooks(){return h},onDidChangeConfiguration:e=>a.onNotification(i.DidChangeConfigurationNotification.type,e),onDidChangeWatchedFiles:e=>a.onNotification(i.DidChangeWatchedFilesNotification.type,e),__textDocumentSync:void 0,onDidOpenTextDocument:e=>a.onNotification(i.DidOpenTextDocumentNotification.type,e),onDidChangeTextDocument:e=>a.onNotification(i.DidChangeTextDocumentNotification.type,e),onDidCloseTextDocument:e=>a.onNotification(i.DidCloseTextDocumentNotification.type,e),onWillSaveTextDocument:e=>a.onNotification(i.WillSaveTextDocumentNotification.type,e),onWillSaveTextDocumentWaitUntil:e=>a.onRequest(i.WillSaveTextDocumentWaitUntilRequest.type,e),onDidSaveTextDocument:e=>a.onNotification(i.DidSaveTextDocumentNotification.type,e),sendDiagnostics:e=>a.sendNotification(i.PublishDiagnosticsNotification.type,e),onHover:e=>a.onRequest(i.HoverRequest.type,((t,n)=>e(t,n,(0,s.attachWorkDone)(a,t),void 0))),onCompletion:e=>a.onRequest(i.CompletionRequest.type,((t,n)=>e(t,n,(0,s.attachWorkDone)(a,t),(0,s.attachPartialResult)(a,t)))),onCompletionResolve:e=>a.onRequest(i.CompletionResolveRequest.type,e),onSignatureHelp:e=>a.onRequest(i.SignatureHelpRequest.type,((t,n)=>e(t,n,(0,s.attachWorkDone)(a,t),void 0))),onDeclaration:e=>a.onRequest(i.DeclarationRequest.type,((t,n)=>e(t,n,(0,s.attachWorkDone)(a,t),(0,s.attachPartialResult)(a,t)))),onDefinition:e=>a.onRequest(i.DefinitionRequest.type,((t,n)=>e(t,n,(0,s.attachWorkDone)(a,t),(0,s.attachPartialResult)(a,t)))),onTypeDefinition:e=>a.onRequest(i.TypeDefinitionRequest.type,((t,n)=>e(t,n,(0,s.attachWorkDone)(a,t),(0,s.attachPartialResult)(a,t)))),onImplementation:e=>a.onRequest(i.ImplementationRequest.type,((t,n)=>e(t,n,(0,s.attachWorkDone)(a,t),(0,s.attachPartialResult)(a,t)))),onReferences:e=>a.onRequest(i.ReferencesRequest.type,((t,n)=>e(t,n,(0,s.attachWorkDone)(a,t),(0,s.attachPartialResult)(a,t)))),onDocumentHighlight:e=>a.onRequest(i.DocumentHighlightRequest.type,((t,n)=>e(t,n,(0,s.attachWorkDone)(a,t),(0,s.attachPartialResult)(a,t)))),onDocumentSymbol:e=>a.onRequest(i.DocumentSymbolRequest.type,((t,n)=>e(t,n,(0,s.attachWorkDone)(a,t),(0,s.attachPartialResult)(a,t)))),onWorkspaceSymbol:e=>a.onRequest(i.WorkspaceSymbolRequest.type,((t,n)=>e(t,n,(0,s.attachWorkDone)(a,t),(0,s.attachPartialResult)(a,t)))),onWorkspaceSymbolResolve:e=>a.onRequest(i.WorkspaceSymbolResolveRequest.type,e),onCodeAction:e=>a.onRequest(i.CodeActionRequest.type,((t,n)=>e(t,n,(0,s.attachWorkDone)(a,t),(0,s.attachPartialResult)(a,t)))),onCodeActionResolve:e=>a.onRequest(i.CodeActionResolveRequest.type,((t,n)=>e(t,n))),onCodeLens:e=>a.onRequest(i.CodeLensRequest.type,((t,n)=>e(t,n,(0,s.attachWorkDone)(a,t),(0,s.attachPartialResult)(a,t)))),onCodeLensResolve:e=>a.onRequest(i.CodeLensResolveRequest.type,((t,n)=>e(t,n))),onDocumentFormatting:e=>a.onRequest(i.DocumentFormattingRequest.type,((t,n)=>e(t,n,(0,s.attachWorkDone)(a,t),void 0))),onDocumentRangeFormatting:e=>a.onRequest(i.DocumentRangeFormattingRequest.type,((t,n)=>e(t,n,(0,s.attachWorkDone)(a,t),void 0))),onDocumentOnTypeFormatting:e=>a.onRequest(i.DocumentOnTypeFormattingRequest.type,((t,n)=>e(t,n))),onRenameRequest:e=>a.onRequest(i.RenameRequest.type,((t,n)=>e(t,n,(0,s.attachWorkDone)(a,t),void 0))),onPrepareRename:e=>a.onRequest(i.PrepareRenameRequest.type,((t,n)=>e(t,n))),onDocumentLinks:e=>a.onRequest(i.DocumentLinkRequest.type,((t,n)=>e(t,n,(0,s.attachWorkDone)(a,t),(0,s.attachPartialResult)(a,t)))),onDocumentLinkResolve:e=>a.onRequest(i.DocumentLinkResolveRequest.type,((t,n)=>e(t,n))),onDocumentColor:e=>a.onRequest(i.DocumentColorRequest.type,((t,n)=>e(t,n,(0,s.attachWorkDone)(a,t),(0,s.attachPartialResult)(a,t)))),onColorPresentation:e=>a.onRequest(i.ColorPresentationRequest.type,((t,n)=>e(t,n,(0,s.attachWorkDone)(a,t),(0,s.attachPartialResult)(a,t)))),onFoldingRanges:e=>a.onRequest(i.FoldingRangeRequest.type,((t,n)=>e(t,n,(0,s.attachWorkDone)(a,t),(0,s.attachPartialResult)(a,t)))),onSelectionRanges:e=>a.onRequest(i.SelectionRangeRequest.type,((t,n)=>e(t,n,(0,s.attachWorkDone)(a,t),(0,s.attachPartialResult)(a,t)))),onExecuteCommand:e=>a.onRequest(i.ExecuteCommandRequest.type,((t,n)=>e(t,n,(0,s.attachWorkDone)(a,t),void 0))),dispose:()=>a.dispose()};for(let e of m)e.attach(b);return a.onRequest(i.InitializeRequest.type,(e=>{t.initialize(e),o.string(e.trace)&&(c.trace=i.Trace.fromString(e.trace));for(let t of m)t.initialize(e.capabilities);if(y){let t=y(e,(new i.CancellationTokenSource).token,(0,s.attachWorkDone)(a,e),void 0);return(n=t,n instanceof Promise?n:o.thenable(n)?new Promise(((e,t)=>{n.then((t=>e(t)),(e=>t(e)))})):Promise.resolve(n)).then((e=>{if(e instanceof i.ResponseError)return e;let t=e;t||(t={capabilities:{}});let n=t.capabilities;n||(n={},t.capabilities=n),void 0===n.textDocumentSync||null===n.textDocumentSync?n.textDocumentSync=o.number(b.__textDocumentSync)?b.__textDocumentSync:i.TextDocumentSyncKind.None:o.number(n.textDocumentSync)||o.number(n.textDocumentSync.change)||(n.textDocumentSync.change=o.number(b.__textDocumentSync)?b.__textDocumentSync:i.TextDocumentSyncKind.None);for(let e of m)e.fillServerCapabilities(n);return t}))}{let e={capabilities:{textDocumentSync:i.TextDocumentSyncKind.None}};for(let t of m)t.fillServerCapabilities(e.capabilities);return e}var n})),a.onRequest(i.ShutdownRequest.type,(()=>(t.shutdownReceived=!0,g?g((new i.CancellationTokenSource).token):void 0))),a.onNotification(i.ExitNotification.type,(()=>{try{_&&_()}finally{t.shutdownReceived?t.exit(0):t.exit(1)}})),a.onNotification(i.SetTraceNotification.type,(e=>{c.trace=i.Trace.fromString(e.value)})),b}},9283:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ShowDocumentFeature=void 0;const i=n(7745);t.ShowDocumentFeature=e=>class extends e{showDocument(e){return this.connection.sendRequest(i.ShowDocumentRequest.type,e)}}},7086:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TextDocuments=void 0;const i=n(7745);t.TextDocuments=class{constructor(e){this._configuration=e,this._syncedDocuments=new Map,this._onDidChangeContent=new i.Emitter,this._onDidOpen=new i.Emitter,this._onDidClose=new i.Emitter,this._onDidSave=new i.Emitter,this._onWillSave=new i.Emitter}get onDidOpen(){return this._onDidOpen.event}get onDidChangeContent(){return this._onDidChangeContent.event}get onWillSave(){return this._onWillSave.event}onWillSaveWaitUntil(e){this._willSaveWaitUntil=e}get onDidSave(){return this._onDidSave.event}get onDidClose(){return this._onDidClose.event}get(e){return this._syncedDocuments.get(e)}all(){return Array.from(this._syncedDocuments.values())}keys(){return Array.from(this._syncedDocuments.keys())}listen(e){e.__textDocumentSync=i.TextDocumentSyncKind.Incremental;const t=[];return t.push(e.onDidOpenTextDocument((e=>{const t=e.textDocument,n=this._configuration.create(t.uri,t.languageId,t.version,t.text);this._syncedDocuments.set(t.uri,n);const i=Object.freeze({document:n});this._onDidOpen.fire(i),this._onDidChangeContent.fire(i)}))),t.push(e.onDidChangeTextDocument((e=>{const t=e.textDocument,n=e.contentChanges;if(0===n.length)return;const{version:i}=t;if(null==i)throw new Error(`Received document change event for ${t.uri} without valid version identifier`);let o=this._syncedDocuments.get(t.uri);void 0!==o&&(o=this._configuration.update(o,n,i),this._syncedDocuments.set(t.uri,o),this._onDidChangeContent.fire(Object.freeze({document:o})))}))),t.push(e.onDidCloseTextDocument((e=>{let t=this._syncedDocuments.get(e.textDocument.uri);void 0!==t&&(this._syncedDocuments.delete(e.textDocument.uri),this._onDidClose.fire(Object.freeze({document:t})))}))),t.push(e.onWillSaveTextDocument((e=>{let t=this._syncedDocuments.get(e.textDocument.uri);void 0!==t&&this._onWillSave.fire(Object.freeze({document:t,reason:e.reason}))}))),t.push(e.onWillSaveTextDocumentWaitUntil(((e,t)=>{let n=this._syncedDocuments.get(e.textDocument.uri);return void 0!==n&&this._willSaveWaitUntil?this._willSaveWaitUntil(Object.freeze({document:n,reason:e.reason}),t):[]}))),t.push(e.onDidSaveTextDocument((e=>{let t=this._syncedDocuments.get(e.textDocument.uri);void 0!==t&&this._onDidSave.fire(Object.freeze({document:t}))}))),i.Disposable.create((()=>{t.forEach((e=>e.dispose()))}))}}},7350:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TypeHierarchyFeature=void 0;const i=n(7745);t.TypeHierarchyFeature=e=>class extends e{get typeHierarchy(){return{onPrepare:e=>this.connection.onRequest(i.TypeHierarchyPrepareRequest.type,((t,n)=>e(t,n,this.attachWorkDoneProgress(t),void 0))),onSupertypes:e=>{const t=i.TypeHierarchySupertypesRequest.type;return this.connection.onRequest(t,((n,i)=>e(n,i,this.attachWorkDoneProgress(n),this.attachPartialResultProgress(t,n))))},onSubtypes:e=>{const t=i.TypeHierarchySubtypesRequest.type;return this.connection.onRequest(t,((n,i)=>e(n,i,this.attachWorkDoneProgress(n),this.attachPartialResultProgress(t,n))))}}}}},6960:(e,t)=>{"use strict";function n(e){return"string"==typeof e||e instanceof String}function i(e){return"function"==typeof e}function o(e){return Array.isArray(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.thenable=t.typedArray=t.stringArray=t.array=t.func=t.error=t.number=t.string=t.boolean=void 0,t.boolean=function(e){return!0===e||!1===e},t.string=n,t.number=function(e){return"number"==typeof e||e instanceof Number},t.error=function(e){return e instanceof Error},t.func=i,t.array=o,t.stringArray=function(e){return o(e)&&e.every((e=>n(e)))},t.typedArray=function(e,t){return Array.isArray(e)&&e.every(t)},t.thenable=function(e){return e&&i(e.then)}},7867:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.generateUuid=t.parse=t.isUUID=t.v4=t.empty=void 0;class n{constructor(e){this._value=e}asHex(){return this._value}equals(e){return this.asHex()===e.asHex()}}class i extends n{static _oneOf(e){return e[Math.floor(e.length*Math.random())]}static _randomHex(){return i._oneOf(i._chars)}constructor(){super([i._randomHex(),i._randomHex(),i._randomHex(),i._randomHex(),i._randomHex(),i._randomHex(),i._randomHex(),i._randomHex(),"-",i._randomHex(),i._randomHex(),i._randomHex(),i._randomHex(),"-","4",i._randomHex(),i._randomHex(),i._randomHex(),"-",i._oneOf(i._timeHighBits),i._randomHex(),i._randomHex(),i._randomHex(),"-",i._randomHex(),i._randomHex(),i._randomHex(),i._randomHex(),i._randomHex(),i._randomHex(),i._randomHex(),i._randomHex(),i._randomHex(),i._randomHex(),i._randomHex(),i._randomHex()].join(""))}}function o(){return new i}i._chars=["0","1","2","3","4","5","6","6","7","8","9","a","b","c","d","e","f"],i._timeHighBits=["8","9","a","b"],t.empty=new n("00000000-0000-0000-0000-000000000000"),t.v4=o;const r=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;function s(e){return r.test(e)}t.isUUID=s,t.parse=function(e){if(!s(e))throw new Error("invalid uuid");return new n(e)},t.generateUuid=function(){return o().asHex()}},2268:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WorkspaceFoldersFeature=void 0;const i=n(7745);t.WorkspaceFoldersFeature=e=>class extends e{constructor(){super(),this._notificationIsAutoRegistered=!1}initialize(e){super.initialize(e);let t=e.workspace;t&&t.workspaceFolders&&(this._onDidChangeWorkspaceFolders=new i.Emitter,this.connection.onNotification(i.DidChangeWorkspaceFoldersNotification.type,(e=>{this._onDidChangeWorkspaceFolders.fire(e.event)})))}fillServerCapabilities(e){super.fillServerCapabilities(e);const t=e.workspace?.workspaceFolders?.changeNotifications;this._notificationIsAutoRegistered=!0===t||"string"==typeof t}getWorkspaceFolders(){return this.connection.sendRequest(i.WorkspaceFoldersRequest.type)}get onDidChangeWorkspaceFolders(){if(!this._onDidChangeWorkspaceFolders)throw new Error("Client doesn't support sending workspace folder change events.");return this._notificationIsAutoRegistered||this._unregistration||(this._unregistration=this.connection.client.register(i.DidChangeWorkspaceFoldersNotification.type)),this._onDidChangeWorkspaceFolders.event}}},1507:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resolveModulePath=t.FileSystem=t.resolveGlobalYarnPath=t.resolveGlobalNodePath=t.resolve=t.uriToFilePath=void 0;const i=n(7310),o=n(1017),r=n(7147),s=n(2081);function a(){return"win32"===process.platform}function c(e,t,n,i){const a=["var p = process;","p.on('message',function(m){","if(m.c==='e'){","p.exit(0);","}","else if(m.c==='rs'){","try{","var r=require.resolve(m.a);","p.send({c:'r',s:true,r:r});","}","catch(err){","p.send({c:'r',s:false});","}","}","});"].join("");return new Promise(((c,l)=>{let u=process.env,d=Object.create(null);Object.keys(u).forEach((e=>d[e]=u[e])),t&&r.existsSync(t)&&(d.NODE_PATH?d.NODE_PATH=t+o.delimiter+d.NODE_PATH:d.NODE_PATH=t,i&&i(`NODE_PATH value is: ${d.NODE_PATH}`)),d.ELECTRON_RUN_AS_NODE="1";try{let t=(0,s.fork)("",[],{cwd:n,env:d,execArgv:["-e",a]});if(void 0===t.pid)return void l(new Error(`Starting process to resolve node module  ${e} failed`));t.on("error",(e=>{l(e)})),t.on("message",(n=>{"r"===n.c&&(t.send({c:"e"}),n.s?c(n.r):l(new Error(`Failed to resolve module: ${e}`)))}));let i={c:"rs",a:e};t.send(i)}catch(e){l(e)}}))}function l(e){let t="npm";const n=Object.create(null);Object.keys(process.env).forEach((e=>n[e]=process.env[e])),n.NO_UPDATE_NOTIFIER="true";const i={encoding:"utf8",env:n};a()&&(t="npm.cmd",i.shell=!0);let r=()=>{};try{process.on("SIGPIPE",r);let n=(0,s.spawnSync)(t,["config","get","prefix"],i).stdout;if(!n)return void(e&&e("'npm config get prefix' didn't return a value."));let c=n.trim();return e&&e(`'npm config get prefix' value is: ${c}`),c.length>0?a()?o.join(c,"node_modules"):o.join(c,"lib","node_modules"):void 0}catch(e){return}finally{process.removeListener("SIGPIPE",r)}}var u;t.uriToFilePath=function(e){let t=i.parse(e);if("file:"!==t.protocol||!t.path)return;let n=t.path.split("/");for(var r=0,s=n.length;r<s;r++)n[r]=decodeURIComponent(n[r]);if("win32"===process.platform&&n.length>1){let e=n[0],t=n[1];0===e.length&&t.length>1&&":"===t[1]&&n.shift()}return o.normalize(n.join("/"))},t.resolve=c,t.resolveGlobalNodePath=l,t.resolveGlobalYarnPath=function(e){let t="yarn",n={encoding:"utf8"};a()&&(t="yarn.cmd",n.shell=!0);let i=()=>{};try{process.on("SIGPIPE",i);let r=(0,s.spawnSync)(t,["global","dir","--json"],n),a=r.stdout;if(!a)return void(e&&(e("'yarn global dir' didn't return a value."),r.stderr&&e(r.stderr)));let c=a.trim().split(/\r?\n/);for(let e of c)try{let t=JSON.parse(e);if("log"===t.type)return o.join(t.data,"node_modules")}catch(e){}return}catch(e){return}finally{process.removeListener("SIGPIPE",i)}},function(e){let t;function n(){return void 0!==t||(t=!("win32"===process.platform||r.existsSync(__filename.toUpperCase())&&r.existsSync(__filename.toLowerCase()))),t}e.isCaseSensitive=n,e.isParent=function(e,t){return n()?0===o.normalize(t).indexOf(o.normalize(e)):0===o.normalize(t).toLowerCase().indexOf(o.normalize(e).toLowerCase())}}(u||(t.FileSystem=u={})),t.resolveModulePath=function(e,t,n,i){return n?(o.isAbsolute(n)||(n=o.join(e,n)),c(t,n,n,i).then((e=>u.isParent(n,e)?e:Promise.reject(new Error(`Failed to load ${t} from node path location.`)))).then(void 0,(n=>c(t,l(i),e,i)))):c(t,l(i),e,i)}},2374:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,o)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.createConnection=t.Files=void 0;const r=n(7261),s=n(6960),a=n(6717),c=n(1507),l=n(4057);var u;o(n(4057),t),o(n(9936),t),function(e){e.uriToFilePath=c.uriToFilePath,e.resolveGlobalNodePath=c.resolveGlobalNodePath,e.resolveGlobalYarnPath=c.resolveGlobalYarnPath,e.resolve=c.resolve,e.resolveModulePath=c.resolveModulePath}(u||(t.Files=u={}));let d,f=!1;!function(){const e="--clientProcessId";function t(e){try{let t=parseInt(e);isNaN(t)||(d=setInterval((()=>{try{process.kill(t,0)}catch(e){process.exit(f?0:1)}}),3e3))}catch(e){}}for(let n=2;n<process.argv.length;n++){let i=process.argv[n];if(i===e&&n+1<process.argv.length)return void t(process.argv[n+1]);{let n=i.split("=");n[0]===e&&t(n[1])}}}();const p={initialize:e=>{const t=e.processId;s.number(t)&&void 0===d&&setInterval((()=>{try{process.kill(t,0)}catch(e){process.exit(f?0:1)}}),3e3)},get shutdownReceived(){return f},set shutdownReceived(e){f=e},exit:e=>{process.exit(e)}};t.createConnection=function(e,t,n,i){let o,c,u,d;return void 0!==e&&"features"===e.__brand&&(o=e,e=t,t=n,n=i),l.ConnectionStrategy.is(e)||l.ConnectionOptions.is(e)?d=e:(c=e,u=t,d=n),function(e,t,n,i){let o=!1;if(!e&&!t&&process.argv.length>2){let n,i,r=process.argv.slice(2);for(let s=0;s<r.length;s++){let a=r[s];if("--node-ipc"===a){e=new l.IPCMessageReader(process),t=new l.IPCMessageWriter(process);break}if("--stdio"===a){o=!0,e=process.stdin,t=process.stdout;break}if("--socket"===a){n=parseInt(r[s+1]);break}if("--pipe"===a){i=r[s+1];break}var c=a.split("=");if("--socket"===c[0]){n=parseInt(c[1]);break}if("--pipe"===c[0]){i=c[1];break}}if(n){let i=(0,l.createServerSocketTransport)(n);e=i[0],t=i[1]}else if(i){let n=(0,l.createServerPipeTransport)(i);e=n[0],t=n[1]}}var u="Use arguments of createConnection or set command line parameters: '--node-ipc', '--stdio' or '--socket={number}'";if(!e)throw new Error("Connection input stream is not set. "+u);if(!t)throw new Error("Connection output stream is not set. "+u);if(s.func(e.read)&&s.func(e.on)){let t=e;t.on("end",(()=>{process.exit(f?0:1)})),t.on("close",(()=>{process.exit(f?0:1)}))}return(0,a.createConnection)((i=>{const s=(0,l.createProtocolConnection)(e,t,i,n);return o&&function(e){function t(e){return e.map((e=>"string"==typeof e?e:(0,r.inspect)(e))).join(" ")}const n=new Map;console.assert=function(n,...i){if(!n)if(0===i.length)e.error("Assertion failed");else{const[n,...o]=i;e.error(`Assertion failed: ${n} ${t(o)}`)}},console.count=function(t="default"){const i=String(t);let o=n.get(i)??0;o+=1,n.set(i,o),e.log(`${i}: ${i}`)},console.countReset=function(e){void 0===e?n.clear():n.delete(String(e))},console.debug=function(...n){e.log(t(n))},console.dir=function(t,n){e.log((0,r.inspect)(t,n))},console.log=function(...n){e.log(t(n))},console.error=function(...n){e.error(t(n))},console.trace=function(...n){const i=(new Error).stack.replace(/(.+\n){2}/,"");let o="Trace";0!==n.length&&(o+=`: ${t(n)}`),e.log(`${o}\n${i}`)},console.warn=function(...n){e.warn(t(n))}}(i),s}),p,i)}(c,u,d,o)}},433:(e,t,n)=>{"use strict";e.exports=n(2374)},7237:function(e){var t;t=()=>(()=>{"use strict";var e={470:e=>{function t(e){if("string"!=typeof e)throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}function n(e,t){for(var n,i="",o=0,r=-1,s=0,a=0;a<=e.length;++a){if(a<e.length)n=e.charCodeAt(a);else{if(47===n)break;n=47}if(47===n){if(r===a-1||1===s);else if(r!==a-1&&2===s){if(i.length<2||2!==o||46!==i.charCodeAt(i.length-1)||46!==i.charCodeAt(i.length-2))if(i.length>2){var c=i.lastIndexOf("/");if(c!==i.length-1){-1===c?(i="",o=0):o=(i=i.slice(0,c)).length-1-i.lastIndexOf("/"),r=a,s=0;continue}}else if(2===i.length||1===i.length){i="",o=0,r=a,s=0;continue}t&&(i.length>0?i+="/..":i="..",o=2)}else i.length>0?i+="/"+e.slice(r+1,a):i=e.slice(r+1,a),o=a-r-1;r=a,s=0}else 46===n&&-1!==s?++s:s=-1}return i}var i={resolve:function(){for(var e,i="",o=!1,r=arguments.length-1;r>=-1&&!o;r--){var s;r>=0?s=arguments[r]:(void 0===e&&(e=process.cwd()),s=e),t(s),0!==s.length&&(i=s+"/"+i,o=47===s.charCodeAt(0))}return i=n(i,!o),o?i.length>0?"/"+i:"/":i.length>0?i:"."},normalize:function(e){if(t(e),0===e.length)return".";var i=47===e.charCodeAt(0),o=47===e.charCodeAt(e.length-1);return 0!==(e=n(e,!i)).length||i||(e="."),e.length>0&&o&&(e+="/"),i?"/"+e:e},isAbsolute:function(e){return t(e),e.length>0&&47===e.charCodeAt(0)},join:function(){if(0===arguments.length)return".";for(var e,n=0;n<arguments.length;++n){var o=arguments[n];t(o),o.length>0&&(void 0===e?e=o:e+="/"+o)}return void 0===e?".":i.normalize(e)},relative:function(e,n){if(t(e),t(n),e===n)return"";if((e=i.resolve(e))===(n=i.resolve(n)))return"";for(var o=1;o<e.length&&47===e.charCodeAt(o);++o);for(var r=e.length,s=r-o,a=1;a<n.length&&47===n.charCodeAt(a);++a);for(var c=n.length-a,l=s<c?s:c,u=-1,d=0;d<=l;++d){if(d===l){if(c>l){if(47===n.charCodeAt(a+d))return n.slice(a+d+1);if(0===d)return n.slice(a+d)}else s>l&&(47===e.charCodeAt(o+d)?u=d:0===d&&(u=0));break}var f=e.charCodeAt(o+d);if(f!==n.charCodeAt(a+d))break;47===f&&(u=d)}var p="";for(d=o+u+1;d<=r;++d)d!==r&&47!==e.charCodeAt(d)||(0===p.length?p+="..":p+="/..");return p.length>0?p+n.slice(a+u):(a+=u,47===n.charCodeAt(a)&&++a,n.slice(a))},_makeLong:function(e){return e},dirname:function(e){if(t(e),0===e.length)return".";for(var n=e.charCodeAt(0),i=47===n,o=-1,r=!0,s=e.length-1;s>=1;--s)if(47===(n=e.charCodeAt(s))){if(!r){o=s;break}}else r=!1;return-1===o?i?"/":".":i&&1===o?"//":e.slice(0,o)},basename:function(e,n){if(void 0!==n&&"string"!=typeof n)throw new TypeError('"ext" argument must be a string');t(e);var i,o=0,r=-1,s=!0;if(void 0!==n&&n.length>0&&n.length<=e.length){if(n.length===e.length&&n===e)return"";var a=n.length-1,c=-1;for(i=e.length-1;i>=0;--i){var l=e.charCodeAt(i);if(47===l){if(!s){o=i+1;break}}else-1===c&&(s=!1,c=i+1),a>=0&&(l===n.charCodeAt(a)?-1==--a&&(r=i):(a=-1,r=c))}return o===r?r=c:-1===r&&(r=e.length),e.slice(o,r)}for(i=e.length-1;i>=0;--i)if(47===e.charCodeAt(i)){if(!s){o=i+1;break}}else-1===r&&(s=!1,r=i+1);return-1===r?"":e.slice(o,r)},extname:function(e){t(e);for(var n=-1,i=0,o=-1,r=!0,s=0,a=e.length-1;a>=0;--a){var c=e.charCodeAt(a);if(47!==c)-1===o&&(r=!1,o=a+1),46===c?-1===n?n=a:1!==s&&(s=1):-1!==n&&(s=-1);else if(!r){i=a+1;break}}return-1===n||-1===o||0===s||1===s&&n===o-1&&n===i+1?"":e.slice(n,o)},format:function(e){if(null===e||"object"!=typeof e)throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof e);return function(e,t){var n=t.dir||t.root,i=t.base||(t.name||"")+(t.ext||"");return n?n===t.root?n+i:n+"/"+i:i}(0,e)},parse:function(e){t(e);var n={root:"",dir:"",base:"",ext:"",name:""};if(0===e.length)return n;var i,o=e.charCodeAt(0),r=47===o;r?(n.root="/",i=1):i=0;for(var s=-1,a=0,c=-1,l=!0,u=e.length-1,d=0;u>=i;--u)if(47!==(o=e.charCodeAt(u)))-1===c&&(l=!1,c=u+1),46===o?-1===s?s=u:1!==d&&(d=1):-1!==s&&(d=-1);else if(!l){a=u+1;break}return-1===s||-1===c||0===d||1===d&&s===c-1&&s===a+1?-1!==c&&(n.base=n.name=0===a&&r?e.slice(1,c):e.slice(a,c)):(0===a&&r?(n.name=e.slice(1,s),n.base=e.slice(1,c)):(n.name=e.slice(a,s),n.base=e.slice(a,c)),n.ext=e.slice(s,c)),a>0?n.dir=e.slice(0,a-1):r&&(n.dir="/"),n},sep:"/",delimiter:":",win32:null,posix:null};i.posix=i,e.exports=i},674:(e,t)=>{if(Object.defineProperty(t,"__esModule",{value:!0}),t.isWindows=void 0,"object"==typeof process)t.isWindows="win32"===process.platform;else if("object"==typeof navigator){let e=navigator.userAgent;t.isWindows=e.indexOf("Windows")>=0}},796:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.uriToFsPath=t.URI=void 0;const i=n(674),o=/^\w[\w\d+.-]*$/,r=/^\//,s=/^\/\//;function a(e,t){if(!e.scheme&&t)throw new Error(`[UriError]: Scheme is missing: {scheme: "", authority: "${e.authority}", path: "${e.path}", query: "${e.query}", fragment: "${e.fragment}"}`);if(e.scheme&&!o.test(e.scheme))throw new Error("[UriError]: Scheme contains illegal characters.");if(e.path)if(e.authority){if(!r.test(e.path))throw new Error('[UriError]: If a URI contains an authority component, then the path component must either be empty or begin with a slash ("/") character')}else if(s.test(e.path))throw new Error('[UriError]: If a URI does not contain an authority component, then the path cannot begin with two slash characters ("//")')}const c="",l="/",u=/^(([^:/?#]+?):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/;class d{static isUri(e){return e instanceof d||!!e&&"string"==typeof e.authority&&"string"==typeof e.fragment&&"string"==typeof e.path&&"string"==typeof e.query&&"string"==typeof e.scheme&&"string"==typeof e.fsPath&&"function"==typeof e.with&&"function"==typeof e.toString}scheme;authority;path;query;fragment;constructor(e,t,n,i,o,r=!1){"object"==typeof e?(this.scheme=e.scheme||c,this.authority=e.authority||c,this.path=e.path||c,this.query=e.query||c,this.fragment=e.fragment||c):(this.scheme=function(e,t){return e||t?e:"file"}(e,r),this.authority=t||c,this.path=function(e,t){switch(e){case"https":case"http":case"file":t?t[0]!==l&&(t=l+t):t=l}return t}(this.scheme,n||c),this.query=i||c,this.fragment=o||c,a(this,r))}get fsPath(){return y(this,!1)}with(e){if(!e)return this;let{scheme:t,authority:n,path:i,query:o,fragment:r}=e;return void 0===t?t=this.scheme:null===t&&(t=c),void 0===n?n=this.authority:null===n&&(n=c),void 0===i?i=this.path:null===i&&(i=c),void 0===o?o=this.query:null===o&&(o=c),void 0===r?r=this.fragment:null===r&&(r=c),t===this.scheme&&n===this.authority&&i===this.path&&o===this.query&&r===this.fragment?this:new p(t,n,i,o,r)}static parse(e,t=!1){const n=u.exec(e);return n?new p(n[2]||c,k(n[4]||c),k(n[5]||c),k(n[7]||c),k(n[9]||c),t):new p(c,c,c,c,c)}static file(e){let t=c;if(i.isWindows&&(e=e.replace(/\\/g,l)),e[0]===l&&e[1]===l){const n=e.indexOf(l,2);-1===n?(t=e.substring(2),e=l):(t=e.substring(2,n),e=e.substring(n)||l)}return new p("file",t,e,c,c)}static from(e){const t=new p(e.scheme,e.authority,e.path,e.query,e.fragment);return a(t,!0),t}toString(e=!1){return _(this,e)}toJSON(){return this}static revive(e){if(e){if(e instanceof d)return e;{const t=new p(e);return t._formatted=e.external,t._fsPath=e._sep===f?e.fsPath:null,t}}return e}}t.URI=d;const f=i.isWindows?1:void 0;class p extends d{_formatted=null;_fsPath=null;get fsPath(){return this._fsPath||(this._fsPath=y(this,!1)),this._fsPath}toString(e=!1){return e?_(this,!0):(this._formatted||(this._formatted=_(this,!1)),this._formatted)}toJSON(){const e={$mid:1};return this._fsPath&&(e.fsPath=this._fsPath,e._sep=f),this._formatted&&(e.external=this._formatted),this.path&&(e.path=this.path),this.scheme&&(e.scheme=this.scheme),this.authority&&(e.authority=this.authority),this.query&&(e.query=this.query),this.fragment&&(e.fragment=this.fragment),e}}const h={58:"%3A",47:"%2F",63:"%3F",35:"%23",91:"%5B",93:"%5D",64:"%40",33:"%21",36:"%24",38:"%26",39:"%27",40:"%28",41:"%29",42:"%2A",43:"%2B",44:"%2C",59:"%3B",61:"%3D",32:"%20"};function m(e,t,n){let i,o=-1;for(let r=0;r<e.length;r++){const s=e.charCodeAt(r);if(s>=97&&s<=122||s>=65&&s<=90||s>=48&&s<=57||45===s||46===s||95===s||126===s||t&&47===s||n&&91===s||n&&93===s||n&&58===s)-1!==o&&(i+=encodeURIComponent(e.substring(o,r)),o=-1),void 0!==i&&(i+=e.charAt(r));else{void 0===i&&(i=e.substr(0,r));const t=h[s];void 0!==t?(-1!==o&&(i+=encodeURIComponent(e.substring(o,r)),o=-1),i+=t):-1===o&&(o=r)}}return-1!==o&&(i+=encodeURIComponent(e.substring(o))),void 0!==i?i:e}function g(e){let t;for(let n=0;n<e.length;n++){const i=e.charCodeAt(n);35===i||63===i?(void 0===t&&(t=e.substr(0,n)),t+=h[i]):void 0!==t&&(t+=e[n])}return void 0!==t?t:e}function y(e,t){let n;return n=e.authority&&e.path.length>1&&"file"===e.scheme?`//${e.authority}${e.path}`:47===e.path.charCodeAt(0)&&(e.path.charCodeAt(1)>=65&&e.path.charCodeAt(1)<=90||e.path.charCodeAt(1)>=97&&e.path.charCodeAt(1)<=122)&&58===e.path.charCodeAt(2)?t?e.path.substr(1):e.path[1].toLowerCase()+e.path.substr(2):e.path,i.isWindows&&(n=n.replace(/\//g,"\\")),n}function _(e,t){const n=t?g:m;let i="",{scheme:o,authority:r,path:s,query:a,fragment:c}=e;if(o&&(i+=o,i+=":"),(r||"file"===o)&&(i+=l,i+=l),r){let e=r.indexOf("@");if(-1!==e){const t=r.substr(0,e);r=r.substr(e+1),e=t.lastIndexOf(":"),-1===e?i+=n(t,!1,!1):(i+=n(t.substr(0,e),!1,!1),i+=":",i+=n(t.substr(e+1),!1,!0)),i+="@"}r=r.toLowerCase(),e=r.lastIndexOf(":"),-1===e?i+=n(r,!1,!0):(i+=n(r.substr(0,e),!1,!0),i+=r.substr(e))}if(s){if(s.length>=3&&47===s.charCodeAt(0)&&58===s.charCodeAt(2)){const e=s.charCodeAt(1);e>=65&&e<=90&&(s=`/${String.fromCharCode(e+32)}:${s.substr(3)}`)}else if(s.length>=2&&58===s.charCodeAt(1)){const e=s.charCodeAt(0);e>=65&&e<=90&&(s=`${String.fromCharCode(e+32)}:${s.substr(2)}`)}i+=n(s,!0,!1)}return a&&(i+="?",i+=n(a,!1,!1)),c&&(i+="#",i+=t?c:m(c,!1,!1)),i}function b(e){try{return decodeURIComponent(e)}catch{return e.length>3?e.substr(0,3)+b(e.substr(3)):e}}t.uriToFsPath=y;const v=/(%[0-9A-Za-z][0-9A-Za-z])+/g;function k(e){return e.match(v)?e.replace(v,(e=>b(e))):e}},679:function(e,t,n){var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,o)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return o(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Utils=void 0;const s=r(n(470)),a=s.posix||s,c="/";var l;!function(e){e.joinPath=function(e,...t){return e.with({path:a.join(e.path,...t)})},e.resolvePath=function(e,...t){let n=e.path,i=!1;n[0]!==c&&(n=c+n,i=!0);let o=a.resolve(n,...t);return i&&o[0]===c&&!e.authority&&(o=o.substring(1)),e.with({path:o})},e.dirname=function(e){if(0===e.path.length||e.path===c)return e;let t=a.dirname(e.path);return 1===t.length&&46===t.charCodeAt(0)&&(t=""),e.with({path:t})},e.basename=function(e){return a.basename(e.path)},e.extname=function(e){return a.extname(e.path)}}(l||(t.Utils=l={}))}},t={};function n(i){var o=t[i];if(void 0!==o)return o.exports;var r=t[i]={exports:{}};return e[i].call(r.exports,r,r.exports,n),r.exports}var i={};return(()=>{var e=i;Object.defineProperty(e,"__esModule",{value:!0}),e.Utils=e.URI=void 0;const t=n(796);Object.defineProperty(e,"URI",{enumerable:!0,get:function(){return t.URI}});const o=n(679);Object.defineProperty(e,"Utils",{enumerable:!0,get:function(){return o.Utils}})})(),i})(),e.exports=t()},2081:e=>{"use strict";e.exports=require("child_process")},6113:e=>{"use strict";e.exports=require("crypto")},7147:e=>{"use strict";e.exports=require("fs")},1808:e=>{"use strict";e.exports=require("net")},7261:e=>{"use strict";e.exports=require("node:util")},2037:e=>{"use strict";e.exports=require("os")},1017:e=>{"use strict";e.exports=require("path")},7310:e=>{"use strict";e.exports=require("url")},3837:e=>{"use strict";e.exports=require("util")}},t={};function n(i){var o=t[i];if(void 0!==o)return o.exports;var r=t[i]={exports:{}};return e[i].call(r.exports,r,r.exports,n),r.exports}n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var i={};(()=>{"use strict";var e=i;Object.defineProperty(e,"__esModule",{value:!0});const t=n(1017),o=n(8952),r=n(433),s=n(7237),a=n(7955),c=n(3939),l=n(701),u=n(9770),d=new r.TextDocuments(o.TextDocument),f=(0,c.set_Connection)((0,r.createConnection)(r.ProposedFeatures.all));let p,h=!1,m=!1,g="",y=new Set;async function _(e){if(!c.extsettings.commands?.includes("ahk2.executeCommand"))return f.window.showErrorMessage(e);await f.window.showErrorMessage(e,{title:"Select Interpreter"})&&f.sendRequest("ahk2.executeCommand",["ahk2.setinterpreter"])}async function b(e=!1,t=!0){let n=0,i=(0,u.runscript)('\n\t#NoTrayIcon\n\t#Warn All, Off\n\ts := "", _H := false, Append := SubStr(A_AhkVersion, 1, 1) = "1" ? "FileAppend2" : "FileAppend"\n\tfor _, p in ["a_ahkpath","a_appdata","a_appdatacommon","a_computername","a_comspec","a_desktop","a_desktopcommon","a_iscompiled","a_mydocuments","a_programfiles","a_programs","a_programscommon","a_startmenu","a_startmenucommon","a_startup","a_startupcommon","a_temp","a_username","a_windir","a_ahkversion"]\n\t\ts .= SubStr(p, 3) "`t" %p% "|"\n\ttry _H := !!A_ThreadID\n\t%Append%(s "is64bit`t" (A_PtrSize = 8) "|h`t" _H "`n", "*", "UTF-8")\n\tFileAppend2(text, file, encode) {\n\t\tFileAppend %text%, %file%, %encode%\n\t}');if(void 0===i)return t?b(e,!1):(_(c.setting.ahkpatherr()),!1);if(!(i=i.trim())){let i=c.ahkpath_cur;if((await C([i]))[0].endsWith("[UIAccess]")){let t=!1,r=i.replace(/_uia\.exe$/i,".exe");if(n=2,i!==r&&(r=(0,u.resolvePath)(r,!0))&&!(await C([r]))[0].endsWith("[UIAccess]")&&((0,c.set_ahkpath)(r),(t=await b(e))&&(n=0),(0,c.set_ahkpath)(i)),n&&f.window.showWarningMessage(c.setting.uialimit()),await o(),t)return!0}else n=1;return 2!==n&&t?b(e,!1):(c.a_vars.mydocuments||f.window.showErrorMessage(c.setting.getenverr()),!1)}if(Object.assign(c.a_vars,Object.fromEntries(i.replace(/\t[A-Z]:\\/g,(e=>e.toLowerCase())).split("|").map((e=>e.split("\t"))))),c.a_vars.ahkpath=c.ahkpath_cur,(0,c.set_version)(c.a_vars.ahkversion??="2.0.0"),c.a_vars.ahkversion.startsWith("1.")&&_(c.setting.versionerr()),!e||!c.libdirs.length){let e;for(e of(c.libdirs.length=0,c.libdirs.push(c.a_vars.mydocuments+"\\AutoHotkey\\Lib\\",c.a_vars.ahkpath.replace(/[^\\/]+$/,"Lib\\")),Object.values(c.libfuncs)))e.inlib=T(e.fsPath)}if(c.a_vars.h=(c.a_vars.h??"0").slice(0,1),"1"===c.a_vars.h?c.isahk2_h||((0,c.set_ahk_h)(!0),e=!1,(0,c.loadahk2)("ahk2_h"),(0,c.loadahk2)("winapi",4)):c.isahk2_h&&((0,c.set_ahk_h)(!1),e=!1,(0,c.initahk2cache)(),(0,c.loadahk2)()),await o(),e)return!0;for(const e in c.lexers){let t=c.lexers[e];t.d||(t.initLibDirs(),(Object.keys(t.include).length||t.diagnostics.length)&&t.update())}return(0,c.clearLibfuns)(),c.extsettings.AutoLibInclude>1&&k(),!0;async function o(){let e=new l.PEFile(c.ahkpath_cur);try{let t=await e.getResource(l.RESOURCE_TYPE.RCDATA);p=t}catch(e){}finally{e.close()}}}function v(e){return Object.assign(Object.values(e.declaration).filter((e=>e.kind===r.SymbolKind.Class||e.kind===r.SymbolKind.Function)),{fsPath:e.fsPath,islib:T(e.fsPath)})}async function k(){let e,t,n,i,o;for(e of c.libdirs)for await(t of(0,c.enum_ahkfiles)(e))if(!c.libfuncs[n=s.URI.file(t).toString().toLowerCase()]){if(!(i=c.lexers[n])&&(!(o=(0,c.openFile)(t))||(i=new c.Lexer(o)).d||(i.parseScript(),i.maybev1)))continue;c.libfuncs[n]=v(i),await(0,c.sleep)(50)}}function T(e){e=e.toLowerCase();for(const t of c.libdirs)if(e.startsWith(t.toLowerCase()))return!0;return!1}async function R(e,n){let i=!!e&&(0,t.resolve)(e,"..").toLowerCase()===(0,t.resolve)(n,"..").toLowerCase();return!!await b(i)&&(i||d.all().forEach((e=>{let t=c.lexers[e.uri.toLowerCase()];t&&(t.initLibDirs(t.scriptdir),1&c.extsettings.AutoLibInclude&&w(t.uri))})),!0)}async function S(e){let t=c.ahkpath_cur;return!(!e||e.toLowerCase()===t.toLowerCase()||((0,c.set_ahkpath)(e),await R(t,e)||(0,c.set_ahkpath)(t),0))}async function w(e){let t=c.lexers[e];if(!t||!e.startsWith("file:"))return;!t.d&&(c.libfuncs[e]??=v(t));let n,i,o="",r=!1;for await(n of((o=t.workspaceFolder)?(o=s.URI.parse(o).fsPath,r=!0):o=t.scriptdir+"\\lib",(0,c.enum_ahkfiles)(o)))if(!c.libfuncs[e=s.URI.file(n).toString().toLowerCase()]){if(!(t=c.lexers[e])){if(!(i=(0,c.openFile)(n))||(t=new c.Lexer(i)).d||(t.parseScript(),t.maybev1))continue;r&&((0,c.parse_include)(c.lexers[e]=t,t.scriptdir),(0,c.traverse_include)(t))}c.libfuncs[e]=v(t),await(0,c.sleep)(50)}}async function C(e){return Promise.all(e.map((async e=>{let t;try{t=new l.PEFile(e);let n=(await t.getResource(l.RESOURCE_TYPE.VERSION))[0].StringTable[0];if(n.ProductName?.toLowerCase().startsWith("autohotkey")){let e=await t.is_bit64,i=(await t.getResource(l.RESOURCE_TYPE.MANIFEST))[0]?.replace(/<!--[\s\S]*?-->/g,"")??"",o=`${n.ProductName} ${n.ProductVersion??"unknown version"} ${e?"64":"32"} bit`;return i.includes('uiAccess="true"')&&(o+=" [UIAccess]"),o}}catch(e){}finally{t?.close()}return"unknown version"})))}async function D(e,t=!1){let n={};for(let i of e){let e=await(0,l.searchAndOpenPEFile)(i,"1"===c.a_vars.is64bit||"0"!==c.a_vars.is64bit&&void 0);if(e)try{if((await e.getExport())?.Functions.forEach((e=>n[e.Name]=!0)),t)break}finally{e.close()}}return delete n[""],Object.keys(n)}function x(e){let t=(0,u.resolvePath)(c.ahkpath_cur,!0),n=`${t}:${e}`;if(!t)return;let i=s.URI.from({scheme:"ahkres",path:n}).toString().toLowerCase();if(c.lexers[i])return{uri:i,path:n};if(t=t.toLowerCase(),!e||!p)return;let r=p[e];if(r)try{return(c.lexers[i]=new c.Lexer(o.TextDocument.create(i,"ahk2",-10,new TextDecoder("utf8",{fatal:!0}).decode(r)))).parseScript(),{uri:i,path:n}}catch{delete p[e]}}f.onInitialize((async e=>{let n=e.capabilities;h=!(!n.workspace||!n.workspace.configuration),m=!(!n.workspace||!n.workspace.workspaceFolders);const i={serverInfo:{name:"ahk2-language-server"},capabilities:{textDocumentSync:{change:r.TextDocumentSyncKind.Incremental,openClose:!0},completionProvider:{resolveProvider:!1,triggerCharacters:[".","#","*","@"]},signatureHelpProvider:{triggerCharacters:["(",","]},documentSymbolProvider:!0,definitionProvider:!0,documentFormattingProvider:!0,documentRangeFormattingProvider:!0,documentOnTypeFormattingProvider:{firstTriggerCharacter:"}",moreTriggerCharacter:["\n",...Object.keys(c.chinese_punctuations)]},executeCommandProvider:{commands:["ahk2.diagnostic.full","ahk2.generate.comment","ahk2.resetinterpreterpath"]},hoverProvider:!0,foldingRangeProvider:!0,colorProvider:!0,codeActionProvider:!0,renameProvider:{prepareProvider:!0},referencesProvider:{workDoneProgress:!0},semanticTokensProvider:{legend:{tokenTypes:Object.values(c.SemanticTokenTypes).filter((e=>"string"==typeof e)),tokenModifiers:Object.values(c.SemanticTokenModifiers).filter((e=>"string"==typeof e))},full:!0,range:!0},workspaceSymbolProvider:!0}};let o;if(m&&(e.workspaceFolders?.forEach((e=>y.add(e.uri.toLowerCase()+"/"))),i.capabilities.workspace={workspaceFolders:{supported:!0}}),process.env.AHK2_LS_CONFIG)try{o=JSON.parse(process.env.AHK2_LS_CONFIG)}catch{}return e.initializationOptions&&(o=Object.assign(o??{},e.initializationOptions)),(0,c.set_dirname)((0,t.resolve)(__dirname,"../..")),(0,c.set_locale)(o?.locale??e.locale),c.utils.get_RCDATA=x,c.utils.get_DllExport=D,c.utils.get_ahkProvider=a.get_ahkProvider,(0,c.loadlocalize)(),(0,c.initahk2cache)(),o&&(0,c.update_settings)(o),await S((0,u.resolvePath)(c.extsettings.InterpreterPath??=""))||_(c.setting.ahkpatherr()),(0,c.set_WorkspaceFolders)(y),(0,c.loadahk2)(),i})),f.onInitialized((()=>{h&&f.client.register(r.DidChangeConfigurationNotification.type),m&&f.workspace.onDidChangeWorkspaceFolders((e=>{e.removed.forEach((e=>y.delete(e.uri.toLowerCase()+"/"))),e.added.forEach((e=>y.add(e.uri.toLowerCase()+"/"))),(0,c.set_WorkspaceFolders)(y)})),D(["user32","kernel32","comctl32","gdi32"].map((e=>`C:\\Windows\\System32\\${e}.dll`))).then((e=>c.winapis.push(...e)))})),f.onDidChangeConfiguration((async e=>{let t=e?.settings;if(h&&!t&&(t=await f.workspace.getConfiguration("AutoHotkey2")),!t)return void f.window.showWarningMessage("Failed to obtain the configuration");let{AutoLibInclude:n,InterpreterPath:i,Syntaxes:o}=c.extsettings;(0,c.update_settings)(t),(0,c.set_WorkspaceFolders)(y),i!==c.extsettings.InterpreterPath&&await S((0,u.resolvePath)(c.extsettings.InterpreterPath??=""))&&f.sendRequest("ahk2.updateStatusBar",[c.extsettings.InterpreterPath]),n!==c.extsettings.AutoLibInclude&&(c.extsettings.AutoLibInclude>1&&n<=1&&k(),1&c.extsettings.AutoLibInclude&&!(1&n)&&d.all().forEach((e=>w(e.uri.toLowerCase())))),o!==c.extsettings.Syntaxes&&((0,c.initahk2cache)(),(0,c.loadahk2)(),c.isahk2_h&&((0,c.loadahk2)("ahk_h"),(0,c.loadahk2)("winapi",4)))})),d.onDidOpen((e=>{let t=g===e.document.uri,n=e.document.uri.toLowerCase(),i=c.lexers[n];i?i.document=e.document:(c.lexers[n]=i=new c.Lexer(e.document),Object.defineProperty(i.include={},"",{value:"",enumerable:!1})),i.actived=!0,t&&(i.actionwhenv1="Continue"),1&c.extsettings.AutoLibInclude&&w(n).then((()=>i.last_diags&&Object.keys(i.included).length&&i.update()))})),d.onDidClose((e=>c.lexers[e.document.uri.toLowerCase()]?.close())),d.onDidChangeContent((e=>c.lexers[e.document.uri.toLowerCase()].update())),f.onCodeAction(c.codeActionProvider),f.onCompletion(c.completionProvider),f.onColorPresentation(c.colorPresentation),f.onDocumentColor(c.colorProvider),f.onDefinition(c.defintionProvider),f.onDocumentFormatting(c.documentFormatting),f.onDocumentRangeFormatting(c.rangeFormatting),f.onDocumentOnTypeFormatting(c.typeFormatting),f.onDocumentSymbol(c.symbolProvider),f.onFoldingRanges((e=>c.lexers[e.textDocument.uri.toLowerCase()].foldingranges)),f.onHover(c.hoverProvider),f.onPrepareRename(c.prepareRename),f.onReferences(c.referenceProvider),f.onRenameRequest(c.renameProvider),f.onSignatureHelp(c.signatureProvider),f.onExecuteCommand((function(e,t){if(t?.isCancellationRequested)return;let n=e.arguments||[];switch(e.command){case"ahk2.diagnostic.full":(0,c.diagnosticFull)();break;case"ahk2.generate.comment":(0,c.generateComment)();break;case"ahk2.resetinterpreterpath":S(n[0])}})),f.onWorkspaceSymbol(c.workspaceSymbolProvider),f.languages.semanticTokens.on(c.semanticTokensOnFull),f.languages.semanticTokens.onRange(c.semanticTokensOnRange),f.onRequest("ahk2.exportSymbols",(e=>(0,c.exportSymbols)(e))),f.onRequest("ahk2.getAHKversion",C),f.onRequest("ahk2.getContent",(e=>c.lexers[e.toLowerCase()]?.document.getText())),f.onRequest("ahk2.getVersionInfo",(e=>{let t=c.lexers[e.toLowerCase()];if(t){let n=t.get_token(0);if(("TK_BLOCK_COMMENT"===n.type||""===n.type)&&n.content.match(/^\s*[;*]?\s*@(date|version)\b/im))return{uri:e,content:n.content,range:{start:t.document.positionAt(n.offset),end:t.document.positionAt(n.offset+n.length)}}}return null})),f.onNotification("onDidCloseTextDocument",(e=>{"ahk2"===e.id?c.lexers[e.uri.toLowerCase()]?.close(!0):g=e.uri})),d.listen(f),f.listen()})();var o=exports;for(var r in i)o[r]=i[r];i.__esModule&&Object.defineProperty(o,"__esModule",{value:!0})})();
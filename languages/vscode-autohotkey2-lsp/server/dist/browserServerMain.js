var serverExportVar;(()=>{var e={7425:e=>{"use strict";function t(e){if("string"!=typeof e)throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}function n(e,t){for(var n,i="",o=0,r=-1,s=0,a=0;a<=e.length;++a){if(a<e.length)n=e.charCodeAt(a);else{if(47===n)break;n=47}if(47===n){if(r===a-1||1===s);else if(r!==a-1&&2===s){if(i.length<2||2!==o||46!==i.charCodeAt(i.length-1)||46!==i.charCodeAt(i.length-2))if(i.length>2){var c=i.lastIndexOf("/");if(c!==i.length-1){-1===c?(i="",o=0):o=(i=i.slice(0,c)).length-1-i.lastIndexOf("/"),r=a,s=0;continue}}else if(2===i.length||1===i.length){i="",o=0,r=a,s=0;continue}t&&(i.length>0?i+="/..":i="..",o=2)}else i.length>0?i+="/"+e.slice(r+1,a):i=e.slice(r+1,a),o=a-r-1;r=a,s=0}else 46===n&&-1!==s?++s:s=-1}return i}var i={resolve:function(){for(var e,i="",o=!1,r=arguments.length-1;r>=-1&&!o;r--){var s;r>=0?s=arguments[r]:(void 0===e&&(e=process.cwd()),s=e),t(s),0!==s.length&&(i=s+"/"+i,o=47===s.charCodeAt(0))}return i=n(i,!o),o?i.length>0?"/"+i:"/":i.length>0?i:"."},normalize:function(e){if(t(e),0===e.length)return".";var i=47===e.charCodeAt(0),o=47===e.charCodeAt(e.length-1);return 0!==(e=n(e,!i)).length||i||(e="."),e.length>0&&o&&(e+="/"),i?"/"+e:e},isAbsolute:function(e){return t(e),e.length>0&&47===e.charCodeAt(0)},join:function(){if(0===arguments.length)return".";for(var e,n=0;n<arguments.length;++n){var o=arguments[n];t(o),o.length>0&&(void 0===e?e=o:e+="/"+o)}return void 0===e?".":i.normalize(e)},relative:function(e,n){if(t(e),t(n),e===n)return"";if((e=i.resolve(e))===(n=i.resolve(n)))return"";for(var o=1;o<e.length&&47===e.charCodeAt(o);++o);for(var r=e.length,s=r-o,a=1;a<n.length&&47===n.charCodeAt(a);++a);for(var c=n.length-a,l=s<c?s:c,d=-1,u=0;u<=l;++u){if(u===l){if(c>l){if(47===n.charCodeAt(a+u))return n.slice(a+u+1);if(0===u)return n.slice(a+u)}else s>l&&(47===e.charCodeAt(o+u)?d=u:0===u&&(d=0));break}var f=e.charCodeAt(o+u);if(f!==n.charCodeAt(a+u))break;47===f&&(d=u)}var p="";for(u=o+d+1;u<=r;++u)u!==r&&47!==e.charCodeAt(u)||(0===p.length?p+="..":p+="/..");return p.length>0?p+n.slice(a+d):(a+=d,47===n.charCodeAt(a)&&++a,n.slice(a))},_makeLong:function(e){return e},dirname:function(e){if(t(e),0===e.length)return".";for(var n=e.charCodeAt(0),i=47===n,o=-1,r=!0,s=e.length-1;s>=1;--s)if(47===(n=e.charCodeAt(s))){if(!r){o=s;break}}else r=!1;return-1===o?i?"/":".":i&&1===o?"//":e.slice(0,o)},basename:function(e,n){if(void 0!==n&&"string"!=typeof n)throw new TypeError('"ext" argument must be a string');t(e);var i,o=0,r=-1,s=!0;if(void 0!==n&&n.length>0&&n.length<=e.length){if(n.length===e.length&&n===e)return"";var a=n.length-1,c=-1;for(i=e.length-1;i>=0;--i){var l=e.charCodeAt(i);if(47===l){if(!s){o=i+1;break}}else-1===c&&(s=!1,c=i+1),a>=0&&(l===n.charCodeAt(a)?-1==--a&&(r=i):(a=-1,r=c))}return o===r?r=c:-1===r&&(r=e.length),e.slice(o,r)}for(i=e.length-1;i>=0;--i)if(47===e.charCodeAt(i)){if(!s){o=i+1;break}}else-1===r&&(s=!1,r=i+1);return-1===r?"":e.slice(o,r)},extname:function(e){t(e);for(var n=-1,i=0,o=-1,r=!0,s=0,a=e.length-1;a>=0;--a){var c=e.charCodeAt(a);if(47!==c)-1===o&&(r=!1,o=a+1),46===c?-1===n?n=a:1!==s&&(s=1):-1!==n&&(s=-1);else if(!r){i=a+1;break}}return-1===n||-1===o||0===s||1===s&&n===o-1&&n===i+1?"":e.slice(n,o)},format:function(e){if(null===e||"object"!=typeof e)throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof e);return function(e,t){var n=t.dir||t.root,i=t.base||(t.name||"")+(t.ext||"");return n?n===t.root?n+i:n+"/"+i:i}(0,e)},parse:function(e){t(e);var n={root:"",dir:"",base:"",ext:"",name:""};if(0===e.length)return n;var i,o=e.charCodeAt(0),r=47===o;r?(n.root="/",i=1):i=0;for(var s=-1,a=0,c=-1,l=!0,d=e.length-1,u=0;d>=i;--d)if(47!==(o=e.charCodeAt(d)))-1===c&&(l=!1,c=d+1),46===o?-1===s?s=d:1!==u&&(u=1):-1!==s&&(u=-1);else if(!l){a=d+1;break}return-1===s||-1===c||0===u||1===u&&s===c-1&&s===a+1?-1!==c&&(n.base=n.name=0===a&&r?e.slice(1,c):e.slice(a,c)):(0===a&&r?(n.name=e.slice(1,s),n.base=e.slice(1,c)):(n.name=e.slice(a,s),n.base=e.slice(a,c)),n.ext=e.slice(s,c)),a>0?n.dir=e.slice(0,a-1):r&&(n.dir="/"),n},sep:"/",delimiter:":",win32:null,posix:null};i.posix=i,e.exports=i},6169:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.update_comment_tags=t.is_line_continue=t.check_same_name_error=t.make_same_name_error=t.get_detail=t.traverse_include=t.update_include_cache=t.get_callinfo=t.find_symbols=t.find_symbol=t.join_types=t.generate_type_annotation=t.decltype_returns=t.decltype_invoke=t.decltype_expr=t.find_class=t.get_class_constructor=t.get_class_members=t.get_class_member=t.get_class_base=t.parse_include=t.find_include_path=t.Lexer=t.allIdentifierChar=t.SUPER=t.THIS=t.VARREF=t.STRING=t.ANY=t.isIdentifierChar=t.FuncNode=t.SymbolNode=t.SemanticTokenModifiers=t.SemanticTokenTypes=t.FuncScope=void 0;const i=n(7351),o=n(7425),r=n(5751),s=n(1727),a=n(7237),c=n(4780),l=n(7994),d=n(3939);var u,f,p,h,g,m;function y(e){return!(e<48)&&(e<58||!(e<65)&&(e<91||(e<97?95===e:e<123||e>127)))}!function(e){e[e.DEFAULT=0]="DEFAULT",e[e.STATIC=1]="STATIC",e[e.GLOBAL=2]="GLOBAL"}(u||(t.FuncScope=u={})),function(e){e[e.class=0]="class",e[e.function=1]="function",e[e.method=2]="method",e[e.parameter=3]="parameter",e[e.variable=4]="variable",e[e.property=5]="property",e[e.keyword=6]="keyword",e[e.string=7]="string",e[e.number=8]="number",e[e.operator=9]="operator"}(f||(t.SemanticTokenTypes=f={})),function(e){e[e.static=1]="static",e[e.readonly=2]="readonly",e[e.definition=4]="definition",e[e.defaultLibrary=8]="defaultLibrary",e[e.deprecated=16]="deprecated"}(p||(t.SemanticTokenModifiers=p={})),function(e){e.create=function(e,t,n,i,o){return{name:e,kind:t,range:n,selectionRange:i,children:o}}}(h||(t.SymbolNode=h={})),function(e){e.create=function(e,t,n,i,o,r,s){let a="",c=!1,l=!1,d=[];o.format?.(o);for(let e of o)d.push(a.length),a+=`, ${e.pass_by_ref?(c=!0,++d[d.length-1],"&"):""}${e.name}${e.defaultVal?` := ${e.defaultVal}`:null===e.defaultVal?"?":e.arr?(l=!0,"*"):""}`;return{assume:u.DEFAULT,static:s,variadic:l,children:r,hasref:c,name:e,kind:t,range:n,selectionRange:i,params:o,param_offsets:d,param_def_len:a.length||2,full:`${s?"static ":""}${e}(${a.substring(2)})`,declaration:{},global:{},local:{},labels:{}}}}(g||(t.FuncNode=g={})),function(e){e.create=function(e,t,n){return{name:e,kind:t,range:n,selectionRange:{...n}}}}(m||(m={})),t.isIdentifierChar=y,String.prototype.trim=function(){return this.replace(/^[ \t\r\n]+|[ \t\r\n]+$/g,"")},String.prototype.trimLeft=function(){return this.replace(/^[ \t\r\n]+/,"")},String.prototype.trimRight=function(){return this.replace(/[ \t\r\n]+$/,"")};const _=new RegExp(/['"\s](c|background|#)?((0x)?[\da-f]{6}([\da-f]{2})?|(black|silver|gray|white|maroon|red|purple|fuchsia|green|lime|olive|yellow|navy|blue|teal|aqua))\b/i),b=JSON.parse('{ "black": "000000", "silver": "c0c0c0", "gray": "808080", "white": "ffffff", "maroon": "800000", "red": "ff0000", "purple": "800080", "fuchsia": "ff00ff", "green": "008000", "lime": "00ff00", "olive": "808000", "yellow": "ffff00", "navy": "000080", "blue": "0000ff", "teal": "008080", "aqua": "00ffff" }'),v=" \t\r\n",k="+ - * / % & ++ -- ** // = += -= *= /= //= .= == := != !== ~= > < >= <= >>> >> << >>>= >>= <<= && &= | || ! ~ , ?? ??= : ? ^ ^= |= =>".split(" "),T="try,throw,return,global,local,static,if,switch,case,for,while,loop,continue,break,goto".split(","),R=T.concat(["class","in","is","isset","contains","else","until","catch","finally","and","or","not","as","super"]),S={BlockStatement:"BlockStatement",Statement:"Statement",ObjectLiteral:"ObjectLiteral",ArrayLiteral:"ArrayLiteral",Conditional:"Conditional",Expression:"Expression"},w=/^(alttab|alttabandmenu|alttabmenu|alttabmenudismiss|shiftalttab|shift|lshift|rshift|alt|lalt|ralt|control|lcontrol|rcontrol|ctrl|lctrl|rctrl|lwin|rwin|appskey|lbutton|rbutton|mbutton|wheeldown|wheelup|wheelleft|wheelright|xbutton1|xbutton2|(0*[2-9]|0*1[0-6]?)?joy0*([1-9]|[12]\d|3[12])|space|tab|enter|escape|esc|backspace|bs|delete|del|insert|ins|pgdn|pgup|home|end|up|down|left|right|printscreen|ctrlbreak|pause|scrolllock|capslock|numlock|numpad0|numpad1|numpad2|numpad3|numpad4|numpad5|numpad6|numpad7|numpad8|numpad9|numpadmult|numpadadd|numpadsub|numpaddiv|numpaddot|numpaddel|numpadins|numpadclear|numpadleft|numpadright|numpaddown|numpadup|numpadhome|numpadend|numpadpgdn|numpadpgup|numpadenter|f1|f2|f3|f4|f5|f6|f7|f8|f9|f10|f11|f12|f13|f14|f15|f16|f17|f18|f19|f20|f21|f22|f23|f24|browser_back|browser_forward|browser_refresh|browser_stop|browser_search|browser_favorites|browser_home|volume_mute|volume_down|volume_up|media_next|media_prev|media_stop|media_play_pause|launch_mail|launch_media|launch_app1|launch_app2|vk[a-f\d]{1,2}(sc[a-f\d]+)?|sc[a-f\d]+|`[;{]|[\x21-\x7E])$/i,D={type:"",content:"",offset:0,length:0,topofline:0,next_token_offset:-1},C={collapse:2,expand:1,none:0},x={start:{line:0,character:0},end:{line:0,character:0}},K=["__NEW","__INIT","__ITEM","__ENUM","__GET","__CALL","__SET","__DELETE"];t.ANY=j("Any");const O=j("Float",r.SymbolKind.Number),E=j("Integer",r.SymbolKind.Number),P=j("Number",r.SymbolKind.Number);t.STRING=j("String",r.SymbolKind.String);const A=j("Array",r.SymbolKind.Class,"Array"),M=j("Object",r.SymbolKind.Class);t.VARREF=j("VarRef",r.SymbolKind.Class,"Any"),t.THIS={def:!0,detail:l.completionitem._this(),is_param:!0,kind:r.SymbolKind.Variable,name:"this",range:x,selectionRange:x},t.SUPER={...t.THIS,name:"super",detail:l.completionitem._super()},t.allIdentifierChar=new RegExp("^[^\0-/:-@[-^`{-]+$");let N=new RegExp("^;;\\s*(?<tag>.+)");const q={ANY:t.ANY,OBJECT:M,STRING:t.STRING,NUMBER:P,INTEGER:E,FLOAT:O,CLASS:t.ANY,FUNC:t.ANY,REGEXMATCHINFO:t.ANY},L={ANY:t.ANY,ARRAY:A,FLOAT:O,INTEGER:E,NUMBER:P,OBJECT:M,STRING:t.STRING,VARREF:t.VARREF,UNSET:j("unset",r.SymbolKind.Null)};class I{message;token;constructor(e,t){this.message=e,this.token=t}}class F{actionwhenv1;actived=!1;beautify;checkmember;children=[];d=0;d_uri="";declaration={};diagnostics=[];diags=0;last_diags=0;dlldir=new Map;dllpaths=[];document;find_token;foldingranges=[];fsPath="";get_token;include={};includedir=new Map;isparsed=!1;labels={};libdirs=[];linepos={};maybev1;object={method:{},property:{}};parseScript;scriptdir="";scriptpath="";STB=new r.SemanticTokensBuilder;symbolInformation;texts={};typedef={};tokenranges=[];tokens={};uri="";workspaceFolder="";hotstringExecuteAction=!1;constructor(e,n,o=0){let _,b,O,E,j,U,V,B,H,z,G,Q,J,Y,Z,ee,te,ne,ie,oe,re,ce,le,de,ue,fe,pe,he,ge,_e,be,ve,ke,Te,Re=this,Se=!0,we=!0,De=!1,Ce=d.isahk2_h,xe=!1,Ke=!1,Oe=!1,Ee=a.URI.parse(e.uri);const Pe={TK_START_EXPR:function(){tt()&&(oe.last_word="_"),(dt()||Q&&!ye(pe.previous_token??D,pe))&&Ge(null);let e=S.Expression;if("("!==he){if(pe.ignore)return Ye(e),ke="("!==pe.previous_token?.content,void Xe();if(pe.topofline<1&&X(pe.previous_token??D))return Ye(e),re.indentation_level=rt(),Xe(),oe.indentation_level=re.indentation_level+1,void(le.space_in_paren&&(ke=!0));(!Q&&pe.previous_token?.callsite||"TK_RESERVED"===be)&&(ke=!0),e=S.ArrayLiteral}else pe.ignore?Ge(!0):"TK_END_EXPR"===be||"TK_WORD"===be?ke=v.includes(pe.prefix_is_whitespace||"\0"):"TK_STRING"===be?ke=!0:"TK_RESERVED"===be&&(ke=!ve.match(/^(break|continue|goto)$/i)&&(["if","for","while","loop","case","catch","switch"].includes(ve)?Boolean(le.space_before_conditional):fe));if(et()||(Q&&le.preserve_newlines?Ge(!0):"TK_EQUALS"!==be&&"TK_COMMA"!==be&&"TK_OPERATOR"!==be||ze()),Ye(e),oe.indentation_level=re.indentation_level=rt(),Xe(),pe.ignore){let e=pe.data.content;e&&Xe(e)}else le.space_in_paren&&(ke=!0);Qe(),"["===he&&(oe.array_style??le.array_style)===C.expand&&Ge(!0)},TK_END_EXPR:function(){for(;oe.mode===S.Statement;)Ze();if("]"===he&&oe.mode===S.ArrayLiteral){let e=oe.array_style??le.array_style;e===C.collapse||"["===ve?Be():(e||Q&&le.preserve_newlines)&&Ge(!0)}else("TK_END_EXPR"===be||"TK_END_BLOCK"===be)&&oe.indentation_level<oe.parent.indentation_level?Be():"TK_START_EXPR"!==be&&ze();ke=Boolean(le.space_in_paren&&!("TK_START_EXPR"===be&&!le.space_in_empty_paren)),Ze(),He()&&ie.length>1&&re.indentation_level===oe.indentation_level&&Be(),Xe(),oe.mode!==S.BlockStatement&&(oe.indentation_level=(oe.parent??oe).indentation_level+1),E??=!1},TK_START_BLOCK:function(){if(pe.data)Ye(S.ObjectLiteral),oe.indentation_level=rt(),re.mode!==S.Conditional&&(re.indentation_level=oe.indentation_level),ke||=fe&&"TK_START_EXPR"!==be,Xe(),Qe(),(oe.object_style??le.object_style)===C.expand?Ge(!0):ke=fe;else{let e=oe.had_comment;if(!["try","if","for","while","loop","catch","else","finally","switch"].includes(oe.last_word))for(;oe.mode===S.Statement;)Ze();oe.declaration_statement=!1,Ye(S.BlockStatement),ke??=fe,re.in_case_statement&&!e&&"TK_LABEL"===be&&/^(default)?:$/.test(ve)&&(oe.indentation_level--,oe.case_body=null,Be()),(0===le.brace_style||Q&&le.preserve_newlines&&!le.brace_style)&&(void 0!==pe.in_expr&&oe.mode!==S.Expression||Ge(!0));let t=!He();Xe(),re.indentation_level=Math.min(re.indentation_level,oe.indentation_level=rt()),le.switch_case_alignment&&"switch"===oe.last_word||Qe(),t||void 0!==le.brace_style?Ge(!0):ke=fe}},TK_END_BLOCK:function(){for(;oe.mode===S.Statement;)Ze();let e=oe.mode===S.ObjectLiteral,t=e||void 0!==pe.in_expr;if(e){let e=oe.object_style??le.object_style;e===C.collapse||"{"===ve?Be():(e||Q&&le.preserve_newlines)&&Ge(!0),ke=fe&&"{"!==ve}else(void 0!==le.brace_style||Q)&&Ge(!0);Ze(),Xe(),t?oe.mode!==S.BlockStatement&&(oe.indentation_level=(oe.parent??oe).indentation_level+1):(null===re.case_body&&Qe(),void 0!==le.brace_style&&Ge(!0),ke=fe)},TK_WORD:at,TK_RESERVED:at,TK_STRING:function(){if(tt()?Q&&le.preserve_newlines?Ge(!0):ke=oe.declaration_statement?"TK_OPERATOR"!==be:fe:"TK_RESERVED"===be||"TK_WORD"===be?Q?Ge():ke=!0:"TK_COMMA"===be||"TK_START_EXPR"===be||"TK_EQUALS"===be||"TK_OPERATOR"===be?et()||ze():(Q&&Ge(),ke=!pe.ignore&&void 0===pe.data),pe.ignore){let e;if(Ge(!0),le.ignore_comment&&he.trimLeft().startsWith("(")&&(e=he.indexOf("\n"))>0){let t=he.slice(0,e).trimRight().replace(/\s+;.*$/,"");he=/(^\s*\(|\s)c(om(ments?)?)?/i.test(t)?`${t}\n${he.slice(e+1).replace(/^\s*;.*\r?\n/gm,"").replace(/\s+;.*/gm,"")}`:`${t}\n${he.slice(e+1)}`}return Xe(),void(ie[ie.length-1].text=[he])}Xe()},TK_EQUALS:function(){tt(),ke=fe,Xe(),ke=fe},TK_OPERATOR:function(){let e=Boolean(fe||he.match(/^\w/)),t=e;if(pe.previous_token?.callsite&&(ke=!0),tt()){if(oe.declaration_statement&&ge.match(/^(\+\+|--|%|!|~|not)$/))return ke=!0,oe.last_word="_",Xe(),void("not"===ge&&(ke=!0))}else if("=>"===he)oe.mode===S.BlockStatement?Ye(S.Statement):Te&&oe.parent.mode===S.BlockStatement&&(Te=!1),Qe(),oe.in_fat_arrow=!0;else if(ge.match(/^(\+\+|--|%|!|~|not)$/)&&dt())return Ge(),Xe(),void("not"===ge&&(ke=!0));return"TK_RESERVED"===be&&(ke=!0),"%"===he?(t=Boolean(void 0!==pe.previous_pair_pos&&" \t".includes(z.charAt(pe.offset+1)||"\0")),ke||=Boolean(pe.next_pair_pos&&" \t".includes(pe.prefix_is_whitespace||"\0")),Q&&le.preserve_newlines&&oe.mode===S.Statement&&ye(pe.previous_token??D,pe)&&Ge(!0),Xe(),void(ke=t)):":"===he&&(oe.in_case||oe.mode===S.Statement&&oe.parent.in_case)?(oe.in_case||Ze(),Qe(),Xe(),nt("\n")?Ge():ke=fe,oe.in_case=!1,oe.case_body=!0,Ye(S.Statement),oe.case_body=!0,void(_e="TK_LABEL")):(Q&&le.preserve_newlines?Ge(!0):"TK_OPERATOR"!==be||ve.match(/^(--|\+\+|%|!|~|not)$/)||ze(),["--","++","!","~"].includes(he)||"-+".includes(he)&&(["TK_START_BLOCK","TK_START_EXPR","TK_EQUALS","TK_OPERATOR","TK_COMMA","TK_RESERVED"].includes(be)||pe.previous_token?.callsite)?(t=!1,e="!"===he&&"TK_WORD"===be,ke||"++"!==he&&"--"!==he||!["TK_END_EXPR","TK_WORD"].includes(be)||(t=!0)):":"===he?oe.ternary_depth?(Ze(),oe.ternary_depth--):(e=!1,st()&&Be()):"?"===he?pe.ignore?(e=!1,t=Re.tokens[pe.next_token_offset]?.content.startsWith("?")??!1):(void 0===oe.ternary_depth?oe.ternary_depth=1:(oe.ternary_depth++,Qe()),Ye(S.Expression)):"."===he?t=e=!0:"&"===he?(("TK_WORD"!==be&&"TK_END_EXPR"!==be||pe.previous_token?.callsite)&&(t=!1),"TK_COMMA"!==be&&"TK_START_EXPR"!==be||(e=!1)):"*"===he&&(","===ve?t=!1:"TK_END_EXPR"===Re.tokens[pe.next_token_offset]?.type&&(e=t=!1)),ke||=e,Xe(),void(ke=t))},TK_COMMA:function(){(oe.mode===S.BlockStatement||oe.declaration_statement)&&(Ye(S.Statement),Qe()),"TK_WORD"===be&&v.includes(pe.prefix_is_whitespace||"\0")&&pe.previous_token?.callsite?Q&&le.preserve_newlines?Ge(!0):ke=!0:(ke=fe&&"TK_COMMA"===be||"for"===ve&&"TK_RESERVED"===be,oe.mode===S.Statement&&oe.parent.mode===S.ObjectLiteral&&Ze(),Q&&le.preserve_newlines?Ge(!0):He()||(Q=!1));let e=st();e&&Be(),Xe(),e===C.expand?Ge(!0):ke=fe},TK_BLOCK_COMMENT:function(){if(oe.mode===S.Statement){let e=Re.tokens[pe.previous_token?.next_token_offset];e&&(oe.in_expression||ye(e.previous_token??D,e))?oe.had_comment<2&&Be():Ge()}if(le.ignore_comment)return;let e=he.split("\n"),t=/^\/\*\*(?!\/)/.test(he),n="";t||(n=new RegExp(`^${z.substring(z.lastIndexOf("\n",pe.offset)+1,pe.offset)}`)),Ge(!0),Xe(e[0].trimRight());for(let i=1,o=e.length-1;i<o;i++)Ge(!0),Xe(t?e[i].replace(/^(\s*(\*?\s*(?=@)|\* ?))?/," * "):e[i].trimRight().replace(n,""));e.length>1&&(Ge(!0),Xe((t?" ":"")+e.at(-1).trim())),Ge(!0),oe.had_comment=3},TK_INLINE_COMMENT:function(){if(ct(he),le.ignore_comment)return;let e;He()&&ie.length>1&&ie.pop(),ie[ie.length-1].text.push(le.white_space_before_inline_comment||((e=pe.previous_token)?z.substring(e.skip_pos??e.offset+e.length,pe.offset):"\t"),he),Ge(!0),oe.had_comment=1},TK_COMMENT:function(){if(oe.mode===S.Statement){let e=Re.tokens[pe.previous_token?.next_token_offset];e&&(oe.in_expression||ye(e.previous_token??D,e))?oe.had_comment<2&&Be():Ge()}ct(he),le.ignore_comment||(he.split("\n").forEach((e=>{Ge(!0),Xe(e.trim())})),Ge(!0),oe.had_comment=2)},TK_DOT:function(){tt(),ze(")"===oe.last_text&&le.break_chained_methods),Xe()},TK_HOT:lt,TK_SHARP:lt,TK_NUMBER:function(){_e="TK_WORD",at()},TK_LABEL:function(){if(Ge(null),"default:"===ge&&(oe.in_case_statement||oe.mode===S.BlockStatement&&"switch"===oe.last_word))return oe.case_body?Je():oe.case_body=!0,Xe(),Qe(),oe.in_case=!1,oe.in_case_statement=!0,ke=fe,Ye(S.Statement),void(oe.case_body=!0);Xe();let e=ie.at(-1).text;""===e[0].trim()?ie[ie.length-1].text=e.slice(1):Qe()},TK_HOTLINE:lt,TK_UNKNOWN:function(){Xe(),1===Re.tokens[pe.next_token_offset]?.topofline&&Ge()}};function Ae(e,t){le={max_preserve_newlines:1},fe=!0,ue="\t",De=!0,de="",delete t.format;for(let n of t){if(!n.range_offset)continue;let[t,i]=n.range_offset;for(be=ve="",ie=[{text:[],indent:0}],ke=!1,ce=[],oe=null,Ye(S.Expression),pe=e[e[t].next_token_offset];pe&&pe.offset<i;pe=e[pe.next_token_offset])_e=pe.type,he=pe.content,ge=he.toLowerCase(),Pe[_e](),be=_e,oe.last_text=ve=ge;n.defaultVal=ie.map((e=>e.text.join(""))).join("\n").trim()}De=!1,ie=[]}function Me(){for(let e of Object.values(O))null===e.data&&/^[ \t]*\*?[ \t]*@typedef\s/m.test(e.content)&&We(Re,e.content,{})}function Ne(e,t=!1,n=l.diagnostic.maybev1()){if(Ke)return!1;switch(Re.maybev1??=1,Re.actionwhenv1??d.extsettings.ActionWhenV1IsDetected){case"SkipLine":if(!t)return!1;if(Re.addDiagnostic(l.diagnostic.skipline(),e.offset,e.length,r.DiagnosticSeverity.Warning),"TK_WORD"===e.type)do{let e=z.indexOf("\n",te);e<0&&(e=G);let t=z.substring(te,e).trimLeft();t.length&&Ue(t,"TK_STRING",e-t.length,t.length,0),te=e}while(nt(","));return!0;case"SwitchToV1":if(!Re.actived)break;d.connection.console.info([Re.document.uri,n,l.diagnostic.tryswitchtov1()].join(" ")),n="",(0,d.setTextDocumentLanguage)(Re.document.uri)&&(Re.actionwhenv1="SwitchToV1");break;case"Continue":return!1;case"Warn":if(!Re.actived)break;d.connection.window.showWarningMessage(`file: '${Re.fsPath}', ${n}`,{title:l.action.switchtov1(),action:"SwitchToV1"},{title:l.action.skipline(),action:"SkipLine"},{title:l.action.stopparsing(),action:"Stop"}).then((e=>{"Stop"!==(Re.actionwhenv1=e?.action??"Continue")&&("SwitchToV1"===Re.actionwhenv1?(0,d.setTextDocumentLanguage)(Re.document.uri):Re.update())}))}throw Re.clear(),te=G,new I(n,e)}function qe(e=0,n=Re,i=""){const o=[],s=Re.document,a=Re.tokens;let k,R,S,w,C,A=Re.tokens[te-1]??D,N=A.previous_token??D,q=0,L=!0,I="",F=[],$=[],U=j,V=xe;return we=!0,0!==e&&(F.push(te-1),delete A.data),j=n,xe=!1,Q(),j=U,xe=V,"TK_EOF"===A.type&&q>(0===e?0:-1)?Re.addDiagnostic(l.diagnostic.missing("}"),F[q-(0===e?1:0)],1):void 0!==C&&Re.addFoldingRange(C,N.offset,"region"),o;function B(){if("("!==z.charAt(A.offset+A.length))return!1;let e=N,t=A,n=Z,i=te,o="",r=0,s=A.topofline>0,a="";for(we=!1;ke();)if("("===(o=A.content))r++;else if(")"===o&&!--r){ke(),a=A.content;break}return N=e,A=t,Z=n,te=i,L=!0,"=>"===a||s&&"{"===a}function H(e){let i=e.op_type??=o(e);return(i>=0&&(1===e.topofline||!X(e.previous_token))||i<=0&&!function(i){switch(i?.type){case"TK_START_BLOCK":case"TK_START_EXPR":case"TK_NUMBER":case"TK_STRING":return!0;case"TK_WORD":return 1!==i.topofline||!t.allIdentifierChar.test(e.content)||!n.ranges;case"TK_RESERVED":return/^(class|isset|throw|super)$/.test(i.content.toLowerCase());case"TK_OPERATOR":return-1===(i.op_type??=o(i));case"TK_END_EXPR":case"TK_EOF":if(e.op_type<1&&"*"===e.content)return e.op_type=1;default:return!1}}(Re.get_token(e.offset+e.length,!0)))&&Re.addDiagnostic(l.diagnostic.missingoperand(),e.offset,e.length),e.op_type;function o(e){switch(e.content.toLowerCase()){case"!":case"~":case"not":return-1;case"%":return void 0===e.previous_pair_pos?-1:1;case"&":case"+":case"-":return e.topofline<1&&X(e.previous_token??D)?0:-1;case"++":case"--":return X(e)?1:-1;case":":return 0;case"?":return e.ignore?1:0;case"*":if(",([".includes(e.previous_token?.content??"\0")&&",),]()[]".includes(e.previous_token.content+(Re.get_token(e.offset+1,!0).content||"\0")))return-1;default:return 0}}}function Q(c=0){for("TK_START_BLOCK"===A.type&&(delete A.data,ke(),L=!1,A.topofline||N.topofline||Re.addDiagnostic(l.diagnostic.unexpected(A.content),A.offset,A.length));we=!0,ke();){let d;if(1===A.topofline){let n;R=A.offset,2===e?"TK_RESERVED"!==A.type&&t.allIdentifierChar.test(A.content)&&(A.type="TK_WORD",delete A.semantic):(n=nt(":"))&&($.length&&"default"===A.content.toLowerCase()&&":"===Re.get_token(n).content||n===te&&v.includes(z.charAt(te+1))&&t.allIdentifierChar.test(A.content)&&(!$.length||"case"!==A.content.toLowerCase()))&&((d=a[n])&&((A.next_token_offset=d.next_token_offset)>0&&(a[d.next_token_offset].previous_token=A),delete a[n]),A.content+=":",A.length=(te=n+1)-A.offset,A.type="TK_LABEL",delete A.semantic,R=void 0)}switch(A.type){case"TK_EOF":return;case"TK_WORD":if(A.topofline>0&&!A.ignore){let t=B();if(ke(),t||!Ce||2===e||1!==N.topofline||A.topofline||"TK_WORD"!==A.type||"macro"!==N.content.toLowerCase()||(A.topofline=1,(t=B())?ke():A.topofline=0),t){let t,a,c=N,d=o.length,u=N.semantic={type:2===e?f.method:f.function},h=de(!0),m=2===c.topofline,y=m?c.previous_token?.offset:c.offset;if(R=void 0,/^\d/.test(a=c.content.toUpperCase())&&Re.addDiagnostic(l.diagnostic.invalidsymbolname(c.content),c.offset,c.length),h||(h=[],Re.addDiagnostic(l.diagnostic.invalidparam(),c.offset,A.offset+1-c.offset)),c.symbol=c.definition=t=g.create(c.content,2===e?r.SymbolKind.Method:r.SymbolKind.Function,r.Range.create(c.pos=s.positionAt(c.offset),{line:0,character:0}),$e(c.offset,c.length),h,void 0,m),0!==e&&(t.parent=n),ke()&&"=>"===A.content){let i=o.splice(d),r=e,a=n;e=2===e?3:1,n=t,t.returns=[te,0];let c=se(void 0,"return",1);o.push(t),n=a,e=r,t.range.end=s.positionAt(t.returns[1]=N.offset+N.length),Re.addFoldingRangePos(t.range.start,t.range.end,"line"),t.children=i,i.push(...c),Re.linepos[t.range.end.line]=y}else{if("{"!==A.content){Re.addDiagnostic(l.diagnostic.unexpected(A.content),A.offset,A.length);break}{let n=o.splice(d),r=A.offset;A.previous_pair_pos=y,o.push(t),t.children=n,n.push(...qe(2===e?3:1,t,i)),t.range.end=s.positionAt(te),Re.addSymbolFolding(t,r)}}u.modifier=p.definition|p.readonly|m,(k=O[t.selectionRange.start.line])&&je(k.symbol=t,k),2===e&&(t.has_this_param=!0,t.full=`(${i.slice(0,-1)}) `+t.full,(Re.object.method[a]??=[]).push(t)),ve(t);break}if(2===e){if("["===z.charAt(N.offset+N.length)||A.content.match(/^(=>|\{)$/)){let t,a=N,c=o.length,d=[];if(R=void 0,"["===A.content&&(d=de(!0,"]")??[],ke(),0===d.length&&Re.addDiagnostic(l.diagnostic.propemptyparams(),a.offset,N.offset-a.offset+1),!A.content.match(/^(=>|\{)$/))){Re.addDiagnostic(l.diagnostic.propdeclaraerr(),a.offset,a.length),L=!1;break}let u=2===a.topofline,h=u?a.previous_token?.offset:a.offset,y=a.symbol=r.DocumentSymbol.create(a.content,void 0,r.SymbolKind.Property,t=$e(a.offset,a.length),{...t});(k=O[y.selectionRange.start.line])&&je(k.symbol=y,k),y.parent=n,y.has_this_param=!0,y.static=u,y.children=o.splice(c);let _="";if(d.length){let e=g.create("",r.SymbolKind.Function,t,t,d);_=`[${e.full.slice(1,-1)}]`,y.local=e.local,y.declaration=e.declaration,y.param_offsets=e.param_offsets,y.children.unshift(...d);for(let t of y.params=d)e.local[I=t.name.toUpperCase()]??=e.declaration[I]=t;for(let t of y.children)(t.def||t.kind===r.SymbolKind.Function)&&(e.declaration[t.name.toUpperCase()]??=t)}if(y.full=`(${i.slice(0,-1)}) ${u?"static ":""}${a.content}${_}`,o.push(y),be(a,y),a.semantic={type:f.property,modifier:p.definition|u},"{"===A.content){let t,n,o,c,u=e,f=A.offset;for(A.previous_pair_pos=h,ke(),L=!1,e=1,"TK_END_BLOCK"!==A.type||N.topofline||A.topofline||Re.addDiagnostic(l.diagnostic.unexpected(A.content),A.offset,A.length);ke()&&"TK_END_BLOCK"!==A.type;)if(A.topofline&&/^[gs]et$/.test(c=A.content.toLowerCase())){let a;if(ke(),t=N,"=>"===A.content)o=g.create(c,r.SymbolKind.Function,$e(N.offset,te-N.offset),$e(N.offset,N.length),[...d]),e=3,o.returns=[te,0],o.parent=y,o.children=se(void 0,"return",1),e=2,o.range.end=s.positionAt(o.returns[1]=N.offset+N.length),y.range.end=o.range.end,y.returns=o.returns,Re.addFoldingRangePos(o.range.start,o.range.end,"line"),"=>"===N.content&&Re.addDiagnostic(l.diagnostic.invaliddefinition("function"),t.offset,t.length),"set"===c?(o.params.unshift(a=m.create("Value",r.SymbolKind.Variable,r.Range.create(0,0,0,0))),a.is_param=a.assigned=a.def=!0,a.detail=l.completionitem.value()):y.returns=o.returns,o.has_this_param=!0,ve(o),Re.linepos[o.range.end.line]=t.offset;else if("{"===A.content)o=g.create(c,r.SymbolKind.Function,$e(t.offset,te-t.offset),$e(t.offset,3),[...d]),n=A,o.parent=y,o.children=qe(3,o,i),o.range.end=s.positionAt(te),"set"===c?(o.params.unshift(a=m.create("Value",r.SymbolKind.Variable,r.Range.create(0,0,0,0))),a.is_param=a.assigned=a.def=!0,a.detail=l.completionitem.value()):y.returns=o.returns,o.has_this_param=!0,ve(o),Re.addSymbolFolding(o,n.offset);else{if(o=void 0,Re.addDiagnostic(l.diagnostic.invalidprop(),A.offset,A.length),"}"===A.content){L=!1;break}{let e=0;for(;"TK_EOF"!==A.type;){if("{"===A.content)e++;else if("}"===A.content&&--e<0)break;ke()}L=!1}}o&&o!==(y[o.name]??=o)&&Re.addDiagnostic(l.diagnostic.dupdeclaration(),t.offset,t.length)}else{let e=0;for(Re.addDiagnostic(l.diagnostic.invalidprop(),A.offset,A.length),L=!1;ke();)if("{"===A.content)e++;else if("}"===A.content&&--e<0)break;L=!1}y.range.end=s.positionAt(te-1),e=u,Re.addSymbolFolding(y,f),y.get&&!y.set&&(a.semantic.modifier|=p.readonly)}else if("=>"===A.content){let n,i=te;e=3,n=g.create("get",r.SymbolKind.Function,t=$e(i,te-i),x,d),n.parent=y,y.get=n,y.returns=n.returns=[te,0],n.children=se(void 0,"return",1),e=2,y.range.end=n.range.end=s.positionAt(n.returns[1]=N.offset+N.length),Re.addFoldingRangePos(n.range.start,n.range.end,"line"),n.has_this_param=!0,ve(n),Re.linepos[y.range.end.line]=h,a.semantic.modifier|=p.readonly}break}A=N,N=D,L=!1,te=A.offset+A.length;let t=o.length,a=n;n=n.$property.__INIT;let c=ce("");n.children.push(...o.splice(t)),n=a,o.push(...c),c.forEach((e=>e.parent=a)),void 0!==R&&(Re.linepos[(N.pos??=s.positionAt(N.offset)).line]=R)}else ne(A),A=N,N=D,te=A.offset+A.length,ie(),void 0!==R&&(Re.linepos[(N.pos??=s.positionAt(N.offset)).line]=R);break}if(2===e){let e=o.length,t=n;n=n.$property.__INIT;let i=ce("");n.children.push(...o.splice(e)),n=t,o.push(...i),i.forEach((e=>e.parent=t))}else A.topofline?ie():(L=!1,o.push(...se())),void 0!==R&&(Re.linepos[(N.pos??=s.positionAt(N.offset)).line]=R);break;case"TK_SHARP":ae();break;case"TK_RESERVED":J();break;case"TK_START_BLOCK":2===e?Re.addDiagnostic(l.diagnostic.unexpected(A.content),A.offset,A.length):(q++,F.push(te-1));break;case"TK_END_BLOCK":if(--q>=0&&F.length){let e=F.pop();Re.addFoldingRange(A.previous_pair_pos=e,te-1),a[e].next_pair_pos=A.offset,1===A.topofline&&(Y=A.offset,_=!0)}if(q<c){if(0!==e||0!==c)return void(F.length&&void 0===A.previous_pair_pos&&(a[A.previous_pair_pos=F.at(-1)].next_pair_pos=A.offset));Re.addDiagnostic(l.diagnostic.unexpected("}"),A.offset,1),q=0,F.length=0}break;case"TK_END_EXPR":Re.addDiagnostic(l.diagnostic.unexpected(A.content),A.offset,1),R=void 0;break;case"TK_LABEL":if($.length&&"default:"===A.content.toLowerCase()){let e=$.pop();$.push(A.offset),e&&Re.addFoldingRange(e,N.offset,"case"),ke(),L=!1,A.topofline||=-1;break}if(2===e){Re.addDiagnostic(l.diagnostic.propdeclaraerr(),A.offset,A.length);break}A.symbol=S=h.create(A.content,r.SymbolKind.Field,$e(A.offset,A.length),$e(A.offset,A.length-1)),S.data=F.at(-1),o.push(S);let t=n.labels;t&&(I=A.content.toUpperCase().slice(0,-1),S.def=!0,t[I]?t[I][0].def?(Re.addDiagnostic(l.diagnostic.duplabel(),A.offset,A.length-1),t[I].splice(1,0,S)):t[I].unshift(S):t[I]=[S]),(k=O[S.selectionRange.start.line])&&je(S,k),(d=Re.get_token(te,!0)).topofline||Re.addDiagnostic(l.diagnostic.unexpected(d.content),d.offset,d.length);break;case"TK_HOTLINE":if(A.symbol=S=h.create(A.content,r.SymbolKind.Event,$e(A.offset,A.length),$e(A.offset,A.length-2)),S.range.end=s.positionAt(te-1),o.push(S),(k=O[S.selectionRange.start.line])&&je(S,k),0!==e&&Re.addDiagnostic(l.diagnostic.hotdeferr(),A.offset,A.length),A.ignore){for(;ke()&&A.ignore&&"TK_STRING"===A.type;);S.range.end=s.positionAt(N.offset+N.length),L=!1;break}W(A.content)||Re.addDiagnostic(l.diagnostic.invalidhotdef(),A.offset,A.length);break;case"TK_HOT":{0!==e?Re.addDiagnostic(l.diagnostic.hotdeferr(),A.offset,A.length):A.ignore||W(A.content)||Re.addDiagnostic(l.diagnostic.invalidhotdef(),A.offset,A.length);let t=h.create(A.content,r.SymbolKind.Event,$e(A.offset,A.length),$e(A.offset,A.length-2));(k=O[t.selectionRange.start.line])&&je(t,k),A.symbol=t,ke();let i,s=N;for(t.declaration={},o.push(t),t.global={},t.local={};"TK_SHARP"===A.type;)ae(),ke();if("{"===A.content)A.previous_pair_pos=s.offset,t.params=[i=m.create("ThisHotkey",r.SymbolKind.Variable,$e(0,0))],i.detail=l.completionitem.thishotkey(),t.children=qe(1,t),t.range=$e(s.offset,te-s.offset),Re.addSymbolFolding(t,A.offset),ve(t);else if(A.topofline){if(ve(t),L=!1,A.type.startsWith("TK_HOT"))break;"TK_WORD"===A.type&&B()||(Ne(s),Re.addDiagnostic(l.diagnostic.hotmissbrace(),s.offset,s.length)),L=!1}else{t.params=[i=m.create("ThisHotkey",r.SymbolKind.Variable,$e(0,0))],i.detail=l.completionitem.thishotkey();let a=n,c=e,d=A.content.toLowerCase(),u=o.length;n=t,e=1,"return"===d?t.children=se(void 0,"return"):["global","local","static"].includes(d)?(J(),t.children=o.splice(u)):(L=!1,re(null,s.offset),t.children=o.splice(u)),n=a,e=c,ve(t);let f=N.offset+N.length;for(;" \t".includes(z.charAt(f)||"\0");)f++;t.range=$e(s.offset,f-s.offset),Re.linepos[t.range.end.line]=s.offset}break}case"TK_UNKNOWN":Re.addDiagnostic(l.diagnostic.unknowntoken(A.content),A.offset,A.length);break;default:1===A.topofline&&(N!==D&&ye(N,A,n)?A.topofline=-1:N=D),L=!1,2===e?(Re.addDiagnostic(l.diagnostic.propdeclaraerr(),A.offset,A.length),se()):(o.push(...se()),void 0!==R&&(Re.linepos[(N.pos??=s.positionAt(N.offset)).line]=R))}}}function J(){let s,a=A.content.toLowerCase(),c=A.offset,h=N,m=te;if(we=!1,2===e){if(s=ot(),L=!1,te=m,A.type="TK_WORD",".[(".includes(z.charAt(A.offset+A.length))||s.content.match(/^(:=|=>|\{)$/))return;if("TK_EQUALS"===s.type||"class"!==a&&"static"!==a)return;s=void 0,L=!0,A.type="TK_RESERVED"}else if("%"===z.charAt(A.offset-1)||"%"===z.charAt(A.offset+A.length))return A.type="TK_WORD",L=!1,void(A.semantic={type:f.variable});switch(a){case"class":if(1!==A.topofline){L=!1,A.type="TK_WORD";break}let _,b="";if(ke(),A.topofline||"TK_RESERVED"!==A.type||(A.type="TK_WORD",2!==e&&Re.addDiagnostic(l.diagnostic.reservedworderr(A.content),A.offset,A.length)),!A.topofline&&"TK_WORD"===A.type){if(1&e&&Re.addDiagnostic(l.diagnostic.classinfuncerr(),A.offset,A.length),_=A,ke(),"extends"===A.content.toLowerCase())if(A=ot(),"TK_WORD"===A.type){for(b=A.content,_e(A,0,Re.children);te<G&&"."===z.charAt(te)&&(ot(),A=ot(),"TK_WORD"===A.type);)b+="."+A.content,be(A);"TK_WORD"===A.type&&ke()}else Re.addDiagnostic(l.diagnostic.unexpected(A.content),A.offset,A.length);if("TK_START_BLOCK"!==A.type){L=!1;break}A.previous_pair_pos=c,_.content.match(/^\d/)&&Re.addDiagnostic(l.diagnostic.invalidsymbolname(_.content),_.offset,_.length);let t=r.DocumentSymbol.create(_.content,void 0,r.SymbolKind.Class,x,$e(_.offset,_.length));_.symbol=_.definition=t,t.full=i+_.content,t.extends=b,t.uri=Re.uri,(k=O[t.selectionRange.start.line])&&je(t,k),t.prototype={...t,detail:void 0,property:t.$property={}},t.children=[],t.cache=[],t.property={},t.type_annotations=[t.full];let n=g.create("__Init",r.SymbolKind.Method,$e(0,0),$e(0,0),[],[],!0);return(t.property.__INIT=n).ranges=[],n.parent=t,n.full=`(${t.full}) static __Init()`,n=g.create("__Init",r.SymbolKind.Method,$e(0,0),$e(0,0),[],[]),(t.$property.__INIT=n).ranges=[],n.parent=t.prototype,n.full=`(${t.full}) __Init()`,t.children=qe(2,t,i+_.content+"."),t.range=t.prototype.range=$e(c,te-c),_.semantic={type:f.class,modifier:p.definition|p.readonly},ve(t),Re.addSymbolFolding(t,A.offset),o.push(t),!0}L=!1,N.type="TK_WORD",te=N.offset+N.length,A=N,N=h;break;case"global":case"static":case"local":if(ke(),2===e&&!A.topofline&&t.allIdentifierChar.test(A.content)&&(A.type="TK_WORD"),A.topofline)2===e?Re.addDiagnostic(l.diagnostic.propdeclaraerr(),N.offset,N.length):"local"===a||o.some((e=>e.kind===r.SymbolKind.Variable))?Re.addDiagnostic(l.diagnostic.declarationerr(),N.offset,N.length):n.assume="static"===a?u.STATIC:u.GLOBAL;else if("TK_WORD"===A.type||"TK_RESERVED"===A.type){if(0===e){L=!1,"global"!==a&&Re.addDiagnostic(l.diagnostic.declarationerr(),N.offset,N.length);break}if(2===e&&"static"!==a){Re.addDiagnostic(l.diagnostic.propdeclaraerr(),N.offset,N.length),L=!1;break}if("([".includes(z.charAt(te))||Re.get_token(te,!0).content.match(/^(\{|=>)$/))A.topofline=2;else{let t,i=o.length,r=n;2===e&&(A.topofline=2,n=n.property.__INIT);let s=n;if(L=!1,t=ce("global"===a?"":a),"global"===a)t.forEach((e=>s.global[e.name.toUpperCase()]??=e));else if(2===e){s.children.push(...o.splice(i)),n=r;for(const e of t)e.static=!0,e.full=e.full.replace(") ",") static "),e.parent=r}else{let e="static"===a;t.forEach((t=>{s.local[t.name.toUpperCase()]??=t,t.static=e,t.decl=!0}))}o.push(...t)}}else"TK_EQUALS"===A.type&&(te=N.offset+N.length,N.type="TK_WORD",A=N,N=h,2!==e&&Re.addDiagnostic(l.diagnostic.reservedworderr(A.content),A.offset,A.length));L=!1;break;case"loop":if(2===e){s=Re.get_token(te),L=!1,A.type="TK_WORD",":="!==s.content&&Re.addDiagnostic(l.diagnostic.propdeclaraerr(),A.offset,A.length);break}ke(),"TK_COMMA"===A.type&&Ne(N);let v,T=0,S=1,w="loop";if("TK_EQUALS"===A.type){te=N.offset+N.length,N.type="TK_WORD",A=N,N=h,L=!1,2!==e&&Re.addDiagnostic(l.diagnostic.reservedworderr(A.content),A.offset,A.length);break}if(2===e){Re.addDiagnostic(l.diagnostic.propdeclaraerr(),N.offset,N.length);break}if(h=N,(L=" \t,".includes(z.charAt(te)||"\0")&&"TK_WORD"===A.type&&["parse","files","read","reg"].includes(v=A.content.toLowerCase()))&&(T=1,S="parse"===v?3:2,A.type="TK_RESERVED",w+=" "+v,N.hover_word=A.hover_word=w,ke(),"TK_COMMA"===A.type&&ke()&&(A.topofline=0),L=!1),A.topofline&&"TK_COMMA"!==A.type||"TK_START_BLOCK"===A.type?T&&Re.addDiagnostic(l.diagnostic.acceptparams(w,`${T}~${S}`),h.offset,h.length):o.push(...se("{",w,T,S)),re(!1,c,!0))return;"TK_RESERVED"===A.type&&"until"===A.content.toLowerCase()&&(L=!0,R=A.offset,o.push(...se(void 0,"until",1)));break;case"for":{let t=[],n=[],i=0;for(nt("(")&&(s=ot());ke();)switch(A.type){case"TK_COMMA":i++;break;case"TK_RESERVED":if(!("class"===A.content.toLowerCase()&&1&e)){Re.addDiagnostic(l.diagnostic.reservedworderr(A.content),A.offset,A.length);break}A.type="TK_WORD";case"TK_WORD":let r=_e(A,0);r&&(r.def=r.assigned=!0,r.for_index=i,r.returns=t,r.data=n);break;case"TK_OPERATOR":return"in"===A.content.toLowerCase()?(t.push(A.offset+2),o.push(...le(void 0,void 0,"{")),t.push(N.offset+N.length),s&&(")"!==A.content?Re.addDiagnostic(l.diagnostic.missing(")"),s.offset,s.length):(L=!0,ke())),n.push(A.offset),re(!1,c,!0)||"TK_RESERVED"!==A.type||"until"!==A.content.toLowerCase()||(L=!0,R=A.offset,o.push(...se(void 0,"until",1))),void n.push(A.offset,i+1)):(Re.addDiagnostic(l.diagnostic.unknownoperatoruse(),A.offset,A.length),void(L=!1));default:L=!1;case"TK_END_EXPR":return void Re.addDiagnostic(l.diagnostic.unexpected(A.content),A.offset,A.length);case"TK_EQUALS":return void Re.addDiagnostic(l.diagnostic.reservedworderr(N.content),N.offset,N.length)}break}case"continue":case"break":case"goto":if(2===e){L=!1,A.type="TK_WORD",":="!==Re.get_token(te,!0).content&&Re.addDiagnostic(l.diagnostic.propdeclaraerr(),A.offset,A.length);break}if(ke(),xe||"goto"===a||Re.addDiagnostic(l.diagnostic.outofloop(),N.offset),"TK_COMMA"===A.type&&(Ne(N),Re.addDiagnostic(l.diagnostic.unexpected(","),A.offset,1)),A.topofline)L=!1,"goto"===a&&Re.addDiagnostic(l.diagnostic.acceptparams(a,1),N.offset,N.length);else{if(t.allIdentifierChar.test(A.content))"TK_NUMBER"===A.type&&"goto"!==a?A.content.match(/[^\d]/)&&Re.addDiagnostic(l.diagnostic.unexpected(A.content),A.offset,A.length):(A.ignore=!0,A.type="TK_WORD",y(A),delete A.semantic),ke(),L=!1;else if("("===z.charAt(N.offset+N.length)){let e=[];pe("(",")",void 0,void 0,e),e.forEach((e=>{e.content.indexOf("\n")<0&&y({content:e.content.slice(1,-1),offset:e.offset+1,length:e.length-2,type:"",topofline:0,next_token_offset:-1})})),ke(),L=!1}else{if("TK_STRING"!==A.type){te=N.offset+N.length,N.type="TK_WORD",A=N,N=h,L=!1,Re.addDiagnostic(l.diagnostic.reservedworderr(A.content),A.offset,A.length);break}Re.addDiagnostic(l.diagnostic.unexpected(A.content),A.offset,A.length),ke(),L=!1}A.topofline||Re.addDiagnostic(l.diagnostic.unexpected(A.content),A.offset,A.length)}break;case"as":case"catch":case"else":case"finally":case"until":Re.addDiagnostic(l.diagnostic.unexpected(A.content),A.offset,A.length);break;case"super":if(3===e){if("("!==z[te]){let e=Re.get_token(te,!0);"TK_DOT"===e.type||"["===e.content||e.topofline&&A.topofline||Re.addDiagnostic(l.diagnostic.syntaxerror(A.content),A.offset,A.length)}}else Re.addDiagnostic(l.diagnostic.invalidsuper(),A.offset,A.length);A.type="TK_WORD",L=!1;break;case"case":if($.length&&A.topofline){let e=$.pop();$.push(A.offset),e&&Re.addFoldingRange(e,N.offset,"case"),ke(),L=!1,":"===A.content||A.topofline?(L=":"===A.content,Re.addDiagnostic(l.diagnostic.unexpected(A.content),A.offset,A.length)):(o.push(...se(":","case",1,20)),":"!==A.content?(Re.addDiagnostic(l.diagnostic.unexpected(A.content),A.offset,A.length),L=!1):(L=!0,ke(),L=!1,"TK_START_BLOCK"===A.type?A.previous_pair_pos=c:A.topofline||=-1))}else A.type="TK_WORD",Re.addDiagnostic(l.diagnostic.reservedworderr(A.content),A.offset,A.length);break;case"try":if(ke(),L=!1,"TK_COMMA"===A.type&&Ne(N),re(!0,c),"TK_RESERVED"===A.type&&"else"!==A.content.toLowerCase()){for(;"catch"===A.content.toLowerCase();)L=!0,R=A.offset,ee();for(let e of["else","finally"])A.content.toLowerCase()===e&&(L=!0,R=A.offset,ke(),L=!1,re(!0,N.offset))}break;case"isset":he(z.charAt(A.offset+5));break;case"throw":if(d.ahk_version>=d.alpha_3){A.semantic={type:f.keyword},A.ignore=!0,A.type="TK_WORD",L=!1;break}default:if(s=it(),"TK_EQUALS"===s.type||s.content.match(/^([<>]=?|~=|&&|\|\||[.|?:^]|\*\*?|\/\/?|<<|>>|!?==?)$/))A.type="TK_WORD",te=m,Re.addDiagnostic(l.diagnostic.reservedworderr(A.content),A.offset,A.length);else if(N=A,A=s,L=!1,"return"===a||"throw"===a){"TK_COMMA"===A.type&&Ne(N);let t=A.offset;o.push(...se(void 0,a)),1&e&&"return"===a&&t<=N.offset&&(n.returns??=[]).push(t,N.offset+N.length)}else if("switch"===a)if(o.push(...se("{",a,0,2)),"{"===A.content){A.previous_pair_pos=c,L=!0,F.push(te-1),$.push(0),Q(++q);let e=$.pop();e&&Re.addFoldingRange(e,N.offset,"case"),ke(),L=!1}else Re.addDiagnostic(l.diagnostic.unexpected(A.content),A.offset,A.length);else"if"!==a&&"while"!==a||("TK_COMMA"===A.type&&Ne(N),o.push(...se("{",a,1)),re(!1,c,"while"===a))}function y(e){let t=n.labels;if(t){t[a=e.content.toUpperCase()]??=[];let n=$e(e.offset,e.length);t[a].push(e.symbol=S=r.DocumentSymbol.create(e.content,void 0,r.SymbolKind.Field,n,n)),S.data=F.at(-1)}}}function ee(){let e,n,i=A.offset;if(R=i,N=n=A,e=it(),e.topofline||"("!==e.content?(A=e,e=void 0):A=it(),A.topofline||"TK_WORD"!==A.type&&!t.allIdentifierChar.test(A.content))e?(te=e.offset-1,Re.addDiagnostic(l.diagnostic.unexpected(A.content),A.offset,A.length)):(L=!1,A.topofline||"{"===A.content?re(null,i):Re.addDiagnostic(l.diagnostic.unexpected(A.content),A.offset,A.length));else{let o=[];if(L=!0,"as"!==A.content.toLowerCase()){for(;;){let e="";if("TK_WORD"!==A.type?Re.addDiagnostic(l.diagnostic.unexpected(A.content),A.offset,A.length):(_e(A),e+=A.content),N=A,A=it(),"TK_DOT"===A.type)for(ke();;){if("TK_WORD"===A.type)be(A),e+="."+A.content,ke();else{if("%"!==A.content)break;Re.addDiagnostic(l.diagnostic.unexpected(A.content),A.offset,A.length),pe("%","%"),ke(),e="@"}if("TK_DOT"!==A.type)break;ke()}if(!e.startsWith("@")&&o.push(e),","!==A.content)break;if(N=A,A=it(),!t.allIdentifierChar.test(A.content))break}if(e){if("{"===A.content)return Re.addDiagnostic(l.diagnostic.missing(")"),e.offset,1),re(null,i);if(")"===A.content)return ke(),L=!1,re(null,i)}else if("{"===A.content||A.topofline)return L=!1,re(null,i)}if("as"===A.content.toLowerCase())if(N=A,A=it(),L=!1,"TK_WORD"===A.type||t.allIdentifierChar.test(A.content))if("TK_WORD"!==A.type)Re.addDiagnostic(l.diagnostic.reservedworderr(A.content),A.offset,A.length),A.type="TK_WORD";else{let t=it();if(te=A.offset+A.length,t.topofline||"{"===t.content||e&&")"===t.content){let n=_e(A);n&&(L=!0,n.def=n.assigned=!0,!o.length&&o.push("Error"),n.type_annotations=o),e&&(")"===t.content?(te=t.offset+1,L=!0):Re.addDiagnostic(l.diagnostic.missing(")"),e.offset,1)),L&&(ke(),L=!1,re(null,i))}else Re.addDiagnostic(l.diagnostic.unexpected(n.content),n.offset,n.length),L=!1}else Re.addDiagnostic(l.diagnostic.unexpected(n.content),n.offset,n.length);else e&&(")"===A.content?(N=A,A=it()):Re.addDiagnostic(l.diagnostic.missing(")"),e.offset,1)),A.topofline?(L=!1,re(null,i)):Re.addDiagnostic(l.diagnostic.unexpected(A.content),A.offset,A.length)}}function ne(e){let t=e.previous_extra_tokens;t&&(t.i=0)}function ie(){let e,t="";if(L=!0,ke(),L=!1,(e=A.ignore&&"?"===A.content)&&(A=ot()),"TK_EQUALS"===A.type||/^(=[=>]?|\?\??|:)$/.test(A.content)||"TK_DOT"!==A.type&&!", \t\r\n".includes(t=z.charAt(N.offset+N.length))){let e,t;/^=>?$/.test(A.content)&&(e=A.content,t=A.offset),ne(A),A=N,N=D,L=!1,te=A.skip_pos??A.offset+A.length,o.push(...se(void 0,e,t))}else if("TK_DOT"===A.type){let n=_e(N);for(L=!0,e&&n&&(n.returns=null);ke();){if("TK_WORD"===A.type){if("%"===z.charAt(te));else if(be(A),ke(),":="===A.content)ge(N);else if(A.ignore&&"?"===A.content&&(A=ot()),"TK_DOT"===A.type)continue;L=!1,"TK_EQUALS"!==A.type&&!"=??".includes(A.content||" ")&&", \t\r\n".includes(t=z.charAt(N.offset+N.length))?oe(r.SymbolKind.Method,t):o.push(...se())}else L=!1,o.push(...se());break}}else _e(N),oe(r.SymbolKind.Function,t)}function oe(e,t){let n,i,a,d=N,u={offset:d.offset,miss:[],comma:[],count:0,unknown:!1,name:d.content};if(","===t){if(e===r.SymbolKind.Function&&c.builtin_ahkv1_commands.includes(d.content.toLowerCase())&&Ne(d,!0))return;Re.addDiagnostic(l.diagnostic.funccallerr(),A.offset,1)}if("TK_OPERATOR"!==(a=A.type)||A.content.match(/^(not|\+\+?|--?|!|~|%|&)$/i)||Re.addDiagnostic(l.diagnostic.unexpected(A.content),A.offset,A.length),d.paraminfo=u,i=se(void 0,void 0,void 0,void 0,u),o.push(...i),e===r.SymbolKind.Method&&(d.semantic=void 0),d.ignore||(d.semantic??={type:e===r.SymbolKind.Function?f.function:(u.method=!0,f.method)}),n=r.DocumentSymbol.create(d.content,void 0,e,$e(d.offset,N.offset+N.length-d.offset),$e(d.offset,d.length)),n.paraminfo=u,n.offset=d.offset,d.callsite=n,N===d){let e=z.indexOf("\n",d.offset);n.range.end=s.positionAt(e<0?G:e)}e===r.SymbolKind.Method&&ge(d,!0),!b||!0!==b&&"TK_START_EXPR"!==a||Re.diagnostics.push({message:l.warn.callwithoutparentheses(),range:n.selectionRange,severity:r.DiagnosticSeverity.Warning})}function re(e,t,n=!1){let i=xe;if(xe||=n,we=!1,"TK_START_BLOCK"===A.type)A.previous_pair_pos=t,L=!0,F.push(te-1),Q(++q),ke(),L="TK_RESERVED"===A.type&&"else"===A.content.toLowerCase();else{if("TK_RESERVED"===A.type&&T.includes(A.content.toLowerCase())){let t=A;if(L=!0,J())return e;t!==A&&(t!==N||L||A.topofline)||(t===A&&"TK_WORD"===t.type?ie():o.push(...se()))}else"TK_WORD"===A.type?ie():"TK_EOF"!==A.type&&(N=D,L=!1,o.push(...se()));void 0!==R&&(Re.linepos[(N.pos??=s.positionAt(N.offset)).line]=R),L="TK_RESERVED"===A.type&&"else"===A.content.toLowerCase()}if(xe=i,"boolean"==typeof e){if(e)L=!1;else if(L)return R=A.offset,ke(),L=!1,re(!0,N.offset),!0}else L=!1;return!1}function se(e,t,n=0,i=1,o){let r,s,a,c=[],d=0,u=0,f=o??{offset:0,count:0,comma:[],miss:[],unknown:!1};if(we=!1,L){let e=Re.get_token(te,!0);r=e.content?e.offset:te+1,"TK_COMMA"===e.type?f.miss.push(f.count++):e.topofline&&!ye(A,e)||(++f.count,s=e)}else r=A.content?A.offset:N.offset+N.length+1,"TK_COMMA"===A.type?f.miss.push(f.count++):A.topofline&&!ye(N,A)||(++f.count,s=A);for(;;){if(c.push(...le(void 0,0,e)),a??=A.offset,"TK_COMMA"===A.type)L=!0,++d,++f.count,"TK_COMMA"===N.type||"TK_START_EXPR"===N.type?f.miss.push(f.comma.length):"TK_OPERATOR"!==N.type||N.ignore||N.content.match(/(--|\+\+|%)/)||Re.addDiagnostic(l.diagnostic.unexpected(","),A.offset,1),f.comma.push(A.offset),o&&(A.paraminfo=o);else{if(A.topofline){L=!1;break}if(e===A.content)break;u!==te&&(Re.addDiagnostic(l.diagnostic.unexpected(A.content),A.offset,A.length),L=!1)}if(u===te&&(!E||A.length))break;u=te}if("="===t||"=>"===t){let e=Re.find_token(r),i=!0,o=Re.tokens;if(e.offset<a){for(;e&&e.offset<a;){if(!e.ignore&&"?"===e.content){i=!1;break}e=e.symbol?Re.find_token(Re.document.offsetAt(e.symbol.range.end),!0):o[e.next_pair_pos??e.next_token_offset]}i&&("="===t&&Ne(o[s.next_token_offset]),Re.addDiagnostic(`${l.diagnostic.unexpected(t)}, ${l.diagnostic.didyoumean(":=").toLowerCase()}`,n,t.length))}}else t&&(d>=i||f.count-(A===s?1:0)<n)&&Re.addDiagnostic(l.diagnostic.acceptparams(t,i===n?n:`${n}~${i}`),r,N.offset+N.length-r);return"*"===N.content&&(f.unknown=!0,f.count--),c}function ae(){let t,n=!1,i=A.data??{content:"",offset:A.offset+A.length,length:0};switch(t=A.content.toLowerCase()){case"#dllload":n=!0;case"#include":case"#includeagain":Ie(i.content.replace(/`;/g,";"),i,e,n);break;case"#dllimport":if(w=i.content.match(/^((\w|[^\x00-\x7f])+)/i)){let e,t=$e(i.offset,w[0].length),n=r.Range.create(0,0,0,0),s={t:"ptr",i:"int",s:"str",a:"astr",w:"wstr",h:"short",c:"char",f:"float",d:"double",I:"int64"},a=w[0],c=[],d="",u=0,f="i";Ce=!0,w=i.content.substring(w[0].length).match(/^\s*,[^,]+,([^,]*)/),w=w?.[1].replace(/\s/g,"").toLowerCase().replace(/i6/g,"I")??"";for(let t of w.replace(/^(\w*)[=@]?=/,((e,t)=>(f=t||f,""))))if("u"===t)d="u";else if(s[t])c.push(e=m.create(`p${++u}_${d+s[t]}`,r.SymbolKind.Variable,n)),e.defaultVal=null,d="";else{if(!e||"*"!==t&&"p"!==t)return void Re.addDiagnostic(l.diagnostic.invalidparam(),i.offset,i.length);e.name+="p",e=void 0}let p=g.create(a,r.SymbolKind.Function,t,t,c);p.type_annotations=["fd".includes(f)?"Float":"asw".includes(f)?"String":"Integer"],o.push(p)}break;case"#requires":t=i.content.toLowerCase(),Ce||=t.startsWith("autohotkey_h"),(w=t.match(/^\w+\s+v(1|2)/))&&("2"===w[1]?Ke=!0:(Re.maybev1=3,Ne(i,!0,l.diagnostic.requirev1())||Re.addDiagnostic(l.diagnostic.unexpected(i.content),i.offset,i.length)));break;case"#hotif":0!==e?Re.addDiagnostic(l.diagnostic.invalidscope(A.content),A.offset,A.length):(void 0!==C&&Re.addFoldingRange(C,A.offset),ke(),L=!1,C=A.topofline?void 0:N.offset);break;case"#hotstring":t=i.content?.trim().toLowerCase()??"","nomouse"!==t&&"endchars"!==t&&(Re.hotstringExecuteAction=/x(?!0)/.test(t));break;default:t.match(/^#(if|hotkey|(noenv|persistent|commentflag|escapechar|menumaskkey|maxmem|maxhotkeysperinterval|keyhistory)\b)/i)&&!Ne(A,!0)&&Re.addDiagnostic(l.diagnostic.unexpected(A.content),A.offset,A.length)}}function ce(i){let a,c,u=[];we=!1;e:for(;ke();){if(1===A.topofline&&!ye(N,A,n)){L=!1;break}switch(A.type){case"TK_WORD":if(a=N,ke(),"TK_EQUALS"===A.type){let r,d=A.content,f=te;"TK_DOT"===a.type?be(N):(r=_e(N,e,u))?(c=O[r.selectionRange.start.line])&&je(r,c):i&&Re.addDiagnostic(l.diagnostic.conflictserr(i,"built-in variable",N.content),N.offset,N.length),o.push(...le(void 0));let p=[f,N.offset+N.length];n.ranges?.push(p),r&&(":="===d||"??="===d&&(r.assigned??=1)?r.returns=p:r.cached_types=[".="===d?t.STRING:P],r.assigned??=!0,r.def=!0,r.range.end=s.positionAt(N.offset+N.length),r.def=!0)}else{if(2===e){let e=N,s=A,a=l.diagnostic.propnotinit(),c=_e(N,2,u);if(c.def=!1,"TK_DOT"===A.type)for(;ke()&&"TK_WORD"===A.type&&ke();){if("TK_EQUALS"===A.type){let e=te;be(N),o.push(...le()),n.ranges?.push([e,N.offset+N.length]);continue e}if("TK_DOT"!==A.type){if(A.topofline&&(t.allIdentifierChar.test(A.content)||"}"===A.content)){N=D,L=!1;break e}a=","!==A.content?l.diagnostic.propdeclaraerr():"";break}be(N)}else if(!i&&":"===A.content){let i,u=A.offset+1,p=N,h="",g=n,m=j.property.__INIT,y=m.children.length,_=!1;if(delete c.def,c.typed=!0,d.ahk_version<d.alpha_3&&Re.addDiagnostic(l.diagnostic.requireversion("2.1-alpha.3"),N.offset,N.length,r.DiagnosticSeverity.Warning),N=A,A=ot(),a="",t.allIdentifierChar.test(A.content))i=A,h+=A.content,ke();else if("TK_START_EXPR"===A.type){let e=o.length;n=m,_=!0,pe(A.content,"("===A.content?")":"]"),m.children.push(...o.splice(e)),n=g,ke()}else":="===A.content||"TK_COMMA"===A.type||A.topofline&&t.allIdentifierChar.test(A.content)?(Re.addDiagnostic(l.diagnostic.unexpected(A.content),A.offset,A.length),L=!1):a=l.diagnostic.propdeclaraerr();if(!a){for(;;)if("."===A.content&&"TK_OPERATOR"!==A.type)"TK_DOT"!==A.type&&Re.addDiagnostic(l.diagnostic.unexpected("."),A.offset,A.length),ke()&&"TK_WORD"===A.type&&(h+="."+A.content,be(A),ke());else{if("TK_START_EXPR"!==A.type||A.prefix_is_whitespace||!t.allIdentifierChar.test(N.content))break;{let e,t=o.length,i=N,s=A,a="TK_DOT"===N.previous_token?.type;if(n=m,_=!0,pe(A.content,"("===A.content?")":e="]"),m.children.push(...o.splice(t)),!e){let e=r.DocumentSymbol.create(i.content,void 0,a?r.SymbolKind.Method:r.SymbolKind.Function,$e(i.offset,te-i.offset),$e(i.offset,i.length));Object.assign(s.paraminfo??{},{name:i.content}),e.paraminfo=s.paraminfo,e.offset=i.offset,i.callsite=e,i.semantic??={type:a?f.method:f.function}}n=g,ke()}}if(i&&(A.previous_token===i&&/^([iu](8|16|32|64)|f(32|64)|[iu]ptr)$/i.test(i.content)?c.type_annotations=[/^f/i.test(i.content)?"Float":"Integer"]:"TK_WORD"===i.type&&_e(i,3,m.children)),c.type_annotations??=_||!h?["Any"]:[h],":="===A.content){m.ranges?.push([u,A.offset-1]),u=A.offset+2,o.push(...le()),n.ranges?.push([u,N.offset+N.length]);continue e}if("TK_COMMA"===A.type||A.topofline&&(t.allIdentifierChar.test(A.content)||"}"===A.content)&&!(L=!1)){m.ranges?.push([u,A.offset-1]);continue e}Re.addDiagnostic(l.diagnostic.propdeclaraerr(),p.offset,p.length),m.children?.splice(y),e=A.previous_token??D,s=A,c.def=!1}}if(a&&Re.addDiagnostic(a,N.offset,N.length),A.topofline&&t.allIdentifierChar.test(A.content)){N=D,L=!1;break e}A.topofline||"TK_COMMA"===A.type||(L=!1,N=e,A=s,te=A.offset+A.length,le(",")),L=!1;break}if("TK_COMMA"===A.type||A.topofline&&(!["TK_COMMA","TK_OPERATOR","TK_EQUALS"].includes(A.type)||A.content.match(/^(!|~|not)$/i))){let t=_e(N,e,u);if(t?(c=O[t.selectionRange.start.line])&&je(t,c):i&&Re.addDiagnostic(l.diagnostic.conflictserr(i,"built-in variable",N.content),N.offset,N.length),"TK_COMMA"!==A.type)break e}}break;case"TK_COMMA":continue;case"TK_UNKNOWN":Re.addDiagnostic(l.diagnostic.unknowntoken(A.content),A.offset,A.length);break;case"TK_RESERVED":2!==e&&Re.addDiagnostic(l.diagnostic.reservedworderr(A.content),A.offset,A.length),L=!1,A.type="TK_WORD";break;case"TK_END_BLOCK":L=!1;break e;case"TK_END_EXPR":Re.addDiagnostic(l.diagnostic.unexpected(A.content),A.offset,1);default:break e}}return u}function le(i,a=1,c){let u,h=o.length,y=[],b=(L&&(ke(),L=!1),A.offset);for(we=!1;ke();){if(1===A.topofline){if(!(i&&","!==i||ye(N,A,n))){"TK_WORD"===N.type&&"."===z.charAt(N.offset-1)&&be(N),L=!1;break}N!==D&&(A.topofline=-1)}switch(A.type){case"TK_WORD":let T="."===z.charAt(A.offset-1);if("("===z.charAt(te))break;if(ke(),"TK_COMMA"===A.type){if(T)be(N);else if("%"!==z.charAt(N.offset-1)){let e=_e(N);e&&void 0!==u&&(e.def=e.assigned=!0,u?e.pass_by_ref=!0:e.cached_types=[P])}else N.ignore=!0;return L=!1,o.splice(h)}if("=>"===A.content){let t=o.length,s=N,l=e,d=te;e=1;let u=$e(s.offset,s.length),f=le(i,a||1,c??(y.length?":":void 0));e=l;let p=g.create("",r.SymbolKind.Function,$e(s.offset,N.offset+N.length-s.offset),$e(s.offset,0),[m.create(s.content,r.SymbolKind.Variable,u)],o.splice(t));p.children.push(...f),p.returns=[d,N.offset+N.length],0!==e&&(p.parent=n),ve(p),o.push(p);break}if(!("TK_OPERATOR"!==A.type||A.topofline&&A.content.match(/^(!|~|not|\+\+|--)$/i))){let e=!A.topofline&&["++","--"].includes(A.content);if("%"!==z.charAt(N.offset-1)&&"%"!==z.charAt(N.offset+N.length))if(T)be(N);else{let t=_e(N);t&&(void 0!==u&&(t.def=t.assigned=!0,u?t.pass_by_ref=!0:t.cached_types=[P]),e?(t.def=t.assigned=!0,t.cached_types=[P]):("??"===A.content||A.ignore)&&(t.returns=null))}else T?(ge(N,null),A=N,N=A.previous_token??D,ue(i),ke(),e||=!A.topofline&&["++","--"].includes(A.content)):N.ignore=!0;L=!1;continue}if(A.topofline&&"TK_EQUALS"!==A.type&&"TK_DOT"!==A.type){if(L=!1,T)"%"!==z.charAt(N.offset-1)?be(N):N.ignore=!0;else if("%"!==z.charAt(N.offset-1)){let e=_e(N);e&&void 0!==u&&(e.def=e.assigned=!0,u?e.pass_by_ref=!0:e.cached_types=[P])}else N.ignore=!0;return v(),o.splice(h)}if(T)(L="TK_EQUALS"===A.type)&&":="===A.content&&ge(N),be(N);else{let e;if("%"!==z.charAt(N.offset-1)&&(e=_e(N)))if(u?e.def=e.pass_by_ref=e.assigned=!0:!1===u&&"TK_DOT"!==A.type&&(e.def=e.assigned=!0,e.cached_types=[P]),"TK_EQUALS"===A.type){(k=O[e.selectionRange.start.line])&&je(e,k);let n=A.content,r=te;L=!0,o.push(...le(i,a||1,c??(y.length?":":void 0))),e.range.end=s.positionAt(N.offset+N.length),":="===n||"??="===n&&(e.assigned??=1)?e.returns=[r,N.offset+N.length]:e.cached_types=[".="===n?t.STRING:P],e.assigned??=!0,e.def=!0}else L=!1,e.pass_by_ref&&"TK_DOT"===A.type&&Re.addDiagnostic(l.diagnostic.requirevariable(),N.previous_token.offset,1);else L=!1,N.ignore=!0}break;case"TK_START_EXPR":if("["===A.content)pe("[","]");else{let t,u,h,m=A.offset,b=!N.type||"("===z.charAt(N.offset+N.length),v=o.length,k=A,T={offset:A.offset,count:0,comma:[],miss:[],unknown:!1};if("TK_WORD"===N.type&&b){if("."===z.charAt(N.offset-1)){let e,t=N;pe("(",")",void 0,T),t.semantic={type:f.method},e=r.DocumentSymbol.create(t.content,void 0,r.SymbolKind.Method,$e(t.offset,te-t.offset),$e(t.offset,t.length)),Object.assign(k.paraminfo??{},{name:t.content,method:!0}),e.paraminfo=T,e.offset=t.offset,t.callsite=e,ge(t,!0);continue}t=N}let R=!t||"%"!==z.charAt(t.offset-1)||void 0===t.previous_token?.previous_pair_pos;if(pe("(",")",void 0,T),u=te,R&&("=>"===(h=Re.get_token(te,!0)).content||!h.topofline&&"{"!==c&&"{"===h.content)){o.splice(v),N=(A=k).previous_token??D,te=A.offset+1;let b="=>"===h.content,T=(A.offset,de(!0)),R=o.splice(v),S=t?t.offset:m;u=te,ke(),t&&(t.content.match(/^\d/)&&Re.addDiagnostic(l.diagnostic.invalidsymbolname(t.content),t.offset,t.length),t.semantic={type:f.function,modifier:p.definition|p.readonly}),T||(T=[],Re.addDiagnostic(l.diagnostic.invalidparam(),S,u-S));let w=g.create(t?.content??"",r.SymbolKind.Function,$e(S,0),$e(S,t?.length??0),T),C=n,x=e;n=w,e=1,t??=k,o.push(t.symbol=t.definition=w),b?(w.children=R,R.push(...le(i,t?.topofline?2:a||1,c??(y.length?":":void 0))),w.range.end=Re.document.positionAt(N.offset+N.length),w.returns=[h.offset+h.length,N.offset+N.length]):(d.ahk_version<d.alpha_3&&Re.addDiagnostic(l.diagnostic.requireversion("2.1-alpha.3"),t.offset,te-t.offset,r.DiagnosticSeverity.Warning),A.in_expr=S,w.children=R,R.push(...qe(1,w)),w.range.end=s.positionAt(te),A=Re.tokens[A.next_pair_pos]??Re.find_token(te-1),A.in_expr=S,_=!1),n=C,e=x,Re.addFoldingRangePos(w.range.start,w.range.end,b?"line":void 0),0!==e&&(w.parent=n),ve(w)}else if(t)if("%"!==z.charAt(t.offset-1)||void 0===t.previous_token?.previous_pair_pos){let e;_e(t),t.semantic??={type:f.function},e=r.DocumentSymbol.create(t.content,void 0,r.SymbolKind.Function,$e(t.offset,u-t.offset),$e(t.offset,t.length)),Object.assign(k.paraminfo??{},{name:t.content}),e.paraminfo=T,e.offset=t.offset,t.callsite=e}else t.ignore=!0,delete t.semantic}break;case"TK_START_BLOCK":if(b<A.offset&&("TK_OPERATOR"!==N.type||1===N.op_type)&&"TK_EQUALS"!==N.type)return L=!1,v(),o.splice(h);{let e=Re.diagnostics.length,t=!1;if(A.offset,"TK_RESERVED"===N.type&&"switch"===N.content.toLowerCase()){let e;if(L=!1,A.topofline||(e=Re.get_token(te)).topofline||e.type.endsWith("COMMENT"))return v(),o.splice(h);L=t=!0}else"TK_EQUALS"===N.type?":=??=".includes(N.content)||Re.addDiagnostic(l.diagnostic.unknownoperatoruse(N.content),N.offset,N.length):1===a&&("TK_WORD"===N.type||"TK_OPERATOR"===N.type&&"=>"!==N.content||N.type.startsWith("TK_END"))&&(a=0);if(fe(a>0||t))break;return Re.diagnostics.splice(e),v(),L=!1,o.splice(h)}case"TK_NUMBER":case"TK_STRING":case"TK_EQUALS":break;case"TK_END_BLOCK":case"TK_END_EXPR":case"TK_COMMA":return L=!1,v(),o.splice(h);case"TK_LABEL":Re.addDiagnostic(l.diagnostic.unexpected(A.content),A.offset,A.length);break;case"TK_UNKNOWN":Re.addDiagnostic(l.diagnostic.unknowntoken(A.content),A.offset,A.length);break;case"TK_RESERVED":{let e=z.charAt(A.offset+A.length);if("%"===e||"%"===z.charAt(A.offset-1)){L=!1,A.type="TK_WORD",A.semantic={type:f.variable};break}if(/^(class|super|isset)$/i.test(A.content)){if("isset"===A.content.toLowerCase()&&he(e))break;L=!1,A.type="TK_WORD";break}if(d.ahk_version>=d.alpha_3&&"throw"===A.content.toLowerCase()){A.semantic={type:f.keyword},L=!1,A.type="TK_WORD",A.ignore=!0;break}Re.addDiagnostic(l.diagnostic.reservedworderr(A.content),A.offset,A.length);break}case"TK_OPERATOR":if("%"===A.content){let e=z.charAt(A.offset-1);if("%"===i)return L=!1,v(),o.splice(h);"."===e?(ge(A,null),ue()):pe("%","%")}else if("=>"===A.content&&"TK_WORD"===N.type){o.length&&o.at(-1).name===N.content&&o.pop();let t=g.create("",r.SymbolKind.Function,$e(N.offset,N.length),$e(N.offset,0),[m.create(N.content,r.SymbolKind.Variable,$e(N.offset,N.length))]);t.returns=[te,0],t.children=le(i,1,c??(y.length?":":void 0)),t.range.end=s.positionAt(t.returns[1]=N.offset+N.length),0!==e&&(t.parent=n),o.push(t),ve(t)}else{if(t.allIdentifierChar.test(A.content)&&("%"===z[A.offset-1]||"%"===z[A.offset+A.length])){L=!1,A.type="TK_WORD",A.semantic={type:f.variable};break}if(":"===A.content){if(void 0===y.pop()){if(":"===c)return L=!1,o.splice(h);Re.addDiagnostic(l.diagnostic.unexpected(":"),A.offset,1)}}else"?"===A.content&&(A.ignore||y.push(A.offset));if(-1===H(A)){if("&"===A.content){u=!0;continue}if(["++","--"].includes(A.content)){u=!1;continue}}}}u=void 0}return v(),o.splice(h);function v(){let e;for(;void 0!==(e=y.pop());)Re.addDiagnostic(l.diagnostic.missing(":"),e,1)}}function de(e=!1,t=")"){let n,i=!0,s=te-1,a=[],c=[",",")"===t?"(":"["],d=!1,u=te,f=A,p=!1,h={offset:s,count:0,comma:[],miss:[],unknown:!1};for(we=!1,f.paraminfo=h,"TK_WORD"===N.type&&void 0===f.prefix_is_whitespace&&(h.name=N.content);ke();){if(1===A.topofline&&(A.topofline=-1),A.content===t){if("TK_COMMA"===N.type){if(e){Re.addDiagnostic(l.diagnostic.unexpected(t),A.offset,A.length);break}return A.previous_pair_pos=s,N.paraminfo=h,h.miss.push(h.count++),void o.push(...a)}break}if("TK_WORD"!==A.type){if(c.includes(N.content)){if("*"===A.content){let e,n=A;if(ke(),A.content===t){a.push(e=m.create("",r.SymbolKind.Variable,$e(n.offset,0))),e.arr=!0;break}Re.addDiagnostic(l.diagnostic.unexpected("*"),n.offset,1)}else if("&"===A.content){let e=A;if(A=it(),"TK_WORD"===A.type){d=!0,L=!1;continue}Re.addDiagnostic(l.diagnostic.unexpected("&"),e.offset,1)}i=!1;break}i=!1;break}if(me(A.content.toLowerCase())){i=!1;break}if(h.count++,!c.includes(N.content)&&N!==D){i=!1,h.count--;break}if(ke(),","!==A.content&&A.content!==t){if(":="===A.content||e&&"="===A.content){"="===A.content&&(Ne(N),Re.addDiagnostic(`${l.diagnostic.unexpected("=")}, ${l.diagnostic.didyoumean(":=").toLowerCase()}`,A.offset,A.length));let e=A;N.content.match(/^\d/)&&Re.addDiagnostic(l.diagnostic.invalidsymbolname(N.content),N.offset,N.length);let n=m.create(N.content,r.SymbolKind.Variable,$e(N.offset,N.length));if((k=O[n.selectionRange.start.line])&&!k.symbol&&je(n,k),n.def=!0,n.defaultVal=null,a.push(n),o.push(...le(",",2)),L=!0,u=te,f=A,N!==e){n.returns=[e.offset+e.length,N.offset+N.length],n.range.end=Re.document.positionAt(N.offset+N.length);let t=A.previous_token,i=[];for(;t&&t!==e;)i.unshift(t),t=t.previous_token;1===i.length?"unset"!==i[0].content.toLowerCase()&&(n.defaultVal=i[0].content):2===i.length&&"-+".includes(i[0].content)?n.defaultVal=`${i[0].content}${i[1].content}`:(n.range_offset=[e.offset,A.offset],p=!0)}if(d&&(d=!1,n.pass_by_ref=n.assigned=!0),"TK_COMMA"===A.type){h.comma.push(A.offset),A.paraminfo=h;continue}i=A.content===t;break}if("TK_OPERATOR"===A.type){if("*"===A.content){let e=N;if(ke(),A.content===t){let t=m.create(e.content,r.SymbolKind.Variable,$e(e.offset,e.length));a.push(t),t.arr=!0,h.unknown=!0,u=te,f=A;break}i=!1,h.count--;break}if("?"===A.content&&A.ignore){let e=N,n=m.create(N.content,r.SymbolKind.Variable,$e(N.offset,N.length));if(n.def=!0,n.defaultVal=null,a.push(n),d&&(d=!1,n.pass_by_ref=n.assigned=!0),ke(),"TK_COMMA"===A.type){e.content.match(/^\d/)&&Re.addDiagnostic(l.diagnostic.invalidsymbolname(e.content),e.offset,e.length),h.comma.push(A.offset),u=te,f=A;continue}(i=A.content===t)||(a.pop(),h.count--);break}i=!1,h.count--;break}if(e&&"TK_WORD"===N.type&&"byref"===N.content.toLowerCase()&&"TK_WORD"===A.type){Ne(N),Re.addDiagnostic(l.diagnostic.deprecated("&","ByRef"),N.offset,A.topofline?N.length:A.offset-N.offset),L=!1,N=D;continue}i=!1,h.count--;break}{N.content.match(/^\d/)&&Re.addDiagnostic(l.diagnostic.invalidsymbolname(N.content),N.offset,N.length);let e=m.create(N.content,r.SymbolKind.Variable,$e(N.offset,N.length));if((k=O[e.selectionRange.start.line])&&e.selectionRange.start.line>(n??=Re.document.positionAt(s).line)&&je(e,k),d&&(d=!1,e.pass_by_ref=e.def=e.assigned=!0),a.push(e),u=te,f=A,","!==A.content)break;h.comma.push(A.offset),A.paraminfo=h}}return h.comma.forEach((e=>Re.tokens[e].paraminfo=h)),i?(p&&(a.format=Ae.bind(void 0,Re.tokens)),A.previous_pair_pos=s,Re.tokens[s].next_pair_pos=A.offset,Re.addFoldingRange(s,te,"block"),a):(o.push(...a),te=u,A=f,void pe(")"===t?"(":"[",t,s,h))}function ue(e){for(L=!1,te=A.offset+A.length;ke();)switch(A.type){case"TK_OPERATOR":if("%"===A.content){if("%"===e)return L=!1;if(pe("%","%"),y(z.charCodeAt(te)))break;return}case"TK_NUMBER":if(!t.allIdentifierChar.test(A.content))return L=!1;case"TK_RESERVED":case"TK_WORD":if(A.type="TK_WORD",A.semantic={type:f.property},"%"===z.charAt(te))break;return;default:return L=!1}}function fe(e=!1){let n,i,s=N,c=A,d=o.length,u=!0,p={},h=[];for(we=!1,L=!0,A.data=M;u;)if(!g()||_()){if(e&&!u){for(i=N,u=!0;!",}".includes(A.content);)le("}",2),L=!0;if(L=!0,Re.addDiagnostic(l.diagnostic.objectliteralerr(),i.offset,N.offset+N.length-i.offset),","===A.content)continue}break}if(u||e)for(let e of h)(n=a[e]).type="TK_WORD",n.semantic={type:f.property};if(!u)return N=s,A=c,o.splice(d),te=A.skip_pos??A.offset+A.length,L=!1;if(":"!==N.content&&"TK_LABEL"!==N.type||Re.addDiagnostic(l.diagnostic.unexpected(A.content),A.offset,A.length),c.data=M,"TK_END_BLOCK"===A.type){if(Re.addFoldingRange(A.previous_pair_pos=c.offset,A.offset),c.next_pair_pos=A.offset,Object.keys(p).length){let e=r.DocumentSymbol.create("",void 0,r.SymbolKind.Class,x,x);c.data=e,e.property=p,e.name=e.full=e.extends=""}A.data=c.data}else Re.addDiagnostic(l.diagnostic.missing("}"),c.offset,1);return!0;function g(){for(;ke();)switch(n=void 0,1===A.topofline&&(A.topofline=-1),A.type){case"TK_OPERATOR":if("%"===A.content){if(pe("%","%"),y(z.charCodeAt(te)))break;return ke(),":"===A.content||(u=!1)}case"TK_NUMBER":if(!t.allIdentifierChar.test(A.content))return u=!1;case"TK_RESERVED":case"TK_WORD":if(h.push(A.offset),"%"===z.charAt(te))break;let e=N;return ke(),":"===A.content?("%"!==e.content&&(n=N),!0):u=!1;case"TK_STRING":return ke(),":"===A.content?(n={...N},n.content=n.content.slice(1,-1),n.offset++,n.length-=2,!Ce&&Re.addDiagnostic(l.diagnostic.invalidpropname(),N.offset,N.length),!0):u=!1;case"TK_LABEL":return A.content.match(/^(\w|[^\x00-\x7f])+:$/)?(n={...A},n.content=n.content.slice(0,-1),n.length--,!0):u=!1;case"TK_END_BLOCK":if("TK_START_BLOCK"===N.type||"TK_COMMA"===N.type)return!1;case"TK_START_EXPR":return u=!1;case"TK_COMMA":if("TK_COMMA"===N.type||"TK_START_BLOCK"===N.type)return!0;default:return u=!1}return!1}function _(){let e=A,t=le(",");return o.push(...t),n&&(be(n),(p[n.content.toUpperCase()]=m.create(n.content,r.SymbolKind.Property,$e(n.offset,n.length))).returns=[e.offset+1,N.offset+N.length]),"TK_COMMA"===A.type?!(L=!0):"TK_END_BLOCK"===A.type?L=!0:"TK_EOF"===A.type||!(u=!1)}}function pe(i,c,u,h,y){let b,v=0,T=o.length,R=te,S=N,w=[u??=A.offset],D=0,C=Re.tokens[u],x=[],K=h??{offset:u,count:0,comma:[],miss:[],unknown:!1},E=!1;if("%"!==i){let e=C.previous_token;C.paraminfo=K,(K.name||!C.topofline&&e&&void 0===C.prefix_is_whitespace&&(void 0!==(e.previous_pair_pos??e.in_expr)||"TK_WORD"===e.type||"TK_DOT"===e.type))&&(E=!0)}else C.op_type=-1;for(;ke();){if(A.topofline){if("%"===i&&(!["TK_COMMA","TK_OPERATOR","TK_EQUALS"].includes(A.type)||A.content.match(/^(!|~|not)$/i)))return Ne(C),C.next_pair_pos=-1,Re.addDiagnostic(l.diagnostic.missing("%"),u,1),L=!1,void q();1===A.topofline&&(A.topofline=-1)}if("("!==i&&"("===A.content)T=o.length,R=te,D=1,S=N,pe("(",")");else if(A.content===c){if(a[A.previous_pair_pos=w.pop()].next_pair_pos=A.offset,"%"!==c?Re.addFoldingRange(A.previous_pair_pos,A.offset+1,"block"):A.op_type=1,--v<0)break;")"===c&&D++}else if(A.content===i){if("("===i){if(")"===z.charAt(A.offset-1)){pe("(",")");continue}T=o.length,R=te,D=0}v++,w.push(te-1),S=N}else if("=>"===A.content||1===D&&")"===N.content&&"{"===A.content){let t,i,a=o.splice(T),u=A,f=-1,p=A.content;if(")"===N.content){if(1!==D){Re.addDiagnostic(l.diagnostic.unknownoperatoruse(),A.offset,2),L=!0;continue}N=S,te=R-1,A=ot(),f=A.offset,a=[],t=de(!0),t||(t=[],Re.addDiagnostic(l.diagnostic.invalidparam(),f,A.offset-f+1)),i=it()}else{if("TK_WORD"!==N.type||"."===z.charAt(N.offset-1)){Re.addDiagnostic(l.diagnostic.unknownoperatoruse(),A.offset,2),L=!0;continue}i=A,f=N.offset,t=[m.create(N.content,r.SymbolKind.Variable,$e(N.offset,N.length))]}if(i.content!==p){A=u,te=u.offset+u.length,L=!0,o.push(...a),Re.addDiagnostic(l.diagnostic.unexpected(A.content),A.offset,A.length);continue}a.push(...o.splice(T));let h=g.create("",r.SymbolKind.Function,$e(f,0),$e(f,0),t,a);Re.tokens[f].symbol=h,"=>"===i.content?(a.push(...le(c,1,x.length?":":void 0)),h.range.end=Re.document.positionAt(N.offset+N.length),h.returns=[i.offset+2,N.offset+N.length]):(d.ahk_version<d.alpha_3&&Re.addDiagnostic(l.diagnostic.requireversion("2.1-alpha.3"),R-1,te-R,r.DiagnosticSeverity.Warning),i.in_expr=f,a.push(...qe(1,h)),h.range.end=s.positionAt(te),A=Re.tokens[A.next_pair_pos]??Re.find_token(te-1),A.in_expr=f,_=!1),0!==e&&(h.parent=n),T=o.length,o.push(h),ve(h),"=>"===p&&",:)]}".includes(A.content)&&(A.fat_arrow_end=!0)}else if("TK_WORD"===A.type)if("."!==z.charAt(A.offset-1))if("("!==z.charAt(te))if("%"===i||"%"!==z.charAt(A.offset-1)&&"%"!==z.charAt(A.offset+A.length)){let e=_e(A);if(e){if(ke(),L=!1,"TK_EQUALS"===A.type){(k=O[e.selectionRange.start.line])&&je(e,k);let n=A.content,i=te;L=!0,o.push(...le(c,2,x.length?":":void 0)),e.range.end=s.positionAt(N.offset+N.length),":="===n||"??="===n&&(e.assigned??=1)?e.returns=[i,N.offset+N.length]:e.cached_types=[".="===n?t.STRING:P],e.assigned??=!0,e.def=!0}else b||("TK_DOT"===A.type?b||=void 0:!A.topofline&&["++","--"].includes(A.content)&&(b=!1));void 0!==b?(e.def=e.assigned=!0,b?e.pass_by_ref=!0:e.cached_types=[P]):("??"===A.content||A.ignore&&"?"===A.content)&&(e.returns=null)}}else A.ignore=!0;else{N=A,A=ot();let t,i=N,a=A,u=o.length,h=de(),m=te,y="%"!==z.charAt(i.offset-1)||void 0===i.previous_token?.previous_pair_pos;if(ke(),y&&((t="=>"===A.content)||"{"===A.content)){let a=n,m=te;h||Re.addDiagnostic(l.diagnostic.invalidparam(),i.offset,A.offset-i.offset+1);let y=g.create(i.content,r.SymbolKind.Function,$e(i.offset,te-i.offset),$e(i.offset,i.length),h||[]);i.content.match(/^\d/)&&Re.addDiagnostic(l.diagnostic.invalidsymbolname(i.content),i.offset,i.length),i.symbol=i.definition=n=y,t?((y.children=o.splice(u)).push(...le(c,2,x.length?":":void 0)),y.range.end=s.positionAt(N.offset+N.length),y.returns=[m,N.offset+N.length]):(d.ahk_version<d.alpha_3&&Re.addDiagnostic(l.diagnostic.requireversion("2.1-alpha.3"),i.offset,te-i.offset,r.DiagnosticSeverity.Warning),A.in_expr=i.offset,(y.children=o.splice(u)).push(...qe(1,y)),y.range.end=s.positionAt(te),A=Re.tokens[A.next_pair_pos]??Re.find_token(te-1),A.in_expr=i.offset,_=!1),i.semantic={type:f.function,modifier:p.definition|p.readonly},n=a,0!==e&&(y.parent=n),ve(y),o.push(y),Re.addFoldingRangePos(y.range.start,y.range.end,t?"line":void 0)}else{if(y){let e;_e(i),e=r.DocumentSymbol.create(i.content,void 0,r.SymbolKind.Function,$e(i.offset,m-i.offset),$e(i.offset,i.length)),Object.assign(a.paraminfo??{},{name:i.content}),e.paraminfo=a.paraminfo,e.offset=i.offset,i.callsite=e,i.semantic??={type:f.function}}else i.ignore=!0,delete i.semantic;if(L=!1,h)for(const e of h)me(e.name.toLowerCase())||(o.push(e),(e.pass_by_ref||e.returns)&&(e.def=!0))}}else if("("===z.charAt(te)){let e,t,n=A;e=A=ot(),n.semantic={type:f.method},pe("(",")"),n.semantic={type:f.method},t=r.DocumentSymbol.create(n.content,void 0,r.SymbolKind.Method,$e(n.offset,te-n.offset),$e(n.offset,n.length)),Object.assign(e.paraminfo??{},{name:n.content,method:!0}),t.paraminfo=e.paraminfo,t.offset=n.offset,n.callsite=t,ge(n,!0)}else"%"!==i&&"%"===z.charAt(te)?(ge(A,null),ue(),ke(),L=!1):(be(A),ke(),L=!1,"TK_EQUALS"===A.type&&ge(N));else if("TK_START_BLOCK"===A.type)["TK_WORD","TK_STRING","TK_NUMBER"].includes(N.type)&&Re.addDiagnostic(l.diagnostic.unexpected("{"),A.offset,A.length),fe(!0);else if("TK_STRING"===A.type)y?.push(A),"["===i&&nt("]")&&!A.content.match(/\n|`n/)&&(M=A.content.substring(1,A.content.length-1),Re.texts[M.toUpperCase()]=M);else if("["===A.content)pe("[","]");else if("%"===A.content)"."===z.charAt(A.offset-1)?(ge(A,null),ue(c)):pe("%","%");else{if(A.type.startsWith("TK_END_"))return Re.addDiagnostic(l.diagnostic.unexpected(A.content),A.offset,1),I(),L=!1,void q();if("TK_RESERVED"===A.type){let e=z.charAt(A.offset+A.length);if("%"!==i&&("%"===e||"%"===z.charAt(A.offset-1))){L=!1,A.type="TK_WORD",A.semantic={type:f.variable};continue}if(/^(class|super|isset)$/i.test(A.content)){if("isset"===A.content.toLowerCase()&&he(e))continue;L=!1,A.type="TK_WORD";continue}if(d.ahk_version>=d.alpha_3&&"throw"===A.content.toLowerCase()){A.semantic={type:f.keyword},L=!1,A.type="TK_WORD",A.ignore=!0;continue}Re.addDiagnostic(l.diagnostic.reservedworderr(A.content),A.offset,A.length)}else if("TK_COMMA"===A.type)E&&(A.paraminfo=K),0===v&&"%"!==i&&(++K.count,"TK_COMMA"===N.type||"TK_START_EXPR"===N.type?K.miss.push(K.comma.length):N.ignore||"TK_OPERATOR"!==N.type||N.content.match(/(--|\+\+|%)/)||Re.addDiagnostic(l.diagnostic.unexpected(","),A.offset,1),K.comma.push(A.offset));else if("TK_OPERATOR"===A.type){if(t.allIdentifierChar.test(A.content)&&("%"===z[A.offset-1]||"%"===z[A.offset+A.length])){L=!1,A.type="TK_WORD",A.semantic={type:f.variable};continue}if(":"===A.content?void 0===x.pop()&&Re.addDiagnostic(l.diagnostic.unexpected(":"),A.offset,1):"?"===A.content&&(A.ignore||x.push(A.offset)),-1===H(A)){if("&"===A.content){b=!0;continue}if(["++","--"].includes(A.content)){b=!1;continue}}}}b=void 0}var M;function q(){let e;for(;void 0!==(e=x.pop());)Re.addDiagnostic(l.diagnostic.missing(":"),e,1)}function I(){let e;for(;void 0!==(e=w.pop());)Re.addDiagnostic(l.diagnostic.missing(c),e,1)}"TK_EOF"===A.type&&v>-1?("%"===c&&Ne(C),I()):a[A.previous_pair_pos].next_pair_pos=A.offset,"%"!==i&&(","===N.content?K.miss.push(K.count++):"TK_START_EXPR"!==N.type&&(K.count++,"*"===N.content&&(K.unknown=!0,K.count--))),q()}function he(e){let t=o.length;if(A.definition=d.ahkvars.ISSET,A.ignore=!0,A.type="TK_WORD",A.semantic={type:f.operator},"("===e){let e=A;_e(A),ke(),pe("(",")");let n=a[A.previous_pair_pos]?.paraminfo?.count??0;if(1!==n)d.extsettings.Diagnostics.ParamsCheck&&Re.addDiagnostic(l.diagnostic.paramcounterr(1,n),e.offset,te-e.offset);else if(o.length>t&&"TK_WORD"===N.type){let e=o.at(-1);N.content===e.name&&N.offset===Re.document.offsetAt(e.range.start)&&(e.assigned??=1,e.returns??=null)}return!0}Re.addDiagnostic(l.diagnostic.missing("("),A.offset,5)}function ge(e,t=!1){if(""===i)return;let o,s=e.previous_token?.previous_token;if(!s||"."===z.charAt(s.offset-1))return;if(I=s.content.toLowerCase(),"this"!==I&&"super"!==I)return;let c=n,l=!1;if(t){let t=e.callsite?.paraminfo;if(t&&"defineprop"===e.content.toLowerCase()&&t.count>1&&0!==t.miss[0]){if(d(),!c?.cache)return;let n=t.comma[0],s=a[e.next_token_offset];if("("===z.charAt(e.offset+e.length)&&(s=a[s.next_token_offset]),"TK_STRING"!==s.type||s.next_token_offset!==n)c.checkmember=!1;else{let e,t,d=a[a[n].next_token_offset],u=s.content.slice(1,-1);o=$e(s.offset+1,u.length),("TK_START_BLOCK"!==d.type||!(t=d.data?.property)||t.GET||t.VALUE||t.SET)&&(e=m.create(u,r.SymbolKind.Property,o),e.full=`(${i.slice(0,-1)}) ${(e.static=l)?"static ":""}${u}`,c.cache.push(e),e.parent=l?c:c.prototype,(e.returns=t?.GET?.returns)?e.alias=!0:e.returns=t?.VALUE?.returns),(t=t?.CALL)&&(e=m.create("",r.SymbolKind.Variable,$e(0,0)),e.arr=!0,e=g.create(u,r.SymbolKind.Method,o,o,[e],void 0,l),e.full=`(${i.slice(0,-1)}) `+e.full,e.returns=t.returns,e.alias=!0,c.cache.push(e),e.parent=l?c:c.prototype)}}}else{if(d(),!c?.cache)return;if(null===t)return void(c.checkmember=!1);let n=m.create(e.content,r.SymbolKind.Property,o=$e(e.offset,e.length));n.static=l,c.cache.push(n),n.def=!1,n.parent=l?c:c.prototype}return;function d(){if(c.kind===r.SymbolKind.Method||c.kind===r.SymbolKind.Function)for(;c&&c.kind!==r.SymbolKind.Class;)c.static&&c.kind===r.SymbolKind.Method&&(l=!0),c=c.parent;c?.kind===r.SymbolKind.Property&&(l=!!c.static,c=c.parent)}}function me(e,t=0){return 2!==t&&!!(c.builtin_variable.includes(e)||Ce&&c.builtin_variable_h.includes(e))}function _e(e,t=0,n){let s=e.content.toLowerCase();if(e.ignore||me(s,t)&&(e.ignore=!0))return void((e.definition=d.ahkvars[s.toUpperCase()])?.uri&&(n??o).push(m.create(e.content,r.SymbolKind.Variable,$e(e.offset,e.length))));if(!e.length)return;let a=$e(e.offset,e.length),c=m.create(e.content,r.SymbolKind.Variable,a);return 2===t?(c.kind=r.SymbolKind.Property,be(e,c),i&&(c.full=`(${i.slice(0,-1)}) ${c.name}`,e.symbol=c)):s.match(/^\d/)&&Re.addDiagnostic(l.diagnostic.invalidsymbolname(e.content),e.offset,e.length),(n??o).push(c),c}function be(e,t){let n=Re.object.property[e.content.toUpperCase()]??=[];e.semantic??={type:f.property},t?n.unshift(t):n[0]??=m.create(e.content,r.SymbolKind.Property,$e(e.offset,e.length))}function ve(e){let n,i=r.DiagnosticSeverity.Error,o=Re.diagnostics,c=!1,d={};if(e.kind===r.SymbolKind.Class){let t=e,c=t.$property,d=t.property??={},u=t.children??=[],f=[d.__INIT],p=t.prototype;ve(d.__INIT),c.__INIT?.ranges?.length?(ve(c.__INIT),f.push(c.__INIT)):delete c.__INIT,d.PROTOTYPE={...p,children:void 0,name:"Prototype",kind:r.SymbolKind.Property,full:`(${t.full}) Prototype`,selectionRange:x,type_annotations:[t.full]},u.forEach((e=>{if(I=e.name.toUpperCase(),K.includes(I)&&delete(a[s.offsetAt(e.selectionRange.start)]??{}).semantic,e.children){let t=e.static||e.kind===r.SymbolKind.Class?d:(e.parent=p,c);if(n=t[I])if(n.kind!==r.SymbolKind.Property||n.children?.length){if(n.kind!==e.kind&&![e.kind,n.kind].includes(r.SymbolKind.Class)){let i,o=n.kind===r.SymbolKind.Property?(i=e,n):(i=n,e);if(!o.call)return o.call=i,t[I]=o}o.push({message:l.diagnostic.dupdeclaration(),range:e.selectionRange,severity:i})}else(e.children.length||e.kind!==r.SymbolKind.Property)&&(t[I]=e);else t[I]=e}})),u.forEach((e=>{if(e.children)return;let t=e.static?d:(e.parent=p,c);if(!(n=t[I=e.name.toUpperCase()]))return!1===e.def||(t[I]=e);if(!0!==n.typed||!(e.typed||!e.children&&(n.typed=1))){if(n.children&&(!e.typed||e.range.start.line<n.range.start.line)){let t=n;if(!t.val)return t.val=e}!1!==e.def&&o.push({message:l.diagnostic.dupdeclaration(),range:e.selectionRange,severity:i})}})),u.push(...f,...t.cache??[]),t.cache?.forEach((e=>(e.static?d:c)[I=e.name.toUpperCase()]??=e)),delete t.cache}else{let s,a=e,f=a.declaration,p={},h={},g=a.has_this_param,m=[];g&&(d.THIS=f.THIS=t.THIS,d.SUPER=f.SUPER=t.SUPER,a.kind!==r.SymbolKind.Method&&(m=void 0));for(let e of a.params??[])e.def=e.assigned=e.is_param=!0,e.name&&(m?.push(e),void 0!==e.defaultVal||e.arr?c=!0:c&&o.push({message:l.diagnostic.defaultvalmissing(e.name),range:e.selectionRange,severity:i}),(n=d[I=e.name.toUpperCase()])?o.push({message:l.diagnostic.conflictserr("parameter","parameter",n.name),range:e.selectionRange,severity:i}):d[I]=f[I]=p[I]=e);for(let[e,t]of Object.entries(a.local??{}))(n=d[e])?o.push({message:l.diagnostic.conflictserr(t.static?"static":"local","parameter",n.name),range:t.selectionRange,severity:i}):(f[e]=t,t.assigned||=Boolean(t.returns));for(let[e,t]of Object.entries(a.global??{})){if(n=f[e]){if(d[e]){o.push({message:l.diagnostic.conflictserr("global","parameter",n.name),range:t.selectionRange,severity:i});continue}let r=t.static?"static":"local";if(o.push({message:l.diagnostic.conflictserr(...n.selectionRange.start.line<t.selectionRange.start.line?(n=t,["global",r]):[r,"global"],n.name),range:n.selectionRange,severity:i}),t!==n)continue;delete a.local[e]}f[e]??=t,Re.declaration[e]??=t,t.assigned||=Boolean(t.returns),t.is_global=!0}for(let e of a.children??=[])if(I=e.name.toUpperCase(),e.kind===r.SymbolKind.Function){let t=e;if(t.static||(t.closure=!0),!I)continue;if(f[I]){if(n=d[I]){o.push({message:l.diagnostic.conflictserr("function","parameter",n.name),range:e.selectionRange,severity:i});continue}if(n=a.global[I]){if(o.push({message:l.diagnostic.conflictserr(...n.selectionRange.start.line<e.selectionRange.start.line||n.selectionRange.start.line===e.selectionRange.start.line&&n.selectionRange.start.character<e.selectionRange.start.character?(n=e,["function","global"]):["global","function"],n.name),range:n.selectionRange,severity:i}),e===n)continue;delete a.global[I],delete n.is_global,Re.declaration[I]===n&&delete Re.declaration[I]}else if(n=a.local[I]){if(n.selectionRange.start.line<e.selectionRange.start.line||n.selectionRange.start.line===e.selectionRange.start.line&&n.selectionRange.start.character<e.selectionRange.start.character){o.push({message:l.diagnostic.conflictserr("function",n.kind===r.SymbolKind.Function?"Func":n.static?"static":"local",e.name),range:e.selectionRange,severity:i});continue}n.static&&o.push({message:l.diagnostic.conflictserr(n.kind===r.SymbolKind.Function?"function":"static",e.kind===r.SymbolKind.Function?"Func":"static",n.name),range:n.selectionRange,severity:i})}}f[I]=a.local[I]=e}else e.kind===r.SymbolKind.Variable&&(((s=e).def?p:h)[I]??=(s.assigned||=Boolean(s.returns),e));if(a.children.unshift(...m??[]),a.parent?.assume===u.GLOBAL&&(a.assume??=u.GLOBAL),a.assume===u.GLOBAL){for(let[e,t]of Object.entries(p={...h,...p}))(n=f[e])?n.kind===r.SymbolKind.Function&&t.def?1!==t.assigned&&o.push({message:l.diagnostic.assignerr("Func",n.name),range:t.selectionRange,severity:i}):n.kind===r.SymbolKind.Variable&&t.def&&t.kind===n.kind&&(n.def=!0,n.assigned||=Boolean(t.returns)):(Re.declaration[e]??=a.global[e]=t,t.is_global=!0);h={}}else{let e=a.assume===u.STATIC,t=a.kind===r.SymbolKind.Method||!a.parent;for(let[s,c]of Object.entries(p))delete h[s],(n=f[s])?n.kind===r.SymbolKind.Function?1!==c.assigned&&o.push({message:l.diagnostic.assignerr("Func",n.name),range:c.selectionRange,severity:i}):n.kind===r.SymbolKind.Variable&&c.def&&c.kind===n.kind&&(n.def=!0,n.assigned||=Boolean(c.returns)):(f[s]=c,t?(a.local[s]=c,c.static=e):e&&(c.static=null))}p=h,h={};for(let e in p)f[e]||((h[e]=p[e]).def=!1);a.unresolved_vars=h;for(let e in p=a.local)p[e].def=!0;d=Object.assign(a.local,d),g&&(delete d.THIS,delete d.SUPER,delete f.THIS,delete f.SUPER)}}function ke(){return L?(N=A,L="TK_EOF"!==(A=it()).type):L="TK_EOF"!==A.type}}function Le(e,t){e.extends=t.trim().replace(/^(.+[\\/])?/,(t=>{if(t=t.slice(0,-1)){let n;if((t=t.replace(/\\/g,"/").toLowerCase()).endsWith(".ahk")||(t+=".d.ahk"),t.startsWith("~/"))n=d.isBrowser?a.URI.parse(d.rootdir+t.slice(1)):a.URI.file(d.rootdir+t.slice(1));else if(/^([a-z]:)?\//.test(t))n=a.URI.file(t);else if(t.includes(":"))n=a.URI.parse(t);else{let e=(Ee.path+"/../"+t).split("/"),i=[];e.shift();for(let t of e)if(".."!==t)i.push(t);else if(!i.pop())return"";n=Ee.with({path:i.join("/")})}e.extendsuri=n.toString().toLowerCase()}return""}))}function Ie(e,t,n=0,o=!1){let s,a,c=!1,u=e[0];if("'\"".includes(u)&&e.endsWith(u)&&(e=e.slice(1,-1)),s=e.match(/^(\*[iI]\s)?(.*)$/))if(a=s[2],c=Boolean(s[1]),s=a.replace(/%(a_scriptdir|a_workingdir)%/i,Re.scriptdir).replace(/%a_linefile%/i,Re.fsPath),t&&Re[o?"dlldir":"includedir"].set((t.pos??=Re.document.positionAt(t.offset)).line,o?V:B),s.trim()){if(!d.isBrowser)if(o)(0,i.existsSync)(s)&&(0,i.statSync)(s).isDirectory()?V=s.endsWith("/")||s.endsWith("\\")?s:s+"\\":(s.match(/\.\w+$/)||(s+=".dll"),s=$(s,[],V,!0)?.path??s,s.includes(":")?Re.dllpaths.push(s.replace(/\\/g,"/")):Re.dllpaths.push((V&&(0,i.existsSync)(V+s)?V+s:s).replace(/\\/g,"/")));else if(t){if(s.startsWith("*")){let e=d.utils.get_RCDATA(t.content.substring(1));e?(H[e.uri]=e.path,t.data=[void 0,e.uri]):Re.addDiagnostic(l.diagnostic.resourcenotfound(),t.offset,t.length,r.DiagnosticSeverity.Warning)}else(s=$(s,Re.libdirs,B))&&(0,i.existsSync)(s.path)?(0,i.statSync)(s.path).isDirectory()?Re.includedir.set(t.pos.line,B=s.path):(H[s.uri]=s.path,t.data=[s.path,s.uri]):c||Re.addDiagnostic(s?l.diagnostic.filenotexist(s.path):l.diagnostic.pathinvalid(),t.offset,t.length);0!==n&&Re.addDiagnostic(l.diagnostic.unsupportinclude(),t.offset,t.length,r.DiagnosticSeverity.Warning)}else(s=$(s.replace(/(\.d)?>$/i,".d>"),Re.libdirs,Re.scriptpath))&&(0,i.existsSync)(s.path)&&!(0,i.statSync)(s.path).isDirectory()&&(H[s.uri]=s.path)}else o?V="":t&&Re.addDiagnostic(l.diagnostic.pathinvalid(),t.offset,t.length);else e&&t&&Re.addDiagnostic(l.diagnostic.pathinvalid(),t.offset,t.length)}function Fe(e,t){return t?(e&&e+"\n\n")+t:e}function je(e,t){let n=t.content;if(n.startsWith(";"))e.detail=t.data??=n.replace(/^[ \t]*; ?/gm,"");else if(/^\/\*\*(?!\/)/.test(n))if(t.data){let{detail:n,ignore:i,tags:o,vars:r}=t.data,s=r&&(r[e.name.toUpperCase()]??r[""]);i&&(e.ignore=i),o&&(e.tags=o),e.markdown_detail=Fe(s?.detail??"",n),s&&(e.type_annotations=s.type_annotations??=ae(s.type_str))}else t.data=We(Re,n,e);else e.detail=t.data??=n.replace(new RegExp(`^${z.substring(z.lastIndexOf("\n",t.offset)+1,t.offset)}`,"gm"),"").replace(/^\/\*\s*\n|\s*\*+\/$/g,"")}function We(e,t,n){if(n.detail=t,!(t=t.replace(/^[ \t]*(\*?[ \t]*(?=@)|\* ?)/gm,"").replace(/^\/\*+\s*|\s*\**\/$/g,"")))return{detail:n.markdown_detail=n.detail=""};let i,o,s,a,c,l=[],d=[],u="",f={},p={},h=n,g=e=>{},m={[r.SymbolKind.Variable]:"var",[r.SymbolKind.Property]:"prop"}[n.kind];if(h.params){let e=h.params;g=t=>{if(!/^d/.test(t))return p[t]??=e.find((e=>t===e.name.toUpperCase()&&!(e.markdown_detail="")))??((h.overload_params??={})[t]={type_annotations:!1,markdown_detail:""})}}for(let p of t.split(/\n(?=@)/))if(s=p.match(/^@(\w*)/)){switch(o=s[1].toLowerCase(),p=p.substring(o.length+1),c&&!o.startsWith("prop")&&(c=void 0),o){case"arg":case"argument":o="param";case"param":case"prop":case"property":case"var":if(p=T(p),s=p.match(/^\s*(\[(\w|[^\x00-\x7f]|(\[\])?\.)*.*?\]|(\w|[^\x00-\x7f]|(\[\])?\.)*)/)){let e="",t=s[1]??="";if(p=p.substring(s[0].length),t.startsWith("[")&&t.slice(1,-1).replace(/^((\w|[^\x00-\x7f]|(\[\])?\.)*)(.*)$/,((...n)=>((t=n[4].trimLeft()).startsWith("=")&&(e=t.substring(1).trim()),t=n[1]))),"param"===o){if(a=g(t.replace(/(\[\])?\..*$/,"").toUpperCase()),a?.name?.length===t.length)a.type_annotations??=ae(u);else if(a?.name){let e=t.split(".");k(v(a,e.shift()),e,u,`*@param* \`${t}\`${u&&`: *\`${u}\`*`}${p.trim()&&`\n___\n${p}`}`),a.markdown_detail||(a=void 0)}o=`*@param* \`${t}\`${u&&`: *\`${u}\`*`}${e&&` := \`${e}\``}${y(p)}`,l.push(o),a&&(a.markdown_detail+=`${o}\n\n`);continue}if(o.startsWith("prop"))o="property",c??=f[""]??=_(),k(v(c,c.name),t.split("."),u,`*@${o}* \`${t}\`${u&&`: *\`${u}\`*`}${e&&` := \`${e}\``}${p.trim()&&`\n___\n${p}`}`);else if("var"===m){p=p.trimLeft(),n.name.toLowerCase()===t.toLowerCase()?(n.type_annotations??=ae(u),(i??={})[t.toUpperCase()]??={detail:p,type_annotations:n.type_annotations},n.markdown_detail??=p):(i??={})[t.toUpperCase()]??={detail:p,type_str:u};continue}p=y(p),l.push(o=`*@${o}* \`${t}\`${u&&`: *\`${u}\`*`}${e&&` := \`${e}\``}${p}`)}continue;case"return":case"returns":case"type":p=T(p),l.push(`*@${o}*${u&&` *\`${u}\`*`}${y(p)}`),!m||n.get?(m||"type"!==o)&&(n.type_annotations??=ae(u)):"type"===o&&((i??={})[""]??={detail:p,type_annotations:ae(u)},l.pop());continue;case"enum":case"throws":p=T(p),l.push(`*@${o}*${u&&` *\`${u}\`*`}${y(p)}`);continue;case"typedef":p=T(p),s=p.match(/^\s*(\$?(\w|[^\x00-\x7f])*)/),(o=s[1])&&(e.typedef[o.toUpperCase()]??=c={name:o,kind:r.SymbolKind.TypeParameter,range:x,selectionRange:x,type_annotations:ae(u)}),l.push(`*@typedef* \`${o}\`: *\`${u||"Any"}\`*${y(p.substring(s[0].length))}`);continue;case"overload":if(!(s=p.match(/^\s*(\w|[^\x00-\x7f])*(?=[(\[])/)))break;d.push(`${n.name||"_"}${p.substring(s[0].length)}`);continue;case"example":l.push("*@example*"),(p=p.replace(/^\s*<caption>(.*?)<\/caption>/,((e,t)=>(l.push(t),""))).replace(/^[ \t\n]+/,""))&&l.push("```ahk2\n"+p+"\n```");continue;case"extends":o="*@extends* ",(s=p.match(/^\s*{([^{}]+)}/))&&(n.kind===r.SymbolKind.Class&&Le(n,s[1]),o+=`\`${s[1]}\``,p=p.substring(s[0].length)),l.push(`${o}${y(p)}`);continue;case"ignore":n.ignore=!0;break;case"deprecated":n.tags??=[1]}l.push(`*@${o}*${y(p)}`)}else l.push(p);if(m){let e=i?.[""]?.type_annotations;!e&&(o=f[""])&&(((i??={})[""]??={detail:""}).type_annotations=e=[o]),n.type_annotations??=e}else h.params&&(o=d.join("\n"))&&(n.overloads=o);return t=l.join("\n\n"),n.markdown_detail=Fe(n.markdown_detail??"",t),{detail:t,ignore:n.ignore,tags:n.tags,vars:i};function y(e){e=e.replace(/^[ \t]*[-—]/,"");let t=0,n=0,i=0;for(let o of e)switch(i++,o){case"\n":if(t>1||2==++n)return e;case"\t":t=0;break;case" ":t++;break;case"\r":break;default:if(n){let t=!1;if("|"===o||">"===o||"-+*".includes(o)&&" \t".includes(e[i])||"```"===e.substring(i-1,i+2))t=!0;else if("#"===o){for(;"#"===e[i];i++);t=" \t".includes(e[i])}else if("."!==o){for(;o>="0"&&o<="9";o=e[i++]);t="."===o&&" \t".includes(e[i])}if(t)return`\n${e}`}return` — ${e}`}return""}function _(e=""){return{kind:r.SymbolKind.Class,name:e,full:"",extends:"",uri:"",property:{},range:x,selectionRange:x}}function b(e,t,n){for(let n=e.length-1;n>=0;n--)t.includes(e[n])&&e.splice(n,1);return n&&e.push(n),n}function v(e,t){let n,i=t.endsWith("]")&&(t=t.slice(0,-2),!0);return n=f[t=t.toUpperCase()]??=b(e.type_annotations||=[],[M],_(e.name)),i?f[`${t}[]`]??=(n.extends||="Array",b(e.type_annotations||[],[A]),b((n.generic_types??=[])[0]??=[],[M],_())):n}function k(e,t,n,i){let o=e.name.toUpperCase(),s=t.length;for(let n of t){let t,i=0;for(;n.endsWith("]");)n=n.slice(0,-2),i++;if(o+=`.${t=n.toUpperCase()}`,s--,e=f[o]??=e.property[t]??={kind:r.SymbolKind.Property,name:n,range:x,selectionRange:x},i||s)do{e=f[o+"."]??=b(e.type_annotations||=[],[M],_()),i&&(e=f[o+="[]"]??=(e.extends||="Array",b((e.generic_types??=[])[0]??=[],i>1?[M,A]:[M],_())),i--)}while(i)}e.property||(e.markdown_detail??=i,e.type_annotations??=ae(n))}function T(e){let t=e.match(/^\s*\{/);if(u="",!t)return e;let n=1,i=t[0].length,o=i;for(;n;)switch(e[i++]){case"{":n++;continue;case"}":n--;continue;case void 0:return e;case'"':case"'":{let t,n=e[i-1];for(;(t=e[i++])!==n;)if("`"===t)i++;else if(!t||"\n"===t)return e;break}}return u=e.substring(o,i-1).trim(),e.substring(i)}}function $e(e,t){return r.Range.create(Re.document.positionAt(e),Re.document.positionAt(e+t))}function Ue(e,t,n,i,o){let r=z.charAt(n-1),s={content:e,type:t,offset:n,length:i,topofline:o,previous_token:Z,next_token_offset:-1,prefix_is_whitespace:v.includes(r)?r:void 0};return Re.tokens[n]=s,Z.next_token_offset=n,s}function Ve(e,t){let n,i,o,r=0,s=0,a="",c="",l=[S.ArrayLiteral,S.Expression,S.ObjectLiteral].includes(t);return e&&(r=e.indentation_level,s=e.had_comment,a=e.last_text,c=e.last_word,l||=e.in_expression,n=e.ternary_depth,i=e.array_style,o=e.object_style),{array_style:i,case_body:!1,catch_block:!1,declaration_statement:!1,else_block:!1,finally_block:!1,had_comment:s,if_block:!1,in_case_statement:!1,in_case:!1,in_expression:l,indentation_level:r,last_text:a,last_word:c,loop_block:0,mode:t,object_style:o,parent:e,start_line_index:ie.length,ternary_depth:n,try_block:!1}}function Be(){if(!1!==E)return;let e=ie.pop();for(;0===e?.text.length;)e=ie.pop();e&&ie.push(e),oe.had_comment&&ie.push({text:[],indent:0})}function He(){return 0===ie.at(-1).text.length}function ze(e=!1){if(le.wrap_line_length&&!e){let t=ie.at(-1),n=0;t.text.length>0&&(n=t.text.join("").length+he.length+(ke?1:0),n>=le.wrap_line_length&&(e=!0))}(le.preserve_newlines&&Q||e)&&!He()&&Ge(!0)}function Ge(e=!1){if(!(e||null!==e&&ye(pe.previous_token??D,D))){for(;oe.mode===S.Statement;)Ze();oe.if_block=oe.loop_block=oe.try_block=oe.catch_block=0}He()||ie.push({text:[],indent:0})}function Xe(e){let t=ie.at(-1);t.text.length?ke&&t.text.push(" "):(de&&t.text.push(de),oe.indentation_level=function(e){if(e){for(let t=ie.length-2;t>=0;t--)if(ie[t].text.length){e=Math.min(ie[t].indent+1,e);break}t.text.push(ue.repeat(t.indent=e))}return e}(oe.indentation_level)),ke=void 0,t.text.push(e??he)}function Qe(){oe.indentation_level+=1}function Je(){oe.indentation_level>0&&(!oe.parent||oe.indentation_level>oe.parent.indentation_level)&&(oe.indentation_level-=1)}function Ye(e){oe?(ce.push(oe),re=oe):re=Ve(null,e),oe=Ve(re,e)}function Ze(){ce.length>0&&(re=oe,oe=ce.pop())}function et(){return oe.parent.mode===S.ObjectLiteral&&oe.mode===S.Statement&&":"===oe.last_text&&!oe.ternary_depth}function tt(){if("TK_RESERVED"===be&&["try","else","finally"].includes(oe.last_text)||"TK_END_EXPR"===be&&re.mode===S.Conditional||"TK_WORD"===be&&oe.mode===S.BlockStatement&&(!Q&&pe.previous_token?.callsite||!oe.in_case&&!["TK_WORD","TK_RESERVED","TK_START_EXPR"].includes(_e)&&!["--","++","%"].includes(he))||oe.declaration_statement||oe.mode===S.ObjectLiteral&&":"===oe.last_text&&!oe.ternary_depth){switch(Ye(S.Statement),Qe(),oe.last_word){case"if":case"for":case"loop":case"while":case"catch":Ge(!0);case"try":case"finally":case"else":oe.declaration_statement=!0}return!0}return!1}function nt(e){let t=te,n=z.charAt(t);for(;n!==e&&v.includes(n)&&++t<G;)n=z.charAt(t);return n===e?t:0}function it(e=0){let t;do{t=ot(e)}while(t.type.endsWith("COMMENT"));return t}function ot(e=0){let t,n,i,o=0,a=te;for(ee=0;v.includes(n=z.charAt(te++));)if("\n"===n)Y=te-1,ee+=1,_=!0;else if(te>=G)return h(),p(),Re.tokens[-1]??={content:"",type:"TK_EOF",offset:G,length:0,topofline:ye(Z,D)?-1:1,next_token_offset:-1,previous_token:Z};let c=te-1,u=Re.tokens[c];if(u&&u.length){let e=!1;if((_=Boolean(u.topofline&&u.type.endsWith("_BLOCK")))&&(Y=c),te=u.skip_pos??c+u.length,Z=u,u.ignore?"TK_START_EXPR"===u.type?(E=!0,e=!De):"TK_END_EXPR"===u.type?(E=null,e=!De):u.type.endsWith("COMMENT")&&(Z=u.previous_token??D):u.type.endsWith("COMMENT")&&(Z=u.previous_token??D),!De){let t=u.previous_extra_tokens,n=u;if(t&&(a<c&&(t.i=0),t.i<t.len?(u=t.tokens[t.i++],te=c):t.i=0),e&&n===u)return ot()}return u}if(_){_=!1,o=1;let t=z.indexOf("\n",te);t<0&&(t=G);let r=z.substring(Y+1,t).trim().replace(/(^|\s+);.*$/,"");if(r.includes("::")&&(we||!"\"'".includes(r[0])||!["TK_EQUALS","TK_COMMA","TK_START_EXPR"].includes(Z.type))){if(i=r.match(/^(:([^:]*):(`.|[^`])*?::)(.*)$/i)){let n;if((n=/x(?!0)/i.test(i[2]))||/^\s*\{?$/.test(i[4])||(n=Re.hotstringExecuteAction&&!/x0/i.test(i[2]))?(te+=i[1].length-1,Z=Ue(i[1],"TK_HOT",c,i[1].length,1)):(Y=t,te=c+i[0].length,Z=Ue(i[1],"TK_HOTLINE",c,i[1].length,1),c+=i[1].length,Z.skip_pos=te,Z.data={content:z.substring(c,te),offset:c,length:te-c},Re.tokenranges.push({start:c,end:te,type:3,previous:Z.offset})),Z.ignore=!0,p(),i[3]||Re.addDiagnostic(l.diagnostic.invalidhotdef(),Z.offset,Z.length),"TK_HOTLINE"===Z.type||!n&&!/^\s*\{/.test(i[4])){if(e>5)return delete Re.tokens[Z.offset],Z;Oe=n=!0;let t,o=Z,r=it(e+1);for(;r.ignore&&"TK_STRING"===r.type;){if((te=z.indexOf("\n",t=te))<0&&(te=G),t<te){let e=z.substring(t,te).trimRight();r.content+=e,r.length+=e.length}Re.tokenranges.push({start:r.offset,end:r.offset+r.length,type:3}),n=!1,r=it(e+1)}Oe=!1,Z=o,n||"TK_HOT"!==Z.type?te=o.skip_pos??o.offset+o.length:(Z.type="TK_HOTLINE",Z.skip_pos=te=c+i[0].length,c+=i[1].length,Z.data={content:z.substring(c,te),offset:c,length:te-c},Re.tokenranges.push({start:c,end:te,type:3,previous:Z.offset}))}return Z}if(i=r.match(/^(((([<>$~*!+#^]*?)(`?;|[\x21-\x3A\x3C-\x7E]|[^\x00-\x2f\x3a-\x40\x5b-\x5e\x60\x7b-\x7f]+))|~?(`?;|[\x21-\x3A\x3C-\x7E]|[^\x00-\x2f\x3a-\x40\x5b-\x5e\x60\x7b-\x7f]+)\s*&\s*~?(`?;|[\x21-\x3A\x3C-\x7E]|[^\x00-\x2f\x3a-\x40\x5b-\x5e\x60\x7b-\x7f]+))(\s+up)?\s*::)(.*)$/i)){let e=i[9].match(/^(\s*)(([<>~*!+#^]*?)(`[{;]|[a-z]\w+|[^{]))$/i);if(p(),e){let n=e[4].toLowerCase();if(1===n.length||!/^joy|^pause$/.test(n)&&w.test(n))return Y=t,te=c+i[0].length,Z=Ue(i[1].replace(/\s+/g," "),"TK_HOTLINE",c,i[1].length,1),c+=Z.length+e[1].length,Z.skip_pos=te,Z.data={content:i[9].trim(),offset:c,length:te-c,data:e[2]},Re.tokenranges.push({start:c,end:te,type:4,previous:Z.offset}),Z}return te=z.indexOf("::",te)+2,Z=Ue(i[1].replace(/\s+/g," "),"TK_HOT",c,i[1].length,1)}}"#"!==n&&p()}if(y(n.charCodeAt(0))||"$"===n&&Se){for(;te<G&&y(z.charCodeAt(te));)n+=z.charAt(te),te+=1;if("."!==z.charAt(c-1)){if(i=n.match(/^(\d+[Ee](\d+)?|(0[Xx][\da-fA-F]+)|(\d+))$/)){if(i[2]||i[3])return Z=Ue(n,"TK_NUMBER",c,n.length,o),Z.data=!!i[2],Z.semantic={type:f.number},Z;if(i[4]){let e;if(te<G&&"."===z.charAt(te)){let t="",i="",r=te+1;for(;r<G&&y(z.charCodeAt(r));)t+=z.charAt(r),r+=1;if(t.match(/^\d*([Ee]\d+)?$/))return n+="."+t,te=r,Z=Ue(n,"TK_NUMBER",c,n.length,o),Z.data=!0,Z.semantic={type:f.number},Z;if(t.match(/^\d*[Ee]$/)&&r<G&&"-+".includes(z.charAt(r))){for(t+=z.charAt(r),r+=1;r<G&&y(z.charCodeAt(r));)i+=z.charAt(r),r+=1;i.match(/^\d+$/)&&(n+="."+t+i,te=r)}e=!0}return Z=Ue(n,"TK_NUMBER",c,n.length,o),Z.data=e,Z.semantic={type:f.number},Z}if(te<G&&"-+".includes(z.charAt(te))){let t,i=z.charAt(te),r=te;if(te+=1,t=ot(e+1),delete Re.tokens[t.offset],"TK_NUMBER"===t.type&&t.content.match(/^\d+$/))return n+=i+t.content,Z=Ue(n,"TK_NUMBER",c,n.length,o),Z.data=!0,Z.semantic={type:f.number},Z;te=r}}if(R.includes(t=n.toLowerCase())){if(/^(and|or|not|in|is|contains)$/.test(t))return Z=Ue(n,"TK_OPERATOR",c,n.length,o);if(o||"class"!==t)return Z=Ue(n,"TK_RESERVED",c,n.length,o)}}return Z=Ue(n,"TK_WORD",c,n.length,o)}if("("===n||"["===n){if("("===n&&o&&!E){let e,i=te;for(;i<G;){if("\n"===(e=z.charAt(i++))){if(Oe){let e=Y+1,n=z.indexOf("\n",i),o=null,r=[];for(;n>0&&!(o=z.substring(i,n).match(/^[ \t]*\)/));)r.push(n-i),n=z.indexOf("\n",i=n+1);return n<0&&(r.push(G-i),o=z.substring(i,G).match(/^[ \t]*\)/)),te=o?i+o[0].length:G,r.push(te-i),t=z.substring(c,te).trimRight(),Z=Ue(z.substring(e,c)+t,"TK_STRING",c,t.length,1),Re.addFoldingRange(e,te,"block"),Z.data=r,Z.ignore=!0,Z}{let e=!Z.type||"TK_START_BLOCK"===Z.type&&Z.topofline>0;for(Z=Ue(n,"TK_START_EXPR",c,1,1),Z.ignore=!0,te=i-1,E=!0;" \t".includes(z.charAt(++c)||"\0");)continue;let t=z.substring(c,te).trimRight();Z.data={content:t,offset:c,length:te-c},Z.skip_pos=te,Re.tokenranges.push({start:c,end:te,type:4,previous:Z.offset});let o,r=t.match(/(^|[ \t])join([^ \t]*)/i),a=/(^|[ \t])[Cc]/.test(t),l=Z,d=Z,u=!1,f=De,p=te,h=0,g=(e,t)=>{};if(r){let e=r[2].replace(/`[srn]/g,"  "),t=!1,n=new F(s.TextDocument.create("","ahk2",-10,e));n.parseScript(),delete n.tokens[-1];let i=Object.values(n.tokens);c+=4+r[1].length+r.index,i.length&&(t=v.includes(e.charAt(e.length-1)),i.forEach((e=>{e.offset+=c,e.length=0,e.next_token_offset=-1})),g=(e,n)=>{let o=[];for(let t=0;t<e;t++){n=z.indexOf("\n",n+1);for(let e of i)e={...e},e.offset=n,o.push(e)}return{i:0,len:o.length,tokens:o,suffix_is_whitespace:t}},",)]}".includes(i[0].content)&&(u=!0))}for(De=!0,o=ot(),E&&"TK_EOF"!==o.type&&(a&&o.topofline&&o.type.endsWith("COMMENT")?h=ee-2:(ee>1&&(o.previous_extra_tokens=g(ee-1,p)),o.topofline=e?1:0),p=Y,d=o,o=ot());E&&"TK_EOF"!==o.type;)o.topofline&&(a&&o.type.endsWith("COMMENT")?h+=ee-1:((h+=ee)&&(o.previous_extra_tokens=g(h,p)),o.topofline=h=0,u&&"?"===d.content&&(d.ignore=!0)),p=Y),d=o,o=ot();return o.ignore&&"TK_END_EXPR"===o.type&&(ee>1&&(o.previous_extra_tokens=g(ee-1,p)),l.next_pair_pos=o.offset,o.previous_pair_pos=l.offset,Re.addFoldingRange(l.offset,o.offset,"block")),te=l.skip_pos,Z=(De=f)?l:ot()}}if((")"===e||"("===e)&&!z.substring(i-6,i-1).match(/[(\s]join\S*$/i))break}}return Z=Ue(n,"TK_START_EXPR",c,1,o)}if(")"===n||"]"===n)return Z=Ue(n,"TK_END_EXPR",c,1,o),")"===n&&o&&E?(E=!1,Z.ignore=!0,De?Z:ot()):Z;if("{"===n&&(t="TK_START_BLOCK")||"}"===n&&(t="TK_END_BLOCK"))return o&&(Y=c,_=!0),Z=Ue(n,t,c,1,o);if('"'===n||"'"===n){let i,r,s=n,a=c,d=!1,u={type:f.string};for(t="",/^[\s+\-*/%:?~!&|^=<>[({,.]$/.test(n=z.charAt(c-1))||(s===n&&'"'===n&&Ne(Z),Re.addDiagnostic(l.diagnostic.missingspace()+", "+l.diagnostic.didyoumean(`\`${n}`),c,1));n=z.charAt(te++);)if("`"===n)te++;else{if(n===s)return t+=z.substring(c,te),Z=Ue(t,"TK_STRING",c,te-c,o),Re.tokenranges.push({start:c,end:te,type:2}),d&&(Z.data=null,Z.semantic=u),i&&(Z=i,te=Z.offset+Z.length),y(z.charCodeAt(te))&&Re.addDiagnostic(l.diagnostic.missingspace(),te),Z;if(E){if("\n"===n){let e=te-1;for(;" \t".includes(n=z.charAt(te)||"\0");)te++;if(")"===n){t=z.substring(c,e).trimRight(),Z=Ue(t,"TK_STRING",c,t.length,o=0),i??=Z,t="",Re.tokenranges.push({start:c,end:c+Z.length,type:2});let r=Z.previous_token;for(;r&&(!r.ignore||"("!==r.content);)r=r.previous_token;for(Re.addFoldingRange(c,e,"string"),Z=Ue(")","TK_END_EXPR",te,1,1),Z.ignore=!0,r&&(r.next_pair_pos=te,Z.previous_pair_pos=r.offset),E=!1,d=!0,c=++te;" \t".includes(n=z.charAt(te)||"\0");)te++;t=z.substring(c,te),c=te}}}else if("\n"===n||";"===n&&" \t".includes(z.charAt(te-2))){t=(t+z.substring(c,te-(";"===n?2:1))).trimRight(),--te,t&&(Z=Ue(t,"TK_STRING",c,t.trimLeft().length,o),Re.tokenranges.push({start:c,end:c+Z.length,type:2}),d&&(Z.data=null,Z.semantic=u),i??=Z,t="");break}}if(n){if(e>5)return Z=i,te=Z.offset+Z.length,delete Re.tokens[Z.offset],Z;Oe=we=!0;let t=it(e+1);e:for(;t.ignore&&"TK_STRING"===t.type;){let i=te,o=t.data;for(d&&(t.semantic=u);n=z.charAt(te++);)if("`"===n)te++;else{if(n===s){let e=z.substring(i,te);t.content+=e,t.length+=e.length,o[o.length-1]+=e.length,Re.tokenranges.push({start:t.offset,end:t.offset+t.length,type:2}),y(z.charCodeAt(te))&&Re.addDiagnostic(l.diagnostic.missingspace(),te);break e}if("\n"===n||";"===n&&" \t".includes(z.charAt(te-2))){let e=z.substring(i,te-(";"===n?2:1)).trimRight();e&&(t.content+=e,t.length+=e.length,o[o.length-1]+=e.length),Re.tokenranges.push({start:t.offset,end:t.offset+t.length,type:2}),te--;break}}if(!n){let e=z.substring(i,--te);e&&(t.content+=e,t.length+=e.length),Re.tokenranges.push({start:t.offset,end:t.offset+t.length,type:2})}t=it(e+1)}return t.ignore&&"TK_STRING"===t.type||((r=t.previous_token)?Re.addDiagnostic(l.diagnostic.unterminated(),r.offset+r.length,1):Re.addDiagnostic(l.diagnostic.missing(s),a,1)),Oe=!1,Z=i,te=Z.offset+Z.length,Z}return Re.addDiagnostic(l.diagnostic.unterminated(),G,1),t+=z.substring(c,G),Z=Ue(t,"TK_STRING",c,G-c,o),Re.tokenranges.push({start:c,end:G,type:2}),d&&(Z.data=null,Z.semantic=u),E&&(Re.addFoldingRange(c,G,"string"),E=!1),Z}if("."===n){let e=z.charAt(te);if("="===e)return te++,Z=Ue(".=","TK_EQUALS",c,2,o);if(v.includes(z.charAt(te-2))&&v.includes(e))return Z=Ue(n,"TK_OPERATOR",c,1,o);if(e.match(/\d/)&&["TK_EQUALS","TK_OPERATOR","TK_COMMA","TK_START_EXPR"].includes(Z.type)){let t=te+1,i="";for(;t<G&&y(z.charCodeAt(t));)e+=z.charAt(t),t+=1;if(e.match(/^\d+([Ee]\d+)?$/))return te=t,n+=e,Z=Ue("0"+n,"TK_NUMBER",c,n.length,o),Z.data=!0,Z.semantic={type:f.number},Z;if(t<G&&e.match(/^\d+[Ee]$/)&&"-+".includes(z.charAt(t))){for(e+=z.charAt(t),t+=1;t<G&&y(z.charCodeAt(t));)i+=z.charAt(t),t+=1;if(i.match(/^\d+$/))return te=t,n+=e+i,Z=Ue("0"+n,"TK_NUMBER",c,n.length,o),Z.data=!0,Z.semantic={type:f.number},Z}}return Z=Ue(n,/[%([]|[^\x00-\x2f\x3a-\x40\x5b-\x5e\x60\x7b-\x7f]/.test(e)?"TK_DOT":"TK_UNKNOWN",c,1,o)}if(";"===n){let e,t,n,i,s="",a=o&&"\n".includes(z.charAt(Y))?"TK_COMMENT":(o=0,"TK_INLINE_COMMENT"),u=c-1,f=0,p=!0;for(;;){if(te=u,u=z.indexOf("\n",te+1),i=z.substring(te+1,u=u<0?G:u).trim(),i.startsWith(";")){if(f++,e=i.match(/^;\s*@/)){let t=i.substring(e[0].length);"include-winapi"===(t=t.toLowerCase())?Ce&&(e=d.lexers[d.ahkuris.winapi])&&Object.defineProperty(H,d.ahkuris.winapi,{value:e.fsPath,enumerable:!1}):(e=t.match(/^include\s+(.*)/i))?Ie(e[1].replace(/\s+;.*$/,"").trim()):(e=t.match(/^lint-(enable|disable)\b\s*(\S*)/))&&"class-static-member-check"===e[2]&&("enable"===e[1]?delete(j??Re).checkmember:(j??Re).checkmember=!1),n=!0}else if(e=i.match(/^;+\s*([{}])/)){if(p=!1,"{"===e[1]?U.bracket.push(te+1):void 0!==(e=U.bracket.pop())&&Re.addFoldingRange(e,te+1,"block"),1===f&&(n=!0),o&&!n)continue;te=u;break}if((e=i.match(/^;\s*(~?\s*|@)(todo|fixme)(:?\s*)(.*)/i))&&(Re.children.push(r.DocumentSymbol.create(`${e[2].toUpperCase()}: ${e[4].trim()}`,void 0,r.SymbolKind.Module,t=$e(te+1,u-te-1),t)),o))continue;if(o){if(e=i.match(/^;\s*[@#](end)?region\b/i))n=!0,p=!1,h(),e[1]?void 0!==(e=U.region.pop())&&Re.addFoldingRange(e,te+1,"region"):(U.region.push(te+1),(i=i.substring(e[0].length).trim())&&Re.children.push(r.DocumentSymbol.create(i,void 0,r.SymbolKind.Module,t=$e(te+1,u-te-1),t)));else if(e=i.match(N)){let i=e.groups;if(i){for(let t in i)if(t.startsWith("tag")&&(e=i[t]?.trim()))break}else e=e[1]?.trim();e&&(Re.children.push(r.DocumentSymbol.create(e,void 0,r.SymbolKind.Module,t=$e(te+1,u-te-1),t)),n=!0)}if(!n)continue}te=u}break}s=z.substring(c,te).trimRight(),Re.tokenranges.push({start:c,end:te,type:1});let g=Re.tokens[c]={type:a,content:s,offset:c,length:s.length,next_token_offset:-1,topofline:o,ignore:n,skip_pos:te,previous_token:Z};if(o){let e=Re.document.positionAt(te).line;Oe||n||!i[0]||i.startsWith("/*")||(O[e+1]=g),J&&(Z.pos??=Re.document.positionAt(Z.offset)).line>J.endLine&&h(),J?J.endLine=e:p&&(J=r.FoldingRange.create(Re.document.positionAt(c).line,e,void 0,void 0,"comment"))}else v.includes(z.charAt(c-1))||Re.addDiagnostic(l.diagnostic.unexpected(g.content),c,g.length);return g}if("/"===n&&o&&"*"===z.charAt(te)){let e=z.indexOf("\n",--te),t=0,r="";for(;!(i=z.substring(te,e>0?e:G).match(/(^[ \t]*\*\/)|\*\/([ \t]*\r?)$/))&&e>0;)Y=e,e=z.indexOf("\n",te=e+1),t++;i?.[1]?(te=z.indexOf("*/",Y)+2,_=!0,Y=te-1):te=(e<0?G:e)-(i?.[2].length??(r="*/",0)),Re.tokenranges.push({start:c,end:te,type:1});let s={type:"TK_BLOCK_COMMENT",content:z.substring(c,te)+r,offset:c,length:te-c,next_token_offset:-1,previous_token:Z,topofline:o,skip_pos:te};if(!Oe){let e=te,t=0;for(;" \t\r".includes(n=z[e]??"\0")||"\n"===n&&++t<2;e++);("*"!==z[c+2]||"/"===z[c+3]||(s.data=null))&&"\n\0".includes(n)||(O[Re.document.positionAt(e).line]=s)}return h(),Re.tokens[c]=s,t&&Re.addFoldingRange(c,te,"comment"),s}if(k.includes(n)){if(Se&&"<>".includes(n))return Z=Ue(n,"<"===n?"TK_START_EXPR":"TK_END_EXPR",c,n.length,o);for(;te<G&&k.includes(n+z.charAt(te))&&(n+=z.charAt(te),te+=1,!(te>=G)););if(","===n)return Z=Ue(n,"TK_COMMA",c,1,o);if("?"===n){Z=Ue(n,"TK_OPERATOR",c,1,o);let t=te,i=Z,s=it(e+1);return te=t,(")]},:??".includes(s.content)||"."===s.content&&"TK_OPERATOR"!==s.type)&&(i.ignore=!0,!")]},:".includes(s.content)&&d.ahk_version<d.alpha_3-1&&Re.addDiagnostic(l.diagnostic.requireversion("2.1-alpha.2"),i.offset,i.length,r.DiagnosticSeverity.Warning)),Z=i}return"??="===n&&d.ahk_version<d.alpha_3-1&&Re.addDiagnostic(l.diagnostic.requireversion("2.1-alpha.2"),c,n.length,r.DiagnosticSeverity.Warning),Z=Ue(n,n.match(/([:.+\-*/|&^]|\/\/|>>|<<|\?\?)=/)?"TK_EQUALS":"TK_OPERATOR",c,n.length,o)}if("#"===n){let e="#";for(;y((n=z.charAt(te)).charCodeAt(0));)e+=n,te++;if(ne.push(c),Z=Ue(e,"TK_SHARP",c,e.length,o),ge=e.toLowerCase(),o&&v.includes(n)&&("#hotif"===ge||Ce&&"#initexec"===ge))return Z;if(Y=z.indexOf("\n",c=te),te=Y<0?G:Y,o&&v.includes(n)){if(" "===n||"\t"===n){for(;" \t".includes(z.charAt(c)||"\0");)c++;let e=z.substring(c,te).trimRight().replace(/(^|\s+);.*$/,"");Z.data={content:e,offset:c,length:e.length},te=c+e.length,e&&(Z.skip_pos=te,Re.tokenranges.push({start:c,end:c+e.length,type:3,previous:Z.offset}))}}else Z.type="TK_UNKNOWN",Z.content+=z.substring(c,te).trimRight(),Z.length+=te-c;return Z}return Z=Ue(n,"TK_UNKNOWN",c,n.length,o);function p(){ne.length>1&&Re.addFoldingRange(ne[0],ne.pop(),"imports"),ne.length=0}function h(){J&&(J.endLine>J.startLine&&Re.foldingranges.push(J),J=void 0)}}function rt(){let e=ie[oe.start_line_index-1];return e?.text.length?e.indent:oe.indentation_level}function st(){return oe.mode===S.ObjectLiteral?oe.object_style??le.object_style:oe.mode===S.ArrayLiteral?oe.array_style??le.array_style:void 0}function at(){let e=!1;if(ke||=/^(TK_NUMBER|TK_WORD|TK_RESERVED|TK_STRING|TK_END_)/.test(be),tt()&&(e=oe.declaration_statement,!Q&&["try","else","finally"].includes(oe.last_word)&&["if","while","loop","for","try","switch"].includes(ge)&&Je()),"TK_RESERVED"===_e){if(void 0!==le.keyword_start_with_uppercase&&(he=le.keyword_start_with_uppercase?ge.replace(/^./,(e=>e.toUpperCase())):ge),["break","continue","global","goto","local","return","static","throw"].includes(ge))Q&&Ge(e);else{let t=!1;switch(ge){case"else":for(;oe.mode===S.Statement&&!oe.if_block&&!oe.loop_block&&(!oe.catch_block||oe.else_block);)Ze();break;case"finally":for(;!(oe.mode!==S.Statement||oe.catch_block||oe.try_block||oe.else_block&&oe.catch_block);)Ze();break;case"catch":for(;oe.mode===S.Statement&&!oe.try_block&&(!oe.catch_block||oe.else_block);)Ze();break;case"until":for(;oe.mode===S.Statement&&1!==oe.loop_block;)Ze();break;case"case":case"class":for(;oe.mode===S.Statement;)Ze();break;case"if":case"for":case"loop":case"while":case"try":case"switch":if(!e)if(!Q||oe.mode!==S.Statement||oe.declaration_statement||oe.is_expression)for(;oe.mode===S.Statement&&oe.declaration_statement;)Ze();else Ge(!1)}if(oe.if_block?"else"===ge?(oe.if_block=!1,oe.else_block=!0,t=!0):oe.if_block=!1:oe.loop_block?1===oe.loop_block&&"until"===ge?(oe.loop_block=0,t=!0):"else"===ge?(oe.else_block=!0,oe.loop_block=0,t=!0):oe.loop_block=0:oe.try_block?"catch"===ge?(oe.try_block=!1,oe.catch_block=!0,t=!0):"finally"===ge?(oe.try_block=!1,oe.finally_block=!0,t=!0):oe.try_block=!1:oe.catch_block?"finally"===ge?(oe.catch_block=oe.else_block=!1,oe.finally_block=!0,t=!0):"else"===ge?(oe.else_block=!0,t=!0):"catch"===ge?t=!0:oe.catch_block=oe.else_block=!1:oe.else_block=oe.finally_block=!1,"class"===ge)return Ge(),Xe(),oe.last_word=ge,Ye(S.Statement),void(Te=!0);if("case"===ge&&(oe.in_case_statement||"BlockStatement"===oe.mode&&"switch"===oe.last_word))return Ge(),oe.case_body&&(Je(),oe.case_body=!1),Xe(),oe.in_case=!0,void(oe.in_case_statement=!0);switch(t?(Be(),"}"!==oe.last_text||le.brace_style<1||Q&&le.preserve_newlines&&!le.brace_style?Ge(!0):ke=fe):Q&&("else"===ve&&!le.preserve_newlines&&["if","for","loop","while","try","switch"].includes(ge)?Je():Ge(e)),ge){case"loop":oe.loop_block=1;break;case"while":case"for":oe.loop_block=2;break;case"if":oe.if_block=!0;break;case"try":oe.try_block=!0}}oe.last_word=ge}else!Q||oe.mode!==S.Statement||oe.is_expression||ye(pe.previous_token??D,pe)?Q&&(le.preserve_newlines||pe.symbol)?(pe.symbol||st()!==C.collapse)&&Ge(!pe.symbol):["TK_COMMA","TK_START_EXPR","TK_EQUALS","TK_OPERATOR"].includes(be)&&(et()||ze()):Ge(e),!Te&&oe.mode===S.BlockStatement&&pe.symbol?.children&&(Ye(S.Statement),Te=!0),oe.last_word="_",le.symbol_with_same_case&&(he=pe.definition?.name||he);Xe()}function ct(e){let t=e.match(/^;\s*@format\b/i);if(t){e=e.substring(t[0].length);for(let t of e.split(",")){let e,n=t.indexOf(":");switch(e=t.substring(0,n).trim()){case"array_style":case"object_style":oe[e]=C[t.substring(n+1).trim()]}}}}function lt(){if(Ge(),le.symbol_with_same_case&&"TK_SHARP"===_e&&(he=d.hoverCache[ge]?.[0]||he),"#hotif"===ge&&le.indent_between_hotif_directive)return oe.hotif_block&&(Je(),oe.hotif_block=!1),Xe(),0===Re.tokens[pe.next_token_offset]?.topofline&&(Qe(),oe.hotif_block=!0),void(ke=!0);Xe();let e=pe.data?.content;e?Xe("TK_HOTLINE"===_e?e:" "+e):ke="TK_HOT"===_e?!!le.space_after_double_colon:fe||"TK_SHARP"===_e}function dt(){return Q&&(oe.parent.mode===S.BlockStatement&&["TK_END_EXPR","TK_START_BLOCK","TK_END_BLOCK","TK_WORD","TK_STRING"].includes(be)||"TK_OPERATOR"===be&&/^(\+\+|--|%)$/.test(ve)||"TK_RESERVED"===be&&/^(break|continue|goto|global|local|loop|return|static|throw)$/.test(ve))}this.document=e,e.uri&&(Se=!1,this.uri=e.uri.toLowerCase(),this.setWorkspaceFolder(),this.scriptpath=(this.fsPath=Ee.fsPath).replace(/[\\/][^\\/]+$/,""),this.initLibDirs(n)),this.get_token=function(e,t=!1){let n,i,o;for(void 0!==e&&(n=te,o=Z,te=e);(i=ot()).type.endsWith("COMMENT")&&t;);return void 0!==e&&(te=n,Z=o),i},this.find_token=function(e,t=!1){let n,i=e,o=z.charAt(e),r=Re.tokens,s={...D,offset:G};if(!o)return s;if(v.includes(o)){for(;v.includes((o=z.charAt(++i))||"\0");)continue;if(n=r[i])return n;if(!o&&(n=r[Re.tokenranges[Re.tokenranges.length-1]?.start])){if(n.offset<=e&&e<n.offset+n.length)return n;n=void 0}}else{if(y(o.charCodeAt(0)))for(;y(z.charCodeAt(--i));)continue;else for(;!v.includes(o=z.charAt(--i))&&!y(o.charCodeAt(0)););if(!(n=r[++i]??r[i-1])&&"."===z.charAt(i)){for(;y(z.charCodeAt(--i));)continue;n=r[i+1]}}if(!n&&z.slice(i=z.lastIndexOf("\n",i)+1,e).trim()&&(n=Re.find_token(i)),n){if(n.offset<=e&&e<n.offset+n.length)return n;for(;(n=r[n.next_token_offset])&&!(n.offset>e);)if(e<n.offset+n.length)return n}return!t&&Re.findStrOrComment(e)||s},this.beautify=function(e,t){let n,i;for(!Re.isparsed&&Re.parseScript(),le={break_chained_methods:!1,ignore_comment:!1,indent_string:"\t",max_preserve_newlines:3,preserve_newlines:!0,space_before_conditional:!0,space_after_double_colon:!0,space_in_empty_paren:!1,space_in_other:!0,space_in_paren:!1,wrap_line_length:0,...e},be=ve="",_=!0,Z={...D},Y=-1,i=G,pe=Re.get_token(0),de=z.substring(z.lastIndexOf("\n",te=pe.offset)+1,te),Te=ke=!1,De=!0,ue=le.indent_string??"\t",fe=le.space_in_other??!0,ie=[{text:[],indent:0}],ce=[],oe=null,Ye(S.BlockStatement),le.symbol_with_same_case&&(0,d.symbolProvider)({textDocument:Re.document}),t&&(i=Re.document.offsetAt(t.end),pe=Re.find_token(Re.document.offsetAt(t.start)),t.start=Re.document.positionAt(te=pe.offset),de=z.substring(z.lastIndexOf("\n",te)+1,te).replace(/\S.*$/,""));;){if(_e=(pe=ot()).type,ge=(he=pe.content).toLowerCase(),pe.fat_arrow_end){for(;!oe.in_fat_arrow;)Ze();Je()}if(pe.offset>=i){if(t){let e=pe.previous_token,n=te;if("TK_RESERVED"===be&&["try","else","finally"].includes(ve)&&Qe(),oe.declaration_statement&&He()||Ge(),e?.type){for(;(pe=Re.find_token(e.skip_pos??e.offset+e.length)).offset<i;)e=pe;for(n=e.offset+e.length;" \t".includes(z.charAt(n)||"\0");n++);for(v.includes(z.charAt(n))||(n=e.offset+e.length);He();)ie.pop()}t.end=Re.document.positionAt(n),t.indent_string=de+ue.repeat(oe.indentation_level)}for(;oe.mode===S.Statement;)Ze();break}if(Te&&!(Te=ee?!o(pe):"TK_START_BLOCK"!==_e||pe.data))Ze(),be="TK_END_EXPR",oe.last_text=")",Q=ee>0;else if(Q=ee>0)if(!1!==E){Ge();for(let e=1;e<ee;e++)ie.push({text:[],indent:0})}else if(!Te&&!oe.in_expression&&(pe.type.endsWith("COMMENT")||!ye(oe.mode===S.Statement?pe.previous_token??D:{},pe))&&("TK_RESERVED"!==be||!["catch","else","finally","until"].includes(ve))){le.max_preserve_newlines&&ee>le.max_preserve_newlines&&(ee=le.max_preserve_newlines),He()||ie.push({text:[],indent:0});for(let e=1;e<ee;e++)ie.push({text:[],indent:0})}Pe[_e](),_e.endsWith("COMMENT")||(!Te&&"TK_RESERVED"===_e&&["if","for","while","loop","catch","switch"].includes(ge)&&(Te=!0,Ye(S.Conditional),"switch"!==ge&&Qe()),oe.last_text=ge,oe.had_comment=0,be=_e,ve=ge)}return n=ie.map((e=>e.text.join(""))).join("\n"),ie=[],De=!1,n;function o(e){if(![S.Conditional,S.Statement].includes(oe.mode)||oe.parent.mode===S.ObjectLiteral)return!1;switch(e.type){case"TK_DOT":case"TK_COMMA":case"TK_EQUALS":case"TK_COMMENT":case"TK_INLINE_COMMENT":case"TK_BLOCK_COMMENT":return!1;case"TK_OPERATOR":return Boolean(e.content.match(/^(!|~|not|%|\+\+|--)$/i));case"TK_STRING":return!e.ignore;default:let t=e.previous_token;switch(t.type){case"TK_COMMA":case"TK_EQUALS":return!1;case"TK_OPERATOR":return Boolean(t.content.match(/^(\+\+|--|%)$/))}}return!0}},o||e.uri.match(/\.d\.(ahk2?|ah2)(?=(\?|$))/i)?(this.d=o||1,Se||=!0,this.parseScript=function(){let e,t,n,i="",o=0,s=0,a=0,c=0,h=!1,y=$e(0,0),b=this.uri,v=r.DocumentSymbol.create("",void 0,r.SymbolKind.Namespace,y,y,this.children),k=[],T=[],R=[];for(this.clear(),U={region:[],bracket:[]},O={},ne=[],z=this.document.getText(),G=z.length,B=this.scriptpath,Z={...D},_=!0,te=0,Y=-1,j=J=void 0,H=this.include,v.property=v.$property=this.declaration;ot().length;);for(R=Object.values(this.tokens),a=R.length;o<a;)switch((e=R[o]).type){case"TK_WORD":if(!e.topofline&&!h){o++;break}if(s=o+1,s<a)if(c&&((t=R[s]).topofline||["=>","?",":","[","{"].includes(t.content))){let o=m.create(e.content,r.SymbolKind.Property,y=$e(e.offset,e.length)),a=o,c="=>"===t.content;e.symbol=e.definition=o,a.parent=v,a.has_this_param=!0;let l=[],d={type:f.property,modifier:p.definition|h};if(K.includes(i=o.name.toUpperCase())||(e.semantic=d),v.children?.push(o),o.static=h,o.full=`(${T.join(".")}) ${h?"static ":""}`+o.name,(h?v.property:v.$property)[i]??=o,(n=O[o.selectionRange.start.line])&&je(n.symbol=o,n),(this.object.property[i]??=[]).push(o),"["===t.content){if(l=w("]"),l.length){a.children=a.params=l,a.full+=`[${l.full}]`,a.param_offsets=l.offset,a.param_def_len=l.full.length+2,a.declaration=a.local={};for(let e of l)a.local[i=e.name.toUpperCase()]??=e}if(!(t=R[++s]))break}if("{"===t.content){let n=o;for(;"}"!==(e=R[++s]).content;)if("=>"===e.content){let e=g.create(t.content,r.SymbolKind.Function,y=$e(t.offset,t.length),{...y},l);i=t.content.toLowerCase(),e.parent=o,t.symbol=t.definition=e,S(e),"get"!==i&&"set"!==i||(e.has_this_param=!0,n[i]=e)}else t=e;o.type_annotations=n.get?.type_annotations,c=Boolean(n.get&&!n.set),o.range.end=this.document.positionAt(e.offset+e.length)}else if("=>"===t.content){let e=g.create("get",r.SymbolKind.Function,y=$e(t.offset,t.length),{...y},l);e.parent=o,o.get=e,c=!0,e.has_this_param=!0,S(e),o.type_annotations=e.type_annotations,o.range.end=e.range.end}else"?"===t.content&&(t.ignore=!0,t=R[++s],o.defaultVal=null),":"===t?.content?S(o):(t=R[--s],o.range.end=this.document.positionAt(t.offset+t.length));c&&(d.modifier|=p.readonly)}else if("("===(t=R[s]).content){let o=w(),a=C(e.content,o,$e(e.offset,e.length),h);"=>"===R[s+1]?.content?(++s,S(a)):a.range.end=this.document.positionAt(t.offset+t.length),a.full+=` => ${se(a.type_annotations)||"void"}`,e.symbol=e.definition=a,K.includes(i=a.name.toUpperCase())||(e.semantic={type:c?f.method:f.function,modifier:p.definition|p.readonly|h}),c&&(a.has_this_param=!0,a.kind=r.SymbolKind.Method,a.full=`(${T.join(".")}) ${a.full}`,a.parent=v,(this.object.method[i]??=[]).push(a)),(n=O[a.selectionRange.start.line])&&je(n.symbol=a,n),v.children?.push(a);let l=h?v.property:v.$property;l[i]?l[i].call=a:l[i]=a}else if(!c&&(["=>",":",","].includes(t.content)||t.topofline)){let i=m.create(e.content,r.SymbolKind.Variable,y=$e(e.offset,e.length));e.symbol=e.definition=i,e.semantic={type:f.variable,modifier:p.definition|("=>"===t.content?p.readonly:0)},i.assigned=i.def=!0,(n=O[i.selectionRange.start.line])&&je(n.symbol=i,n),["=>",":"].includes(t.content)?S(i):","!==t.content&&--s,v.children.push(i),v.property[i.name.toUpperCase()]??=i}o=s+1,h=!1;break;case"TK_RESERVED":if(h=!1,1!==e.topofline)e.type="TK_WORD";else if("static"===(i=e.content.toLowerCase()))h=!0,o++;else if(o<a-4&&"class"===i){let i="",l=r.DocumentSymbol.create((e=R[++o]).content,void 0,r.SymbolKind.Class,$e(R[o-1].offset,0),$e(e.offset,e.length),[]);if(s=o+1,T.push(l.name),e.semantic={type:f.class,modifier:p.definition|p.readonly},e.symbol=e.definition=l,l.extends="",l.uri??=this.uri,"<"===(t=R[s])?.content&&!t.topofline){let e={},n=0;for(;"TK_WORD"===(t=R[++s])?.type;){let i=$e(t.offset,t.length),o={name:t.content,data:n,kind:r.SymbolKind.TypeParameter,range:i,selectionRange:i};if(n++,e[t.content.toUpperCase()]??=o,"="===(t=R[++s])?.content&&(S(o),t=R[++s]),","!==t?.content)break}">"===t?.content?(l.type_params=e,t=R[++s]):P(">")}if("extends"===t?.content.toLowerCase()){for("TK_WORD"===(t=R[s+1])?.type&&this.children.push(m.create(t.content,r.SymbolKind.Variable,$e(t.offset,t.length)));++s<a&&"{"!==(t=R[s]).content;)i+=t.content;l.extends=i}(n=O[l.selectionRange.start.line])&&je(n.symbol=l,n),l.full=T.join("."),l.property={},l.prototype={...l,detail:void 0,property:l.$property={}},(!c&&l.name.startsWith("$")?Re.typedef:v.property)[l.name.toUpperCase()]??=l,v.children.push(l),c++,k.push(v),v=l,l.type_annotations=[l.full],o=s+1}else"global"===i&&"TK_WORD"===R[o+1].type?o++:e.type="TK_WORD";break;case"TK_END_BLOCK":c&&(v.range.end=v.prototype.range.end=this.document.positionAt(e.offset+e.length),v.property.PROTOTYPE={...v.prototype,children:void 0,name:"Prototype",kind:r.SymbolKind.Property,full:`(${v.full}) Prototype`,selectionRange:x,type_annotations:[v.full]},v.uri=b,(v=v.prototype).uri=b,this.addFoldingRangePos(v.range.start,v.range.end),Object.values(v.property).forEach((e=>e.parent=v)),c--,T.pop(),v=k.pop());default:o++,h=!1}if(!(this.d<0)){if(2&this.d){let e,t,n=b.endsWith("/ahk2_h.d.ahk")?1:0;for(let[t,i]of Object.entries(this.declaration))switch(i.kind){case r.SymbolKind.Function:i.def=!1,i.uri=b;case r.SymbolKind.Class:i.overwrite??=n,i.def??=!0,(!(e=d.ahkvars[t])||n>=(e.overwrite??0))&&(d.ahkvars[t]=i);break;case r.SymbolKind.Variable:i.def&&(d.ahkvars[t]=i,i.uri=b)}n&&(d.ahk_version>d.alpha_3?["STRUCT","SIZEOF","OBJDUMP","OBJLOAD","A_ZIPCOMPRESSIONLEVEL"].forEach((e=>delete d.ahkvars[e])):(t=this.declaration.STRUCT)?.kind===r.SymbolKind.Class&&(t.def=!1));for(let e in q)q[e]=d.ahkvars[e]?.prototype}Me(),me({},this.children,this.diagnostics),this.diags=this.diagnostics.length,this.isparsed=!0,U.region.forEach((e=>this.addFoldingRange(e,te-1,"region")))}function S(e){let i=function i(){let o,c,l,d,u=[];e:for(;t=R[++s];){switch(t.type){case"TK_WORD":for(l=t.content,d="TK_WORD",(c="typeof"===l)&&R[s+1]?.type===d&&!R[s+1].topofline&&(t.semantic={type:f.operator},t=R[++s],l=t.content),("this"!==l.toLowerCase()||e.kind===r.SymbolKind.Function&&e.parent?.kind!==r.SymbolKind.Property)&&(t.semantic={type:f.class});(t=R[++s])&&!t.topofline&&t.type!==d&&(/^[.#~]$/.test(t.content)||"TK_WORD"===t.type&&(t.semantic={type:f.class}));)l+=t.content,d=t.type;if("<"!==t?.content||t.topofline)l&&u.push(c?`typeof ${l}`:L[l.toUpperCase()]??l);else{let e=[];for(;;){if(e.push(i()),!t||">"===t.content){let n={name:l,kind:"comobject"===l.toLowerCase()?r.SymbolKind.Interface:r.SymbolKind.Class,extends:l,full:`${l}<${e.map((e=>se(e))).join(", ")}>`,range:x,selectionRange:x};n.generic_types=e,c?n.prototype={...n}:n.data=L[l.toUpperCase()],u.push(n),t=R[++s];break}if(","!==t.content){P(">"),t=R[++s];break}}}break;case"TK_NUMBER":case"TK_STRING":u.push(t.content),t=R[++s];break;case"TK_START_BLOCK":{let e={},i=t,o="";for(;"TK_WORD"===(t=E())?.type;){let i=m.create(t.content,r.SymbolKind.Property,$e(t.offset,t.length));if(e[t.content.toUpperCase()]??=i,t.semantic={type:f.property},o+=", "+t.content,n&&n===O[i.selectionRange.start.line]&&je(i,n),"?"===(t=R[++s])?.content&&(t.ignore=!0,t=R[++s],i.defaultVal=null,o+="?"),":"===t?.content&&(S(i),t=R[++s],o+=`: ${se(i.type_annotations)||"unknown"}`),","!==t?.content)break;n=void 0}if("}"===t?.content){let n=r.DocumentSymbol.create("",void 0,r.SymbolKind.Class,x,x);n.property=e,n.name=n.extends="",n.uri=Re.uri,u.push(i.data=t.data=n),n.full=(o=o.substring(2))&&`{ ${o} }`}else P("}"),i.data=M,"}"===t?.content&&(t.data=M);t=R[++s];break}case"TK_COMMENT":case"TK_BLOCK_COMMENT":n=t;case"TK_INLINE_COMMENT":continue;default:if("("===t.content)if(",:=?&*)[".includes((o=R[s+2])?.content??"\0")||"=>"===o?.content){let e=t.offset,i=C("",w(),$e(e,0));if(s>=a)break e;"=>"===R[s+1]?.content?(++s,S(i)):i.range.end=Re.document.positionAt(t.offset+t.length),i.full+=` => ${se(i.type_annotations)||"void"}`,u.push(i),i.uri=Re.uri,n&&n===O[i.selectionRange.start.line]&&je(n.symbol=i,n)}else u.push(...i()),")"===t?.content&&(t=R[++s]);else{if("-"!==t.content||"TK_NUMBER"!==(t=R[++s])?.type){"throw"===t.content.toLowerCase()&&"=>"===t.previous_token?.content&&(t=R[++s]);break e}u.push(`-${t.content}`),t=R[++s]}}if("|"!==t?.content)break;n=void 0}return u}();if((t=R[--s])||(t=R[s=R.length-1]),i.length){let t=new Set(i);t.delete("void"),e.type_annotations=Array.from(t)}return e.range.end=Re.document.positionAt(t.offset+t.length),s}function w(e=")"){let n,i,o=[],a=!0,c=0,l="",d=o.offset??=[];e:for(;(t=R[++s])&&t.content!==e;)if("TK_WORD"===t.type){if(!a){P(e);break e}if(n=m.create(t.content,r.SymbolKind.Variable,$e(t.offset,t.length)),1===a&&(o.hasref=n.pass_by_ref=!0,l+="&",a=!0),n.assigned=n.def=n.is_param=!0,o.push(n),t.semantic={type:f.parameter,modifier:p.definition},d.push(l.length),l+=t.content,t=R[++s],c&&(n.defaultVal=!1),"*"===t?.content?(o.variadic=n.arr=!0,t=R[++s],l+="*"):"?"===t?.content&&(n.defaultVal=null,t.ignore=!0,t=R[++s],l+="?"),":"===t?.content&&(t=R[s=S(n)+1],l+=`: ${se(n.type_annotations)||"unknown"}`),!t)break e;if(":="===t.content){if(!(t=R[++s])||t.content===e)break e;if(n.defaultVal=t.content,"-+".includes(t.content)&&"TK_NUMBER"===R[s+1]?.type&&(n.defaultVal+=R[++s].content),l+=` := ${n.defaultVal}`,!(t=R[++s]))break e}"["===t.content?(c++,t.ignore=!0,t=R[++s],l+=" ["):c&&"]"===t.content&&(c--,t.ignore=!0,t=R[++s],l+="]"),","===t?.content?l+=", ":(s--,a=!1)}else if(","===t.content){if(a){P(e);break e}l+=", ",a=!0}else if("*"===t.content){if(!a){P(e);break e}n=m.create("",r.SymbolKind.Variable,$e(t.offset,0)),i??=n,o.variadic=n.arr=n.assigned=n.def=n.is_param=!0,c&&(n.defaultVal=!1),a=!1,d.push(l.length),l+="*"}else if("["===t.content)c++,t.ignore=!0,l+="[";else if(c&&"]"===t.content)c--,t.ignore=!0,l=l.trimRight()+"] ";else{if(!0!==a||"&"!==t.content){P(e);break e}a=1,t.op_type=-1}return o.full=l,i&&o.push(i),o}function C(e,t,n,i=!1){let o={assume:u.DEFAULT,children:[],declaration:{},full:`${i?"static ":""}${e}(${t.full})`,global:{},hasref:t.hasref,kind:r.SymbolKind.Function,labels:{},name:e,param_def_len:t.full.length+2,param_offsets:t.offset,params:t,range:n,selectionRange:{...n},static:i,variadic:t.variadic};o.local=o.declaration;for(let e of t)o.local[e.name.toUpperCase()]=e;return delete o.local[""],o}function E(){for(;(t=R[++s])?.type.endsWith("COMMENT")&&(n=t););return t}function P(e){let n=1,i={">":"<",")":"(","]":"[","}":"{"}[e];for(t??=R.at(-1),Re.addDiagnostic(l.diagnostic.unexpected(t.content),t.offset,t.length);(t=R[++s])&&(t.content!==e||--n);){if(t.topofline>0)return s--;t.content===i&&++n}}}):(this.fsPath.replace(/^(.*)\.(ahk2?|ah2)$/i,((e,t)=>{let n=t+".d.ahk",i=this.d_uri=a.URI.file(n).toString().toLowerCase();if(!d.isBrowser&&!d.lexers[this.d_uri]){let e=(0,d.openFile)((0,d.restorePath)(n),!1);e&&(d.lexers[i]=new F(e,void 0,1)).parseScript()}return""})),this.parseScript=function(){z=this.document.getText(),G=z.length,B=this.scriptpath,V="",_=!0,Ke=!1,Z={...D},j=J=void 0,te=0,Y=-1,U={region:[],bracket:[]},E=!1,Ce=d.isahk2_h,this.clear(),H=this.include,O={},ne=[],b=d.extsettings.Warn?.CallWithoutParentheses;try{let e=d.utils.get_RCDATA("#2");e&&(H[e.uri]=e.path),this.children.push(...qe())}catch(e){xe=Ke=Oe=!1,e instanceof I?e.message&&this.addDiagnostic(e.message,e.token.offset,e.token.length,r.DiagnosticSeverity.Warning):console.error(e)}Me(),me(this.declaration,this.children,this.diagnostics),this.diags=this.diagnostics.length,this.isparsed=!0,U.region.forEach((e=>this.addFoldingRange(e,te-1,"region"))),this.actived&&(this.actionwhenv1??="Continue")})}clear(){this.texts={},this.declaration={},this.include={},this.tokens={},this.linepos={},this.labels={},this.typedef={},this.object={method:{},property:{}},this.diagnostics.length=this.foldingranges.length=0,this.children.length=this.dllpaths.length=this.tokenranges.length=0,this.includedir.clear(),this.dlldir.clear(),this.hotstringExecuteAction=this.isparsed=!1,delete this.maybev1,delete this.checkmember,delete this.symbolInformation}get included(){return fe[this.uri]??{}}get relevance(){const e=this.uri,t={...ue[e]};for(const n in fe[e])Object.assign(t,ue[n]);return delete t[e],t}findSymbol(e,t,n){let i,o,s=this.uri;if(t===r.SymbolKind.Field){let t,r=this.tokens,a=n?this.document.offsetAt(n):-1;for(i of(o=n&&this.searchScopedNode(n),(o??this).labels?.[e.endsWith(":")?e.slice(0,-1):e]??[])){if(!i.def)break;if(-1===(t=i.data)||t<a&&(!(t=r[r[t].next_pair_pos]?.offset)||a<t))return{node:i,uri:s,scope:o}}return o&&null}let a,c,l=!0;if(e.startsWith("$"))return(i=p(this.d?s:this.d_uri))&&{node:i,uri:s,is_global:!0};if(o=n&&this.searchScopedNode(n))if(o.kind===r.SymbolKind.Class)o=void 0;else if(o.kind===r.SymbolKind.Property&&"THIS"===e)return{node:o.parent,uri:s,scope:o,is_this:!0};let f=o;for(;f?.local;){if(a=f.local[e]){i=a,c=f,l=!1,i.is_param&&f.parent?.kind===r.SymbolKind.Property&&(c=f.parent);break}if(f.has_this_param&&("THIS"===e||"SUPER"===e)){for(i=f;i.kind!==r.SymbolKind.Class;)if(!(i=i.parent))return null;if("THIS"===e)return{node:i,uri:s,scope:o,is_this:!0};V(i,this);let t=i,n=!t.prototype;return t=i=G(this,t.extends||(n?"object":"class"),t.extendsuri),!i||n&&!(i=t.prototype)?null:{node:i,uri:s,scope:o,is_this:!1}}if(((a=f.global?.[e])&&(i=a)||f.assume===u.GLOBAL)&&(l=!0))break;if((a=f.declaration?.[e])?(i=a,c=f,l=!1):i??=(c=f,f.unresolved_vars?.[e]),f.static&&f.kind===r.SymbolKind.Function){(a=f.parent?.local[e])?.static&&(i=a,c=f.parent),i?.def&&(l=!1);break}f=f.parent}return l&&(i=p(this.d_uri)??this.declaration[e]??(l=1,i)??(l=!0,this.typedef[e])),i&&{node:i,uri:s,scope:o,is_global:l,parent:c};function p(t){let n=d.lexers[t];if(!n)return;let i=n.declaration[e]??n.typedef[e];return i&&(s=i.uri=t,i)}}getContext(e,t=!1){let n,i,o,s,a,c=this.document,l=this.tokens,{line:d,character:u}=e,p=c.getText(r.Range.create(d,0,d+1,0)).trimRight();for(s=u;--s>=0&&y(p.charCodeAt(s)););if(!t)for(;y(p.charCodeAt(u));u++);let h=r.Range.create(d,s+=this.d&&"$"===p[s]?0:1,d,u),g=p.slice(s,u),m=g,_=c.offsetAt(h.start),b=(o=l[_])?o.previous_token:l[_-1];if("."===b?.content&&!o?.prefix_is_whitespace&&"TK_OPERATOR"!==b.type||(a=b&&X(b)&&"TK_START_EXPR"===o?.type&&o.topofline<1&&("["===o.content||void 0===o.prefix_is_whitespace))){let e=b,t=a?b:b.previous_token,i=Boolean(o?.paraminfo)||"("===p[u];for(;t;)switch(t.type){case"TK_DOT":e=t,t=t.previous_token;break;case"TK_END_EXPR":if(!(t=l[t.previous_pair_pos]))break;e=t,!t.next_pair_pos||t.topofline>0?t=void 0:void 0===t.prefix_is_whitespace||"["===t.content&&!t.previous_token?.callsite?(t=t.previous_token)&&("TK_NUMBER"===t.type||"TK_STRING"===t.type||"%"===t.content&&(t=D)?(e=t,t=void 0):"TK_WORD"===t.type||"TK_DOT"===t.type||t.type.startsWith("TK_END_")||(t=void 0)):t=void 0;break;case"TK_START_BLOCK":case"TK_START_EXPR":break;case"TK_END_BLOCK":if(void 0!==t.in_expr){e=l[t.in_expr],t=void 0;break}if(e=t,!(t=l[t.previous_pair_pos]))break;case"TK_START_BLOCK":e=t.data?t:D,t=void 0;break;case"TK_NUMBER":case"TK_STRING":e=t,t=void 0;break;case"TK_WORD":if(e=t,t=t.previous_token){if("TK_DOT"===t.type)break;if("TK_START_BLOCK"===t.type){t=void 0;break}void 0===e.prefix_is_whitespace&&void 0!==t.previous_pair_pos&&"%"===t.content&&(e=D),t=void 0}break;case"TK_OPERATOR":if(t.ignore&&"?"===t.content){e=t,t=t.previous_token;break}default:t=void 0}/TK_WORD|TK_NUMBER|TK_STRING|TK_START_/.test(e.type)?(o=e,h.start=c.positionAt(e.offset),h.end=c.positionAt(b.offset+(a?1:0))):(o=D,n=r.SymbolKind.Null),m="",n??=a?r.SymbolKind.Variable:i?r.SymbolKind.Method:r.SymbolKind.Property}else if(o)if("TK_WORD"===o.type){let e,t=o.semantic,s=(i=o.symbol)??o.definition;if(s)n=s.kind,e=s,n===r.SymbolKind.Class?m=e.full:n!==r.SymbolKind.Property&&n!==r.SymbolKind.Method||(m=e.full.replace(/^\((\S+)\).*$/,((...t)=>`${t[1]}${e.static?".":"#"}${e.name}`)));else if(t)switch(t.type){case f.function:n=r.SymbolKind.Function;break;case f.method:n=r.SymbolKind.Method;break;case f.class:n=r.SymbolKind.Class;break;case f.property:n=r.SymbolKind.Property;break;case f.variable:if(o.ignore)break;case f.parameter:n=r.SymbolKind.Variable}else n=r.SymbolKind.Variable}else"TK_LABEL"===o.type&&(n=r.SymbolKind.Field);else if(b?.content.startsWith("#"))o=b,m=b.content;else if(m=(o=this.find_token(h.start.character===p.length?_-1:_)).content,o.type.endsWith("COMMENT")){let e=p.substring(0,u),t=e.match(/(@see|\{@link(code|plain)?|@param(\s+\{[^}]*\})?)\s+((\[\s*)?\S+)$/);if(t){if(e=t[4],t[1].startsWith("@param")){e=e.replace(/^\[\s*/,"");let t=o.symbol;t?.params&&(e=`${oe(t)}~${e}`)}else":"===p[u]&&/^[a-zA-Z]+$/.test(e)&&(e="");(t=e.match(/^(([\w.$#~]|[^\x00-\x7f])+)(\(\))?$/))&&(m=t[1],n=m.includes(".")?t[3]?r.SymbolKind.Method:r.SymbolKind.Property:t[3]?r.SymbolKind.Function:r.SymbolKind.Class)}}return n??=r.SymbolKind.Null,{text:m,word:g,range:h,kind:n,linetext:p,token:o,symbol:i}}searchScopedNode(e,t){let n,i,o,s,{line:a,character:c}=e;for(let l of t??this.children)if(!(!(n=l.children)||a>l.range.end.line||a<l.selectionRange.start.line||a===l.selectionRange.start.line&&c<l.selectionRange.start.character||a===l.range.end.line&&c>l.range.end.character)){if(e.line>l.selectionRange.start.line||e.character>l.selectionRange.end.character){switch(l=this.searchScopedNode(e,n)??l,l.kind){case r.SymbolKind.Property:return this.searchScopedNode(e,[l.get,l.set].filter(Boolean))??l;case r.SymbolKind.Class:for(o of(s=this.document.offsetAt(e),i=l,[i.property.__INIT,i.$property?.__INIT]))for(let t of o?.ranges??[]){if(s<=t[0])break;if(s<=t[1])return this.searchScopedNode(e,o.children)??o}}return l}return}}getScopeSymbols(e){if(!e||e.kind===r.SymbolKind.Class||e.kind===r.SymbolKind.Property)return{};let n=e,i=[n];for(;(n=n.parent)&&n.kind!==r.SymbolKind.Class;)i.push(n);let o=n?.kind===r.SymbolKind.Class?{THIS:t.THIS,SUPER:t.SUPER}:{};for(;n=i.pop();)n.kind!==r.SymbolKind.Property&&(n.assume===u.GLOBAL?o={}:n.assume===u.STATIC&&Object.entries(o).forEach((([e,t])=>!t.static&&null!==t.static&&delete o[e])),Object.assign(o,n.local??{}),Object.entries(n.declaration??{}).forEach((([e,t])=>o[e]??=t)),Object.entries(n.unresolved_vars??{}).forEach((([e,t])=>o[e]??=t)),Object.keys(n.global??{}).forEach((e=>delete o[e])));return o}initLibDirs(e){if(d.isBrowser)return;let t;for(t of d.extsettings.WorkingDirs)if(this.uri.startsWith(t)){e=a.URI.parse(t).fsPath.replace(/[\\/]$/,"");break}e?this.scriptdir=(0,d.restorePath)(e):(t=(0,o.resolve)()).toLowerCase()!==this.scriptpath.toLowerCase()&&t.toLowerCase()!==process.argv0.toLowerCase()&&this.scriptpath.toLowerCase().startsWith(t)&&!/\\lib(\\.+)?$/i.test(this.scriptpath)?(0,i.existsSync)(this.scriptpath+"\\Lib")&&(0,i.statSync)(this.scriptpath+"\\Lib").isDirectory()?this.scriptdir=this.scriptpath:this.scriptdir=t:this.scriptdir=this.scriptpath.replace(/\\Lib(\\.+)?$/i,""),this.libdirs=[e=this.scriptdir+"\\Lib\\"],e=e.toLowerCase();for(const e of d.libdirs)this.libdirs[0]!==e.toLowerCase()&&this.libdirs.push(e)}getColors(){let e=this.tokenranges,t=this.document,n=t.getText(),i=[];for(let o of e)if(2===o.type){let e,s=o.start,a=o.end,c=_.exec(n.substring(s,a)),l="";if(!c||!c[1]&&a-s!==c[2].length+2)continue;e=r.Range.create(t.positionAt(s+=c.index+1+(c[1]?.length??0)),t.positionAt(s+c[2].length)),l=c[5]?b[c[5].toLowerCase()]:void 0===c[3]?c[2]:c[2].substring(2);let d={red:0,green:0,blue:0,alpha:1},u=["red","green","blue"];void 0!==c[4]&&u.unshift("alpha");for(const e of u)d[e]=parseInt("0x"+l.substring(0,2))/255,l=l.slice(2);i.push({range:e,color:d})}return i}addDiagnostic(e,t,n,i=r.DiagnosticSeverity.Error,o){let s=this.document.positionAt(t),a=s;void 0!==n&&(a=this.document.positionAt(t+n)),(o||this.diagnostics).push({range:r.Range.create(s,a),message:e,severity:i})}addFoldingRange(e,t,n="block"){let i=this.document.positionAt(e).line,o=this.document.positionAt(t).line-("block"===n?1:0);i<o&&this.foldingranges.push(r.FoldingRange.create(i,o,void 0,void 0,n))}addFoldingRangePos(e,t,n="block"){let i=e.line,o=t.line-("block"===n?1:0);i<o&&this.foldingranges.push(r.FoldingRange.create(i,o,void 0,void 0,n))}addSymbolFolding(e,t){let n=d.extsettings.SymbolFoldingFromOpenBrace?this.document.positionAt(t).line:e.range.start.line,i=e.range.end.line-1,o=this.foldingranges;n<i&&(o[o.length-1]?.startLine===n&&o.pop(),o.push(r.FoldingRange.create(n,i,void 0,void 0,"block")))}update(){const e=this.uri,t=this.include;this.parseScript(),d.libfuncs[e]&&(d.libfuncs[e].length=0,d.libfuncs[e].push(...Object.values(this.declaration).filter((e=>e.kind===r.SymbolKind.Class||e.kind===r.SymbolKind.Function))));let n=this.include,i=0,o=Object.keys(n).length;for(const e in t)if(!n[e]){i=2;break}if(!i&&(o>Object.keys(t).length||!o&&""===t[""]&&Object.keys(fe[e]??{}).length)&&(i=1),!i)return this.sendDiagnostics(!0);if(U(this,this.scriptdir),1===i){const e=he(this);for(const t in this.included)Object.assign(ue[t],e)}else pe();let s=this.scriptpath,a=Object.keys(ue[e]).length;for(const t in fe[e])o=Object.keys(ue[t]).length,(o>a||o===a&&d.lexers[t].scriptpath.length<s.length)&&(s=d.lexers[t].scriptpath,a=o);let c,l=s.toLowerCase();const u=this.relevance;(l+"\\").startsWith(this.scriptdir.toLowerCase()+"\\lib\\")?(s=this.scriptdir,l=s.toLowerCase()):l!==this.scriptdir.toLowerCase()&&this.initLibDirs(s);for(const e in u)delete t[e],(c=d.lexers[e]).scriptdir.toLowerCase()!==l&&c.initLibDirs(s);for(const e in t){const t=d.lexers[e];t&&!t.actived&&t.close()}this.sendDiagnostics(!0,!0)}clearDiagnostics(){this.last_diags&&(this.include={},this.last_diags=0,d.connection.sendDiagnostics({uri:this.document.uri,diagnostics:[]}))}sendDiagnostics(e=!1,t=!1){let n=this.last_diags;if((n!==this.diagnostics.length||e&&n)&&(d.connection.sendDiagnostics({uri:this.document.uri,diagnostics:this.diagnostics}),this.last_diags=this.diagnostics.length),t)for(let t in this.relevance)d.lexers[t]?.sendDiagnostics(e)}setWorkspaceFolder(){let e=this.uri;for(const t of d.workspaceFolders)if(e.startsWith(t))return this.workspaceFolder=t;return this.workspaceFolder=""}keepAlive(){if(this.actived)return!0;let e,{uri:t,d:n}=this;if(!d.lexers[t])return!1;if(n){if(n>2&&!t.includes("?"))return!0;if(d.lexers[t.slice(0,-5)+"ahk"]?.keepAlive())return!0}for(const n in this.relevance)if((e=d.lexers[n])?.actived&&e.relevance[t])return!0;return!1}close(e=!1,t=!0){if(this.actived=!1,!e&&this.keepAlive())return;this.clearDiagnostics();const n=this.relevance;if(!e&&this.workspaceFolder||(delete d.lexers[this.uri],delete ue[this.uri],!this.actived&&d.lexers[this.d_uri]?.close(!1,!1)),!t)return;let i=!0;for(const e in n)i=!1,d.lexers[e]?.close(!1,!1);i?d.lexers[this.uri]||delete fe[this.uri]:pe()}findStrOrComment(e){let t,n=this.tokenranges,i=0,o=n.length-1,r=0;for(;i<=o;)if(t=n[r=i+o>>1],e<t.start)o=r-1;else{if(!(e>=t.end))break;i=r+1}if(i<=o&&t)return this.tokens[t.start]??((t=this.tokens[t.previous])?.data&&{...t.data,previous_token:t,type:""})}}function j(e,t=0,n=""){return{name:e,full:e,kind:t,extends:n,range:x,selectionRange:x,uri:""}}function W(e){let t=e.match(/^((([<>$~*!+#^]*?)(`?;|[\x21-\x3A\x3C-\x7E]|\w+|[^\x00-\x7f]))|~?(`?;|[\x21-\x3A\x3C-\x7E]|\w+|[^\x00-\x7f])\s+&\s+~?(`?;|[\x21-\x3A\x3C-\x7E]|\w+|[^\x00-\x7f]))(\s+up)?::$/i);if(!t)return!1;for(let e=4;e<7;e++)if((t[e]??"").length>1&&!w.test(t[e]))return!1;return!0}function $(e,t,n="",r=!1){let s,c="",l=e;if(!e.startsWith("<")||!e.endsWith(">")){for(;s=e.match(/%a_(\w+)%/i);){let t=s[1].toLowerCase();if(!d.a_vars[t])return;e=e.replace(s[0],d.a_vars[t])}if(e.indexOf(":")<0?e=(0,o.resolve)(n,e):e.includes("..")&&(e=(0,o.resolve)(e)),r&&!(0,i.existsSync)(e))return;return c=a.URI.file(e).toString().toLowerCase(),{uri:c,path:d.lexers[c]?.fsPath??e,raw:l}}{if(!(e=e.slice(1,-1)))return;let n=[e+".ahk"];(s=e.match(/^((\w|[^\x00-\x7f])+)_.*/))&&n.push(s[1]+".ahk");for(const o of t)for(const t of n)if((0,i.existsSync)(e=o+t))return c=a.URI.file(e).toString().toLowerCase(),{uri:c,path:d.lexers[c]?.fsPath??e,raw:l}}}function U(e,t){let n=e.include;for(const e in n){let o=n[e];if(!d.lexers[e]&&(0,i.existsSync)(o)){let n=(0,d.openFile)((0,d.restorePath)(o));if(!n)continue;let i=new F(n,t);d.lexers[e]=i,i.parseScript(),U(i,t)}}}function V(e,t){switch(e.kind){case r.SymbolKind.Method:case r.SymbolKind.Function:return q.FUNC;case r.SymbolKind.Number:return q[e.name.toUpperCase()];case r.SymbolKind.String:return q.STRING;default:if(!e.property)return;case r.SymbolKind.Class:let n,i,o=e;if(n=o.base)return n;if(i=!!o.prototype,o.extends)return o=G(t??d.lexers[o.uri],o.extends,o.extendsuri),i?o:o?.prototype;switch(o){case q.ANY:return;case d.ahkvars.ANY:return q.CLASS;default:return i?d.ahkvars.OBJECT:q.OBJECT}}}function B(e,t,n,i,o){let s,a,c,l,d=t,u=0,f=o??=[];for(n=n.toUpperCase();;){if(u===f.length){if(f.includes(d))break;f.push(d)}if(c=d.property?.[n]){if(c.kind===r.SymbolKind.Method===i)return c.uri??=d.uri,c;if(i&&((l=c).kind===r.SymbolKind.Class||(l=c.call)))return l.uri??=d.uri,l;i?s??=(c.uri??=d.uri,c):a??=(c.uri??=d.uri,c)}if(null===(l=f[++u]))break;if(!(d=l??V(d,e))){f.push(null);break}}if(s??=a)return s}function H(e,t){let n=B(t??=d.lexers[e.uri],e,"call",!0);return n?.full?.startsWith("(Object) static Call(")?B(t,e.prototype,"__new",!0)??n:n}function z(e,t,n){let i,o=[];do{if(i=t.property?.[n])return i.uri??=t.uri,i}while(t=(i=t.extends?.toLowerCase())&&[i,`(${i}) prototype`].includes(t.full.toLowerCase())&&!o.includes(t)&&o.push(t)?V(t,e):void 0)}function G(e,t,n){let i=t.toUpperCase().split("."),o=i.shift(),r=n?d.lexers[n]?.declaration[o]:le(e,o)?.node;if(r?.property&&!1!==r.def){for(o of(n??=r.uri,i))if(!(r=z(e,r,o)))return;return r.uri??=n,r}}function X(e){switch(e.type){case"TK_DOT":return!0;case"TK_END_BLOCK":return Boolean(e.data??void 0!==e.in_expr);case"TK_END_EXPR":case"TK_NUMBER":case"TK_STRING":return!0;case"TK_WORD":return!e.paraminfo;case"TK_OPERATOR":if(1===e.op_type)return!0;switch(e.content){case"?":return Boolean(e.ignore);case"%":return void 0!==e.previous_pair_pos;case"++":case"--":return!e.topofline&&X(e.previous_token??D)}default:return!1}}function Q(e,n,i,o){let s,a,c,l=e.tokens,u=D,f=[],p=[],h=[0];s="object"==typeof i?e.document.offsetAt(i):i;e:for(;n&&n.offset<s;){switch(n.type){case"TK_STRING":case"TK_NUMBER":if(b())break e;f.push(n),u=n;break;case"TK_WORD":if(b())break e;if(f.push(n),u=n,n.symbol){n=e.find_token(e.document.offsetAt(n.symbol.range.end),!0);continue}if(n.callsite){if(n.next_token_offset>=s)break e;if(f.push(a={content:"",type:"TK_FUNC",paraminfo:n.callsite.paraminfo??n.paraminfo}),n=l[n.next_token_offset],a.data="("===n?.content,!n||!(n=l[n.next_pair_pos])){f.length=0;break e}}break;case"TK_DOT":if("TK_WORD"===(n=l[n.next_token_offset])?.type){if(a=l[n.next_token_offset],"["===a?.content&&a.topofline<1||"("===a?.content&&!a.prefix_is_whitespace){let e={content:n.content,type:"TK_FUNC"};if(f.push(e),a.offset>=s)break e;if(e.data="("===a.content,e.paraminfo=a.paraminfo,!(n=l[a.next_pair_pos])){f.length=0;break e}break}"%"!==a?.content||a.prefix_is_whitespace||void 0!==a.previous_pair_pos?f.push({content:n.content,type:"TK_FUNC"}):v()}else if("TK_START_EXPR"===n?.type){if(n.offset>=s)break e;if(f.push({content:"",type:"TK_FUNC",data:"("===n.content,paraminfo:n.paraminfo}),!(n=l[n.next_pair_pos])){f.length=0;break e}}else v();break;case"TK_OPERATOR":if("%"===n.content&&void 0===n.previous_pair_pos){if(n.prefix_is_whitespace){if(b())break e;v()}else v();break}case"TK_EQUALS":if(_(n))break e;break;case"TK_START_EXPR":if(!(n=l[(a=n).next_pair_pos])){f.length=0;break e}if(!a.symbol&&(!a.prefix_is_whitespace||"["===a.content&&a.topofline<1)&&(1===u.op_type||["TK_WORD","TK_NUMBER","TK_STRING","TK_END_EXPR"].includes(u.type)||"TK_END_BLOCK"===u.type&&(c=l[u.previous_pair_pos])&&(c.data??void 0!==c.in_expr)))f.push({content:"",type:"TK_FUNC",paraminfo:a.paraminfo,data:"("===a.content});else if("["===a.content)f.push({symbol:A});else{if(b())break e;if(f.push(a),a.symbol){u=n,n=e.find_token(e.document.offsetAt(a.symbol.range.end),!0);continue}}u=n;break;case"TK_START_BLOCK":if(!(n=l[(a=n).next_pair_pos])){f.length=0;break e}f.push(a);break;case"TK_COMMENT":case"TK_INLINE_COMMENT":case"TK_BLOCK_COMMENT":break;case"TK_COMMA":f.length=p.length=0,u=D,h=[0];break;case"TK_END_BLOCK":case"TK_END_EXPR":if(n.offset===s-1)break e;default:f.length=0;break e}n=l[n.next_token_offset]}if(!f.length)return[];for(;n=p.pop();)y(n);let g=new Set,m=[];for(n of f)if(n.symbol)if(n.symbol.kind===r.SymbolKind.Property){let t=n.symbol,i=t.parent;m=(t=i?.property?.[t.name.toUpperCase()])?ie(t,d.lexers[i.uri]??e,i):[]}else m=[n.symbol],n.symbol.uri??=e.uri;else switch(n.type){case"TK_FUNC":let i=!!n.data;m=J(e,m,n.content.toLowerCase()||(i?"call":"__item"),i,n.paraminfo);break;case"TK_WORD":let s=e.document.positionAt(n.offset),d=le(e,n.content,r.SymbolKind.Variable,s);if(!d)continue;m=new Set;let u=d.node;if(u.kind===r.SymbolKind.Variable)for(let t of Z(u,e,s,d.scope,o))m.add(t);else m.add(u);break;case"TK_NUMBER":m=/^[-+]?(\d+$|0[xX])/.test(n.content)?[E]:/^[-+]?\d+[.eE]/.test(n.content)?[O]:[P];break;case"TK_STRING":m=[t.STRING];break;case"TK_START_BLOCK":if(!(a=n.data))break;if(m=[a],a.uri??=e.uri,c=!a.extends&&a.property?.BASE){let t=ie(c,e,o);if(t.length<2)a.base=t[0];else{m=[];for(let e of t)m.push({...a,base:e})}}break;case"TK_START_EXPR":let f=(a=n.paraminfo?.comma)?.length?a.at(-1):n.next_token_offset;m=Q(e,l[f],n.next_pair_pos-1,o);break;default:if("||"===n.content)for(let e of m)g.add(e);m=[]}for(let e of m)g.add(e);return[...g];function y(e){let n=h.pop(),i=f.splice(n??0),o={content:"",type:"TK_NUMBER"};if(void 0===n||!i.length)return f.length=0,!0;switch(e.op_type??("TK_EQUALS"===e.type&&0)){case-1:"&"===e.content&&1===i.length&&"TK_WORD"===i[0].type&&i[0].offset&&(o={symbol:t.VARREF});case 1:break;case 0:let r,s=f.splice((n=h.pop())??0);if(void 0===n||!s.length)return f.length=0,!0;if(e.content.startsWith("."))o.type="TK_STRING";else{if(":="===e.content)return h.push(f.length),void f.push(...i);if(["&&","and"].includes(r=e.content.toLowerCase()))return h.push(f.length),f.push(o),f.push({type:"TK_OPERATOR",content:"||",op_type:0}),void f.push(...i);if(["||","or","??","??=",":"].includes(r))return h.push(f.length),f.push(...s),f.push({type:"TK_OPERATOR",content:"||",op_type:0}),void f.push(...i)}break;default:return f.length=0,!0}h.push(f.length),f.push(o)}function _(e){let t=k(e,!1),n=p.length?k(p[p.length-1]):-1;for(;t<=n;){if(y(p.pop()))return!0;n=p.length?k(p[p.length-1]):-1}"?"===e.content?e.ignore||f.splice(h[h.length-1]??0):(p.push(e),!e.op_type&&h.push(f.length)),u=e}function b(){if(X(u))return _(u={content:".",type:"TK_OPERATOR",op_type:0})}function v(){let e=n;f.splice(h[h.length-1]),f.push({symbol:t.ANY});do{for(;n;)if("TK_WORD"===n.type){if(e=n,!(n=l[n.next_token_offset])||"%"!==n.content||n.prefix_is_whitespace)break}else{if("%"!==n.content||void 0!==n.previous_pair_pos)break;if(e=l[n.next_pair_pos],!(n=l[e?.next_token_offset])||"TK_WORD"!==n.type||n.prefix_is_whitespace)break}if(n&&("["===n.content||"("===n.content&&!n.prefix_is_whitespace)){if(e=n,!(n=l[n.next_pair_pos]))break;e=n,n=l[n.next_token_offset]}}while("TK_DOT"===n?.type&&n.offset<s);u=n=e}function k(e,t=!0){if("TK_OPERATOR"===e.type)switch(e.content.toLowerCase()){case"++":case"--":return-1===e.op_type?77:82;case"||":case"or":return 17;case"&&":case"and":return 21;case"is":return 28;case">":case"<":case">=":case"<=":return 34;case"=":case"==":case"!=":case"!==":return 30;case"~=":return 36;case".":return 38;case"|":return 42;case"^":return 46;case"&":return-1===e.op_type?67:50;case"<<":case">>":case"<<<":return 54;case"//":case"*":case"/":return 62;case"+":case"-":return-1===e.op_type?67:58;case"**":return 73;case"not":return 25;case"!":return 67;case"?":return e.ignore?85:11;case":":return 11;default:return 0}return"TK_DOT"===e.type?86:"TK_EQUALS"===e.type?t?7:99:"TK_COMMA"===e.type?6:0}}function J(e,n,i,o,s){let a=new Set;for(let l of n){let n=l;switch(l.kind){case 0:return[t.ANY];case r.SymbolKind.Class:if(o&&"call"===i){if(!(l=B(e,n,i,o))){if(c(n))break;continue}let t=l.full??"";if(t.startsWith("(Object)"))l=n;else if(t.startsWith("(ComObject)")){let t=e.tokens,n=t[t[s?.offset]?.next_token_offset],i=[];"TK_STRING"===n?.type&&(i.push(n.content),","===(n=t[n.next_token_offset])?.content&&(n=t[n.next_token_offset],"TK_STRING"===n?.type&&(i.push(n.content),n=t[n.next_token_offset])),")"===n?.content&&a.add({kind:r.SymbolKind.Interface,name:"ComObject",full:`ComObject<${i.join(", ")}>`,generic_types:[i],range:x,selectionRange:x}));continue}break}case r.SymbolKind.Function:case r.SymbolKind.Method:if(o&&"call"===i)break;default:if(!(l=B(e,n,i,o))){if(l=c(n))break;continue}if(l.kind!==r.SymbolKind.Property){if(l.alias){if(s)continue;let t=ie(l,d.lexers[l.uri]??e,n);for(let n of o?J(e,t,"call",!0):t)a.add(n);continue}if(o)break;if(s)for(let t of J(e,[l],"__item",!1,s))a.add(t);else a.add(l);continue}if(l.alias){let t=J(e,ie(l,d.lexers[l.uri]??e,n),"call",!0);for(let n of o?J(e,t,"call",!0):t)a.add(n);continue}if(o||s&&!l.get?.params.length){for(let t of J(e,ie(l,d.lexers[l.uri]??e,n),o?"call":"__item",o,s))a.add(t);continue}}for(let t of ie(l,d.lexers[l.uri]??e,n))a.add(t)}return a;function c(t){let n=B(e,t,o?"__call":"__get",o);if(!n)return;if(n.kind===r.SymbolKind.Method&&!n.alias)return n;let i=n.kind===r.SymbolKind.Class?[n]:n.children?void 0:ie(n,d.lexers[n.uri]??e,t);if(i?.length)for(let t of J(e,i,"call",!0,s))a.add(t)}}function Y(e,t){if(!t||t.children)return t;let n=le(e,t.full.replace(/<.+/,""))?.node;return n?.prototype?n:void 0}function Z(e,n,i,o,s){let a,c,l=e.name.toUpperCase(),u=e,f=e.type_annotations?[e]:[];if(!o)for(const e in n?.relevance){let t=d.lexers[e]?.declaration?.[l];t?.type_annotations&&(f.includes(t)||f.push(t))}for(let e of f){if((c=e.returns)&&(e.returns=void 0),a=ie(e,n,s),c&&(e.returns=c),e.is_param&&e.pass_by_ref){let e=new Set;for(let i of a){if(i===t.VARREF)return[t.ANY];i.data===t.VARREF?ne(i.generic_types?.[1]??[t.ANY],e,n,s):e.add(i)}a=[...e]}if(a.includes(t.ANY)&&(a=[t.ANY])||!a.includes(M))return a;break}a??=[],c=void 0;for(const t of(o??n).children??[])if(l===t.name.toUpperCase()){if(t.kind!==r.SymbolKind.Variable)return[t];if(t.range.end.line>i.line||t.range.end.line===i.line&&t.range.end.character>i.character)break;(t.pass_by_ref||t.returns&&(void 0===t.for_index||ee(t,c??=n.document.offsetAt(i))))&&(e=t)}if(void 0!==e.for_index){if(e===u&&!ee(e,c??=n.document.offsetAt(i)))return[];let o=ie(e,n,s);for(let e of o)if(l(e))return[t.ANY];return a=[...new Set(a)],a.includes(t.ANY)?[t.ANY]:a;function l(i,o=!0){let s,u=0;switch(i.kind){case r.SymbolKind.Class:{let e=[];if(o&&(c=B(n,i,"__enum",!0,e))){if(c.kind!==r.SymbolKind.Method)break;for(let e of ie(c,d.lexers[c.uri]??n,i))l(e,!1);break}if((c=B(n,i,"call",!0,e))?.kind!==r.SymbolKind.Method)break;u=-1,s=i,i=c}case r.SymbolKind.Method:u++;case r.SymbolKind.Function:let f,p=i.params?.[e.for_index+u];if(!p||!(f=p.type_annotations))break;for(let e of f){if(e===t.VARREF)return!0;e.data===t.VARREF&&a.push(...te(e.generic_types?.[0]??[],n,s,Y(n,s)?.type_params))}}}}return e.pass_by_ref&&!e.is_param?function(e,n,i,o){let s=de(n,e.selectionRange.start);if(!s||s.index<0)return[];let{pos:a,index:c,kind:l}=s,u=n.getContext(a),f=!0,p=Q(n,u.token,u.range.end);if(p.includes(t.ANY))return[t.ANY];if(!p.length)return[];let h=u.text?"":u.word.toLowerCase();l===r.SymbolKind.Property?(h||="__item",f=!1):h||="call";for(let e of p)if(g(e,h,i))return[t.ANY];return(i=[...new Set(i)]).includes(t.ANY)?[t.ANY]:i;function g(e,i,s,a=0){switch(e.kind){case r.SymbolKind.Method:a++;case r.SymbolKind.Function:if(!f||"call"!==i)break;case r.SymbolKind.Property:let l,u=e.params?.[c+a];if(!u||!(l=u.type_annotations))break;for(let e of l){if(e===t.VARREF)return!0;e.data===t.VARREF&&s.push(...te(e.generic_types?.[0]??[],n,o,Y(n,o)?.type_params))}break;case r.SymbolKind.Class:let p=B(n,e,i,f),h=e;if(!p)break;if(f){if(p.kind===r.SymbolKind.Class)p=H(p);else if(p.full?.startsWith("(Object) static Call("))p=B(n,h.prototype,"__new",!0)??p;else if(p.kind===r.SymbolKind.Property||p.alias){let e=ie(p,d.lexers[p.uri]??n,h);return p.kind===r.SymbolKind.Property&&p.alias&&(e=J(n,e,"call",!0)),void e.forEach((e=>g(e,"call",s,-1)))}return void(p?.kind===r.SymbolKind.Method&&g(p,"call",s,-1))}if(p.kind===r.SymbolKind.Class)p=B(n,p,"__item",!1);else{if(p.kind!==r.SymbolKind.Property)return;if(!p.params){for(let e of ie(p,d.lexers[p.uri]??n,h))(e=B(n,e,"__item",!1))&&g(e,"",s);return}}p&&g(p,"",s)}}}(e,n,a,s):(a.push(...ie(e,n,s)),a=[...new Set(a)],a.includes(t.ANY)?[t.ANY]:a)}function ee(e,t){let n=e.data;return n[0]<=t&&t<n[1]}function te(e,n,i,o){let r,s=new Set;for(let n of e)"object"!=typeof n?((r=n.startsWith("typeof "))&&(n=n.substring(7)),"'\"".includes(n[0])?s.add(t.STRING):/^[-+]?(\d+$|0[xX])/.test(n)?s.add(E):/^[-+]?\d+[.eE]/.test(n)?s.add(O):s.add(`${r?"typeof ":""}${n}`)):s.add(n);let a=new Set;return ne([...s],a,n,i,o),[...a]}function ne(e,t,n,i,o){let s,a,c,l,d,u,f=-1;for(let s of e)f++,"string"==typeof s?((c=s.startsWith("typeof "))&&(s=s.substring(7)),(d=o?.[s.toUpperCase()])?ne(i.generic_types?.[d.data]??(d.type_annotations||[]),t,n,i,o):(l=(a="this"===s)&&i||le(n,s)?.node)&&(l.kind===r.SymbolKind.TypeParameter?(u=!0,e[f]="",e.push(...te(l.type_annotations||[],n))):l.kind!==r.SymbolKind.Variable&&(t.add(l=!c&&l.prototype||l),!a&&(e[f]=l)))):s.kind===r.SymbolKind.TypeParameter?(u=!0,e[f]="",e.push(...te(s.type_annotations||[],n))):t.add(o?p(s):s);function p(e){let t=e.generic_types;return t?(s??=new RegExp(`[< ](${Object.keys(o).join("|")})[,>]`,"i"),s.test(e.full)?(t=t.map((e=>e.flatMap((e=>"object"==typeof e?[p(e)]:(d=o[e.toUpperCase()])?i.generic_types?.[d.data]??(d.type_annotations||[]):[e])))),t.length||(t=void 0),{...e,generic_types:t,full:e.full.replace(/<.+/,t?`<${t.map((e=>se(e))).join(", ")}>`:"")}):e):e}u&&e.push(...new Set(e.splice(0).filter(Boolean)))}function ie(e,n,i){let o,r,s,a,c;switch(!e.cached_types){case!0:let c=e.type_annotations;if(!c)break;o=new Set;for(let e of c)"object"!=typeof e?((s=e.startsWith("typeof "))&&(e=e.substring(7)),"'\"".includes(e[0])?o.add(t.STRING):/^[-+]?(\d+$|0[xX])/.test(e)?o.add(E):/^[-+]?\d+[.eE]/.test(e)?o.add(O):o.add(`${s?"typeof ":""}${e}`)):o.add(e);if(o.has(t.ANY))return e.cached_types=[t.ANY];e.cached_types=[...o],a=o.has(M);default:if(ne(r=e.cached_types,o=new Set,n,i,i&&e.parent?.type_params),!a)return[...o]}if(e.returns){e.cached_types=[t.ANY],c=[];for(let t=0,o=e.returns,r=o.length;t<r;t+=2)c.push(...Q(n,n.find_token(o[t],!0),o[t+1],i));if(o){for(let e of new Set(c))!e.property||e.name||o.has(e)||(o.add(e),r.push(e));c=[...o],e.cached_types=r}else o=new Set(c),e.cached_types=c=[...o]}else c=o?[...o]:[];return c}function oe(e){let t;switch(e.kind){case r.SymbolKind.Interface:return e.full;case r.SymbolKind.Class:return t=e,t.prototype?`typeof ${t.full}`:t.full||"Object";case r.SymbolKind.Function:if(e.name){let t=e,n=[e],i=[e.name];for(;t.parent?.params;)n.push(t=t.parent),i.push(t.name);if(!i.includes("")&&t.kind!==r.SymbolKind.Property)return t.kind!==r.SymbolKind.Function&&i.splice(-1,1,oe(t)),i.reverse().join("~")}let n=e;return t=n.full.replace(/^[^()]+/,""),t.length===n.param_def_len&&(n.params.some((e=>e.range_offset))&&(t=`(${n.params.map((e=>`${e.pass_by_ref?"&":""}${e.name}${null===e.defaultVal||e.range_offset?"?":e.defaultVal?` := ${e.defaultVal}`:e.arr?"*":""}`)).join(", ")})`),t+=` => ${re(e)||"void"}`),t;case r.SymbolKind.String:case r.SymbolKind.Number:return(e.data??e.name).toString();case r.SymbolKind.Null:return"unset";case r.SymbolKind.Method:case r.SymbolKind.Property:if(t=e.full?.match(/^\((.+?)\)/)?.[1])return`${t}${e.static?".":"#"}${e.name}`;default:return"unknown"}}function re(e,t){return se(e.type_annotations||ie(e,d.lexers[e.uri]??t))}function se(e){if(!e)return"";let t=[...new Set(e.map((e=>"string"==typeof e?e:oe(e))))],n=t.pop();return n?((t=t.map((e=>e.includes("=>")&&!"\"'".includes(e[0])?`(${e})`:e))).push(n),t.join(" | ")):""}function ae(e){if(e){let t=new F(s.TextDocument.create("","ahk2",0,`$:${e}`),void 0,-1);return t.parseScript(),t.declaration.$?.type_annotations??!1}return!1}t.Lexer=F,t.find_include_path=$,t.parse_include=U,t.get_class_base=V,t.get_class_member=B,t.get_class_members=function(e,t,n){let i=t,o=n??[],r=[];for(;i&&!o.includes(i);)o.push(i),r.push(i.property),i=V(i,e);if(!n)for(let e;i=o.pop();e=i.checkmember??=e);return Object.assign({},...r.reverse())},t.get_class_constructor=H,t.find_class=G,t.decltype_expr=Q,t.decltype_invoke=J,t.decltype_returns=ie,t.generate_type_annotation=re,t.join_types=se;const ce=[r.SymbolKind.Variable,r.SymbolKind.Function,r.SymbolKind.Field];function le(e,t,n,i){let o,s,a=t.toUpperCase().split(/[.#~]/),c=a.shift(),l=a.length,u=!0,f=e.findSymbol(c,n,!l&&ce.includes(n)?i:void 0);if(null===f)return;let p=f?.scope;if(f&&1!==f.is_global?f.is_global&&f.node.kind===r.SymbolKind.Variable&&(s=y(e.relevance,c),s&&(s.node.kind!==r.SymbolKind.Variable||s.node.def&&!f.node.def)&&(f=s)):f=y(e.relevance,c)??f,n===r.SymbolKind.Field)return f;if((!f||f.node.kind===r.SymbolKind.Variable&&((u=!f.node.def)||f.is_global))&&(s=function(e){if(s=d.ahkvars[e])return s;for(let t of[d.ahkuris.ahk2_h,d.ahkuris.ahk2])if(s=d.lexers[t]?.typedef[e])return s.uri??=t,s;return u&&!l&&(s=d.lexers[o=d.ahkuris.winapi]?.declaration[e])?(s.uri??=o,s):void 0}(c))?f={uri:s.uri,node:s,is_global:!0}:p&&(p.uri??=e.uri,f.scope=p),!f)return;let h,g=c.length,m=f.node;for(c of(m.uri??=f.uri,a)){switch(t[g]){default:return;case"#":if(!(m=m.prototype))return;case".":if(!(m=z(e,m,c)))return;break;case"~":if(!(m=(h=m).declaration?.[c]))return;m.uri??=h.uri}g+=c.length+1}return l&&(n===r.SymbolKind.Method&&(s=m.call)&&(s.uri??=m.uri,m=s),f={node:m,uri:m.uri,parent:h}),f;function y(e,t){let i,o;for(const s in e)if(o=(d.lexers[s]??(0,d.openAndParse)((0,d.restorePath)(e[s]),!1))?.findSymbol(t,n)){if(o.node.kind!==r.SymbolKind.Variable)return o;(!i||o.node.def&&!i.node.def)&&(i=o)}return i}}function de(e,t,n){let i,o,s,a=e.tokens,c=e.document.offsetAt(t);function l(t){let n=a[t.offset];if(i=e.document.positionAt(t.offset),"TK_WORD"===n.type)o=c>t.offset+n.content.length?0:-1;else{if(n.previous_token?.symbol)return;if(o=0,"["===n.content){if(1===n.topofline||!X(n.previous_token))return;s=r.SymbolKind.Property}else if(n.prefix_is_whitespace||!X(n.previous_token))return}if(-1!==o)for(let e of t.comma){if(!(c>e))break;++o}return s??=t.method?r.SymbolKind.Method:r.SymbolKind.Function,{name:t.name??"",pos:i,index:o,kind:s}}if(n)return l(n);let d=e.find_token(c),u=d.previous_token;if(!(c<=d.offset)||(d=u)){if(d.callsite&&c>d.offset+d.length&&t.line<=d.callsite.range.end.line)return l(d.paraminfo);if(!(d.topofline>0||t.line>e.document.positionAt(d.offset+d.length).line&&!ye(d,D)))for(;d.topofline<=0;){switch(d.type){case"TK_END_BLOCK":d=a[d.previous_pair_pos];break;case"TK_END_EXPR":d=a[(u=d).previous_pair_pos],d=d?.previous_token;break;case"TK_START_EXPR":case"TK_COMMA":if(u=d,d.paraminfo)return l(d.paraminfo);if("TK_COMMA"===u.type)return;break;case"TK_OPERATOR":"%"!==d.content||d.next_pair_pos||(d=a[d.previous_pair_pos])}if(!(d=d?.previous_token))break;if(d.callsite&&d.paraminfo)return l(d.paraminfo)}}}t.find_symbol=le,t.find_symbols=function(e,t){let n,{text:i,word:o,range:s,kind:a}=t;if(i)return(n=le(e,i,a,s.end))&&[n];let c=[],l=a===r.SymbolKind.Method,d=Q(e,t.token,s.end);if(!o&&d.length){for(let e of d)c.push({node:e,uri:e.uri});return c}for(let t of d)(n=B(e,t,o,l))&&c.push({node:n,uri:n.uri,parent:t});return c.length?c:void 0},t.get_callinfo=de;let ue={},fe={};function pe(){ue={},fe={};for(const e of Object.values(d.lexers))he(e)}function he(e,t){let{uri:n,include:i}=e,o=!0,r=ue[n]??=(o=!1,{[n]:e.fsPath});(t=(t??=fe[n])?{...t}:{})[n]=e.fsPath;for(const s in i)if(Object.assign(fe[s]??={},t),e=d.lexers[s])if(r[s])t[s]||he(e,t);else{if(o&&t[s])continue;let i=he(e,t);i[n]?r=ue[n]=Object.assign(i,r):Object.assign(r,i)}return r}function ge(e,t){if(e.kind===t.kind)return e.kind===r.SymbolKind.Class?l.diagnostic.conflictserr("class","Class",e.name):e.kind===r.SymbolKind.Function?l.diagnostic.conflictserr("function","Func",e.name):l.diagnostic.dupdeclaration();switch(t.kind){case r.SymbolKind.Variable:return l.diagnostic.assignerr(e.kind===r.SymbolKind.Function?"Func":"Class",e.name);case r.SymbolKind.Function:return e.kind===r.SymbolKind.Variable?l.diagnostic.assignerr("Func",e.name):l.diagnostic.conflictserr("function","Class",e.name);case r.SymbolKind.Class:return e.kind===r.SymbolKind.Function?l.diagnostic.conflictserr("class","Func",e.name):e.kind===r.SymbolKind.Property||e.kind===r.SymbolKind.Method?l.diagnostic.dupdeclaration():l.diagnostic.assignerr("Class",e.name);case r.SymbolKind.Property:case r.SymbolKind.Method:return l.diagnostic.dupdeclaration()}return""}function me(e,t,n){let i,o,s="";for(const a of t)if(a.name&&a.selectionRange.end.character)switch((i=a).kind){case r.SymbolKind.Variable:i.assigned||=Boolean(i.returns);case r.SymbolKind.Class:case r.SymbolKind.Function:if(o=e[s=a.name.toUpperCase()])if(o.is_global){if(i.kind===r.SymbolKind.Variable){if(i.def&&o.kind!==r.SymbolKind.Variable){1!==i.assigned&&n.push({message:l.diagnostic.assignerr(o.kind===r.SymbolKind.Function?"Func":"Class",a.name),range:a.selectionRange,severity:r.DiagnosticSeverity.Error});continue}}else if(o.def)1!==o.assigned&&n.push({message:l.diagnostic.assignerr(a.kind===r.SymbolKind.Function?"Func":"Class",a.name),range:o.selectionRange,severity:r.DiagnosticSeverity.Error});else if(o.kind===r.SymbolKind.Function){n.push({message:ge(o,a),range:a.selectionRange,severity:r.DiagnosticSeverity.Error});continue}e[s]=a}else i.kind===r.SymbolKind.Variable?o.kind===r.SymbolKind.Variable?i.def&&!o.def?e[s]=a:o.assigned||=i.assigned:i.def&&(delete i.def,1!==i.assigned&&n.push({message:ge(o,a),range:a.selectionRange,severity:r.DiagnosticSeverity.Error})):o.kind===r.SymbolKind.Variable?(o.def&&(delete o.def,1!==o.assigned&&n.push({message:ge(a,o),range:o.selectionRange,severity:r.DiagnosticSeverity.Error})),e[s]=a):!1!==o.def?n.push({message:ge(o,a),range:a.selectionRange,severity:r.DiagnosticSeverity.Error}):!1!==i.def&&(e[s]=a);else e[s]=a}}function ye(e,n,i){switch(e.type){case"":case"TK_COMMA":case"TK_EQUALS":case"TK_START_EXPR":return!0;case"TK_OPERATOR":if(e.ignore)return!1;if(!e.content.match(/^(%|\+\+|--)$/))return!0;default:switch(n.type){case"TK_DOT":case"TK_COMMA":case"TK_EQUALS":return!0;case"TK_OPERATOR":return!(n.content.match(/^(!|~|not|%|\+\+|--)$/i)||i?.ranges&&t.allIdentifierChar.test(n.content));case"TK_STRING":if(n.ignore)return!0;default:return!1}}}t.update_include_cache=pe,t.traverse_include=he,t.get_detail=function(e,t,n){let i=e.markdown_detail;return i?(n&&(i=i.replace(n,"")),i=i.replace(/\{@link(code|plain)?\b([^{}\n]*)\}/gm,((...e)=>{let n,i=e[2]?.trim()??"",o="";const s=i.search(/[|\s]/);if(-1!==s&&(o=i.substring(s+1).trim(),i=i.slice(0,s).trim()),t&&(n=i.match(/^(([\w.$#~]|[^\x00-\x7f])+)(\(\))?$/)?.[1])){const e=le(t,n,n.includes(".")?i.endsWith(")")?r.SymbolKind.Method:r.SymbolKind.Property:i.endsWith(")")?r.SymbolKind.Function:r.SymbolKind.Class);if(e&&(t=d.lexers[e.uri])){const{start:{line:n,character:r}}=e.node.selectionRange,s=encodeURIComponent(JSON.stringify([a.URI.parse(t.document.uri).toJSON(),[-1,{selection:{startLineNumber:n+1,startColumn:r+1}}]]));o||=i,i=`command:_workbench.open?${s}`}}return/^[a-z]+:/.test(i)?`[${"code"===e[1]?`\`${o}\``:o}](${i})`:` ${i} ${o} `})),i?{kind:"markdown",value:i}:""):e.detail??""},t.make_same_name_error=ge,t.check_same_name_error=me,t.is_line_continue=ye,t.update_comment_tags=function(e){let t=N;try{N=new RegExp(e,"i")}catch(e){throw N=t,e}}},6487:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.codeActionProvider=void 0;const i=n(7351),o=n(5751),r=n(7994),s=n(3939);t.codeActionProvider=async function(e,t){let n=e.textDocument.uri,a=s.lexers[n.toLowerCase()];if(!a||t.isCancellationRequested)return;let c,l=new RegExp("^"+r.diagnostic.filenotexist().replace("{0}","(.+?)\\*(\\.\\w+)")),d="",u=new RegExp(`${r.diagnostic.unexpected("(.+)")}, ${r.diagnostic.didyoumean(":=").toLowerCase()}`.replace("?","\\?")+"$|^"+r.diagnostic.deprecated("([^'\"]+)","([^'\"]+)")),f=[],p={};for(const e of a.diagnostics)if(c=u.exec(e.message))(p[c[3]?`${c[3]} ${d=c[2]}`:`${c[1]} ${d=":="}`]??=[]).push({range:e.range,newText:d});else if(c=l.exec(e.message)){d=a.document.getText(e.range);let t=(0,s.restorePath)(c[1]),l=new RegExp(c[2]+"$","i"),u=[],p=Object.assign({},e.range);p.start=Object.assign({},p.start),p.start.character=0;for(const e of(0,i.readdirSync)(t))try{l.test(e)&&u.push(`#Include '${t}${e}'`)}catch{}let h={range:p,newText:u.join("\n")},g={title:r.codeaction.include(t+"*"+c[2]),kind:o.CodeActionKind.QuickFix};g.edit={changes:{[n]:[h]}},f.push(g)}for(let[e,t]of Object.entries(p))f.push({title:e.replace(/(\S+) (\S+)/,"Replace '$1' with '$2'"),edit:{changes:{[n]:t}},kind:o.CodeActionKind.QuickFix});return f.length?f:void 0}},4104:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.colorProvider=t.colorPresentation=void 0;const i=n(3939);t.colorPresentation=async function(e,t){let n,o="RGB: ",r={range:e.range,newText:""},s=e.color,a=i.lexers[e.textDocument.uri.toLowerCase()]?.document.getText(e.range),c="";if(a&&!t.isCancellationRequested){for(const e of[s.alpha,s.red,s.green,s.blue])c+=("00"+Math.round(255*e).toString(16)).slice(-2);return(n=a.match(/^(0x)?([\da-f]{6}([\da-f]{2})?)/i))?r.newText=(n[1]||"")+c.slice(-n[2].length):r.newText=c.substring(2),o+=r.newText,[{label:o,textEdit:r}]}},t.colorProvider=async function(e,t){if(!t.isCancellationRequested)return i.lexers[e.textDocument.uri.toLowerCase()]?.getColors()}},6129:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.diagnosticFull=t.exportSymbols=t.generateComment=t.generate_fn_comment=t.setTextDocumentLanguage=t.insertSnippet=void 0;const i=n(5751),o=n(3939);function r(e){return!!o.extsettings.commands?.includes(e)||(o.connection.console.warn(`Command '${e}' is not implemented!`),!1)}function s(e){return e?.replace(/^[ \t]*(\*?[ \t]*(?=@)|\* ?)/gm,"").replace(/^\/\*+\s*|\s*\**\/$/g,"")??""}function a(e,t){r("ahk2.insertSnippet")&&o.connection.sendRequest("ahk2.insertSnippet",[e,t])}function c(e,t,n){let i,r,s=n?.replace(/\$/g,"\\$").split("\n"),a=[],c=[],l=["/**"],d={},u=0,f=!0;if(s?.forEach((e=>{(r=e.match(/^@(param|arg)\s+(({[^}]*}\s)?\s*(\[.*?\]|\S+).*)$/i))?(i=d[r[4].replace(/^\[?((\w|[^\x00-\x7f])+).*$/,"$1").toUpperCase()]??=[]).push("@param "+r[2].trim()):(r=e.match(/^@(returns?)([\s:]\s*(.*))?$/i))?(i=a,a.push(`@${r[1].toLowerCase()} ${r[3]}`)):i&&!e.startsWith("@")?i.push(e):(i=void 0,c.push(e))})),c.join("").trim()?c.forEach((e=>l.push(" * "+e))):(l.push(" * $0"),f=!1),t.params.forEach((t=>{if(i=d[t.name.toUpperCase()])i.forEach((e=>l.push(" * "+e)));else if(t.name){let n=(0,o.generate_type_annotation)(t,e);n?l.push(` * @param \${${++u}:{${n}\\}} ${t.name} $${++u}`):l.push(` * @param ${t.name} $${++u}`)}})),a.length)a.forEach((e=>l.push(" * "+e)));else{let n=(0,o.generate_type_annotation)(t,e);n&&l.push(` * @returns \${${++u}:{${n}\\}} $${++u}`)}l.push(" */");let p=l.join("\n");return f&&(p=p.replace(new RegExp(`\\$${u}\\b`),"$0")),p}t.insertSnippet=a,t.setTextDocumentLanguage=function(e,t){if(r("ahk2.setTextDocumentLanguage"))return o.connection.sendRequest("ahk2.setTextDocumentLanguage",[e,t])},t.generate_fn_comment=c,t.generateComment=async function(){if(!r("ahk2.getActiveTextEditorUriAndPosition")||!r("ahk2.insertSnippet"))return;let{uri:e,position:t}=await o.connection.sendRequest("ahk2.getActiveTextEditorUriAndPosition"),n=o.lexers[e=e.toLowerCase()],l=n.searchScopedNode(t),d=l?.children||n.children;for(const e of d)if((e.kind===i.SymbolKind.Function||e.kind===i.SymbolKind.Method)&&e.selectionRange.start.line===t.line&&e.selectionRange.start.character<=t.character&&t.character<=e.selectionRange.end.character){l=e;break}if(!l||!l.params)return;let u,f,p,h=l.selectionRange.start;if(void 0===l.markdown_detail)u=`${c(n,l)}\n`,f=n.tokens[n.document.offsetAt(h)],2===f.topofline&&(f=f.previous_token),h=n.document.positionAt(f.offset),p={start:h,end:h};else{if(f=n.find_token(n.document.offsetAt({line:h.line-1,character:0})),"TK_BLOCK_COMMENT"!==f.type)return;u=c(n,l,s(l.detail)),p={start:n.document.positionAt(f.offset),end:n.document.positionAt(f.offset+f.length)}}a(u,p)},t.exportSymbols=function(e){let t=o.lexers[e.toLowerCase()],n={},r={};if(t){(0,o.update_include_cache)();for(let e of[t.uri,...Object.keys(t.relevance)]){if(!(t=o.lexers[e]))continue;let n;n=Object.entries(t.include).map((e=>o.lexers[e[0]]?.fsPath??(0,o.restorePath)(e[1]))),!n.length&&(n=void 0),a(Object.values(t.declaration),r[t.fsPath||t.document.uri]={includes:n})}return r}function a(e,r){let c,l,d,u;for(let t of e)if(t.selectionRange.end.character)switch(c=t.kind){case i.SymbolKind.Class:d=t,(r.classes??=[]).push(u={name:t.name,label:d.full,extends:p(d),detail:h(t)}),a(Object.values(d.property??{}),u),a(Object.values(d.$property??{}),u);break;case i.SymbolKind.Property:if(l=t,(r.properties??=[]).push({name:t.name,label:l.full,static:l.static??!1,variadic:l.variadic??!1,params:g(l.params),readonly:l.params&&!t.set||!1,detail:h(t)}),!(t=t.call))break;case i.SymbolKind.Function:case i.SymbolKind.Method:l=t,(r[c===i.SymbolKind.Function?"functions":"methods"]??=[]).push({name:t.name,label:l.full,static:l.static??!1,variadic:l.variadic??!1,params:g(l.params),detail:h(t)})}function f(e){switch(e.defaultVal){case!1:return null;case null:return"unset";default:return e.defaultVal}}function p(e){let i;if(i=e.extends)return n[`${e.extendsuri},${i}`]??=(0,o.find_class)(t,i,e.extendsuri)?.full||i}function h(e){return e.markdown_detail?s(e.detail):e.detail??""}function g(e){return e?.map((e=>({name:e.name,defval:f(e),byref:e.pass_by_ref??!1,variadic:e.arr??!1,type:(0,o.join_types)(e.type_annotations)})))}}},t.diagnosticFull=async function(){if(!r("ahk2.getActiveTextEditorUriAndPosition")||!r("ahk2.insertSnippet"))return;let{uri:e}=await o.connection.sendRequest("ahk2.getActiveTextEditorUriAndPosition");const t=o.lexers[e.toLowerCase()];if(t){(0,o.update_include_cache)();for(let e in t.relevance)(e=o.lexers[e]?.document.uri)&&(0,o.semanticTokensOnFull)({textDocument:{uri:e}});(0,o.semanticTokensOnFull)({textDocument:{uri:e}})}}},3939:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,o)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.sleep=t.set_WorkspaceFolders=t.set_version=t.set_locale=t.set_dirname=t.set_Connection=t.set_ahkpath=t.set_ahk_h=t.clearLibfuns=t.arrayEqual=t.enumNames=t.make_search_re=t.sendAhkRequest=t.update_settings=t.enum_ahkfiles=t.loadahk2=t.initahk2cache=t.getwebfile=t.getlocalefile=t.getlocalefilepath=t.restorePath=t.openAndParse=t.openFile=t.completionItemCache=t.workspaceFolders=t.libdirs=t.hoverCache=t.libfuncs=t.ahkvars=t.ahkuris=t.ahk_version=t.isahk2_h=t.rootdir=t.locale=t.ahkpath_cur=t.connection=t.utils=t.extsettings=t.alpha_3=t.lexers=t.winapis=void 0;const r=n(7425),s=n(7237),a=n(7351),c=n(1727),l=n(1516),d=n(6169),u=n(7994),f=n(4780);var p;function h(e,n=!0){if(f.isBrowser){let t=y(e);return t?c.TextDocument.create(t.url,"ahk2",-10,t.text):void 0}{let i;try{i=(0,a.readFileSync)(e)}catch(t){return void(n&&(delete t.stack,t.path=e,console.log(t)))}if(255===i[0]&&254===i[1])i=i.toString("utf16le");else if(239===i[0]&&187===i[1]&&191===i[2])i=i.toString("utf8").substring(1);else try{i=new TextDecoder("utf8",{fatal:!0}).decode(i)}catch{return void(n&&t.connection.window.showErrorMessage(u.diagnostic.invalidencoding(e)))}return c.TextDocument.create(s.URI.file(e).toString(),"ahk2",-10,i)}}function g(e){if(f.isBrowser||!(0,a.existsSync)(e))return e;e.includes("..")&&(e=(0,r.resolve)(e));let t=e.toLowerCase().split(/[/\\]/),n=1,i=t[0],o=e.split(/[/\\]/);for(;n<t.length;){try{for(const e of(0,a.readdirSync)(i+r.sep))if(e.toLowerCase()===t[n]){i+=r.sep+e;break}}catch{i+=r.sep+o[n]}n++}return i}function m(e){let n,i=e.match(/<>./);if(i){if((0,a.existsSync)(n=e.replace("<>",t.locale)))return n;if("zh-tw"===t.locale.toLowerCase()&&(0,a.existsSync)(n=e.replace("<>","zh-cn")))return n;if((0,a.existsSync)(n=e.replace(i[0],"")))return n}else if((0,a.existsSync)(e))return e}function y(e){let n,i=e.match(/<>./),o=[],r=new XMLHttpRequest;if(i?(o.push(e.replace("<>",t.locale)),"zh-tw"===t.locale.toLowerCase()&&o.unshift(e.replace("<>","zh-cn")),o.unshift(e.replace(i[0],""))):o.push(e),n=o.pop())return function e(t){return r.open("GET",t,!1),r.send(),200===r.status?{url:t,text:r.responseText}:(n=o.pop())?e(n):void 0}(n)}o(n(6487),t),o(n(4104),t),o(n(6129),t),o(n(6810),t),o(n(4780),t),o(n(3113),t),o(n(2793),t),o(n(9541),t),o(n(6169),t),o(n(7994),t),o(n(6658),t),o(n(5932),t),o(n(6001),t),o(n(5373),t),o(n(5116),t),function(e){e[e.Disabled=0]="Disabled",e[e.Local=1]="Local",e[e["User and Standard"]=2]="User and Standard",e[e.All=3]="All"}(p||(p={})),t.winapis=[],t.lexers={},t.alpha_3=b("2.1.0.3"),t.extsettings={ActionWhenV1IsDetected:"Warn",AutoLibInclude:0,CommentTags:"^;;\\s*(.*)",CompleteFunctionParens:!1,CompletionCommitCharacters:{Class:".(",Function:"("},Diagnostics:{ClassStaticMemberCheck:!0,ParamsCheck:!0},Files:{Exclude:[],MaxDepth:2},FormatOptions:{},InterpreterPath:"C:\\Program Files\\AutoHotkey\\v2\\AutoHotkey.exe",SymbolFoldingFromOpenBrace:!1,Warn:{VarUnset:!0,LocalSameAsGlobal:!1,CallWithoutParentheses:!1},WorkingDirs:[]},t.utils={get_DllExport:(e,t=!1)=>Promise.resolve([]),get_RCDATA:e=>{},get_ahkProvider:async()=>null},t.ahkpath_cur="",t.locale="en-us",t.rootdir="",t.isahk2_h=!1,t.ahk_version=b("3.0.0.0"),t.ahkuris={},t.ahkvars={},t.libfuncs={},t.hoverCache={},t.libdirs=[],t.workspaceFolders=[],t.openFile=h,t.openAndParse=function(e,n=!0,i=!0){let o=h(e,n);if(o){let e=new d.Lexer(o);return e.parseScript(),i&&(t.lexers[e.uri]=e),e}},t.restorePath=g,t.getlocalefilepath=m,t.getlocalefile=function(e,t){let n=m(e);if(n)return(0,a.readFileSync)(n,t?{encoding:t}:void 0)},t.getwebfile=y,t.initahk2cache=function(){let e=l.CompletionItemKind.Keyword;t.ahkvars={},t.ahkuris={},t.completionItemCache={constant:[],directive:{"#":[],"@":f.jsDocTagNames.map((t=>({label:t,kind:e,data:"*"})))},key:[],keyword:[],snippet:[],text:[],option:{ahk_criteria:[],hotstring:[]},static:{label:"static",insertText:"static",kind:l.CompletionItemKind.Keyword}}},t.loadahk2=function(e="ahk2",n=3){let i;const o=`${t.rootdir}/syntaxes/<>/${e}`;if(f.isBrowser){let i,s=h(o+".d.ahk");if(s){let i=new d.Lexer(s,void 0,n);i.parseScript(),t.lexers[i.uri]=i,t.ahkuris[e]=i.uri}"ahk2"===e&&(i=y(`${t.rootdir}/syntaxes/ahk2_common.json`))&&r(JSON.parse(i.text)),(i=y(o+".json"))&&r(JSON.parse(i.text))}else{const s=t.extsettings.Syntaxes&&(0,a.existsSync)(t.extsettings.Syntaxes)?t.extsettings.Syntaxes:"",c=s?`${s}/<>/${e}`:o;let l;if((i=u(".d.ahk"))&&(l=h(g(i)))){let i=new d.Lexer(l,void 0,n);i.parseScript(),t.lexers[i.uri]=i,t.ahkuris[e]=i.uri}if((i=u(".json"))&&r(JSON.parse((0,a.readFileSync)(i,{encoding:"utf8"}))),"ahk2"===e&&(t.completionItemCache.static=t.completionItemCache.keyword.find((e=>"static"===e.label))??t.completionItemCache.static,r(JSON.parse((0,a.readFileSync)(`${t.rootdir}/syntaxes/ahk2_common.json`,{encoding:"utf8"}))),s))for(let e of(0,a.readdirSync)(s))e.toLowerCase().endsWith(".snippet.json")&&!(0,a.statSync)(e=`${i}/${e}`).isDirectory()&&r(JSON.parse((0,a.readFileSync)(e,{encoding:"utf8"})));function u(e){return m(c+e)||(c!==o?m(o+e):void 0)}}function r(e){let n,i,o,r=l.Range.create(0,0,0,0);for(const c in e){let d=e[c];switch(c){case"constants":for(o of(i=l.CompletionItemKind.Constant,n=l.InsertTextFormat.Snippet,d))t.completionItemCache.constant.push({label:o.prefix,kind:i,insertTextFormat:n,insertText:`\${1:${o.prefix} := }${o.body}$0`,detail:o.description??o.body});break;case"directives":let e="";for(o of(i=l.CompletionItemKind.Keyword,n=l.InsertTextFormat.Snippet,d))o.prefix??=o.body.trim(),"@#".includes(e=o.prefix.charAt(0))&&(t.completionItemCache.directive[e].push({label:o.prefix.replace(/^[^#\w]/,""),insertText:o.body.replace(/^\W+/,""),kind:i,insertTextFormat:n,documentation:o.description&&{kind:"markdown",value:o.description},data:o.body.charAt(0)}),"#"===e&&(t.hoverCache[o.prefix.toLowerCase()]=[o.prefix,{contents:{kind:"markdown",value:"```ahk2\n"+(o.syntax??a(o.body))+"\n```\n\n"+(o.description??"")}}]));break;case"keys":for(o of(i=l.CompletionItemKind.Keyword,d))t.completionItemCache.key.push({label:o.body,kind:i,documentation:o.description});break;case"keywords":for(o of(i=l.CompletionItemKind.Keyword,n=l.InsertTextFormat.Snippet,d))o.prefix??=o.body.trim(),t.completionItemCache.keyword.push({label:o.prefix,kind:i,insertTextFormat:n,insertText:o.body,documentation:o.description,preselect:!0}),t.hoverCache[o.prefix.toLowerCase()]=[o.prefix,{contents:{kind:"markdown",value:"```ahk2\n"+(o.syntax??a(o.body))+"\n```\n\n"+(o.description??"")}}];break;case"snippet":for(o of(i=l.CompletionItemKind.Snippet,n=l.InsertTextFormat.Snippet,d))t.completionItemCache.snippet.push({label:o.prefix,insertText:(s=o.body,"object"==typeof s?s.join("\n"):s),documentation:o.description,kind:i,insertTextFormat:n});break;case"variables":for(o of d)t.ahkvars[o.body.toUpperCase()]={name:o.body,kind:l.SymbolKind.Variable,range:r,selectionRange:r,detail:o.description};break;case"texts":for(o of(i=l.CompletionItemKind.Text,d))t.completionItemCache.text.push({label:o.body,kind:i});break;case"options":i=l.CompletionItemKind.Text;for(let e in d){let n=t.completionItemCache.option[e]??=[];for(o of d[e])n.push({label:o.body,kind:i,documentation:o.description&&{kind:"markdown",value:o.description}})}}}var s;function a(e){return e.replace(/\$\{\d+((\|)|:)([^}]*)\2\}|\$\d/g,((...e)=>e[2]?e[3].replace(/,/g,"|"):e[3]||""))}}};let _={};function b(e){let t=(e.replace(/-\w+/,".0")+".0").split("."),n=0;for(let e=0;e<4;e++)n+=parseInt(t[e])*2**(10*(3-e));return n}function v(e){let t,n,i="",o=!1;(t=e.startsWith("!"))&&(e=e.slice(1));for(let r=0,s=e.length;r<s;r++)switch(n=e[r]){case"/":case"\\":i+="[\\x5c/]";break;case"$":case"^":case"+":case".":case"(":case")":case"=":case"|":i+="\\"+n;break;case"?":i+=".";break;case"!":r?i.endsWith("[")?i+="^":i+="\\"+n:t=!0;break;case"{":o=!0,i+="(";break;case"}":o=!1,i+=")";break;case",":i+=o?"|":",";break;case"*":let s=r;for(;"*"===e[r+1];)r++;r>s&&/^[\x5c/]?\*+[\x5c/]?$/.test(e.substring(s-1,r+2))?(i+="((?:[^\\x5c/]*(?:[\\x5c/]|$))*)",r++):i+="([^\\x5c/]*)";break;default:i+=n}return/^([a-zA-Z]:|\*\*)/.test(e)?i="^"+i:/[\\/]/.test(e[0])||(i="[\\x5c/]"+i),/[\\/]$/.test(e)||(i+="$"),t&&(i=i.startsWith("^")?`^(?!${i})`:`(?!${i})`),new RegExp(i,"i")}t.enum_ahkfiles=function(e){let n=t.extsettings.Files.MaxDepth,{file:i,folder:o}=_;return async function*e(t,s){try{let c=await a.promises.opendir(t);for await(let a of c)if(a.isDirectory()&&s<n){let n=(0,r.resolve)(t,a.name);o?.some((e=>e.test(n)))||(yield*e(n,s+1))}else if(a.isFile()&&/\.(ahk2?|ah2)$/i.test(a.name)){let e=(0,r.resolve)(t,a.name);i?.some((t=>t.test(e)))||(yield e)}}catch(e){}}(g(e),0)},t.update_settings=function(e){if("string"==typeof e.AutoLibInclude?e.AutoLibInclude=p[e.AutoLibInclude]:"boolean"==typeof e.AutoLibInclude&&(e.AutoLibInclude=e.AutoLibInclude?3:0),"string"==typeof e.Warn?.CallWithoutParentheses&&(e.Warn.CallWithoutParentheses={On:!0,Off:!1,Parentheses:1}[e.Warn.CallWithoutParentheses]),"string"==typeof e.FormatOptions?.brace_style)switch(e.FormatOptions.brace_style){case"0":case"Allman":e.FormatOptions.brace_style=0;break;case"1":case"One True Brace":e.FormatOptions.brace_style=1;break;case"-1":case"One True Brace Variant":e.FormatOptions.brace_style=-1;break;default:delete e.FormatOptions.brace_style}for(let t of["array_style","object_style"])"string"==typeof e.FormatOptions?.[t]&&(e.FormatOptions[t]={collapse:2,expand:1,none:0}[e.FormatOptions[t]]);try{(0,d.update_comment_tags)(e.CommentTags)}catch(t){delete t.stack,delete e.CommentTags,console.log(t)}if(e.WorkingDirs instanceof Array?e.WorkingDirs=e.WorkingDirs.map((e=>(e=s.URI.file(e.includes(":")?e:(0,r.resolve)(e)).toString().toLowerCase()).endsWith("/")?e:e+"/")):e.WorkingDirs=[],_={},e.Files){let t=[],n=[];for(let i of e.Files.Exclude??[])try{(/[\\/]$/.test(i)?n:t).push(v(i))}catch(e){console.log(`[Error] Invalid glob pattern: ${i}`)}t.length&&(_.file=t),n.length&&(_.folder=n),(e.Files.MaxDepth??=2)<0&&(e.Files.MaxDepth=1/0)}e.Syntaxes&&(e.Syntaxes=(0,r.resolve)(e.Syntaxes).toLowerCase()),Object.assign(t.extsettings,e)},t.sendAhkRequest=async function(e,n){if(!f.isBrowser)return t.utils.get_ahkProvider().then((t=>t?.sendRequest(e,...n)))},t.make_search_re=function(e){let t;return e=e.replace(/([*.?+^$|\\/\[\](){}])|([^\x00-\x7f])|(.)/g,((e,n,i,o)=>`${o||(t??=i)||`\\${n}`}.*`)),new RegExp(t?e:`([^\\x00-\\x7f]|${e})`,"i")},t.enumNames=function(e){return Object.values(e).filter((e=>"string"==typeof e))},t.arrayEqual=function(e,t){return e.length===t.length&&(e.sort(),t.sort(),!e.some(((e,n)=>e!==t[n])))},t.clearLibfuns=function(){t.libfuncs={}},t.set_ahk_h=function(e){t.isahk2_h=e},t.set_ahkpath=function(e){t.ahkpath_cur=e},t.set_Connection=function(e){return t.connection=e},t.set_dirname=function(e){t.rootdir=e.replace(/[/\\]$/,"")},t.set_locale=function(e){e&&(t.locale=e.toLowerCase())},t.set_version=function(e){t.ahk_version=b(e)},t.set_WorkspaceFolders=function(e){let n=t.workspaceFolders;if(t.workspaceFolders=[...e],t.extsettings.WorkingDirs.forEach((n=>!e.has(n)&&t.workspaceFolders.push(n))),t.workspaceFolders.sort().reverse(),n.length!==t.workspaceFolders.length||n.some(((e,n)=>t.workspaceFolders[n]!==e)))for(const e of Object.values(t.lexers))t.lexers[e.uri]&&!e.setWorkspaceFolder()&&!e.actived&&e.close()},t.sleep=async function(e){return new Promise((t=>setTimeout(t,e)))}},6810:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.completionProvider=void 0;const i=n(7351),o=n(7425),r=n(5751),s=n(7237),a=n(3939);t.completionProvider=async function(e,t){let{position:n,textDocument:{uri:c}}=e,l=a.lexers[c=c.toLowerCase()];if(!l||t.isCancellationRequested)return;let d,u,f,p,h,g=[],m={},y=g.pop(),{triggerKind:_,triggerCharacter:b}=e.context??{};if("*"===b){let e=l.tokens[l.document.offsetAt(n)-3];if("TK_BLOCK_COMMENT"===e?.type){e.previous_token?.type||g.push({label:"/** */",detail:"File Doc",kind:r.CompletionItemKind.Text,insertTextFormat:r.InsertTextFormat.Snippet,textEdit:r.TextEdit.replace({start:l.document.positionAt(e.offset),end:l.document.positionAt(e.offset+e.length)},["/************************************************************************"," * @description ${1:}"," * @file $TM_FILENAME"," * @author ${2:}"," * @date ${3:$CURRENT_YEAR/$CURRENT_MONTH/$CURRENT_DATE}"," * @version ${4:0.0.0}"," ***********************************************************************/","$0"].join("\n"))});let t=I(e);if(t){let n=t;g=[{label:"/** */",detail:"JSDoc Comment",kind:r.CompletionItemKind.Snippet,insertTextFormat:r.InsertTextFormat.Snippet,textEdit:r.TextEdit.replace({start:l.document.positionAt(e.offset),end:l.document.positionAt(e.offset+e.length)},"/**\n * $0\n */")}],n.params&&(g[0].textEdit.newText=(0,a.generate_fn_comment)(l,n))}}return g}if("@"===b){let e=l.findStrOrComment(l.document.offsetAt(n)-1);if(e?.type.endsWith("COMMENT")){let t=l.document.positionAt(e.offset).line===n.line,i="TK_BLOCK_COMMENT"===e.type?"/*":";";return a.completionItemCache.directive["@"].filter((e=>i.includes(d=e.data)&&(t||"/"!==d)))}return}let v=Object.fromEntries(Object.entries(a.extsettings.CompletionCommitCharacters??{}).map((e=>(e[1]=(e[1]||void 0)?.split(""),e)))),{text:k,word:T,token:R,range:S,linetext:w,kind:D,symbol:C}=l.getContext(n,!0),x=l.relevance,{line:K,character:O}=n,E=!1,P=(0,a.make_search_re)(T);switch(R.type){case"TK_UNKNOWN":if("."===R.content)break;if("#"!==R.content)return;case"TK_SHARP":return 1===R.topofline?a.completionItemCache.directive["#"]:[];case"TK_HOT":case"TK_HOTLINE":if(!R.ignore)return a.completionItemCache.key.filter((e=>!e.label.toLowerCase().includes("alttab")));let e=l.document.offsetAt(n)-R.offset;return 0<e&&e<=k.indexOf(":",1)?a.completionItemCache.option.hotstring:void 0;case"":case"TK_EOF":if("TK_SHARP"===(f=R.previous_token)?.type){let e=!1;switch(f.content.toLowerCase()){case"#dllload":e=!0;case"#include":case"#includeagain":{if(a.isBrowser)return;let t,s=l.document.offsetAt(n)-R.offset,c=(k=R.content).slice(0,s),d=c[0],u=!1,f="";if("'\"".includes(d)?c=c.slice(1):d="",c=c.replace(/^\*i\s/i,""),c.startsWith("*")){P=(0,a.make_search_re)(c.slice(1));for(let e in a.utils.get_RCDATA()??{})P.test(e)&&j(e,r.CompletionItemKind.File);return g}if("<"===c[0]&&(d=">"+d,c=c.slice(1)),/["<>*?|]/.test(c)||e&&d.startsWith(">"))return;if(c=c.replace(/`;/g,";").replace(/[^\\/]+$/,(e=>(f=e,""))),!d.startsWith(">")&&k.includes("%")){if("\0"===k.replace(/%[^%]+%/g,(e=>"\0".repeat(e.length)))[s])return Object.values(a.ahkvars).filter((e=>e.kind===r.SymbolKind.Variable&&P.test(e.name))).map($);let e={...a.a_vars,scriptdir:l.scriptdir,linefile:l.fsPath};if(c=c.replace(/%a_(\w+)%/i,((t,n)=>{let i=e[n.toLowerCase()];return"string"==typeof i?i:"\0"})),c.includes("\0"))return}if(e)t=[(h=l.dlldir.get(n.line))?h:l.scriptpath,"C:\\Windows\\System32"];else if(d.startsWith(">"))t=l.libdirs,u=!0;else{let e=l.scriptpath,i=n.line;for(let[t,n]of l.includedir){if(!(t<i))break;e=n}t=[e]}d&&(k.endsWith(d)||k.endsWith(">")?d="":2===d.length&&k.endsWith(d[1])&&(d=d[0]));let p,m=c.endsWith("/")?"/":"\\",_=(0,a.make_search_re)(f),b=e?/\.(dll|ocx|cpl)$/i:u?/\.ahk$/i:/\.(ahk2?|ah2)$/i;a.allIdentifierChar.test(f)||(p=r.TextEdit.replace({start:{line:n.line,character:n.character-f.length},end:n},""));for(let e of t)if((0,i.existsSync)(e=(0,o.resolve)(e,c)+"\\")&&(0,i.statSync)(e).isDirectory()){for(let t of(0,i.readdirSync)(e))try{(0,i.statSync)(e+t).isDirectory()?_.test(t)&&j(t.replace(/(\s);/g,"$1`;"),r.CompletionItemKind.Folder)&&(y.command={title:"Trigger Suggest",command:"editor.action.triggerSuggest"},p?y.textEdit=Object.assign({},p,{newText:y.label+m}):y.insertText=y.label+m):b.test(t)&&_.test(u?t=t.replace(b,""):t)&&j(t.replace(/(\s);/g,"$1`;"),r.CompletionItemKind.File)&&(p?y.textEdit=Object.assign({},p,{newText:y.label+d}):y.insertText=y.label+d)}catch{}if(c.includes(":"))break}return g}default:return}}else if("TK_HOTLINE"!==f?.type)return;if(f.ignore)return F(),g;g.push(...a.completionItemCache.key),D=r.SymbolKind.Event;break;case"TK_COMMENT":case"TK_BLOCK_COMMENT":case"TK_INLINE_COMMENT":return;default:if(R.callsite||R.topofline>0)break;let t,s=["TK_COMMA","TK_DOT","TK_EQUALS","TK_NUMBER","TK_OPERATOR","TK_RESERVED","TK_STRING","TK_WORD"],c="TK_STRING"===R.type?0:3,u=0,_=(f=R).callsite,b=l.tokens,v=_?.paraminfo;for(;(f=(t=b[f.previous_pair_pos])??f.previous_token)&&++u!==c;)if(t){if(E=!0,f.topofline>0||(u++,!(f=t.previous_token))||f.topofline>0){f=void 0;break}}else{if(E||=void 0!==f.next_pair_pos||s.includes(f.type),v??=f.paraminfo){f=b[v.offset]?.previous_token,u++,E=!0;break}if((_??=f.callsite)||f.topofline>0)break}if((_??v)&&(v??=_?.paraminfo,E=!0),"TK_RESERVED"===f?.type)switch(d=f.content.toLowerCase()){case"class":if(2===u)return[{label:"extends",kind:r.CompletionItemKind.Keyword,preselect:!0}];if(3!==u||"extends"!==R.previous_token?.content.toLowerCase())return;u=1;case"catch":if(1!==u)return;if(!k){let e=R,t=l.document.offsetAt(S.end);for(k=R.content;(e=b[e.next_token_offset])&&e.offset<t;k+=e.content);if(a.allIdentifierChar.test(k.replace(/\./g,"")))for(let e of Object.values((0,a.find_class)(l,k)?.property??{}))e.kind===r.SymbolKind.Class&&!m[d=e.name.toUpperCase()]&&P.test(d)&&(g.push($(e)),m[d]=!0);return g}let e=[a.ahkvars,l.declaration];for(const n in x)(t=a.lexers[n])&&e.push(t.declaration);for(const n of e)for(const e in n)(t=n[e]).kind===r.SymbolKind.Class&&!m[e]&&P.test(e)&&(g.push($(t)),m[e]=!0);return g;case"break":case"continue":case"goto":if(1===u&&"TK_WORD"!==R.type)return;p=l.searchScopedNode(n);let i,o=(p??l).labels,s=l.document.offsetAt(n);for(let e in o)if(P.test(e))for(let t of o[e]){if(!t.def)break;if(-1===(i=t.data)||i<s&&(!(i=b[b[i].next_pair_pos]?.offset)||s<i)){g.push($(t));break}}if(!p)for(let e in x)for(let t in o=a.lexers[e]?.labels)if(P.test(t))for(let e of o[t]){if(!e.def)break;if(-1===e.data){g.push($(e));break}}if(1===u||2===u&&!c)return g;if(c)for(let e of g)e.insertText=`'${e.insertText}'`}else if(!c){let e=v&&(0,a.get_callinfo)(l,n,v);if(e){let o,s,c,d,u,f,p,h,m=k.substring(1).endsWith(k[0])?"":k[0],_=m?e=>({label:e,kind:o,insertText:`${e}${m}`}):e=>({label:e,kind:o,command:s}),T=(0,a.find_symbols)(l,c=l.getContext(e.pos))??[],R=Object.values(a.ahkuris),S=[],w=[];for(h of T){if(d=h.node,w.includes(d))continue;switch(w.push(d),p=R.includes(d.uri),f=e.index,u=d.name.toLowerCase(),o=r.CompletionItemKind.Value,s={title:"cursorRight",command:"cursorRight"},p&&e.kind){case r.SymbolKind.Method:switch(u){case"deleteprop":case"getmethod":case"getownpropdesc":case"hasownprop":case"hasmethod":case"hasprop":if(0!==f||!h.parent)continue;let e=u.endsWith("method")?e=>e!==r.SymbolKind.Method:void 0;for(let t of Object.values((0,a.get_class_members)(l,h.parent,S)))P.test(t.name)&&!e?.(t.kind)&&j(t.name,t.kind===r.SymbolKind.Method?r.CompletionItemKind.Method:r.CompletionItemKind.Property);continue;case"bind":case"call":if(![r.SymbolKind.Function,"call"===u&&r.SymbolKind.Class].includes(h.parent?.kind))break;T.push({node:h.parent,uri:""});continue}break;case r.SymbolKind.Function:switch(u){case"dynacall":if(0!==f)continue;case"dllcall":if(0===f){if(a.isBrowser)continue;let o=b[l.document.offsetAt(e.pos)],s=l.document.offsetAt(n);if(!o)continue;for(;(o=b[o.next_token_offset])&&"("===o.content;)continue;if(o&&"TK_STRING"===o.type&&s>o.offset&&s<=o.offset+o.length){let e=o.content.substring(1,s-o.offset),n=[l],c={};for(let e in x)(t=a.lexers[e])&&n.push(t);if(e.match(/[\\/]/)){let t={},i=!0;u=e.replace(/[\\/][^\\/]*$/,"").replace(/\\/g,"/").toLowerCase(),u.match(/\.\w+$/)||(u+=".dll"),u.includes(":")?(i=!1,t[u]=1):u.includes("/")?u.startsWith("/")?t[l.scriptpath+u]=1:t[l.scriptpath+"/"+u]=1:n.forEach((e=>{e.dllpaths.forEach((e=>{e.toLowerCase().endsWith(u)&&(t[e]=1,i&&e.includes("/")&&(i=!1))})),i&&(t[u]=t[e.scriptpath+"/"+u]=1)})),(await a.utils.get_DllExport(Object.keys(t),!0)).forEach((e=>P.test(e)&&j(e,r.CompletionItemKind.Function)))}else n.forEach((e=>e.dllpaths.forEach((e=>{e=e.replace(/^.*[\\/]/,"").replace(/\.dll$/i,""),c[u=e.toLowerCase()]||(c[u]=!0,j(e+"\\",r.CompletionItemKind.File))})))),(0,i.readdirSync)("C:\\Windows\\System32").forEach((e=>{e.toLowerCase().endsWith(".dll")&&P.test(e=e.slice(0,-4))&&j(e+"\\",r.CompletionItemKind.File)})),a.winapis.forEach((e=>{P.test(e)&&j(e,r.CompletionItemKind.Function)}))}continue}f++;case"comcall":if(f>1&&f%2==0)for(const e of["cdecl"].concat(a.dllcalltpe))j(e,r.CompletionItemKind.TypeParameter)&&(y.commitCharacters=["*"]);continue;case"comobject":0===f&&g.push(...(await(0,a.sendAhkRequest)("GetProgID",[]))?.filter((e=>P.test(e))).map(_)??[]);continue;case"numget":if(2!==f&&1!==f)continue;f=0;case"numput":if(f%2==0)for(const e of a.dllcalltpe.filter((e=>!/str$/i.test(e))))j(e,r.CompletionItemKind.TypeParameter);continue;case"hotkey":f<2&&g.push(...a.completionItemCache.key.filter((e=>P.test(e.label))));continue;case"objbindmethod":case"hasmethod":case"objhasownprop":case"hasprop":if(1===f){let e=v.comma[0];if(!e)continue;let t=u.endsWith("method")?e=>e!==r.SymbolKind.Method:void 0;for(let n of(0,a.decltype_expr)(l,l.find_token(v.offset+1,!0),e))for(let e of Object.values((0,a.get_class_members)(l,n,S)))P.test(e.name)&&!t?.(e.kind)&&j(e.name,e.kind===r.SymbolKind.Method?r.CompletionItemKind.Method:r.CompletionItemKind.Property)}continue}}d.kind===r.SymbolKind.Class&&(d=e.kind===r.SymbolKind.Property?(0,a.get_class_member)(a.lexers[d.uri],d,"__item",!1):(0,a.get_class_constructor)(d));let c=d?.params?.[f];if(!c)continue;if(p){if("Keys"===c.name){o=r.CompletionItemKind.Text,s=void 0,u.includes("send")&&g.push(_("Blind")),g.push(...a.completionItemCache.key.filter((e=>P.test(e.label))));continue}if("WinTitle"===c.name){g.push(...a.completionItemCache.option.ahk_criteria.filter((e=>P.test(e.label))));continue}}let m=c.type_annotations||[];m.includes(a.STRING)&&(o=r.CompletionItemKind.Text,s=void 0);for(let e of m)"string"==typeof e&&/['"]/.test(e[0])&&e.endsWith(e[0])&&P.test(e=e.slice(1,-1))&&g.push(_(e))}}return!g.length&&F(),g}}let A="([".includes(w[S.end.character]||"\0"),M=0===a.extsettings.FormatOptions.brace_style?"\n":" ";if(C){if(!C.children&&(p??=l.searchScopedNode(n))?.kind===r.SymbolKind.Class){let e=p,t=["__Init()","__Call(${1:Name}, ${2:Params})","__Delete()","__Enum(${1:NumberOfVars})","__Get(${1:Key}, ${2:Params})","__Item[$1]","__New($1)","__Set(${1:Key}, ${2:Params}, ${3:Value})"];if(g.push(...a.completionItemCache.snippet),1===R.topofline&&g.push(a.completionItemCache.static,{label:"class",insertText:["class $1","{\n\t$0\n}"].join(M),kind:r.CompletionItemKind.Snippet,insertTextFormat:r.InsertTextFormat.Snippet}),0===l.tokens[R.next_token_offset]?.topofline)return 1===R.topofline?(g.pop(),g):void 0;(C.static??!1)&&t.splice(0,1),R.topofline&&t.forEach((e=>{let t=e.replace(/[(\[].*$/,"");g.push({label:t,kind:r.CompletionItemKind.Snippet,insertTextFormat:r.InsertTextFormat.Snippet,insertText:e+M+"{\n\t$0\n}"})}));for(let t of Object.values((0,a.get_class_members)(l,e)))j(t.name,t.kind===r.SymbolKind.Method?r.CompletionItemKind.Method:r.CompletionItemKind.Property);return g}return}if(D===r.SymbolKind.Null)return;if(D===r.SymbolKind.Property||D===r.SymbolKind.Method){if(!R.symbol&&R.semantic?.type===a.SemanticTokenTypes.property)return;let e={},t=(0,a.decltype_expr)(l,R,S.end),n=t.includes(a.ANY),i=[];"."===w[S.end.character]&&(A="([".includes(w.charAt(S.end.character+T.length+1)||"\0")),n&&(t=[]);for(const n of t){if(n.kind===r.SymbolKind.Interface){let e=n.generic_types?.[0]?.map((e=>"'\"".includes(e[0])?e.slice(1,-1):e));if(!e?.length)continue;let t=await(0,a.sendAhkRequest)("GetDispMember",e)??{};Object.entries(t).forEach((e=>P.test(e[0])&&j(e[0],1===e[1]?r.CompletionItemKind.Method:r.CompletionItemKind.Property)));continue}let t=(0,a.get_class_members)(l,n,i);for(const[n,i]of Object.entries(t))P.test(n)&&((h=e[n])?h.detail?.endsWith(i.full??"")||(h.detail="(...) "+(h.insertText=i.name),h.commitCharacters=h.command=h.documentation=void 0):g.push(e[n]=$(i)))}if(!n&&(1!==_||T.length<3))return g;let o=new Set([l.object,a.lexers[a.ahkuris.ahk2]?.object,a.lexers[a.ahkuris.ahk2_h]?.object]);o.delete(void 0);for(const e in x)o.add(a.lexers[e].object);for(const e in h=l.object.property){let t=h[e];1===t.length&&!t[0].full&&W(t[0])&&delete h[e]}for(const t of o)for(const n of Object.values(t))for(const[t,i]of Object.entries(n))if(P.test(t)){if(h=e[t]){if(h.detail?.endsWith(i[0].full??""))continue}else if(g.push(e[t]=h=$(i[0])),1===i.length)continue;h.detail="(...) "+h.label,h.insertText?.endsWith(")")&&i.some((e=>e.kind===r.SymbolKind.Property))&&(h.insertText=h.label,h.kind=r.CompletionItemKind.Property),h.commitCharacters=h.command=h.documentation=void 0}return g}if(g.push(...a.completionItemCache.snippet),p??=l.searchScopedNode(n),p?.children&&p.kind===r.SymbolKind.Property){if(1!==R.topofline)return;return[{label:"get",kind:r.CompletionItemKind.Function},{label:"set",kind:r.CompletionItemKind.Function}]}let N=a.extsettings.FormatOptions?.keyword_start_with_uppercase,q=N?function(e){g.push(e=Object.assign({},e)),e.insertText=(e.insertText??e.label).replace(/(?<=^(loop\s)?)[a-z]/g,(e=>e.toUpperCase()))}:e=>g.push(e);if(E)for(let e of a.completionItemCache.keyword){if("break"===e.label)break;P.test(e.label)&&q(e)}else{let e=r.CompletionItemKind.Snippet,t=r.InsertTextFormat.Snippet,n=e=>e,i=n;N&&(n=e=>e.replace(/\b[a-z](?=\w)/g,(e=>e.toUpperCase()))),a.extsettings.FormatOptions?.switch_case_alignment&&(i=e=>e.replace(/^\t/gm,""));for(let[o,r]of[["switch",["switch ${1:[SwitchValue, CaseSense]}",i("{\n\tcase ${2:}:\n\t\t${3:}\n\tdefault:\n\t\t$0\n}")]],["trycatch",["try","{\n\t$1\n}","catch ${2:Error} as ${3:e}","{\n\t$0\n}"]],["class",["class $1","{\n\t$0\n}"]]])g.push({label:o,kind:e,insertTextFormat:t,insertText:n(r.join(M))});for(let e of a.completionItemCache.keyword)P.test(e.label)&&q(e)}!p&&(h=w.match(/^\s*(((([<>$~*!+#^]*?)(`?;|[a-z]\w+|[\x21-\x3A\x3C-\x7E]|[^\x00-\x7f]))|~?(`?;|[\x21-\x3A\x3C-\x7E]|[a-z]\w+|[^\x00-\x7f])\s*&\s*~?(`?;|[\x21-\x3A\x3C-\x7E]|[a-z]\w+|[^\x00-\x7f]))\s*(\s(up?)?)?)$/i))&&(g=g.concat(h[8]?{label:"Up",kind:r.CompletionItemKind.Keyword}:a.completionItemCache.key.filter((e=>!e.label.toLowerCase().includes("alttab")))));for(const e in a.ahkvars)P.test(e)&&(m[e]=$(a.ahkvars[e]));for(let e of Object.values(l.declaration))!P.test(d=e.name.toUpperCase())||W(e)||m[d]&&e.kind===r.SymbolKind.Variable||(m[d]=$(e));let L=Object.keys(x);for(let e of[l.d_uri,...L.map((e=>a.lexers[e]?.d_uri)),...L]){if(!(h=a.lexers[e]?.declaration))continue;u=a.lexers[e].fsPath;let t=!!x[e];for(const e in h){let n=h[e];t&&P.test(e)&&(!m[e]||m[e].kind===r.CompletionItemKind.Variable&&n.kind!==r.SymbolKind.Variable)&&(m[e]=y=$(n),y.detail=`${a.completionitem.include(u)}\n\n${y.detail??""}`)}}if(p&&(n=S.end,Object.entries(l.getScopeSymbols(p)).forEach((([e,t])=>{!P.test(e)||!1===t.def&&(m[e]||W(t))||(m[e]=$(t))}))),a.extsettings.AutoLibInclude){let e,t,c=0,f=-1,p=l.libdirs,h=l.workspaceFolder,g={};h=(h?s.URI.parse(h).fsPath:l.scriptdir).toLowerCase(),l.includedir.forEach(((e,t)=>f=t));for(const e in a.libfuncs)if(!x[e]&&(u=a.libfuncs[e].fsPath)&&(a.extsettings.AutoLibInclude>1&&a.libfuncs[e].islib||1&a.extsettings.AutoLibInclude&&u.toLowerCase().startsWith(h))){for(let t of a.libfuncs[e])P.test(d=t.name)&&(m[d.toUpperCase()]??=(y=$(t),c++,y.additionalTextEdits=g[u]??=_(u),y.detail=`${a.completionitem.include(u)}\n\n${y.detail??""}`,y));if(c>300)break}function _(s){let a=(s=s.replace(/(\s);/g,"$1`;")).toLowerCase(),c=0,d=-1,u=l.scriptpath,h=[];for(const e of p)if(++c,a.startsWith(e.toLowerCase())){let t=(0,o.basename)(s);a.endsWith(".ahk")&&!p.slice(0,c-1).some((e=>(0,i.existsSync)(e+t)))?h.push(`#Include <${(0,o.relative)(e,s.slice(0,-4))}>`):1===c?h.push(`#Include %A_MyDocuments%\\AutoHotkey\\Lib\\${t}`):2===c?h.push(`#Include %A_AhkPath%\\..\\Lib\\${t}`):h.push(`#Include %A_ScriptDir%\\Lib\\${t}`)}l.includedir.forEach(((e,t)=>{a.startsWith(e.toLowerCase()+"\\")?e.length>=u.length&&(d=t,u=e):u||(d=t)})),-1===d&&(d=f),u.charAt(0)===a.charAt(0)&&h.push(`#Include ${(0,o.relative)(u,s)}`);let g,m={line:l.document.lineCount,character:0},y=`#Include ${s}`;return h.forEach((e=>e.length<y.length&&(y=e))),y="\n"+y,-1!==d?(g=l.document.getText({start:{line:d,character:0},end:{line:d+1,character:0}}),m={line:d,character:g.length}):n.line===m.line-1&&((e??=(t=l.find_token(0))?.type.endsWith("COMMENT")&&!I(t))?(m=l.document.positionAt(t.offset+t.length),y="\n"+y):(m.line=0,y=y.trimLeft()+"\n")),[r.TextEdit.insert(m,y)]}}if(L.unshift(l.uri),!L.includes(a.ahkuris.winapi)&&L.some((e=>a.lexers[e]?.include[a.ahkuris.winapi])))for(const e in h=a.lexers[a.ahkuris.winapi]?.declaration)P.test(e)&&(m[e]??=$(h[e]));if(!E&&D!==r.SymbolKind.Event&&(1===_&&k.length>2&&k.includes("_")||/[A-Z]{2,}/.test(k)))for(const e of a.completionItemCache.constant)P.test(e.label)&&g.push(e);return g.concat(Object.values(m));function I(e){if(e.symbol)return e.symbol;let t,n=l.tokens[e.next_token_offset];return n&&void 0!==((t=n.symbol)?.detail??(t=l.tokens[n.next_token_offset]?.symbol)?.detail)?t:void 0}function F(){for(let e of a.completionItemCache.text)P.test(e.label)&&(m[e.label.toUpperCase()]=!0,g.push(e));for(const e in h=l.texts)P.test(e)&&j(h[e],r.CompletionItemKind.Text);for(const e in x)for(const t in h=a.lexers[e]?.texts)P.test(t)&&j(h[t],r.CompletionItemKind.Text)}function j(e,t){return!m[d=e.toUpperCase()]&&(g.push(y={label:e,kind:t}),m[d]=!0)}function W(e){return e.selectionRange.end.line===K&&O===e.selectionRange.end.character}function $(e){let t=r.CompletionItem.create(e.name);switch(e.kind){case r.SymbolKind.Function:case r.SymbolKind.Method:if(t.kind=e.kind===r.SymbolKind.Method?r.CompletionItemKind.Method:r.CompletionItemKind.Function,a.extsettings.CompleteFunctionParens){let n=e;A?t.command={title:"cursorRight",command:"cursorRight"}:n.params.length?(t.command={title:"Trigger Parameter Hints",command:"editor.action.triggerParameterHints"},n.params[0].name.includes("|")?(t.insertText=t.label+"(${1|"+n.params[0].name.replace(/\|/g,",")+"|})",t.insertTextFormat=r.InsertTextFormat.Snippet):(t.insertText=t.label+"($0)",t.insertTextFormat=r.InsertTextFormat.Snippet)):t.insertText=t.label+"()"}else t.commitCharacters=v.Function;t.detail=e.full;break;case r.SymbolKind.Variable:if(t.kind=r.CompletionItemKind.Variable,!e.range.end.character)return t.detail=e.detail,t;break;case r.SymbolKind.Class:t.kind=r.CompletionItemKind.Class,t.commitCharacters=v.Class,t.detail="class "+(e.full||t.label);break;case r.SymbolKind.Event:return t.kind=r.CompletionItemKind.Event,t;case r.SymbolKind.Field:return t.kind=r.CompletionItemKind.Field,t.label=t.insertText=t.label.slice(0,-1),t;case r.SymbolKind.Property:t.kind=r.CompletionItemKind.Property,t.detail=e.full||t.label;let n=e;!n.call&&n.get?.params.length&&(t.insertTextFormat=r.InsertTextFormat.Snippet,t.insertText=t.label+"[$0]");break;default:return t.kind=r.CompletionItemKind.Text,t}e.tags&&(t.tags=e.tags);let n=(0,a.get_detail)(e,l);return n&&(t.documentation=n),t}}},4780:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.jsDocTagNames=t.isWindows=t.isBrowser=t.chinese_punctuations=t.dllcalltpe=t.a_vars=t.builtin_ahkv1_commands=t.builtin_variable_h=t.builtin_variable=void 0,t.builtin_variable=["true","false","unset","a_ahkpath","a_ahkversion","a_allowmainwindow","a_appdata","a_appdatacommon","a_args","a_clipboard","a_computername","a_comspec","a_controldelay","a_coordmodecaret","a_coordmodemenu","a_coordmodemouse","a_coordmodepixel","a_coordmodetooltip","a_cursor","a_dd","a_ddd","a_dddd","a_defaultmousespeed","a_desktop","a_desktopcommon","a_detecthiddentext","a_detecthiddenwindows","a_endchar","a_eventinfo","a_fileencoding","a_hotkeyinterval","a_hotkeymodifiertimeout","a_hour","a_iconfile","a_iconhidden","a_iconnumber","a_icontip","a_index","a_initialworkingdir","a_is64bitos","a_isadmin","a_iscompiled","a_iscritical","a_ispaused","a_issuspended","a_keydelay","a_keydelayplay","a_keyduration","a_keydurationplay","a_language","a_lasterror","a_linefile","a_linenumber","a_listlines","a_loopfield","a_loopfileattrib","a_loopfiledir","a_loopfileext","a_loopfilefullpath","a_loopfilename","a_loopfilepath","a_loopfileshortname","a_loopfileshortpath","a_loopfilesize","a_loopfilesizekb","a_loopfilesizemb","a_loopfiletimeaccessed","a_loopfiletimecreated","a_loopfiletimemodified","a_loopreadline","a_loopregkey","a_loopregname","a_loopregtimemodified","a_loopregtype","a_maxhotkeysperinterval","a_mday","a_menumaskkey","a_min","a_mm","a_mmm","a_mmmm","a_mon","a_mousedelay","a_mousedelayplay","a_msec","a_mydocuments","a_now","a_nowutc","a_osversion","a_priorhotkey","a_priorkey","a_programfiles","a_programs","a_programscommon","a_ptrsize","a_regview","a_screendpi","a_screenheight","a_screenwidth","a_scriptdir","a_scriptfullpath","a_scripthwnd","a_scriptname","a_sec","a_sendlevel","a_sendmode","a_space","a_startmenu","a_startmenucommon","a_startup","a_startupcommon","a_storecapslockmode","a_tab","a_temp","a_thisfunc","a_thishotkey","a_tickcount","a_timeidle","a_timeidlekeyboard","a_timeidlemouse","a_timeidlephysical","a_timesincepriorhotkey","a_timesincethishotkey","a_titlematchmode","a_titlematchmodespeed","a_traymenu","a_username","a_wday","a_windelay","a_windir","a_workingdir","a_yday","a_year","a_yweek","a_yyyy"],t.builtin_variable_h=["a_ahkdir","a_dlldir","a_dllpath","a_globalstruct","a_isdll","a_mainthreadid","a_memorymodule","a_modulehandle","a_scriptstruct","a_threadid","a_zipcompressionlevel"],t.builtin_ahkv1_commands=["autotrim","blockinput","click","clipwait","control","controlclick","controlfocus","controlget","controlgetfocus","controlgetpos","controlgettext","controlmove","controlsend","controlsendraw","controlsettext","coordmode","critical","detecthiddentext","detecthiddenwindows","drive","driveget","drivespacefree","envadd","envdiv","envget","envmult","envset","envsub","envupdate","exit","exitapp","fileappend","filecopy","filecopydir","filecreatedir","filecreateshortcut","filedelete","fileencoding","filegetattrib","filegetshortcut","filegetsize","filegettime","filegetversion","fileinstall","filemove","filemovedir","fileopen","fileread","filereadline","filerecycle","filerecycleempty","fileremovedir","fileselectfile","fileselectfolder","filesetattrib","filesettime","format","formattime","getkeystate","gosub","groupactivate","groupadd","groupclose","groupdeactivate","gui","guicontrol","guicontrolget","hotkey","ifequal","ifexist","ifgreater","ifgreaterorequal","ifless","iflessorequal","ifmsgbox","ifnotequal","ifnotexist","ifwinactive","ifwinexist","ifwinnotactive","ifwinnotexist","imagesearch","inidelete","iniread","iniwrite","input","inputbox","keywait","listlines","menu","mouseclick","mouseclickdrag","mousegetpos","mousemove","msgbox","onerror","onexit","outputdebug","pause","pixelgetcolor","pixelsearch","postmessage","process","progress","random","regdelete","regread","regwrite","run","runas","runwait","send","sendevent","sendinput","sendlevel","sendmessage","sendmode","sendplay","sendraw","setbatchlines","setcapslockstate","setcontroldelay","setdefaultmousespeed","setenv","setformat","setkeydelay","setmousedelay","setnumlockstate","setregview","setscrolllockstate","setstorecapslockmode","settimer","settitlematchmode","setwindelay","setworkingdir","shutdown","sleep","sort","soundbeep","soundget","soundgetwavevolume","soundplay","soundset","soundsetwavevolume","splashimage","splashtextoff","splashtexton","splitpath","statusbargettext","statusbarwait","stringcasesense","stringleft","stringlower","stringright","stringtrimleft","stringtrimright","stringupper","suspend","sysget","thread","tooltip","transform","traytip","urldownloadtofile","winactivate","winactivatebottom","winclose","winget","wingetactivestats","wingetactivetitle","wingetclass","wingetpos","wingettext","wingettitle","winhide","winkill","winmaximize","winmenuselectitem","winminimize","winminimizeall","winminimizeallundo","winmove","winrestore","winset","winsettitle","winshow","winwait","winwaitactive","winwaitclose","winwaitnotactive"],t.a_vars={space:" ",tab:"\t"},t.dllcalltpe=["str","astr","wstr","int64","int","uint","short","ushort","char","uchar","float","double","ptr","uptr","hresult"],t.chinese_punctuations={"，":",","。":".","；":";","‘":"'","’":"'","【":"[","】":"]","《":"<","》":">","？":"?","：":":","“":'"',"”":'"',"（":"(","）":")","！":"!"},t.isBrowser="undefined"==typeof process,t.isWindows=!t.isBrowser&&"win32"===process.platform,t.jsDocTagNames=["abstract","access","alias","argument","async","augments","author","borrows","callback","class","classdesc","constant","constructor","constructs","copyright","default","deprecated","description","emits","enum","event","example","exports","extends","external","field","file","fileoverview","fires","function","generator","global","hideconstructor","host","ignore","implements","inheritdoc","inner","instance","interface","kind","lends","license","link","linkcode","linkplain","listens","member","memberof","method","mixes","module","name","namespace","overload","override","package","param","private","prop","property","protected","public","readonly","requires","returns","satisfies","see","since","static","summary","template","this","throws","todo","tutorial","type","typedef","var","variation","version","virtual","yields"]},3113:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defintionProvider=void 0;const i=n(5751),o=n(3939),r=n(7237);t.defintionProvider=async function(e,t){if(t.isCancellationRequested)return;let n=e.textDocument.uri.toLowerCase(),s=[],a=o.lexers[n],c=a?.getContext(e.position);if(!c)return;if(!c.token.type){let t=c.token.previous_token;if(t?.content.match(/^#include/i)){let n=e.position.line,s=c.linetext.indexOf("#"),a=t.data,l=a?.data;if(l){s+=a.offset-t.offset;let e=i.Range.create(0,0,o.lexers[l[1]]?.document.lineCount??0,0),c=s+a.content.length,d=l[0]?r.URI.file((0,o.restorePath)(l[0].replace(/`;/g,";"))).toString():l[1];return[i.LocationLink.create(d,e,e,i.Range.create(n,s,n,c))]}}return}if(c.kind===i.SymbolKind.Null)return;let l=[];return(0,o.find_symbols)(a,c)?.forEach((e=>{!l.includes(e.node)&&l.push(e.node)&&e.node.selectionRange.end.character&&(n=e.node.uri??e.uri)&&s.push(i.LocationLink.create(o.lexers[n].document.uri,e.node.range,e.node.selectionRange))})),s}},2793:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.typeFormatting=t.rangeFormatting=t.documentFormatting=void 0;const i=n(5751),o=n(3939);t.documentFormatting=async function(e){let t=o.lexers[e.textDocument.uri.toLowerCase()],n=i.Range.create(0,0,t.document.lineCount,0),r=Object.assign({},o.extsettings.FormatOptions);return r.indent_string??=e.options.insertSpaces?" ".repeat(e.options.tabSize):"\t",[{range:n,newText:t.beautify(r)}]},t.rangeFormatting=async function(e){let t=o.lexers[e.textDocument.uri.toLowerCase()],n=e.range,i=Object.assign({},o.extsettings.FormatOptions);return i.indent_string=e.options.insertSpaces?" ".repeat(e.options.tabSize):"\t",[{range:n,newText:t.beautify(i,n).trim()}]},t.typeFormatting=async function(e){let t,n,r,s,a=o.lexers[e.textDocument.uri.toLowerCase()],{ch:c,position:l}=e,d=Object.assign({},o.extsettings.FormatOptions);if(d.indent_string=" ".repeat(e.options.tabSize),r=a.document.getText({start:{line:0,character:0},end:{line:0,character:1}}),("\t"===r||!e.options.insertSpaces&&" "!==r)&&(d.indent_string="\t"),"\n"===c){let e,{line:i,character:o}=l,r=a.document.getText({start:{line:i-1,character:0},end:{line:i+2,character:0}}).split(/\r?\n/),c=r[0].trimRight();if(r[1].trim()||(o=r[1].length),c.endsWith("{"))(t=u({line:i-1,character:c.length}))&&(e=t[0].range.indent_string??"",r[1].substring(0,o)!==e&&t.push({newText:e,range:{start:{line:i,character:0},end:{line:i,character:o}}}),(c=(r[2]??="").trimLeft()).startsWith("}")&&!r[2].startsWith((e=e.replace(d.indent_string,""))+"}")&&t.push({newText:e,range:{start:{line:i+1,character:0},end:{line:i+1,character:r[2].length-c.length}}}));else if(void 0!==(s=a.linepos[i-1])){let n={start:a.document.positionAt(s),end:{line:i-1,character:c.length}};t=[{range:n,newText:a.beautify(d,n).trim()}],e=n.indent_string??"",r[1].substring(0,o)!==e&&t.push({newText:e,range:{start:{line:i,character:0},end:{line:i,character:o}}})}else if(!c&&r[0]!==(r[1]=r[1].substring(0,o))){if(!r[0]){if(n=a.find_token(a.document.offsetAt(l)),"TK_STRING"===n.type||n.type.endsWith("COMMENT"))return;let e=["TK_START_EXPR","TK_START_BLOCK",""];for(;(n=n.previous_token)&&!e.includes(n.type););if(e.pop(),e.includes(n?.type))return}t=[{newText:r[0],range:{start:{line:i,character:0},end:{line:i,character:o}}}]}return t}if("}"===c)return u(l);if(r=o.chinese_punctuations[c]){let e={line:l.line,character:l.character-1};if(n=a.find_token(a.document.offsetAt(e)),"TK_WORD"===n.type)return n.length>1&&(r=n.content.replace(/./g,(e=>o.chinese_punctuations[e]??e)),e=a.document.positionAt(n.offset),l.character=e.character+n.length),[i.TextEdit.replace({start:e,end:l},r)]}function u(e){if(n=a.tokens[a.document.offsetAt({line:e.line,character:e.character-1})],s=n?.previous_pair_pos,void 0!==s){for(;void 0!==(n=a.tokens[s])?.previous_pair_pos;)s=n.previous_pair_pos;let t={start:a.document.positionAt(s),end:e};return[{range:t,newText:a.beautify(d,t).trim()}]}}}},9541:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.hoverProvider=void 0;const i=n(5751),o=n(3939);t.hoverProvider=async function(e,t){if(t.isCancellationRequested)return;let n,r=e.textDocument.uri.toLowerCase(),s=o.lexers[r],a=s?.getContext(e.position),c=[];if(!a)return;if(a.kind===i.SymbolKind.Null)return a.token.semantic?.type!==o.SemanticTokenTypes.variable&&(n=a.token,n=o.hoverCache[(n.hover_word||n.content).toLowerCase()])?n[1]:void 0;let l=(0,o.find_symbols)(s,a);if(!l?.length)return;let d=[];if(l=l.filter((e=>!d.includes(e.node)&&d.push(e.node))),l.length>1)for(n of l)(n=n.node.full)&&c.push({kind:"ahk2",value:n});else{let{node:e,is_global:t,uri:r}=l[0],s=e;if(e.kind!==i.SymbolKind.Class||s.full?.startsWith("(")){if(s.full){c.push({kind:"ahk2",value:s.full});let e=s.overloads;switch(typeof e){case"object":e=e.map((e=>e.full)).join("\n");case"string":c.at(-1).value+=`\n${e}`}}}else c.push({kind:"ahk2",value:"class "+(s.full||e.name)});let a=(0,o.get_detail)(e,o.lexers[r]);a="string"==typeof a?a&&"```plaintext\n"+a+"\n```":a.value,e.is_param?a=a.startsWith("*@param* ")?a.replace(/\n|(?<=`\*?) — /,"\n___\n"):`*@param* \`${e.name}\`${(n=(0,o.join_types)(e.type_annotations))&&`: *\`${n}\`*`}\n___\n${a}`:e.kind===i.SymbolKind.Variable&&(a=`${!0===t?"*@global*":e.static?"*@static*":"*@local*"} \`${e.name}\`${(n=(0,o.join_types)(e.type_annotations))&&`: *\`${n}\`*`}\n___\n${a}`),a&&c.push({value:(c.length?"___\n":"")+a})}return{contents:{kind:"markdown",value:c.map((e=>"ahk2"===e.kind?"```ahk2\n"+e.value+"\n```":e.value)).join("\n\n")}}}},7994:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loadlocalize=t.response=t.action=t.setting=t.warn=t.diagnostic=t.codeaction=t.completionitem=void 0;const i=n(3939);let o={};var r,s,a,c,l,d,u;function f(e,t){return(...n)=>n.length?function(e,...t){return e.replace(/\{(\d+)\}/g,((...e)=>{let n=parseInt(e[1]);return n<t.length?t[n]:" "}))}(p(e,t),...n):p(e,t)}function p(e,t){return o[e]||t}!function(e){e.author=f("completionitem.author","Add file infos about author, description, date, version."),e.comment=f("completionitem.generatecomment","Generate comment template of current function/method."),e.include=f("completionitem.include","Auto import from '{0}'"),e.prototype=f("completionitem.prototype","Retrieve or set the object on which all instances of the class are based."),e.thishotkey=f("completionitem.thishotkey","The hidden parameter to the hotkey function."),e.value=f("completionitem.value","Within the dynamic property 'set', 'Value' contains the value being assigned."),e._new=f("completionitem.new","export construct a new instance of the class."),e._this=f("completionitem.this","In the class, access other instance variables and methods of the class through 'this'."),e._super=f("completionitem.super","In the inherited class, 'super' can replace 'this' to access the superclass version of the method or property that is overridden in the derived class.")}(r||(t.completionitem=r={})),function(e){e.include=f("codeaction.include","Import '{0}'")}(s||(t.codeaction=s={})),function(e){e.acceptparams=f("diagnostic.acceptparams","'{0}' accepts {1} parameter(s)"),e.assignerr=f("diagnostic.assignerr","This {0} '{1}' cannot be used as an output variable"),e.classinfuncerr=f("diagnostic.classinfuncerr","Functions cannot contain classes"),e.classuseerr=f("diagnostic.classuseerr","This class cannot be used as an output variable"),e.conflictserr=f("diagnostic.conflictserr","This {0} '{2}' declaration conflicts with an existing {1}"),e.declarationerr=f("diagnostic.declarationerr","Unexpected declaration"),e.defaultvalmissing=f("diagnostic.defaultvalmissing","Parameter default required. Specifically: '{0}'"),e.deprecated=f("diagnostic.deprecated","Using '{0}' instead of '{1}'"),e.didyoumean=f("diagnostic.didyoumean","Did you mean to use '{0}'?"),e.dupdeclaration=f("diagnostic.dupdeclaration","Duplicate declaration"),e.duplabel=f("diagnostic.duplabel","Duplicate label"),e.filenotexist=f("diagnostic.filenotexist","'{0}' not exist"),e.funccallerr=f("diagnostic.funccallerr","Function calls require a space or '(',  use comma only between parameters"),e.funccallerr2=f("diagnostic.funccallerr2","In the expression, the function call requires parentheses"),e.globalconflicts=f("diagnostic.globalconflicts","This global declaration conflicts with an existing {0}"),e.hotdeferr=f("diagnostic.hotdeferr","Hotkeys/hotstrings cannot be defined in functions/classes"),e.hotmissbrace=f("diagnostic.hotmissbrace","Hotkey or hotstring is missing its opening brace"),e.invaliddefinition=f("diagnostic.invaliddefinition","Invalid {0} definition"),e.invalidencoding=f("diagnostic.invalidencoding","'{0}' invalid file encoding"),e.invalidhotdef=f("diagnostic.invalidhotdef","Invalid hotkey definition"),e.invalidparam=f("diagnostic.invalidparam","Invalid parameter definition"),e.invalidprop=f("diagnostic.invalidprop","Invalid dynamic property"),e.invalidpropname=f("diagnostic.invalidpropname","Invalid property name in object literal"),e.invalidsymbolname=f("diagnostic.invalidsymbolname","Invalid symbol naming '{0}'"),e.invalidsuper=f("diagnostic.invalidsuper","'super' is valid only inside a class"),e.invalidscope=f("diagnostic.invalidscope","'{0}' cannot be used in functions/classes"),e.maybehavenotmember=f("diagnostic.maybehavenotmember","Class '{0}' maybe have not member '{1}'"),e.maybev1=f("diagnostic.maybev1","This might be a v1 script, and the lexer stops parsing."),e.missing=f("diagnostic.missing","Missing '{0}'"),e.missingparam=f("diagnostic.missingparam","Missing a required parameter"),e.missingoperand=f("diagnostic.missingoperand","Missing operand"),e.missingretval=f("diagnostic.missingretval","The function missing a return value"),e.missingspace=f("diagnostic.missingspace","Missing space or operator before this"),e.objectliteralerr=f("diagnostic.objectliteralerr","Error in object literal"),e.outofloop=f("diagnostic.outofloop","Break/Continue must be enclosed by a Loop"),e.paramcounterr=f("diagnostic.paramcounterr","Expected {0} parameters, but got {1}"),e.pathinvalid=f("diagnostic.pathinvalid","Invalid file path"),e.propdeclaraerr=f("diagnostic.propdeclaraerr","Not a valid method, class or property definition"),e.propemptyparams=f("diagnostic.propemptyparams","Empty [] not permitted"),e.propnotinit=f("diagnostic.propnotinit","Property declaration is not initialized"),e.requirev1=f("diagnostic.requirev1","This script requires AutoHotkey v1, and the lexer stops parsing."),e.requireversion=f("diagnostic.requireversion","This feature requires the AutoHotkey version >= v{0}"),e.requirevariable=f("diagnostic.requirevariable","'&' requires a variable"),e.reservedworderr=f("diagnostic.reservedworderr","The following reserved word '{0}' must not be used as a variable name"),e.resourcenotfound=f("diagnostic.resourcenotfound","No resource found or could not be resolved"),e.skipline=f("diagnostic.skipline","The line is skipped and not resolved"),e.syntaxerror=f("diagnostic.syntaxerror","Syntax error. Specifically: {0}"),e.tryswitchtov1=f("diagnostic.tryswitchtov1","Try switching to AutoHotkey v1."),e.typemaybenot=f("diagnostic.typemaybenot","Type maybe not '{0}'"),e.unexpected=f("diagnostic.unexpected","Unexpected '{0}'"),e.unknown=f("diagnostic.unknown","Unknown {0}"),e.unknownoperatoruse=f("diagnostic.unknownoperatoruse","Unknown operator use"),e.unknowntoken=f("diagnostic.unknowntoken","Unknown token '{0}'"),e.unsupportinclude=f("diagnostic.unsupportinclude","#Include in functions and classes cannot correctly deduce scope and code completion"),e.unterminated=f("diagnostic.unterminated","Unterminated string text")}(a||(t.diagnostic=a={})),function(e){e.varisunset=f("warn.varisunset","Variable '{0}' appears to never be assigned a value"),e.localsameasglobal=f("warn.localsameasglobal","This local variable '{0}' has the same name as a global variable"),e.callwithoutparentheses=f("warn.callwithoutparentheses","This function or method call has no parentheses")}(c||(t.warn=c={})),function(e){e.ahkpatherr=f("setting.ahkpatherr","The AutoHotkey interpreter does not exist, re-specify in'Settings-AutoHotkey2.InterpreterPath'"),e.getenverr=f("setting.getenverr","Failed to get environment variables"),e.uialimit=f("setting.uialimit","The UIA executable does not allow redirection to stdin/stdout due to security restrictions, so some features that depend on this will not work"),e.versionerr=f("setting.versionerr","The current AutoHotkey.exe is not the v2 version, and cannot get the correct syntax analysis, completion and other functions")}(l||(t.setting=l={})),function(e){e.switchtov1=f("action.switchtov1","Switch to ahk v1"),e.skipline=f("action.skipline","Skip the line"),e.stopparsing=f("action.stopparsing","Stop parsing")}(d||(t.action=d={})),function(e){e.cannotrename=f("response.cannotrename","The element can't be renamed."),e.cannotrenamestdlib=f("response.cannotrenamestdlib","Elements defined in the standard AutoHotkey library can't be renamed.")}(u||(t.response=u={})),t.loadlocalize=function(){if(i.isBrowser){let e=(0,i.getwebfile)(`${i.rootdir}/package.nls.<>.json`);e&&(o=JSON.parse(e.text))}else{let e=(0,i.getlocalefile)(`${i.rootdir}/package.nls.<>.json`,"utf8");o=e?JSON.parse(e):{}}}},6658:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getAllReferences=t.referenceProvider=void 0;const i=n(5751),o=n(3939);function r(e,t,n=!0){if(t.kind===i.SymbolKind.Null)return;let r=(0,o.find_symbols)(e,t);if(1!==r?.length)return;let c=t.text.toUpperCase(),l={},{node:d,uri:u,scope:f,is_this:p,is_global:h}=r[0];if(u&&d.selectionRange.end.character&&!1!==p){if(!n&&(d===o.ahkvars[c]||u===o.ahkuris.winapi))return null;if(p){let e=[],t=d.property;for(let n of Object.values(t??{}))n.children?.length&&a(n,c,e,!1,!1);return e.length?{[o.lexers[u].document.uri]:e}:void 0}switch(d.kind){case i.SymbolKind.Field:if(f){let e=f.labels;e&&e[c]&&(l[o.lexers[u].document.uri]=e[c].map((e=>e.selectionRange)))}else{let t=e.labels;t[c]&&(l[e.document.uri]=t[c].map((e=>e.selectionRange)));for(const n in e.relevance)t=o.lexers[n].labels,t[c]&&(l[o.lexers[n].document.uri]=t[c].map((e=>e.selectionRange)))}break;case i.SymbolKind.Function:case i.SymbolKind.Variable:case i.SymbolKind.Class:if(d.kind!==i.SymbolKind.Class||!d.full.includes(".")){f=!0===h?void 0:r[0].parent;let t={[e.uri]:f};if(u!==e.uri&&(t[u]=void 0),!f)for(const n in e.relevance)t[n]=void 0;for(const e in t){let n=s(o.lexers[e],c,i.SymbolKind.Variable,t[e]);n.length&&(l[o.lexers[e].document.uri]=n)}break}default:if(d.kind===i.SymbolKind.Class||d.static){if(d.kind===i.SymbolKind.Class)c=d.full.toUpperCase();else{let e=d,t=e.full?.match(/^\(([^)]+)\)\sstatic\s([^(]+)($|[(\[])/);if(t)c=`${t[1]}.${t[2]}`.toUpperCase();else{if(e.parent?.kind!==i.SymbolKind.Class)return;c=`${e.parent.full}.${e.name}`.toUpperCase()}}let t=c.split("."),n=t.length,r=0,f={};for(const n of new Set([e.uri,...Object.keys(e.relevance)]))f[o.lexers[n].document.uri]=s(o.lexers[n],t[0],i.SymbolKind.Variable);for(;r<n;){let s=t.slice(0,++r).join("."),c=(0,o.find_symbol)(e,s);if(c?.node.kind===i.SymbolKind.Class)for(let e of Object.values(c.node.property??{}))e.children?.length&&a(e,"THIS",f[o.lexers[c.uri].document.uri]??=[],!1,!1);for(const e in f){let i=f[e],s=o.lexers[e.toLowerCase()],a=l[e]??=[],c=s.document,d=s.tokens;e:for(let e of i){let i=d[c.offsetAt(e.start)];if(i){for(let e=r;e<n;e++){if("TK_DOT"!==(i=d[i.next_token_offset])?.type)continue e;if("TK_WORD"!==(i=d[i.next_token_offset])?.type||i.content.toUpperCase()!==t[e])continue e}a.push({start:c.positionAt(i.offset),end:c.positionAt(i.offset+i.length)})}}l[e].length||delete l[e]}f={}}let p=d.parent,h=l[o.lexers[u].document.uri]??=[];for(;p&&p.kind!==i.SymbolKind.Class;)p=p.parent;if(p){let e=d.name.toLowerCase(),t=[];for(let n of p.children??[])n.static&&n.name.toLowerCase()===e&&t.push(n.selectionRange);h.unshift(...t)}else h.includes(d.selectionRange)||h.unshift(d.selectionRange);break}return}return Object.keys(l).length?l:void 0}}function s(e,t,n,o){let r=[];if(n===i.SymbolKind.Method||n===i.SymbolKind.Property);else{let c=o??e,l=!o,d=l,u=!c?.local?.[t]?.static;if(u&&o&&null===c.declaration?.[t]?.static&&(u=!1),d)d=!1;else{let e=c.local,n=c.declaration;e?.[t]||n?.[t]||(d=void 0)}if(c.children?.forEach((e=>{e.name.toUpperCase()===t&&r.push(e.selectionRange),e.children?.length&&a(e,t,r,l,l||e.kind===i.SymbolKind.Function?d:void 0,u)})),c.kind===i.SymbolKind.Property){let i=c;for(let o of[i.get,i.set,i.call])o?.children&&r.push(...s(e,t,n,o))}}return r}function a(e,t,n,r,s,c=!0){let l,d=e.kind===i.SymbolKind.Function&&e.static,u=d||e.closure,f=s;if(!d||!c||r){if(r&&e.has_this_param&&["THIS","SUPER"].includes(t))s=f=!1;else if(e.assume===o.FuncScope.GLOBAL||e.global?.[t]){if(!r)return;s=f=!0}else if(e.local?.[t]||(!u||r&&!s)&&e.declaration?.[t]){if(!r)return;s=f=!1}else r&&!s&&(!d||(l=e.declaration?.[t])&&(l.kind!==i.SymbolKind.Variable||l.def)?e.unresolved_vars?.[t]&&(f=!0):f=!0);c&&(c=!e?.local?.[t]?.static),f===r?e.children?.forEach((e=>{e.name.toUpperCase()===t&&e.kind!==i.SymbolKind.Property&&e.kind!==i.SymbolKind.Method&&e.kind!==i.SymbolKind.Class&&n.push(e.selectionRange),e.children?.length&&a(e,t,n,r,e.kind===i.SymbolKind.Function?s:r||void 0,c)})):e.children?.forEach((e=>{e.children?.length&&a(e,t,n,r,!r&&void 0,c)}))}}t.referenceProvider=async function(e,t){let n=[],i=o.lexers[e.textDocument.uri.toLowerCase()];if(!i||t.isCancellationRequested)return;let s=r(i,i.getContext(e.position));for(const e in s)n.push(...s[e].map((t=>({uri:e,range:t}))));return n},t.getAllReferences=r},5932:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.renameProvider=t.prepareRename=void 0;const i=n(9406),o=n(3939);let r;t.prepareRename=async function(e,t){let n=o.lexers[e.textDocument.uri.toLowerCase()];if(!n||t.isCancellationRequested)return;let s=n.getContext(e.position);return(r=(0,o.getAllReferences)(n,s,!1))?{range:s.range,placeholder:s.text.split(".").pop()||""}:new i.ResponseError(0,null===r?o.response.cannotrenamestdlib():o.response.cannotrename())},t.renameProvider=async function(e,t){if(t.isCancellationRequested)return;let n={changes:{}},i=e.newName;for(const e in r)n.changes[e]=r[e].map((e=>({range:e,newText:i})));return n}},6001:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.semanticTokensOnRange=t.semanticTokensOnFull=void 0;const i=n(5751),o=n(3939);let r,s=new Map;function a(e,t){let n,a;if(a=e.semantic){let n=e.pos??(e.pos=t.document.positionAt(e.offset)),c=a.type;if(c===o.SemanticTokenTypes.string)if(e.ignore){let i=n.line+1,o=e.data;for(let e=0;e<o.length;e++)t.STB.push(i++,0,o[e],c,0)}else t.STB.push(n.line,n.character,e.length,c,0);else(r&&(c===o.SemanticTokenTypes.method||c===o.SemanticTokenTypes.property)&&"TK_DOT"===e.previous_token?.type||(r=void 0,c===o.SemanticTokenTypes.class))&&(c=function(e,t,n){let a=t.semantic;switch(a.type){case o.SemanticTokenTypes.class:return r=o.globalsymbolcache[e],r?.kind!==i.SymbolKind.Class&&(r=void 0),o.SemanticTokenTypes.class;case o.SemanticTokenTypes.method:case o.SemanticTokenTypes.property:if(r){let l,d=r.property[e],u=d?.kind;if(!d||!1===d.def){let t=(l=s.get(r)??(s.set(r,l=(0,o.get_class_members)(n,r)),l))[e];t?(d=t,u=t.kind):a.type===o.SemanticTokenTypes.method?l.__CALL&&(u=i.SymbolKind.Null):l.__GET&&(u=i.SymbolKind.Null)}switch(u){case i.SymbolKind.Method:if(a.modifier=(a.modifier??0)|o.SemanticTokenModifiers.readonly|o.SemanticTokenModifiers.static,t.callsite){if(r)if(d.full?.startsWith("(Object) static Call("))d=(0,o.get_class_member)(n,r.prototype,"__new",!0)??d;else if(d.full?.startsWith("(Object) DefineProp(")){let e=n.tokens[t.next_token_offset];"("===e?.content&&(e=n.tokens[e.next_token_offset]),e&&("TK_STRING"===e.type?c(r,e.content.slice(1,-1),e.offset+1):c(r,""))}(0,o.checkParams)(n,d,t.callsite)}return r=void 0,a.type=o.SemanticTokenTypes.method;case i.SymbolKind.Class:return a.modifier=(a.modifier??0)|o.SemanticTokenModifiers.readonly,r=r.property[e],t.callsite&&(0,o.checkParams)(n,r,t.callsite),a.type=o.SemanticTokenTypes.class;case i.SymbolKind.Property:let l=d.children;return 1===l?.length&&"get"===l[0].name.toLowerCase()&&(a.modifier=(a.modifier??0)|o.SemanticTokenModifiers.readonly|o.SemanticTokenModifiers.static),r=void 0,a.type=o.SemanticTokenTypes.property;case void 0:!1!==(r.checkmember??n.checkmember)&&o.extsettings.Diagnostics.ClassStaticMemberCheck&&(":="===n.tokens[t.next_token_offset]?.content?c(r,t.content,t.offset):!1!==s.get(r)?.["#checkmember"]&&((r.undefined??={})[t.content.toUpperCase()]??=[]).push(t))}}default:return r=void 0,a.type}function c(e,t,r){let a=o.lexers[e.uri];if(a&&r){let o=i.Range.create(a.document.positionAt(r),a.document.positionAt(r+t.length)),c=i.DocumentSymbol.create(t,void 0,i.SymbolKind.Property,o,o);if(c.static=c.def=!0,t=t.toUpperCase(),a===n&&a.d<2)e.children?.push(c),e.property[t]??=c;else{let n=s.get(e);n&&(n[t]??=c)}e.undefined&&delete e.undefined[t]}else if(delete e.undefined,a&&a.d<2)e.checkmember=!1;else{let t=s.get(e);t&&(t["#checkmember"]=!1)}}}(e.content.toUpperCase(),e,t)),t.STB.push(n.line,n.character,e.length,c,(a.modifier??0)|!0===e.definition?.static)}else if(r&&"TK_DOT"!==e.type&&!e.type.endsWith("COMMENT"))r=void 0;else if("TK_WORD"===e.type&&["THIS","SUPER"].includes(n=e.content.toUpperCase())&&"TK_DOT"!==e.previous_token?.type){let o=t.findSymbol(n,i.SymbolKind.Variable,t.document.positionAt(e.offset));void 0!==o?.is_this&&(r=o.node)}}function c(e){for(let t of s.keys())if(t.undefined){let n=t.name;for(let i of Object.values(t.undefined))for(let t of i)e.addDiagnostic(o.diagnostic.maybehavenotmember(n,t.content),t.offset,t.length,2);delete t.undefined}}t.semanticTokensOnFull=function(e,t){let n=o.lexers[e.textDocument.uri.toLowerCase()];return!n||t?.isCancellationRequested?{data:[]}:(n.STB.previousResult(""),r=void 0,s.clear(),(0,o.symbolProvider)({textDocument:e.textDocument},null),Object.values(n.tokens).forEach((e=>a(e,n))),c(n),s.clear(),n.STB.build())},t.semanticTokensOnRange=function(e,t){let n=o.lexers[e.textDocument.uri.toLowerCase()];if(!n||t?.isCancellationRequested)return{data:[]};let i=n.document.offsetAt(e.range.start),l=n.document.offsetAt(e.range.end);n.STB.previousResult(""),r=void 0,s.clear(),(0,o.symbolProvider)({textDocument:e.textDocument},null);for(let e of Object.values(n.tokens))if(!(e.offset<i)){if(e.offset>l)break;a(e,n)}return c(n),s.clear(),n.STB.build()}},5373:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.signatureProvider=void 0;const i=n(5751),o=n(1727),r=n(3939);t.signatureProvider=async function(e,t){if(t.isCancellationRequested)return;let n=e.textDocument.uri.toLowerCase(),s=r.lexers[n],a={activeSignature:0,signatures:[],activeParameter:0},c=(0,r.get_callinfo)(s,e.position);if(!c||c.index<0)return;let{name:l,pos:d,index:u,kind:f}=c,p=s.getContext(d),h=!0;if(p.kind===i.SymbolKind.Null||p.token.symbol)return;let g=(0,r.decltype_expr)(s,p.token,p.range.end),m=new Set,y=[];if(g.includes(r.ANY)){if(f!==i.SymbolKind.Method)return;l=l.toUpperCase(),y=[];for(const e of new Set([r.ahkuris.ahk2,r.ahkuris.ahk2_h,s.uri,...Object.keys(s.relevance)]))for(const t of r.lexers[e]?.object.method[l]??[])y.push({node:t,uri:e})}else{let e=p.text?"":p.word.toLowerCase();f===i.SymbolKind.Property?(e||="__item",h=!1):e||="call";for(let t of g)_(t,e)}function _(e,t,n=0){let o,a=e.uri;switch(e.kind){case i.SymbolKind.Method:if(!h)break;if(n++,"call"===t){y.push({node:e,needthis:n,uri:a});break}o=e,c();break;case i.SymbolKind.Function:if(!h)break;if("call"===t){y.push({node:e,needthis:n,uri:a});break}o=e;case i.SymbolKind.Class:c()}function c(){let a,c=e;if(a=(0,r.get_class_member)(s,c,t,h)){if(h)if(a.kind===i.SymbolKind.Class)a=(0,r.get_class_constructor)(a);else if(a.full?.startsWith("(Object) static Call("))a=(0,r.get_class_member)(s,c.prototype,"__new",!0)??a;else{if(a.kind===i.SymbolKind.Property||a.alias){let e=(0,r.decltype_returns)(a,r.lexers[a.uri]??s,c);return a.kind===i.SymbolKind.Property&&a.alias&&(e=(0,r.decltype_invoke)(s,e,"call",!0)),e.forEach((e=>_(e,"call",-1)))}if(o&&"bind"===t){if(m.has(o))return;m.add(o);let e=o.full.indexOf("(",o.name?1:0);o={...o,name:a.name,detail:void 0===a.markdown_detail?a.detail:void 0,full:`(Func) Bind${o.full.slice(e,e+o.param_def_len)} => BoundFunc`,markdown_detail:a.markdown_detail},a=o}}else if(a.kind===i.SymbolKind.Class)a=(0,r.get_class_member)(s,a,"__item",!1);else{if(a.kind!==i.SymbolKind.Property)return;if(!a.params){for(let e of(0,r.decltype_returns)(a,r.lexers[a.uri]??s,c))(e=(0,r.get_class_member)(s,e,"__item",!1))&&y.push({node:e,needthis:n,uri:e.uri});return}}a&&y.push({node:a,needthis:n,uri:a.uri})}}}for(let e of y){let t=e.node,n=r.lexers[e.uri],s=e.needthis??0;if(!t.params||m.has(t))continue;let c,l,d,f,p,h,g=[t],y=t.name&&t.full.match(/^(\(.+?\))?[^([]+/)?.[0].length||0,_=u-s,b=[],v=(0,r.get_detail)(t,n,/(^|\n)\*@param\*(.|\n|\r)*?(?=\n\*@|$)/g);if(t.overloads)if("string"==typeof t.overloads){let e=new r.Lexer(o.TextDocument.create("","ahk2",-10,t.kind===i.SymbolKind.Function?t.overloads:`class _ {\n${t.overloads}\n}`),void 0,-1);e.parseScript(),p=t.name||"_";let n=t.kind===i.SymbolKind.Function?e.children:e.declaration._?.children??[],s=t.full.match(/^(\(.+?\))?[^([]+/)?.[0]??p;for(let e of n)e.name===p&&e.params&&(e.full=s+e.full.replace(/^(\(.+?\))?[^([]+/,""),g.push(e));t.overloads=g.slice(1)}else g.push(...t.overloads);y+=s>0?7:1,m.add(t);for(let e of g){p=e.full,c=e.params,d=e.variadic&&c[(f=c.length)-1].arr?Math.min(_,f-1):_,h=c[d]?.name.toUpperCase()??(s&&-1===d?"this":"\0"),l=t.params.find((e=>e.name.toUpperCase()===h))??t.overload_params?.[h],b=e.param_offsets.map(((e,t)=>({label:[e+=y,e+(c[t].name.length||1)]}))),s>0&&(b.unshift({label:"this"}),d++,p=p.replace(/(?<=.)\(/,"(this"+(c.length?", ":"")));let i=l&&(0,r.get_detail)(l,n);i&&(b[d].documentation=i),a.signatures.push({label:p,parameters:b,documentation:v,activeParameter:d})}}return a}},5116:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.workspaceSymbolProvider=t.checkParams=t.symbolProvider=t.globalsymbolcache=void 0;const i=n(5751),o=n(1727),r=n(7237),s=n(3939);function a(e,n){let o=e.textDocument.uri.toLowerCase(),r=s.lexers[o];if(!r||n?.isCancellationRequested)return[];if(null!==n&&r.symbolInformation)return r.symbolInformation;let a=t.globalsymbolcache={...s.ahkvars},l=[o,...Object.keys(r.relevance)],d={};l=l.map((e=>s.lexers[e]?.d_uri)).concat(l);for(const e of l){let t=s.lexers[e];if(!t)continue;let n,o=t.d,r=t.declaration;for(let e in r)!(n=a[e])||o||r[e].kind!==i.SymbolKind.Variable&&(n.kind===i.SymbolKind.Variable||!1===n.def)?a[e]=r[e]:n.kind===i.SymbolKind.Variable&&(n.assigned||=r[e].assigned,r[e].def)&&(n.def??=!1)}if(r.symbolInformation)return r.symbolInformation;s.ahkuris.winapi&&!l.includes(s.ahkuris.winapi)&&(d=s.lexers[s.ahkuris.winapi]?.declaration??d);const u=s.extsettings.Warn?.LocalSameAsGlobal,f=[],p=new Map,h=[i.SymbolKind.Method,i.SymbolKind.Property,i.SymbolKind.Class];for(let[e,t]of Object.entries(r.declaration)){let n=a[e],o=!1;n.kind!==i.SymbolKind.Variable||n.assigned||(d[e]?(n=a[e]=d[e],o=!0):void 0===t.returns&&p.set(n,t)),n!==t&&t.kind===i.SymbolKind.Variable||(f.push(t),m(t,t,o||t===s.ahkvars[e]).definition=t)}if(function e(t,n={},o=!1){const l=[];let y,_=t.kind===i.SymbolKind.Class;t.children?.forEach((e=>{if(e.children&&l.push(e),!e.name)return;let t=e.kind;if(t===i.SymbolKind.Variable||t===i.SymbolKind.Function||!_&&t===i.SymbolKind.Class){let t=e.name.toUpperCase(),o=n[t]??a[t];if(o===e||!o)return;(y=m(e,o,o===s.ahkvars[t])).definition=o,o.selectionRange.end.character?e.kind!==i.SymbolKind.Variable?f.push(e):o.kind===i.SymbolKind.Variable?g(o,e):y.callsite&&c(r,o,y.callsite):delete y.semantic}else h.includes(t)||f.push(e)}));for(let t of l){let c,h={},y=t,_=o;switch(t.kind){case i.SymbolKind.Class:let e=t;h={THIS:s.THIS,SUPER:s.SUPER},o=!1;for(let t of[e.property,e.prototype?.property??{}])Object.values(t).forEach((e=>e.selectionRange.end.character&&f.push(e)));break;case i.SymbolKind.Method:o||=y.assume===s.FuncScope.GLOBAL;case i.SymbolKind.Function:y.has_this_param&&(h={THIS:s.THIS,SUPER:s.SUPER});case i.SymbolKind.Event:if(y.parent){if(y.kind!==i.SymbolKind.Method)if(0===n.SUPER?.range.end.character&&delete n.SUPER,y.assume!==s.FuncScope.GLOBAL)if(y.assume===s.FuncScope.STATIC&&(o=!1),y.static)for(let[e,t]of Object.entries(n))(t.static||t===a[e])&&(h[e]=t);else h={...n};else o=!0}else o||=y.assume===s.FuncScope.GLOBAL;for(let[e,t]of Object.entries(y.global??{}))c=h[e]=a[e]??=t,m(t,c,c===s.ahkvars[e]).definition=c,c.kind===i.SymbolKind.Variable&&g(c,t);for(let[e,t]of Object.entries(y.local??{})){if(m(h[e]=t,t).definition=t,t.kind===i.SymbolKind.Variable){if(t.is_param)continue;t.assigned||void 0!==t.returns?u&&!t.decl&&a[e]&&r.diagnostics.push({message:s.warn.localsameasglobal(t.name),range:t.selectionRange,severity:i.DiagnosticSeverity.Warning}):p.set(t,t)}f.push(t)}for(let[e,t]of Object.entries(y.declaration??={}))(c=h[e])?c!==t&&(m(t,c,c===s.ahkvars[e]).definition=c,c.kind===i.SymbolKind.Variable&&g(c,t)):o?(c=a[e]??=(f.push(t),t.is_global=!0,r.declaration[e]=t),m(t,c,c===s.ahkvars[e]).definition=c,c.kind===i.SymbolKind.Variable&&g(c,t)):!t.def&&(c=a[e])?m(t,c,c===s.ahkvars[e]).definition=c:(m(h[e]=y.local[e]=t,t).definition=t,f.push(t),null===t.static&&(t.static=!0),u&&t.kind===i.SymbolKind.Variable&&a[e]&&r.diagnostics.push({message:s.warn.localsameasglobal(t.name),range:t.selectionRange,severity:i.DiagnosticSeverity.Warning}));for(let[e,t]of Object.entries(y.unresolved_vars??{}))(c=h[e]??a[e]??d[e])?m(t,c,c===s.ahkvars[e]).definition=c:(m(t,t).definition=t,f.push(h[e]=t),y.assume===s.FuncScope.STATIC&&(t.static=!0),void 0===t.returns&&p.set(t,t));break;case i.SymbolKind.Property:if(t.parent?.kind===i.SymbolKind.Class){let e=t;for(let t of[e.get,e.set,e.call])t&&(l.push(t),t.selectionRange.end.character&&f.push(t))}break;default:h={...n}}e(t,h,o),o=_}}(r),s.extsettings.Warn?.VarUnset)for(let[e,t]of p)e.assigned||r.diagnostics.push({message:s.warn.varisunset(t.name),range:t.selectionRange,severity:i.DiagnosticSeverity.Warning});return r.actived&&(function(e){if(e.d)return;let t,n={...s.ahkvars},o={};Object.keys(e.labels).forEach((e=>o[e]=!0));for(const r in e.relevance)if(t=s.lexers[r]){t.diagnostics.splice(t.diags),(0,s.check_same_name_error)(n,Object.values(t.declaration).filter((e=>e.kind!==i.SymbolKind.Variable)),t.diagnostics);for(const e in t.labels)t.labels[e][0].def&&(o[e]?t.diagnostics.push({message:s.diagnostic.duplabel(),range:t.labels[e][0].selectionRange,severity:i.DiagnosticSeverity.Error}):o[e]=!0)}let r,a=Object.values(e.declaration);(0,s.check_same_name_error)(n,a,e.diagnostics);for(const o in e.relevance)(t=s.lexers[o])&&(0,s.check_same_name_error)(n,Object.values(t.declaration).filter((e=>e.kind===i.SymbolKind.Variable)),t.diagnostics);a.forEach((t=>{if(t.kind===i.SymbolKind.Class&&void 0===(r=t).extendsuri){let n=r.extends?.toUpperCase();n===t.name.toUpperCase()?c(e,r,!1):n&&!(0,s.find_class)(e,n)?.prototype&&c(e,r)}}));for(const n in e.relevance)if(t=s.lexers[n])for(const e of Object.values(t.declaration))if(e.kind===i.SymbolKind.Class&&void 0===(r=e).extendsuri){let n=r.extends?.toUpperCase();n===e.name.toUpperCase()?c(t,r,!1):n&&!(0,s.find_class)(t,n)?.prototype&&c(t,r)}function c(e,t,n=!0){let o,r=e.document.offsetAt(t.selectionRange.start),a=e.tokens;if(!(o=a[a[r].next_token_offset])||!(o=a[o.next_token_offset]))return;r=o.offset;let c={start:e.document.positionAt(r),end:e.document.positionAt(r+t.extends.length)};e.diagnostics.push({message:n?s.diagnostic.unknown("class '"+t.extends)+"'":s.diagnostic.unexpected(t.extends),range:c,severity:i.DiagnosticSeverity.Warning})}}(r),r.sendDiagnostics(!1,!0)),r.diags=r.diagnostics.length,o=r.document.uri,r.symbolInformation=f.map((e=>i.SymbolInformation.create(e.name,e.kind,e.range,o)));function g(e,t){(e.assigned||=t.assigned)||void 0!==t.returns||p.has(e)||p.set(e,t)}function m(e,t,n=!1){let o,a,c,l,d=t.kind;switch(d){case i.SymbolKind.Variable:if(t.is_param){if(!e.selectionRange.end.character)return{};c=s.SemanticTokenTypes.parameter;break}c=s.SemanticTokenTypes.variable;break;case i.SymbolKind.Class:c=s.SemanticTokenTypes.class;break;case i.SymbolKind.Function:c=s.SemanticTokenTypes.function}if((o=r.tokens[l=r.document.offsetAt(e.selectionRange.start)])&&void 0!==c&&!o.ignore){if(void 0===(a=o.semantic)){if(o.semantic=a={type:c},e.kind!==i.SymbolKind.Variable||!e.def||d!==i.SymbolKind.Class&&d!==i.SymbolKind.Function||(r.addDiagnostic((0,s.make_same_name_error)(e,{kind:d}),l,e.name.length),delete e.def),!o.callsite&&c===s.SemanticTokenTypes.function){let e=r.tokens[o.next_token_offset];e&&e.topofline<1&&!(e.op_type>=0||":?.+-*/=%<>,)]}".includes(e.content.charAt(0))||!e.data&&"{"===e.content)&&r.addDiagnostic(s.diagnostic.funccallerr2(),o.offset,o.length,2)}}else void 0!==d&&(a.type=c);c<3&&(a.modifier=(a.modifier??0)|s.SemanticTokenModifiers.readonly|(n?s.SemanticTokenModifiers.defaultLibrary:0))}return o??{}}}function c(e,t,n){let o,r,a=n.paraminfo;if(!a||!s.extsettings.Diagnostics.ParamsCheck)return;if((o=t?.kind===i.SymbolKind.Class)&&(t=(0,s.get_class_constructor)(t)),!(r=t?.params))return;let c,{max:l,min:d}=function(e){let t=e.params,n=t.length,i=n;for(e.variadic&&(i=1/0,n>0&&t[n-1].arr&&n--);n>0&&void 0!==t[n-1].defaultVal;)--n;for(let e=0;e<n;++e)!1===t[e].defaultVal&&--n;return{min:n,max:i,has_this_param:e.has_this_param}}(t),u=r.length,{count:f,miss:p}=a,h={};for(;void 0!==(c=p.pop());)if(c!==--f){f++,p.push(c);break}for(c of((f<d&&!a.unknown||f>l)&&e.diagnostics.push({message:s.diagnostic.paramcounterr(d===l?d:l===1/0?`${d}+`:`${d}-${l}`,f),range:n.range,severity:i.DiagnosticSeverity.Error}),p)){if(c>=u)break;h[c]=!0,g(r,c)&&e.addDiagnostic(s.diagnostic.missingparam(),a.comma[c]??e.document.offsetAt(n.range.end),1)}if(t.hasref&&r.forEach(((t,i)=>{if(i<f&&t.pass_by_ref&&!p[i]){let o,r;if(o=0===i?n.offset+n.name.length+1:a.comma[i-1]+1,"&"!==(r=e.find_token(o)).content&&("unset"!==r.content.toLowerCase()||void 0===t.defaultVal)&&"TK_DOT"!==e.tokens[r.next_token_offset]?.type){let t=0;if((0,s.decltype_expr)(e,r,a.comma[i]??(t=e.document.offsetAt(n.range.end)-(e.tokens[n.offset+n.name.length]?1:0))).some((e=>e===s.VARREF||e===s.ANY||e.data===s.VARREF)))return;let o=e.tokens[a.comma[i]]?.previous_token;o&&(t=o.offset+o.length),e.addDiagnostic(s.diagnostic.typemaybenot("VarRef"),r.offset,Math.max(0,t-r.offset),2)}}})),!(t.returns?.length||(t.type_annotations||null)?.length||o&&"__new"===t.name.toLowerCase())){let t=e.tokens[n.offset];if("TK_EQUALS"===t?.previous_token?.type){let i=e.get_token(e.document.offsetAt(n.range.end),!0);i&&(0,s.is_line_continue)(i.previous_token,i)&&("??"===i.content||"?"===i.content&&i.ignore)||e.addDiagnostic(s.diagnostic.missingretval(),t.offset,t.length,2)}}function g(e,t){if(void 0!==e[t].defaultVal)return!1;let n=t-1;for(;n>=0;){for(;n>=0&&!1===e[n].defaultVal;n--,t++);if(!e[t]||void 0!==e[t].defaultVal)return!1;for(;n>=0&&!1!==e[n].defaultVal;n--);}return!0}}t.globalsymbolcache={},t.symbolProvider=a,t.checkParams=c,t.workspaceSymbolProvider=async function(e,t){let n=[],i=0,c=e.query;if(t.isCancellationRequested||!c||!c.match(/^(\w|[^\x00-\x7f])+$/))return n;let l=new RegExp(c.match(/[^\w]/)?c.replace(/(.)/g,"$1.*"):"("+c.replace(/(.)/g,"$1.*")+"|[^\\w])","i");for(let e in s.lexers)if(d(e))return n;if(s.isBrowser){let e=await s.connection.sendRequest("ahk2.getWorkspaceFiles",[])||[];for(let t of e){let e,i=t.toLowerCase();if(!s.lexers[i]){let r=await s.connection.sendRequest("ahk2.getWorkspaceFileContent",[t]);if(e=new s.Lexer(o.TextDocument.create(t,"ahk2",-10,r)),e.parseScript(),s.lexers[i]=e,d(i))return n}}}else{let e,t,i;for(let o of s.workspaceFolders){o=r.URI.parse(o).fsPath;for await(let a of(0,s.enum_ahkfiles)(o))if(e=r.URI.file(a).toString().toLowerCase(),!s.lexers[e]&&(i=(0,s.openFile)(a))){if((t=new s.Lexer(i)).parseScript(),t.maybev1)continue;if(s.lexers[e]=t,d(e))return n}}}return n;function d(e){for(let t of a({textDocument:{uri:e}}))if(l.test(t.name)&&(n.push(t),++i>=1e3))return!0;return!1}}},9838:(e,t,n)=>{"use strict";e.exports=n(9406)},9406:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,o)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.createMessageConnection=t.BrowserMessageWriter=t.BrowserMessageReader=void 0,n(6028).default.install();const r=n(5748);o(n(5748),t);class s extends r.AbstractMessageReader{constructor(e){super(),this._onData=new r.Emitter,this._messageListener=e=>{this._onData.fire(e.data)},e.addEventListener("error",(e=>this.fireError(e))),e.onmessage=this._messageListener}listen(e){return this._onData.event(e)}}t.BrowserMessageReader=s;class a extends r.AbstractMessageWriter{constructor(e){super(),this.port=e,this.errorCount=0,e.addEventListener("error",(e=>this.fireError(e)))}write(e){try{return this.port.postMessage(e),Promise.resolve()}catch(t){return this.handleError(t,e),Promise.reject(t)}}handleError(e,t){this.errorCount++,this.fireError(e,t,this.errorCount)}end(){}}t.BrowserMessageWriter=a,t.createMessageConnection=function(e,t,n,i){return void 0===n&&(n=r.NullLogger),r.ConnectionStrategy.is(i)&&(i={connectionStrategy:i}),(0,r.createMessageConnection)(e,t,n,i)}},6028:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(5748);class o extends i.AbstractMessageBuffer{constructor(e="utf-8"){super(e),this.asciiDecoder=new TextDecoder("ascii")}emptyBuffer(){return o.emptyBuffer}fromString(e,t){return(new TextEncoder).encode(e)}toString(e,t){return"ascii"===t?this.asciiDecoder.decode(e):new TextDecoder(t).decode(e)}asNative(e,t){return void 0===t?e:e.slice(0,t)}allocNative(e){return new Uint8Array(e)}}o.emptyBuffer=new Uint8Array(0);class r{constructor(e){this.socket=e,this._onData=new i.Emitter,this._messageListener=e=>{e.data.arrayBuffer().then((e=>{this._onData.fire(new Uint8Array(e))}),(()=>{(0,i.RAL)().console.error("Converting blob to array buffer failed.")}))},this.socket.addEventListener("message",this._messageListener)}onClose(e){return this.socket.addEventListener("close",e),i.Disposable.create((()=>this.socket.removeEventListener("close",e)))}onError(e){return this.socket.addEventListener("error",e),i.Disposable.create((()=>this.socket.removeEventListener("error",e)))}onEnd(e){return this.socket.addEventListener("end",e),i.Disposable.create((()=>this.socket.removeEventListener("end",e)))}onData(e){return this._onData.event(e)}}class s{constructor(e){this.socket=e}onClose(e){return this.socket.addEventListener("close",e),i.Disposable.create((()=>this.socket.removeEventListener("close",e)))}onError(e){return this.socket.addEventListener("error",e),i.Disposable.create((()=>this.socket.removeEventListener("error",e)))}onEnd(e){return this.socket.addEventListener("end",e),i.Disposable.create((()=>this.socket.removeEventListener("end",e)))}write(e,t){if("string"==typeof e){if(void 0!==t&&"utf-8"!==t)throw new Error(`In a Browser environments only utf-8 text encoding is supported. But got encoding: ${t}`);this.socket.send(e)}else this.socket.send(e);return Promise.resolve()}end(){this.socket.close()}}const a=new TextEncoder,c=Object.freeze({messageBuffer:Object.freeze({create:e=>new o(e)}),applicationJson:Object.freeze({encoder:Object.freeze({name:"application/json",encode:(e,t)=>{if("utf-8"!==t.charset)throw new Error(`In a Browser environments only utf-8 text encoding is supported. But got encoding: ${t.charset}`);return Promise.resolve(a.encode(JSON.stringify(e,void 0,0)))}}),decoder:Object.freeze({name:"application/json",decode:(e,t)=>{if(!(e instanceof Uint8Array))throw new Error("In a Browser environments only Uint8Arrays are supported.");return Promise.resolve(JSON.parse(new TextDecoder(t.charset).decode(e)))}})}),stream:Object.freeze({asReadableStream:e=>new r(e),asWritableStream:e=>new s(e)}),console,timer:Object.freeze({setTimeout(e,t,...n){const i=setTimeout(e,t,...n);return{dispose:()=>clearTimeout(i)}},setImmediate(e,...t){const n=setTimeout(e,0,...t);return{dispose:()=>clearTimeout(n)}},setInterval(e,t,...n){const i=setInterval(e,t,...n);return{dispose:()=>clearInterval(i)}}})});function l(){return c}!function(e){e.install=function(){i.RAL.install(c)}}(l||(l={})),t.default=l},5748:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ProgressType=t.ProgressToken=t.createMessageConnection=t.NullLogger=t.ConnectionOptions=t.ConnectionStrategy=t.AbstractMessageBuffer=t.WriteableStreamMessageWriter=t.AbstractMessageWriter=t.MessageWriter=t.ReadableStreamMessageReader=t.AbstractMessageReader=t.MessageReader=t.SharedArrayReceiverStrategy=t.SharedArraySenderStrategy=t.CancellationToken=t.CancellationTokenSource=t.Emitter=t.Event=t.Disposable=t.LRUCache=t.Touch=t.LinkedMap=t.ParameterStructures=t.NotificationType9=t.NotificationType8=t.NotificationType7=t.NotificationType6=t.NotificationType5=t.NotificationType4=t.NotificationType3=t.NotificationType2=t.NotificationType1=t.NotificationType0=t.NotificationType=t.ErrorCodes=t.ResponseError=t.RequestType9=t.RequestType8=t.RequestType7=t.RequestType6=t.RequestType5=t.RequestType4=t.RequestType3=t.RequestType2=t.RequestType1=t.RequestType0=t.RequestType=t.Message=t.RAL=void 0,t.MessageStrategy=t.CancellationStrategy=t.CancellationSenderStrategy=t.CancellationReceiverStrategy=t.ConnectionError=t.ConnectionErrors=t.LogTraceNotification=t.SetTraceNotification=t.TraceFormat=t.TraceValues=t.Trace=void 0;const i=n(5285);Object.defineProperty(t,"Message",{enumerable:!0,get:function(){return i.Message}}),Object.defineProperty(t,"RequestType",{enumerable:!0,get:function(){return i.RequestType}}),Object.defineProperty(t,"RequestType0",{enumerable:!0,get:function(){return i.RequestType0}}),Object.defineProperty(t,"RequestType1",{enumerable:!0,get:function(){return i.RequestType1}}),Object.defineProperty(t,"RequestType2",{enumerable:!0,get:function(){return i.RequestType2}}),Object.defineProperty(t,"RequestType3",{enumerable:!0,get:function(){return i.RequestType3}}),Object.defineProperty(t,"RequestType4",{enumerable:!0,get:function(){return i.RequestType4}}),Object.defineProperty(t,"RequestType5",{enumerable:!0,get:function(){return i.RequestType5}}),Object.defineProperty(t,"RequestType6",{enumerable:!0,get:function(){return i.RequestType6}}),Object.defineProperty(t,"RequestType7",{enumerable:!0,get:function(){return i.RequestType7}}),Object.defineProperty(t,"RequestType8",{enumerable:!0,get:function(){return i.RequestType8}}),Object.defineProperty(t,"RequestType9",{enumerable:!0,get:function(){return i.RequestType9}}),Object.defineProperty(t,"ResponseError",{enumerable:!0,get:function(){return i.ResponseError}}),Object.defineProperty(t,"ErrorCodes",{enumerable:!0,get:function(){return i.ErrorCodes}}),Object.defineProperty(t,"NotificationType",{enumerable:!0,get:function(){return i.NotificationType}}),Object.defineProperty(t,"NotificationType0",{enumerable:!0,get:function(){return i.NotificationType0}}),Object.defineProperty(t,"NotificationType1",{enumerable:!0,get:function(){return i.NotificationType1}}),Object.defineProperty(t,"NotificationType2",{enumerable:!0,get:function(){return i.NotificationType2}}),Object.defineProperty(t,"NotificationType3",{enumerable:!0,get:function(){return i.NotificationType3}}),Object.defineProperty(t,"NotificationType4",{enumerable:!0,get:function(){return i.NotificationType4}}),Object.defineProperty(t,"NotificationType5",{enumerable:!0,get:function(){return i.NotificationType5}}),Object.defineProperty(t,"NotificationType6",{enumerable:!0,get:function(){return i.NotificationType6}}),Object.defineProperty(t,"NotificationType7",{enumerable:!0,get:function(){return i.NotificationType7}}),Object.defineProperty(t,"NotificationType8",{enumerable:!0,get:function(){return i.NotificationType8}}),Object.defineProperty(t,"NotificationType9",{enumerable:!0,get:function(){return i.NotificationType9}}),Object.defineProperty(t,"ParameterStructures",{enumerable:!0,get:function(){return i.ParameterStructures}});const o=n(5164);Object.defineProperty(t,"LinkedMap",{enumerable:!0,get:function(){return o.LinkedMap}}),Object.defineProperty(t,"LRUCache",{enumerable:!0,get:function(){return o.LRUCache}}),Object.defineProperty(t,"Touch",{enumerable:!0,get:function(){return o.Touch}});const r=n(8159);Object.defineProperty(t,"Disposable",{enumerable:!0,get:function(){return r.Disposable}});const s=n(345);Object.defineProperty(t,"Event",{enumerable:!0,get:function(){return s.Event}}),Object.defineProperty(t,"Emitter",{enumerable:!0,get:function(){return s.Emitter}});const a=n(7770);Object.defineProperty(t,"CancellationTokenSource",{enumerable:!0,get:function(){return a.CancellationTokenSource}}),Object.defineProperty(t,"CancellationToken",{enumerable:!0,get:function(){return a.CancellationToken}});const c=n(278);Object.defineProperty(t,"SharedArraySenderStrategy",{enumerable:!0,get:function(){return c.SharedArraySenderStrategy}}),Object.defineProperty(t,"SharedArrayReceiverStrategy",{enumerable:!0,get:function(){return c.SharedArrayReceiverStrategy}});const l=n(4806);Object.defineProperty(t,"MessageReader",{enumerable:!0,get:function(){return l.MessageReader}}),Object.defineProperty(t,"AbstractMessageReader",{enumerable:!0,get:function(){return l.AbstractMessageReader}}),Object.defineProperty(t,"ReadableStreamMessageReader",{enumerable:!0,get:function(){return l.ReadableStreamMessageReader}});const d=n(9248);Object.defineProperty(t,"MessageWriter",{enumerable:!0,get:function(){return d.MessageWriter}}),Object.defineProperty(t,"AbstractMessageWriter",{enumerable:!0,get:function(){return d.AbstractMessageWriter}}),Object.defineProperty(t,"WriteableStreamMessageWriter",{enumerable:!0,get:function(){return d.WriteableStreamMessageWriter}});const u=n(5506);Object.defineProperty(t,"AbstractMessageBuffer",{enumerable:!0,get:function(){return u.AbstractMessageBuffer}});const f=n(6336);Object.defineProperty(t,"ConnectionStrategy",{enumerable:!0,get:function(){return f.ConnectionStrategy}}),Object.defineProperty(t,"ConnectionOptions",{enumerable:!0,get:function(){return f.ConnectionOptions}}),Object.defineProperty(t,"NullLogger",{enumerable:!0,get:function(){return f.NullLogger}}),Object.defineProperty(t,"createMessageConnection",{enumerable:!0,get:function(){return f.createMessageConnection}}),Object.defineProperty(t,"ProgressToken",{enumerable:!0,get:function(){return f.ProgressToken}}),Object.defineProperty(t,"ProgressType",{enumerable:!0,get:function(){return f.ProgressType}}),Object.defineProperty(t,"Trace",{enumerable:!0,get:function(){return f.Trace}}),Object.defineProperty(t,"TraceValues",{enumerable:!0,get:function(){return f.TraceValues}}),Object.defineProperty(t,"TraceFormat",{enumerable:!0,get:function(){return f.TraceFormat}}),Object.defineProperty(t,"SetTraceNotification",{enumerable:!0,get:function(){return f.SetTraceNotification}}),Object.defineProperty(t,"LogTraceNotification",{enumerable:!0,get:function(){return f.LogTraceNotification}}),Object.defineProperty(t,"ConnectionErrors",{enumerable:!0,get:function(){return f.ConnectionErrors}}),Object.defineProperty(t,"ConnectionError",{enumerable:!0,get:function(){return f.ConnectionError}}),Object.defineProperty(t,"CancellationReceiverStrategy",{enumerable:!0,get:function(){return f.CancellationReceiverStrategy}}),Object.defineProperty(t,"CancellationSenderStrategy",{enumerable:!0,get:function(){return f.CancellationSenderStrategy}}),Object.defineProperty(t,"CancellationStrategy",{enumerable:!0,get:function(){return f.CancellationStrategy}}),Object.defineProperty(t,"MessageStrategy",{enumerable:!0,get:function(){return f.MessageStrategy}});const p=n(8094);t.RAL=p.default},7770:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CancellationTokenSource=t.CancellationToken=void 0;const i=n(8094),o=n(8472),r=n(345);var s;!function(e){e.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:r.Event.None}),e.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:r.Event.None}),e.is=function(t){const n=t;return n&&(n===e.None||n===e.Cancelled||o.boolean(n.isCancellationRequested)&&!!n.onCancellationRequested)}}(s||(t.CancellationToken=s={}));const a=Object.freeze((function(e,t){const n=(0,i.default)().timer.setTimeout(e.bind(t),0);return{dispose(){n.dispose()}}}));class c{constructor(){this._isCancelled=!1}cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?a:(this._emitter||(this._emitter=new r.Emitter),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=void 0)}}t.CancellationTokenSource=class{get token(){return this._token||(this._token=new c),this._token}cancel(){this._token?this._token.cancel():this._token=s.Cancelled}dispose(){this._token?this._token instanceof c&&this._token.dispose():this._token=s.None}}},6336:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createMessageConnection=t.ConnectionOptions=t.MessageStrategy=t.CancellationStrategy=t.CancellationSenderStrategy=t.CancellationReceiverStrategy=t.RequestCancellationReceiverStrategy=t.IdCancellationReceiverStrategy=t.ConnectionStrategy=t.ConnectionError=t.ConnectionErrors=t.LogTraceNotification=t.SetTraceNotification=t.TraceFormat=t.TraceValues=t.Trace=t.NullLogger=t.ProgressType=t.ProgressToken=void 0;const i=n(8094),o=n(8472),r=n(5285),s=n(5164),a=n(345),c=n(7770);var l,d,u,f,p,h,g,m,y,_,b,v,k,T,R,S,w,D,C;!function(e){e.type=new r.NotificationType("$/cancelRequest")}(l||(l={})),function(e){e.is=function(e){return"string"==typeof e||"number"==typeof e}}(d||(t.ProgressToken=d={})),function(e){e.type=new r.NotificationType("$/progress")}(u||(u={})),t.ProgressType=class{constructor(){}},function(e){e.is=function(e){return o.func(e)}}(f||(f={})),t.NullLogger=Object.freeze({error:()=>{},warn:()=>{},info:()=>{},log:()=>{}}),function(e){e[e.Off=0]="Off",e[e.Messages=1]="Messages",e[e.Compact=2]="Compact",e[e.Verbose=3]="Verbose"}(p||(t.Trace=p={})),function(e){e.Off="off",e.Messages="messages",e.Compact="compact",e.Verbose="verbose"}(h||(t.TraceValues=h={})),function(e){e.fromString=function(t){if(!o.string(t))return e.Off;switch(t=t.toLowerCase()){default:return e.Off;case"messages":return e.Messages;case"compact":return e.Compact;case"verbose":return e.Verbose}},e.toString=function(t){switch(t){case e.Off:return"off";case e.Messages:return"messages";case e.Compact:return"compact";case e.Verbose:return"verbose";default:return"off"}}}(p||(t.Trace=p={})),function(e){e.Text="text",e.JSON="json"}(g||(t.TraceFormat=g={})),function(e){e.fromString=function(t){return o.string(t)&&"json"===(t=t.toLowerCase())?e.JSON:e.Text}}(g||(t.TraceFormat=g={})),function(e){e.type=new r.NotificationType("$/setTrace")}(m||(t.SetTraceNotification=m={})),function(e){e.type=new r.NotificationType("$/logTrace")}(y||(t.LogTraceNotification=y={})),function(e){e[e.Closed=1]="Closed",e[e.Disposed=2]="Disposed",e[e.AlreadyListening=3]="AlreadyListening"}(_||(t.ConnectionErrors=_={}));class x extends Error{constructor(e,t){super(t),this.code=e,Object.setPrototypeOf(this,x.prototype)}}t.ConnectionError=x,function(e){e.is=function(e){const t=e;return t&&o.func(t.cancelUndispatched)}}(b||(t.ConnectionStrategy=b={})),function(e){e.is=function(e){const t=e;return t&&(void 0===t.kind||"id"===t.kind)&&o.func(t.createCancellationTokenSource)&&(void 0===t.dispose||o.func(t.dispose))}}(v||(t.IdCancellationReceiverStrategy=v={})),function(e){e.is=function(e){const t=e;return t&&"request"===t.kind&&o.func(t.createCancellationTokenSource)&&(void 0===t.dispose||o.func(t.dispose))}}(k||(t.RequestCancellationReceiverStrategy=k={})),function(e){e.Message=Object.freeze({createCancellationTokenSource:e=>new c.CancellationTokenSource}),e.is=function(e){return v.is(e)||k.is(e)}}(T||(t.CancellationReceiverStrategy=T={})),function(e){e.Message=Object.freeze({sendCancellation:(e,t)=>e.sendNotification(l.type,{id:t}),cleanup(e){}}),e.is=function(e){const t=e;return t&&o.func(t.sendCancellation)&&o.func(t.cleanup)}}(R||(t.CancellationSenderStrategy=R={})),function(e){e.Message=Object.freeze({receiver:T.Message,sender:R.Message}),e.is=function(e){const t=e;return t&&T.is(t.receiver)&&R.is(t.sender)}}(S||(t.CancellationStrategy=S={})),function(e){e.is=function(e){const t=e;return t&&o.func(t.handleMessage)}}(w||(t.MessageStrategy=w={})),function(e){e.is=function(e){const t=e;return t&&(S.is(t.cancellationStrategy)||b.is(t.connectionStrategy)||w.is(t.messageStrategy))}}(D||(t.ConnectionOptions=D={})),function(e){e[e.New=1]="New",e[e.Listening=2]="Listening",e[e.Closed=3]="Closed",e[e.Disposed=4]="Disposed"}(C||(C={})),t.createMessageConnection=function(e,n,h,b){const k=void 0!==h?h:t.NullLogger;let T=0,R=0,D=0;const K="2.0";let O;const E=new Map;let P;const A=new Map,M=new Map;let N,q,L=new s.LinkedMap,I=new Map,F=new Set,j=new Map,W=p.Off,$=g.Text,U=C.New;const V=new a.Emitter,B=new a.Emitter,H=new a.Emitter,z=new a.Emitter,G=new a.Emitter,X=b&&b.cancellationStrategy?b.cancellationStrategy:S.Message;function Q(e){if(null===e)throw new Error("Can't send requests with id null since the response can't be correlated.");return"req-"+e.toString()}function J(e){}function Y(){return U===C.Listening}function Z(){return U===C.Closed}function ee(){return U===C.Disposed}function te(){U!==C.New&&U!==C.Listening||(U=C.Closed,B.fire(void 0))}function ne(){N||0===L.size||(N=(0,i.default)().timer.setImmediate((()=>{N=void 0,function(){if(0===L.size)return;const e=L.shift();try{const t=b?.messageStrategy;w.is(t)?t.handleMessage(e,ie):ie(e)}finally{ne()}}()})))}function ie(e){r.Message.isRequest(e)?function(e){if(ee())return;function t(t,i,o){const s={jsonrpc:K,id:e.id};t instanceof r.ResponseError?s.error=t.toJson():s.result=void 0===t?null:t,se(s,i,o),n.write(s).catch((()=>k.error("Sending response failed.")))}function i(t,i,o){const r={jsonrpc:K,id:e.id,error:t.toJson()};se(r,i,o),n.write(r).catch((()=>k.error("Sending response failed.")))}!function(e){if(W!==p.Off&&q)if($===g.Text){let t;W!==p.Verbose&&W!==p.Compact||!e.params||(t=`Params: ${re(e.params)}\n\n`),q.log(`Received request '${e.method} - (${e.id})'.`,t)}else ce("receive-request",e)}(e);const s=E.get(e.method);let a,c;s&&(a=s.type,c=s.handler);const l=Date.now();if(c||O){const s=e.id??String(Date.now()),d=v.is(X.receiver)?X.receiver.createCancellationTokenSource(s):X.receiver.createCancellationTokenSource(e);null!==e.id&&F.has(e.id)&&d.cancel(),null!==e.id&&j.set(s,d);try{let u;if(c)if(void 0===e.params){if(void 0!==a&&0!==a.numberOfParams)return void i(new r.ResponseError(r.ErrorCodes.InvalidParams,`Request ${e.method} defines ${a.numberOfParams} params but received none.`),e.method,l);u=c(d.token)}else if(Array.isArray(e.params)){if(void 0!==a&&a.parameterStructures===r.ParameterStructures.byName)return void i(new r.ResponseError(r.ErrorCodes.InvalidParams,`Request ${e.method} defines parameters by name but received parameters by position`),e.method,l);u=c(...e.params,d.token)}else{if(void 0!==a&&a.parameterStructures===r.ParameterStructures.byPosition)return void i(new r.ResponseError(r.ErrorCodes.InvalidParams,`Request ${e.method} defines parameters by position but received parameters by name`),e.method,l);u=c(e.params,d.token)}else O&&(u=O(e.method,e.params,d.token));const f=u;u?f.then?f.then((n=>{j.delete(s),t(n,e.method,l)}),(t=>{j.delete(s),t instanceof r.ResponseError?i(t,e.method,l):t&&o.string(t.message)?i(new r.ResponseError(r.ErrorCodes.InternalError,`Request ${e.method} failed with message: ${t.message}`),e.method,l):i(new r.ResponseError(r.ErrorCodes.InternalError,`Request ${e.method} failed unexpectedly without providing any details.`),e.method,l)})):(j.delete(s),t(u,e.method,l)):(j.delete(s),function(t,i,o){void 0===t&&(t=null);const r={jsonrpc:K,id:e.id,result:t};se(r,i,o),n.write(r).catch((()=>k.error("Sending response failed.")))}(u,e.method,l))}catch(n){j.delete(s),n instanceof r.ResponseError?t(n,e.method,l):n&&o.string(n.message)?i(new r.ResponseError(r.ErrorCodes.InternalError,`Request ${e.method} failed with message: ${n.message}`),e.method,l):i(new r.ResponseError(r.ErrorCodes.InternalError,`Request ${e.method} failed unexpectedly without providing any details.`),e.method,l)}}else i(new r.ResponseError(r.ErrorCodes.MethodNotFound,`Unhandled method ${e.method}`),e.method,l)}(e):r.Message.isNotification(e)?function(e){if(ee())return;let t,n;if(e.method===l.type.method){const t=e.params.id;return F.delete(t),void ae(e)}{const i=A.get(e.method);i&&(n=i.handler,t=i.type)}if(n||P)try{if(ae(e),n)if(void 0===e.params)void 0!==t&&0!==t.numberOfParams&&t.parameterStructures!==r.ParameterStructures.byName&&k.error(`Notification ${e.method} defines ${t.numberOfParams} params but received none.`),n();else if(Array.isArray(e.params)){const i=e.params;e.method===u.type.method&&2===i.length&&d.is(i[0])?n({token:i[0],value:i[1]}):(void 0!==t&&(t.parameterStructures===r.ParameterStructures.byName&&k.error(`Notification ${e.method} defines parameters by name but received parameters by position`),t.numberOfParams!==e.params.length&&k.error(`Notification ${e.method} defines ${t.numberOfParams} params but received ${i.length} arguments`)),n(...i))}else void 0!==t&&t.parameterStructures===r.ParameterStructures.byPosition&&k.error(`Notification ${e.method} defines parameters by position but received parameters by name`),n(e.params);else P&&P(e.method,e.params)}catch(t){t.message?k.error(`Notification handler '${e.method}' failed with message: ${t.message}`):k.error(`Notification handler '${e.method}' failed unexpectedly.`)}else H.fire(e)}(e):r.Message.isResponse(e)?function(e){if(!ee())if(null===e.id)e.error?k.error(`Received response message without id: Error is: \n${JSON.stringify(e.error,void 0,4)}`):k.error("Received response message without id. No further error information provided.");else{const t=e.id,n=I.get(t);if(function(e,t){if(W!==p.Off&&q)if($===g.Text){let n;if(W!==p.Verbose&&W!==p.Compact||(e.error&&e.error.data?n=`Error data: ${re(e.error.data)}\n\n`:e.result?n=`Result: ${re(e.result)}\n\n`:void 0===e.error&&(n="No result returned.\n\n")),t){const i=e.error?` Request failed: ${e.error.message} (${e.error.code}).`:"";q.log(`Received response '${t.method} - (${e.id})' in ${Date.now()-t.timerStart}ms.${i}`,n)}else q.log(`Received response ${e.id} without active response promise.`,n)}else ce("receive-response",e)}(e,n),void 0!==n){I.delete(t);try{if(e.error){const t=e.error;n.reject(new r.ResponseError(t.code,t.message,t.data))}else{if(void 0===e.result)throw new Error("Should never happen.");n.resolve(e.result)}}catch(e){e.message?k.error(`Response handler '${n.method}' failed with message: ${e.message}`):k.error(`Response handler '${n.method}' failed unexpectedly.`)}}}}(e):function(e){if(!e)return void k.error("Received empty message.");k.error(`Received message which is neither a response nor a notification message:\n${JSON.stringify(e,null,4)}`);const t=e;if(o.string(t.id)||o.number(t.id)){const e=t.id,n=I.get(e);n&&n.reject(new Error("The received response has neither a result nor an error property."))}}(e)}e.onClose(te),e.onError((function(e){V.fire([e,void 0,void 0])})),n.onClose(te),n.onError((function(e){V.fire(e)}));const oe=e=>{try{if(r.Message.isNotification(e)&&e.method===l.type.method){const t=e.params.id,i=Q(t),o=L.get(i);if(r.Message.isRequest(o)){const r=b?.connectionStrategy,s=r&&r.cancelUndispatched?r.cancelUndispatched(o,J):void 0;if(s&&(void 0!==s.error||void 0!==s.result))return L.delete(i),j.delete(t),s.id=o.id,se(s,e.method,Date.now()),void n.write(s).catch((()=>k.error("Sending response for canceled message failed.")))}const s=j.get(t);if(void 0!==s)return s.cancel(),void ae(e);F.add(t)}!function(e,t){var n;r.Message.isRequest(t)?e.set(Q(t.id),t):r.Message.isResponse(t)?e.set(null===(n=t.id)?"res-unknown-"+(++D).toString():"res-"+n.toString(),t):e.set("not-"+(++R).toString(),t)}(L,e)}finally{ne()}};function re(e){if(null!=e)switch(W){case p.Verbose:return JSON.stringify(e,null,4);case p.Compact:return JSON.stringify(e);default:return}}function se(e,t,n){if(W!==p.Off&&q)if($===g.Text){let i;W!==p.Verbose&&W!==p.Compact||(e.error&&e.error.data?i=`Error data: ${re(e.error.data)}\n\n`:e.result?i=`Result: ${re(e.result)}\n\n`:void 0===e.error&&(i="No result returned.\n\n")),q.log(`Sending response '${t} - (${e.id})'. Processing request took ${Date.now()-n}ms`,i)}else ce("send-response",e)}function ae(e){if(W!==p.Off&&q&&e.method!==y.type.method)if($===g.Text){let t;W!==p.Verbose&&W!==p.Compact||(t=e.params?`Params: ${re(e.params)}\n\n`:"No parameters provided.\n\n"),q.log(`Received notification '${e.method}'.`,t)}else ce("receive-notification",e)}function ce(e,t){if(!q||W===p.Off)return;const n={isLSPMessage:!0,type:e,message:t,timestamp:Date.now()};q.log(n)}function le(){if(Z())throw new x(_.Closed,"Connection is closed.");if(ee())throw new x(_.Disposed,"Connection is disposed.")}function de(e){return void 0===e?null:e}function ue(e){return null===e?void 0:e}function fe(e){return null!=e&&!Array.isArray(e)&&"object"==typeof e}function pe(e,t){switch(e){case r.ParameterStructures.auto:return fe(t)?ue(t):[de(t)];case r.ParameterStructures.byName:if(!fe(t))throw new Error("Received parameters by name but param is not an object literal.");return ue(t);case r.ParameterStructures.byPosition:return[de(t)];default:throw new Error(`Unknown parameter structure ${e.toString()}`)}}function he(e,t){let n;const i=e.numberOfParams;switch(i){case 0:n=void 0;break;case 1:n=pe(e.parameterStructures,t[0]);break;default:n=[];for(let e=0;e<t.length&&e<i;e++)n.push(de(t[e]));if(t.length<i)for(let e=t.length;e<i;e++)n.push(null)}return n}const ge={sendNotification:(e,...t)=>{let i,s;if(le(),o.string(e)){i=e;const n=t[0];let o=0,a=r.ParameterStructures.auto;r.ParameterStructures.is(n)&&(o=1,a=n);let c=t.length;const l=c-o;switch(l){case 0:s=void 0;break;case 1:s=pe(a,t[o]);break;default:if(a===r.ParameterStructures.byName)throw new Error(`Received ${l} parameters for 'by Name' notification parameter structure.`);s=t.slice(o,c).map((e=>de(e)))}}else{const n=t;i=e.method,s=he(e,n)}const a={jsonrpc:K,method:i,params:s};return function(e){if(W!==p.Off&&q)if($===g.Text){let t;W!==p.Verbose&&W!==p.Compact||(t=e.params?`Params: ${re(e.params)}\n\n`:"No parameters provided.\n\n"),q.log(`Sending notification '${e.method}'.`,t)}else ce("send-notification",e)}(a),n.write(a).catch((e=>{throw k.error("Sending notification failed."),e}))},onNotification:(e,t)=>{let n;return le(),o.func(e)?P=e:t&&(o.string(e)?(n=e,A.set(e,{type:void 0,handler:t})):(n=e.method,A.set(e.method,{type:e,handler:t}))),{dispose:()=>{void 0!==n?A.delete(n):P=void 0}}},onProgress:(e,t,n)=>{if(M.has(t))throw new Error(`Progress handler for token ${t} already registered`);return M.set(t,n),{dispose:()=>{M.delete(t)}}},sendProgress:(e,t,n)=>ge.sendNotification(u.type,{token:t,value:n}),onUnhandledProgress:z.event,sendRequest:(e,...t)=>{let i,s,a;if(le(),function(){if(!Y())throw new Error("Call listen() first.")}(),o.string(e)){i=e;const n=t[0],o=t[t.length-1];let l=0,d=r.ParameterStructures.auto;r.ParameterStructures.is(n)&&(l=1,d=n);let u=t.length;c.CancellationToken.is(o)&&(u-=1,a=o);const f=u-l;switch(f){case 0:s=void 0;break;case 1:s=pe(d,t[l]);break;default:if(d===r.ParameterStructures.byName)throw new Error(`Received ${f} parameters for 'by Name' request parameter structure.`);s=t.slice(l,u).map((e=>de(e)))}}else{const n=t;i=e.method,s=he(e,n);const o=e.numberOfParams;a=c.CancellationToken.is(n[o])?n[o]:void 0}const l=T++;let d;a&&(d=a.onCancellationRequested((()=>{const e=X.sender.sendCancellation(ge,l);return void 0===e?(k.log(`Received no promise from cancellation strategy when cancelling id ${l}`),Promise.resolve()):e.catch((()=>{k.log(`Sending cancellation messages for id ${l} failed`)}))})));const u={jsonrpc:K,id:l,method:i,params:s};return function(e){if(W!==p.Off&&q)if($===g.Text){let t;W!==p.Verbose&&W!==p.Compact||!e.params||(t=`Params: ${re(e.params)}\n\n`),q.log(`Sending request '${e.method} - (${e.id})'.`,t)}else ce("send-request",e)}(u),"function"==typeof X.sender.enableCancellation&&X.sender.enableCancellation(u),new Promise((async(e,t)=>{const o={method:i,timerStart:Date.now(),resolve:t=>{e(t),X.sender.cleanup(l),d?.dispose()},reject:e=>{t(e),X.sender.cleanup(l),d?.dispose()}};try{await n.write(u),I.set(l,o)}catch(e){throw k.error("Sending request failed."),o.reject(new r.ResponseError(r.ErrorCodes.MessageWriteError,e.message?e.message:"Unknown reason")),e}}))},onRequest:(e,t)=>{le();let n=null;return f.is(e)?(n=void 0,O=e):o.string(e)?(n=null,void 0!==t&&(n=e,E.set(e,{handler:t,type:void 0}))):void 0!==t&&(n=e.method,E.set(e.method,{type:e,handler:t})),{dispose:()=>{null!==n&&(void 0!==n?E.delete(n):O=void 0)}}},hasPendingResponse:()=>I.size>0,trace:async(e,t,n)=>{let i=!1,r=g.Text;void 0!==n&&(o.boolean(n)?i=n:(i=n.sendNotification||!1,r=n.traceFormat||g.Text)),W=e,$=r,q=W===p.Off?void 0:t,!i||Z()||ee()||await ge.sendNotification(m.type,{value:p.toString(e)})},onError:V.event,onClose:B.event,onUnhandledNotification:H.event,onDispose:G.event,end:()=>{n.end()},dispose:()=>{if(ee())return;U=C.Disposed,G.fire(void 0);const t=new r.ResponseError(r.ErrorCodes.PendingResponseRejected,"Pending response rejected since connection got disposed");for(const e of I.values())e.reject(t);I=new Map,j=new Map,F=new Set,L=new s.LinkedMap,o.func(n.dispose)&&n.dispose(),o.func(e.dispose)&&e.dispose()},listen:()=>{le(),function(){if(Y())throw new x(_.AlreadyListening,"Connection is already listening")}(),U=C.Listening,e.listen(oe)},inspect:()=>{(0,i.default)().console.log("inspect")}};return ge.onNotification(y.type,(e=>{if(W===p.Off||!q)return;const t=W===p.Verbose||W===p.Compact;q.log(e.message,t?e.verbose:void 0)})),ge.onNotification(u.type,(e=>{const t=M.get(e.token);t?t(e.value):z.fire(e)})),ge}},8159:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.Disposable=void 0,function(e){e.create=function(e){return{dispose:e}}}(n||(t.Disposable=n={}))},345:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Emitter=t.Event=void 0;const i=n(8094);var o;!function(e){const t={dispose(){}};e.None=function(){return t}}(o||(t.Event=o={}));class r{add(e,t=null,n){this._callbacks||(this._callbacks=[],this._contexts=[]),this._callbacks.push(e),this._contexts.push(t),Array.isArray(n)&&n.push({dispose:()=>this.remove(e,t)})}remove(e,t=null){if(!this._callbacks)return;let n=!1;for(let i=0,o=this._callbacks.length;i<o;i++)if(this._callbacks[i]===e){if(this._contexts[i]===t)return this._callbacks.splice(i,1),void this._contexts.splice(i,1);n=!0}if(n)throw new Error("When adding a listener with a context, you should remove it with the same context")}invoke(...e){if(!this._callbacks)return[];const t=[],n=this._callbacks.slice(0),o=this._contexts.slice(0);for(let r=0,s=n.length;r<s;r++)try{t.push(n[r].apply(o[r],e))}catch(e){(0,i.default)().console.error(e)}return t}isEmpty(){return!this._callbacks||0===this._callbacks.length}dispose(){this._callbacks=void 0,this._contexts=void 0}}class s{constructor(e){this._options=e}get event(){return this._event||(this._event=(e,t,n)=>{this._callbacks||(this._callbacks=new r),this._options&&this._options.onFirstListenerAdd&&this._callbacks.isEmpty()&&this._options.onFirstListenerAdd(this),this._callbacks.add(e,t);const i={dispose:()=>{this._callbacks&&(this._callbacks.remove(e,t),i.dispose=s._noop,this._options&&this._options.onLastListenerRemove&&this._callbacks.isEmpty()&&this._options.onLastListenerRemove(this))}};return Array.isArray(n)&&n.push(i),i}),this._event}fire(e){this._callbacks&&this._callbacks.invoke.call(this._callbacks,e)}dispose(){this._callbacks&&(this._callbacks.dispose(),this._callbacks=void 0)}}t.Emitter=s,s._noop=function(){}},8472:(e,t)=>{"use strict";function n(e){return"string"==typeof e||e instanceof String}function i(e){return Array.isArray(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.stringArray=t.array=t.func=t.error=t.number=t.string=t.boolean=void 0,t.boolean=function(e){return!0===e||!1===e},t.string=n,t.number=function(e){return"number"==typeof e||e instanceof Number},t.error=function(e){return e instanceof Error},t.func=function(e){return"function"==typeof e},t.array=i,t.stringArray=function(e){return i(e)&&e.every((e=>n(e)))}},5164:(e,t)=>{"use strict";var n,i;Object.defineProperty(t,"__esModule",{value:!0}),t.LRUCache=t.LinkedMap=t.Touch=void 0,function(e){e.None=0,e.First=1,e.AsOld=e.First,e.Last=2,e.AsNew=e.Last}(i||(t.Touch=i={}));class o{constructor(){this[n]="LinkedMap",this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){return this._head?.value}get last(){return this._tail?.value}has(e){return this._map.has(e)}get(e,t=i.None){const n=this._map.get(e);if(n)return t!==i.None&&this.touch(n,t),n.value}set(e,t,n=i.None){let o=this._map.get(e);if(o)o.value=t,n!==i.None&&this.touch(o,n);else{switch(o={key:e,value:t,next:void 0,previous:void 0},n){case i.None:this.addItemLast(o);break;case i.First:this.addItemFirst(o);break;case i.Last:default:this.addItemLast(o)}this._map.set(e,o),this._size++}return this}delete(e){return!!this.remove(e)}remove(e){const t=this._map.get(e);if(t)return this._map.delete(e),this.removeItem(t),this._size--,t.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");const e=this._head;return this._map.delete(e.key),this.removeItem(e),this._size--,e.value}forEach(e,t){const n=this._state;let i=this._head;for(;i;){if(t?e.bind(t)(i.value,i.key,this):e(i.value,i.key,this),this._state!==n)throw new Error("LinkedMap got modified during iteration.");i=i.next}}keys(){const e=this._state;let t=this._head;const n={[Symbol.iterator]:()=>n,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(t){const e={value:t.key,done:!1};return t=t.next,e}return{value:void 0,done:!0}}};return n}values(){const e=this._state;let t=this._head;const n={[Symbol.iterator]:()=>n,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(t){const e={value:t.value,done:!1};return t=t.next,e}return{value:void 0,done:!0}}};return n}entries(){const e=this._state;let t=this._head;const n={[Symbol.iterator]:()=>n,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(t){const e={value:[t.key,t.value],done:!1};return t=t.next,e}return{value:void 0,done:!0}}};return n}[(n=Symbol.toStringTag,Symbol.iterator)](){return this.entries()}trimOld(e){if(e>=this.size)return;if(0===e)return void this.clear();let t=this._head,n=this.size;for(;t&&n>e;)this._map.delete(t.key),t=t.next,n--;this._head=t,this._size=n,t&&(t.previous=void 0),this._state++}addItemFirst(e){if(this._head||this._tail){if(!this._head)throw new Error("Invalid list");e.next=this._head,this._head.previous=e}else this._tail=e;this._head=e,this._state++}addItemLast(e){if(this._head||this._tail){if(!this._tail)throw new Error("Invalid list");e.previous=this._tail,this._tail.next=e}else this._head=e;this._tail=e,this._state++}removeItem(e){if(e===this._head&&e===this._tail)this._head=void 0,this._tail=void 0;else if(e===this._head){if(!e.next)throw new Error("Invalid list");e.next.previous=void 0,this._head=e.next}else if(e===this._tail){if(!e.previous)throw new Error("Invalid list");e.previous.next=void 0,this._tail=e.previous}else{const t=e.next,n=e.previous;if(!t||!n)throw new Error("Invalid list");t.previous=n,n.next=t}e.next=void 0,e.previous=void 0,this._state++}touch(e,t){if(!this._head||!this._tail)throw new Error("Invalid list");if(t===i.First||t===i.Last)if(t===i.First){if(e===this._head)return;const t=e.next,n=e.previous;e===this._tail?(n.next=void 0,this._tail=n):(t.previous=n,n.next=t),e.previous=void 0,e.next=this._head,this._head.previous=e,this._head=e,this._state++}else if(t===i.Last){if(e===this._tail)return;const t=e.next,n=e.previous;e===this._head?(t.previous=void 0,this._head=t):(t.previous=n,n.next=t),e.next=void 0,e.previous=this._tail,this._tail.next=e,this._tail=e,this._state++}}toJSON(){const e=[];return this.forEach(((t,n)=>{e.push([n,t])})),e}fromJSON(e){this.clear();for(const[t,n]of e)this.set(t,n)}}t.LinkedMap=o,t.LRUCache=class extends o{constructor(e,t=1){super(),this._limit=e,this._ratio=Math.min(Math.max(0,t),1)}get limit(){return this._limit}set limit(e){this._limit=e,this.checkTrim()}get ratio(){return this._ratio}set ratio(e){this._ratio=Math.min(Math.max(0,e),1),this.checkTrim()}get(e,t=i.AsNew){return super.get(e,t)}peek(e){return super.get(e,i.None)}set(e,t){return super.set(e,t,i.Last),this.checkTrim(),this}checkTrim(){this.size>this._limit&&this.trimOld(Math.round(this._limit*this._ratio))}}},5506:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AbstractMessageBuffer=void 0,t.AbstractMessageBuffer=class{constructor(e="utf-8"){this._encoding=e,this._chunks=[],this._totalLength=0}get encoding(){return this._encoding}append(e){const t="string"==typeof e?this.fromString(e,this._encoding):e;this._chunks.push(t),this._totalLength+=t.byteLength}tryReadHeaders(e=!1){if(0===this._chunks.length)return;let t=0,n=0,i=0,o=0;e:for(;n<this._chunks.length;){const e=this._chunks[n];for(i=0;i<e.length;){switch(e[i]){case 13:switch(t){case 0:t=1;break;case 2:t=3;break;default:t=0}break;case 10:switch(t){case 1:t=2;break;case 3:t=4,i++;break e;default:t=0}break;default:t=0}i++}o+=e.byteLength,n++}if(4!==t)return;const r=this._read(o+i),s=new Map,a=this.toString(r,"ascii").split("\r\n");if(a.length<2)return s;for(let t=0;t<a.length-2;t++){const n=a[t],i=n.indexOf(":");if(-1===i)throw new Error(`Message header must separate key and value using ':'\n${n}`);const o=n.substr(0,i),r=n.substr(i+1).trim();s.set(e?o.toLowerCase():o,r)}return s}tryReadBody(e){if(!(this._totalLength<e))return this._read(e)}get numberOfBytes(){return this._totalLength}_read(e){if(0===e)return this.emptyBuffer();if(e>this._totalLength)throw new Error("Cannot read so many bytes!");if(this._chunks[0].byteLength===e){const t=this._chunks[0];return this._chunks.shift(),this._totalLength-=e,this.asNative(t)}if(this._chunks[0].byteLength>e){const t=this._chunks[0],n=this.asNative(t,e);return this._chunks[0]=t.slice(e),this._totalLength-=e,n}const t=this.allocNative(e);let n=0;for(;e>0;){const i=this._chunks[0];if(i.byteLength>e){const o=i.slice(0,e);t.set(o,n),n+=e,this._chunks[0]=i.slice(e),this._totalLength-=e,e-=e}else t.set(i,n),n+=i.byteLength,this._chunks.shift(),this._totalLength-=i.byteLength,e-=i.byteLength}return t}}},4806:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ReadableStreamMessageReader=t.AbstractMessageReader=t.MessageReader=void 0;const i=n(8094),o=n(8472),r=n(345),s=n(6791);var a,c;!function(e){e.is=function(e){let t=e;return t&&o.func(t.listen)&&o.func(t.dispose)&&o.func(t.onError)&&o.func(t.onClose)&&o.func(t.onPartialMessage)}}(a||(t.MessageReader=a={}));class l{constructor(){this.errorEmitter=new r.Emitter,this.closeEmitter=new r.Emitter,this.partialMessageEmitter=new r.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(e){this.errorEmitter.fire(this.asError(e))}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}get onPartialMessage(){return this.partialMessageEmitter.event}firePartialMessage(e){this.partialMessageEmitter.fire(e)}asError(e){return e instanceof Error?e:new Error(`Reader received error. Reason: ${o.string(e.message)?e.message:"unknown"}`)}}t.AbstractMessageReader=l,function(e){e.fromOptions=function(e){let t,n;const o=new Map;let r;const s=new Map;if(void 0===e||"string"==typeof e)t=e??"utf-8";else{if(t=e.charset??"utf-8",void 0!==e.contentDecoder&&(n=e.contentDecoder,o.set(n.name,n)),void 0!==e.contentDecoders)for(const t of e.contentDecoders)o.set(t.name,t);if(void 0!==e.contentTypeDecoder&&(r=e.contentTypeDecoder,s.set(r.name,r)),void 0!==e.contentTypeDecoders)for(const t of e.contentTypeDecoders)s.set(t.name,t)}return void 0===r&&(r=(0,i.default)().applicationJson.decoder,s.set(r.name,r)),{charset:t,contentDecoder:n,contentDecoders:o,contentTypeDecoder:r,contentTypeDecoders:s}}}(c||(c={})),t.ReadableStreamMessageReader=class extends l{constructor(e,t){super(),this.readable=e,this.options=c.fromOptions(t),this.buffer=(0,i.default)().messageBuffer.create(this.options.charset),this._partialMessageTimeout=1e4,this.nextMessageLength=-1,this.messageToken=0,this.readSemaphore=new s.Semaphore(1)}set partialMessageTimeout(e){this._partialMessageTimeout=e}get partialMessageTimeout(){return this._partialMessageTimeout}listen(e){this.nextMessageLength=-1,this.messageToken=0,this.partialMessageTimer=void 0,this.callback=e;const t=this.readable.onData((e=>{this.onData(e)}));return this.readable.onError((e=>this.fireError(e))),this.readable.onClose((()=>this.fireClose())),t}onData(e){try{for(this.buffer.append(e);;){if(-1===this.nextMessageLength){const e=this.buffer.tryReadHeaders(!0);if(!e)return;const t=e.get("content-length");if(!t)return void this.fireError(new Error(`Header must provide a Content-Length property.\n${JSON.stringify(Object.fromEntries(e))}`));const n=parseInt(t);if(isNaN(n))return void this.fireError(new Error(`Content-Length value must be a number. Got ${t}`));this.nextMessageLength=n}const e=this.buffer.tryReadBody(this.nextMessageLength);if(void 0===e)return void this.setPartialMessageTimer();this.clearPartialMessageTimer(),this.nextMessageLength=-1,this.readSemaphore.lock((async()=>{const t=void 0!==this.options.contentDecoder?await this.options.contentDecoder.decode(e):e,n=await this.options.contentTypeDecoder.decode(t,this.options);this.callback(n)})).catch((e=>{this.fireError(e)}))}}catch(e){this.fireError(e)}}clearPartialMessageTimer(){this.partialMessageTimer&&(this.partialMessageTimer.dispose(),this.partialMessageTimer=void 0)}setPartialMessageTimer(){this.clearPartialMessageTimer(),this._partialMessageTimeout<=0||(this.partialMessageTimer=(0,i.default)().timer.setTimeout(((e,t)=>{this.partialMessageTimer=void 0,e===this.messageToken&&(this.firePartialMessage({messageToken:e,waitingTime:t}),this.setPartialMessageTimer())}),this._partialMessageTimeout,this.messageToken,this._partialMessageTimeout))}}},9248:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WriteableStreamMessageWriter=t.AbstractMessageWriter=t.MessageWriter=void 0;const i=n(8094),o=n(8472),r=n(6791),s=n(345);var a,c;!function(e){e.is=function(e){let t=e;return t&&o.func(t.dispose)&&o.func(t.onClose)&&o.func(t.onError)&&o.func(t.write)}}(a||(t.MessageWriter=a={}));class l{constructor(){this.errorEmitter=new s.Emitter,this.closeEmitter=new s.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(e,t,n){this.errorEmitter.fire([this.asError(e),t,n])}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}asError(e){return e instanceof Error?e:new Error(`Writer received error. Reason: ${o.string(e.message)?e.message:"unknown"}`)}}t.AbstractMessageWriter=l,function(e){e.fromOptions=function(e){return void 0===e||"string"==typeof e?{charset:e??"utf-8",contentTypeEncoder:(0,i.default)().applicationJson.encoder}:{charset:e.charset??"utf-8",contentEncoder:e.contentEncoder,contentTypeEncoder:e.contentTypeEncoder??(0,i.default)().applicationJson.encoder}}}(c||(c={})),t.WriteableStreamMessageWriter=class extends l{constructor(e,t){super(),this.writable=e,this.options=c.fromOptions(t),this.errorCount=0,this.writeSemaphore=new r.Semaphore(1),this.writable.onError((e=>this.fireError(e))),this.writable.onClose((()=>this.fireClose()))}async write(e){return this.writeSemaphore.lock((async()=>this.options.contentTypeEncoder.encode(e,this.options).then((e=>void 0!==this.options.contentEncoder?this.options.contentEncoder.encode(e):e)).then((t=>{const n=[];return n.push("Content-Length: ",t.byteLength.toString(),"\r\n"),n.push("\r\n"),this.doWrite(e,n,t)}),(e=>{throw this.fireError(e),e}))))}async doWrite(e,t,n){try{return await this.writable.write(t.join(""),"ascii"),this.writable.write(n)}catch(t){return this.handleError(t,e),Promise.reject(t)}}handleError(e,t){this.errorCount++,this.fireError(e,t,this.errorCount)}end(){this.writable.end()}}},5285:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Message=t.NotificationType9=t.NotificationType8=t.NotificationType7=t.NotificationType6=t.NotificationType5=t.NotificationType4=t.NotificationType3=t.NotificationType2=t.NotificationType1=t.NotificationType0=t.NotificationType=t.RequestType9=t.RequestType8=t.RequestType7=t.RequestType6=t.RequestType5=t.RequestType4=t.RequestType3=t.RequestType2=t.RequestType1=t.RequestType=t.RequestType0=t.AbstractMessageSignature=t.ParameterStructures=t.ResponseError=t.ErrorCodes=void 0;const i=n(8472);var o,r;!function(e){e.ParseError=-32700,e.InvalidRequest=-32600,e.MethodNotFound=-32601,e.InvalidParams=-32602,e.InternalError=-32603,e.jsonrpcReservedErrorRangeStart=-32099,e.serverErrorStart=-32099,e.MessageWriteError=-32099,e.MessageReadError=-32098,e.PendingResponseRejected=-32097,e.ConnectionInactive=-32096,e.ServerNotInitialized=-32002,e.UnknownErrorCode=-32001,e.jsonrpcReservedErrorRangeEnd=-32e3,e.serverErrorEnd=-32e3}(o||(t.ErrorCodes=o={}));class s extends Error{constructor(e,t,n){super(t),this.code=i.number(e)?e:o.UnknownErrorCode,this.data=n,Object.setPrototypeOf(this,s.prototype)}toJson(){const e={code:this.code,message:this.message};return void 0!==this.data&&(e.data=this.data),e}}t.ResponseError=s;class a{constructor(e){this.kind=e}static is(e){return e===a.auto||e===a.byName||e===a.byPosition}toString(){return this.kind}}t.ParameterStructures=a,a.auto=new a("auto"),a.byPosition=new a("byPosition"),a.byName=new a("byName");class c{constructor(e,t){this.method=e,this.numberOfParams=t}get parameterStructures(){return a.auto}}t.AbstractMessageSignature=c,t.RequestType0=class extends c{constructor(e){super(e,0)}},t.RequestType=class extends c{constructor(e,t=a.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}},t.RequestType1=class extends c{constructor(e,t=a.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}},t.RequestType2=class extends c{constructor(e){super(e,2)}},t.RequestType3=class extends c{constructor(e){super(e,3)}},t.RequestType4=class extends c{constructor(e){super(e,4)}},t.RequestType5=class extends c{constructor(e){super(e,5)}},t.RequestType6=class extends c{constructor(e){super(e,6)}},t.RequestType7=class extends c{constructor(e){super(e,7)}},t.RequestType8=class extends c{constructor(e){super(e,8)}},t.RequestType9=class extends c{constructor(e){super(e,9)}},t.NotificationType=class extends c{constructor(e,t=a.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}},t.NotificationType0=class extends c{constructor(e){super(e,0)}},t.NotificationType1=class extends c{constructor(e,t=a.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}},t.NotificationType2=class extends c{constructor(e){super(e,2)}},t.NotificationType3=class extends c{constructor(e){super(e,3)}},t.NotificationType4=class extends c{constructor(e){super(e,4)}},t.NotificationType5=class extends c{constructor(e){super(e,5)}},t.NotificationType6=class extends c{constructor(e){super(e,6)}},t.NotificationType7=class extends c{constructor(e){super(e,7)}},t.NotificationType8=class extends c{constructor(e){super(e,8)}},t.NotificationType9=class extends c{constructor(e){super(e,9)}},function(e){e.isRequest=function(e){const t=e;return t&&i.string(t.method)&&(i.string(t.id)||i.number(t.id))},e.isNotification=function(e){const t=e;return t&&i.string(t.method)&&void 0===e.id},e.isResponse=function(e){const t=e;return t&&(void 0!==t.result||!!t.error)&&(i.string(t.id)||i.number(t.id)||null===t.id)}}(r||(t.Message=r={}))},8094:(e,t)=>{"use strict";let n;function i(){if(void 0===n)throw new Error("No runtime abstraction layer installed");return n}Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.install=function(e){if(void 0===e)throw new Error("No runtime abstraction layer provided");n=e}}(i||(i={})),t.default=i},6791:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Semaphore=void 0;const i=n(8094);t.Semaphore=class{constructor(e=1){if(e<=0)throw new Error("Capacity must be greater than 0");this._capacity=e,this._active=0,this._waiting=[]}lock(e){return new Promise(((t,n)=>{this._waiting.push({thunk:e,resolve:t,reject:n}),this.runNext()}))}get active(){return this._active}runNext(){0!==this._waiting.length&&this._active!==this._capacity&&(0,i.default)().timer.setImmediate((()=>this.doRunNext()))}doRunNext(){if(0===this._waiting.length||this._active===this._capacity)return;const e=this._waiting.shift();if(this._active++,this._active>this._capacity)throw new Error("To many thunks active");try{const t=e.thunk();t instanceof Promise?t.then((t=>{this._active--,e.resolve(t),this.runNext()}),(t=>{this._active--,e.reject(t),this.runNext()})):(this._active--,e.resolve(t),this.runNext())}catch(t){this._active--,e.reject(t),this.runNext()}}}},278:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SharedArrayReceiverStrategy=t.SharedArraySenderStrategy=void 0;const i=n(7770);var o;!function(e){e.Continue=0,e.Cancelled=1}(o||(o={})),t.SharedArraySenderStrategy=class{constructor(){this.buffers=new Map}enableCancellation(e){if(null===e.id)return;const t=new SharedArrayBuffer(4);new Int32Array(t,0,1)[0]=o.Continue,this.buffers.set(e.id,t),e.$cancellationData=t}async sendCancellation(e,t){const n=this.buffers.get(t);if(void 0===n)return;const i=new Int32Array(n,0,1);Atomics.store(i,0,o.Cancelled)}cleanup(e){this.buffers.delete(e)}dispose(){this.buffers.clear()}};class r{constructor(e){this.data=new Int32Array(e,0,1)}get isCancellationRequested(){return Atomics.load(this.data,0)===o.Cancelled}get onCancellationRequested(){throw new Error("Cancellation over SharedArrayBuffer doesn't support cancellation events")}}class s{constructor(e){this.token=new r(e)}cancel(){}dispose(){}}t.SharedArrayReceiverStrategy=class{constructor(){this.kind="request"}createCancellationTokenSource(e){const t=e.$cancellationData;return void 0===t?new i.CancellationTokenSource:new s(t)}}},9351:(e,t,n)=>{"use strict";e.exports=n(5968)},5968:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,o)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.createProtocolConnection=void 0;const r=n(9838);o(n(9838),t),o(n(559),t),t.createProtocolConnection=function(e,t,n,i){return(0,r.createMessageConnection)(e,t,n,i)}},559:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,o)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.LSPErrorCodes=t.createProtocolConnection=void 0,o(n(9406),t),o(n(1516),t),o(n(4742),t),o(n(7304),t);var r,s=n(7558);Object.defineProperty(t,"createProtocolConnection",{enumerable:!0,get:function(){return s.createProtocolConnection}}),function(e){e.lspReservedErrorRangeStart=-32899,e.RequestFailed=-32803,e.ServerCancelled=-32802,e.ContentModified=-32801,e.RequestCancelled=-32800,e.lspReservedErrorRangeEnd=-32800}(r||(t.LSPErrorCodes=r={}))},7558:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createProtocolConnection=void 0;const i=n(9406);t.createProtocolConnection=function(e,t,n,o){return i.ConnectionStrategy.is(o)&&(o={connectionStrategy:o}),(0,i.createMessageConnection)(e,t,n,o)}},4742:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ProtocolNotificationType=t.ProtocolNotificationType0=t.ProtocolRequestType=t.ProtocolRequestType0=t.RegistrationType=t.MessageDirection=void 0;const i=n(9406);var o;!function(e){e.clientToServer="clientToServer",e.serverToClient="serverToClient",e.both="both"}(o||(t.MessageDirection=o={})),t.RegistrationType=class{constructor(e){this.method=e}};class r extends i.RequestType0{constructor(e){super(e)}}t.ProtocolRequestType0=r;class s extends i.RequestType{constructor(e){super(e,i.ParameterStructures.byName)}}t.ProtocolRequestType=s;class a extends i.NotificationType0{constructor(e){super(e)}}t.ProtocolNotificationType0=a;class c extends i.NotificationType{constructor(e){super(e,i.ParameterStructures.byName)}}t.ProtocolNotificationType=c},2565:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CallHierarchyOutgoingCallsRequest=t.CallHierarchyIncomingCallsRequest=t.CallHierarchyPrepareRequest=void 0;const i=n(4742);var o,r,s;!function(e){e.method="textDocument/prepareCallHierarchy",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolRequestType(e.method)}(o||(t.CallHierarchyPrepareRequest=o={})),function(e){e.method="callHierarchy/incomingCalls",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolRequestType(e.method)}(r||(t.CallHierarchyIncomingCallsRequest=r={})),function(e){e.method="callHierarchy/outgoingCalls",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolRequestType(e.method)}(s||(t.CallHierarchyOutgoingCallsRequest=s={}))},5509:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ColorPresentationRequest=t.DocumentColorRequest=void 0;const i=n(4742);var o,r;!function(e){e.method="textDocument/documentColor",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolRequestType(e.method)}(o||(t.DocumentColorRequest=o={})),function(e){e.method="textDocument/colorPresentation",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolRequestType(e.method)}(r||(t.ColorPresentationRequest=r={}))},7296:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ConfigurationRequest=void 0;const i=n(4742);var o;!function(e){e.method="workspace/configuration",e.messageDirection=i.MessageDirection.serverToClient,e.type=new i.ProtocolRequestType(e.method)}(o||(t.ConfigurationRequest=o={}))},9137:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DeclarationRequest=void 0;const i=n(4742);var o;!function(e){e.method="textDocument/declaration",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolRequestType(e.method)}(o||(t.DeclarationRequest=o={}))},8338:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DiagnosticRefreshRequest=t.WorkspaceDiagnosticRequest=t.DocumentDiagnosticRequest=t.DocumentDiagnosticReportKind=t.DiagnosticServerCancellationData=void 0;const i=n(9406),o=n(9348),r=n(4742);var s,a,c,l,d;!function(e){e.is=function(e){const t=e;return t&&o.boolean(t.retriggerRequest)}}(s||(t.DiagnosticServerCancellationData=s={})),function(e){e.Full="full",e.Unchanged="unchanged"}(a||(t.DocumentDiagnosticReportKind=a={})),function(e){e.method="textDocument/diagnostic",e.messageDirection=r.MessageDirection.clientToServer,e.type=new r.ProtocolRequestType(e.method),e.partialResult=new i.ProgressType}(c||(t.DocumentDiagnosticRequest=c={})),function(e){e.method="workspace/diagnostic",e.messageDirection=r.MessageDirection.clientToServer,e.type=new r.ProtocolRequestType(e.method),e.partialResult=new i.ProgressType}(l||(t.WorkspaceDiagnosticRequest=l={})),function(e){e.method="workspace/diagnostic/refresh",e.messageDirection=r.MessageDirection.serverToClient,e.type=new r.ProtocolRequestType0(e.method)}(d||(t.DiagnosticRefreshRequest=d={}))},2235:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WillDeleteFilesRequest=t.DidDeleteFilesNotification=t.DidRenameFilesNotification=t.WillRenameFilesRequest=t.DidCreateFilesNotification=t.WillCreateFilesRequest=t.FileOperationPatternKind=void 0;const i=n(4742);var o,r,s,a,c,l,d;!function(e){e.file="file",e.folder="folder"}(o||(t.FileOperationPatternKind=o={})),function(e){e.method="workspace/willCreateFiles",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolRequestType(e.method)}(r||(t.WillCreateFilesRequest=r={})),function(e){e.method="workspace/didCreateFiles",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolNotificationType(e.method)}(s||(t.DidCreateFilesNotification=s={})),function(e){e.method="workspace/willRenameFiles",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolRequestType(e.method)}(a||(t.WillRenameFilesRequest=a={})),function(e){e.method="workspace/didRenameFiles",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolNotificationType(e.method)}(c||(t.DidRenameFilesNotification=c={})),function(e){e.method="workspace/didDeleteFiles",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolNotificationType(e.method)}(l||(t.DidDeleteFilesNotification=l={})),function(e){e.method="workspace/willDeleteFiles",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolRequestType(e.method)}(d||(t.WillDeleteFilesRequest=d={}))},5171:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FoldingRangeRefreshRequest=t.FoldingRangeRequest=void 0;const i=n(4742);var o,r;!function(e){e.method="textDocument/foldingRange",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolRequestType(e.method)}(o||(t.FoldingRangeRequest=o={})),function(e){e.method="workspace/foldingRange/refresh",e.messageDirection=i.MessageDirection.serverToClient,e.type=new i.ProtocolRequestType0(e.method)}(r||(t.FoldingRangeRefreshRequest=r={}))},2441:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ImplementationRequest=void 0;const i=n(4742);var o;!function(e){e.method="textDocument/implementation",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolRequestType(e.method)}(o||(t.ImplementationRequest=o={}))},4248:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InlayHintRefreshRequest=t.InlayHintResolveRequest=t.InlayHintRequest=void 0;const i=n(4742);var o,r,s;!function(e){e.method="textDocument/inlayHint",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolRequestType(e.method)}(o||(t.InlayHintRequest=o={})),function(e){e.method="inlayHint/resolve",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolRequestType(e.method)}(r||(t.InlayHintResolveRequest=r={})),function(e){e.method="workspace/inlayHint/refresh",e.messageDirection=i.MessageDirection.serverToClient,e.type=new i.ProtocolRequestType0(e.method)}(s||(t.InlayHintRefreshRequest=s={}))},9366:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InlineCompletionRequest=void 0;const i=n(4742);var o;!function(e){e.method="textDocument/inlineCompletion",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolRequestType(e.method)}(o||(t.InlineCompletionRequest=o={}))},1557:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InlineValueRefreshRequest=t.InlineValueRequest=void 0;const i=n(4742);var o,r;!function(e){e.method="textDocument/inlineValue",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolRequestType(e.method)}(o||(t.InlineValueRequest=o={})),function(e){e.method="workspace/inlineValue/refresh",e.messageDirection=i.MessageDirection.serverToClient,e.type=new i.ProtocolRequestType0(e.method)}(r||(t.InlineValueRefreshRequest=r={}))},7304:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WorkspaceSymbolRequest=t.CodeActionResolveRequest=t.CodeActionRequest=t.DocumentSymbolRequest=t.DocumentHighlightRequest=t.ReferencesRequest=t.DefinitionRequest=t.SignatureHelpRequest=t.SignatureHelpTriggerKind=t.HoverRequest=t.CompletionResolveRequest=t.CompletionRequest=t.CompletionTriggerKind=t.PublishDiagnosticsNotification=t.WatchKind=t.RelativePattern=t.FileChangeType=t.DidChangeWatchedFilesNotification=t.WillSaveTextDocumentWaitUntilRequest=t.WillSaveTextDocumentNotification=t.TextDocumentSaveReason=t.DidSaveTextDocumentNotification=t.DidCloseTextDocumentNotification=t.DidChangeTextDocumentNotification=t.TextDocumentContentChangeEvent=t.DidOpenTextDocumentNotification=t.TextDocumentSyncKind=t.TelemetryEventNotification=t.LogMessageNotification=t.ShowMessageRequest=t.ShowMessageNotification=t.MessageType=t.DidChangeConfigurationNotification=t.ExitNotification=t.ShutdownRequest=t.InitializedNotification=t.InitializeErrorCodes=t.InitializeRequest=t.WorkDoneProgressOptions=t.TextDocumentRegistrationOptions=t.StaticRegistrationOptions=t.PositionEncodingKind=t.FailureHandlingKind=t.ResourceOperationKind=t.UnregistrationRequest=t.RegistrationRequest=t.DocumentSelector=t.NotebookCellTextDocumentFilter=t.NotebookDocumentFilter=t.TextDocumentFilter=void 0,t.MonikerRequest=t.MonikerKind=t.UniquenessLevel=t.WillDeleteFilesRequest=t.DidDeleteFilesNotification=t.WillRenameFilesRequest=t.DidRenameFilesNotification=t.WillCreateFilesRequest=t.DidCreateFilesNotification=t.FileOperationPatternKind=t.LinkedEditingRangeRequest=t.ShowDocumentRequest=t.SemanticTokensRegistrationType=t.SemanticTokensRefreshRequest=t.SemanticTokensRangeRequest=t.SemanticTokensDeltaRequest=t.SemanticTokensRequest=t.TokenFormat=t.CallHierarchyPrepareRequest=t.CallHierarchyOutgoingCallsRequest=t.CallHierarchyIncomingCallsRequest=t.WorkDoneProgressCancelNotification=t.WorkDoneProgressCreateRequest=t.WorkDoneProgress=t.SelectionRangeRequest=t.DeclarationRequest=t.FoldingRangeRefreshRequest=t.FoldingRangeRequest=t.ColorPresentationRequest=t.DocumentColorRequest=t.ConfigurationRequest=t.DidChangeWorkspaceFoldersNotification=t.WorkspaceFoldersRequest=t.TypeDefinitionRequest=t.ImplementationRequest=t.ApplyWorkspaceEditRequest=t.ExecuteCommandRequest=t.PrepareRenameRequest=t.RenameRequest=t.PrepareSupportDefaultBehavior=t.DocumentOnTypeFormattingRequest=t.DocumentRangesFormattingRequest=t.DocumentRangeFormattingRequest=t.DocumentFormattingRequest=t.DocumentLinkResolveRequest=t.DocumentLinkRequest=t.CodeLensRefreshRequest=t.CodeLensResolveRequest=t.CodeLensRequest=t.WorkspaceSymbolResolveRequest=void 0,t.InlineCompletionRequest=t.DidCloseNotebookDocumentNotification=t.DidSaveNotebookDocumentNotification=t.DidChangeNotebookDocumentNotification=t.NotebookCellArrayChange=t.DidOpenNotebookDocumentNotification=t.NotebookDocumentSyncRegistrationType=t.NotebookDocument=t.NotebookCell=t.ExecutionSummary=t.NotebookCellKind=t.DiagnosticRefreshRequest=t.WorkspaceDiagnosticRequest=t.DocumentDiagnosticRequest=t.DocumentDiagnosticReportKind=t.DiagnosticServerCancellationData=t.InlayHintRefreshRequest=t.InlayHintResolveRequest=t.InlayHintRequest=t.InlineValueRefreshRequest=t.InlineValueRequest=t.TypeHierarchySupertypesRequest=t.TypeHierarchySubtypesRequest=t.TypeHierarchyPrepareRequest=void 0;const i=n(4742),o=n(1516),r=n(9348),s=n(2441);Object.defineProperty(t,"ImplementationRequest",{enumerable:!0,get:function(){return s.ImplementationRequest}});const a=n(8685);Object.defineProperty(t,"TypeDefinitionRequest",{enumerable:!0,get:function(){return a.TypeDefinitionRequest}});const c=n(6098);Object.defineProperty(t,"WorkspaceFoldersRequest",{enumerable:!0,get:function(){return c.WorkspaceFoldersRequest}}),Object.defineProperty(t,"DidChangeWorkspaceFoldersNotification",{enumerable:!0,get:function(){return c.DidChangeWorkspaceFoldersNotification}});const l=n(7296);Object.defineProperty(t,"ConfigurationRequest",{enumerable:!0,get:function(){return l.ConfigurationRequest}});const d=n(5509);Object.defineProperty(t,"DocumentColorRequest",{enumerable:!0,get:function(){return d.DocumentColorRequest}}),Object.defineProperty(t,"ColorPresentationRequest",{enumerable:!0,get:function(){return d.ColorPresentationRequest}});const u=n(5171);Object.defineProperty(t,"FoldingRangeRequest",{enumerable:!0,get:function(){return u.FoldingRangeRequest}}),Object.defineProperty(t,"FoldingRangeRefreshRequest",{enumerable:!0,get:function(){return u.FoldingRangeRefreshRequest}});const f=n(9137);Object.defineProperty(t,"DeclarationRequest",{enumerable:!0,get:function(){return f.DeclarationRequest}});const p=n(2964);Object.defineProperty(t,"SelectionRangeRequest",{enumerable:!0,get:function(){return p.SelectionRangeRequest}});const h=n(7450);Object.defineProperty(t,"WorkDoneProgress",{enumerable:!0,get:function(){return h.WorkDoneProgress}}),Object.defineProperty(t,"WorkDoneProgressCreateRequest",{enumerable:!0,get:function(){return h.WorkDoneProgressCreateRequest}}),Object.defineProperty(t,"WorkDoneProgressCancelNotification",{enumerable:!0,get:function(){return h.WorkDoneProgressCancelNotification}});const g=n(2565);Object.defineProperty(t,"CallHierarchyIncomingCallsRequest",{enumerable:!0,get:function(){return g.CallHierarchyIncomingCallsRequest}}),Object.defineProperty(t,"CallHierarchyOutgoingCallsRequest",{enumerable:!0,get:function(){return g.CallHierarchyOutgoingCallsRequest}}),Object.defineProperty(t,"CallHierarchyPrepareRequest",{enumerable:!0,get:function(){return g.CallHierarchyPrepareRequest}});const m=n(5402);Object.defineProperty(t,"TokenFormat",{enumerable:!0,get:function(){return m.TokenFormat}}),Object.defineProperty(t,"SemanticTokensRequest",{enumerable:!0,get:function(){return m.SemanticTokensRequest}}),Object.defineProperty(t,"SemanticTokensDeltaRequest",{enumerable:!0,get:function(){return m.SemanticTokensDeltaRequest}}),Object.defineProperty(t,"SemanticTokensRangeRequest",{enumerable:!0,get:function(){return m.SemanticTokensRangeRequest}}),Object.defineProperty(t,"SemanticTokensRefreshRequest",{enumerable:!0,get:function(){return m.SemanticTokensRefreshRequest}}),Object.defineProperty(t,"SemanticTokensRegistrationType",{enumerable:!0,get:function(){return m.SemanticTokensRegistrationType}});const y=n(903);Object.defineProperty(t,"ShowDocumentRequest",{enumerable:!0,get:function(){return y.ShowDocumentRequest}});const _=n(7323);Object.defineProperty(t,"LinkedEditingRangeRequest",{enumerable:!0,get:function(){return _.LinkedEditingRangeRequest}});const b=n(2235);Object.defineProperty(t,"FileOperationPatternKind",{enumerable:!0,get:function(){return b.FileOperationPatternKind}}),Object.defineProperty(t,"DidCreateFilesNotification",{enumerable:!0,get:function(){return b.DidCreateFilesNotification}}),Object.defineProperty(t,"WillCreateFilesRequest",{enumerable:!0,get:function(){return b.WillCreateFilesRequest}}),Object.defineProperty(t,"DidRenameFilesNotification",{enumerable:!0,get:function(){return b.DidRenameFilesNotification}}),Object.defineProperty(t,"WillRenameFilesRequest",{enumerable:!0,get:function(){return b.WillRenameFilesRequest}}),Object.defineProperty(t,"DidDeleteFilesNotification",{enumerable:!0,get:function(){return b.DidDeleteFilesNotification}}),Object.defineProperty(t,"WillDeleteFilesRequest",{enumerable:!0,get:function(){return b.WillDeleteFilesRequest}});const v=n(9219);Object.defineProperty(t,"UniquenessLevel",{enumerable:!0,get:function(){return v.UniquenessLevel}}),Object.defineProperty(t,"MonikerKind",{enumerable:!0,get:function(){return v.MonikerKind}}),Object.defineProperty(t,"MonikerRequest",{enumerable:!0,get:function(){return v.MonikerRequest}});const k=n(9970);Object.defineProperty(t,"TypeHierarchyPrepareRequest",{enumerable:!0,get:function(){return k.TypeHierarchyPrepareRequest}}),Object.defineProperty(t,"TypeHierarchySubtypesRequest",{enumerable:!0,get:function(){return k.TypeHierarchySubtypesRequest}}),Object.defineProperty(t,"TypeHierarchySupertypesRequest",{enumerable:!0,get:function(){return k.TypeHierarchySupertypesRequest}});const T=n(1557);Object.defineProperty(t,"InlineValueRequest",{enumerable:!0,get:function(){return T.InlineValueRequest}}),Object.defineProperty(t,"InlineValueRefreshRequest",{enumerable:!0,get:function(){return T.InlineValueRefreshRequest}});const R=n(4248);Object.defineProperty(t,"InlayHintRequest",{enumerable:!0,get:function(){return R.InlayHintRequest}}),Object.defineProperty(t,"InlayHintResolveRequest",{enumerable:!0,get:function(){return R.InlayHintResolveRequest}}),Object.defineProperty(t,"InlayHintRefreshRequest",{enumerable:!0,get:function(){return R.InlayHintRefreshRequest}});const S=n(8338);Object.defineProperty(t,"DiagnosticServerCancellationData",{enumerable:!0,get:function(){return S.DiagnosticServerCancellationData}}),Object.defineProperty(t,"DocumentDiagnosticReportKind",{enumerable:!0,get:function(){return S.DocumentDiagnosticReportKind}}),Object.defineProperty(t,"DocumentDiagnosticRequest",{enumerable:!0,get:function(){return S.DocumentDiagnosticRequest}}),Object.defineProperty(t,"WorkspaceDiagnosticRequest",{enumerable:!0,get:function(){return S.WorkspaceDiagnosticRequest}}),Object.defineProperty(t,"DiagnosticRefreshRequest",{enumerable:!0,get:function(){return S.DiagnosticRefreshRequest}});const w=n(5626);Object.defineProperty(t,"NotebookCellKind",{enumerable:!0,get:function(){return w.NotebookCellKind}}),Object.defineProperty(t,"ExecutionSummary",{enumerable:!0,get:function(){return w.ExecutionSummary}}),Object.defineProperty(t,"NotebookCell",{enumerable:!0,get:function(){return w.NotebookCell}}),Object.defineProperty(t,"NotebookDocument",{enumerable:!0,get:function(){return w.NotebookDocument}}),Object.defineProperty(t,"NotebookDocumentSyncRegistrationType",{enumerable:!0,get:function(){return w.NotebookDocumentSyncRegistrationType}}),Object.defineProperty(t,"DidOpenNotebookDocumentNotification",{enumerable:!0,get:function(){return w.DidOpenNotebookDocumentNotification}}),Object.defineProperty(t,"NotebookCellArrayChange",{enumerable:!0,get:function(){return w.NotebookCellArrayChange}}),Object.defineProperty(t,"DidChangeNotebookDocumentNotification",{enumerable:!0,get:function(){return w.DidChangeNotebookDocumentNotification}}),Object.defineProperty(t,"DidSaveNotebookDocumentNotification",{enumerable:!0,get:function(){return w.DidSaveNotebookDocumentNotification}}),Object.defineProperty(t,"DidCloseNotebookDocumentNotification",{enumerable:!0,get:function(){return w.DidCloseNotebookDocumentNotification}});const D=n(9366);var C,x,K,O,E,P,A,M,N,q,L,I,F,j,W,$,U,V,B,H,z,G,X,Q,J,Y,Z,ee,te,ne,ie,oe,re,se,ae,ce,le,de,ue,fe,pe,he,ge,me,ye,_e,be,ve,ke,Te,Re,Se,we,De,Ce,xe,Ke,Oe,Ee,Pe,Ae,Me,Ne,qe,Le;Object.defineProperty(t,"InlineCompletionRequest",{enumerable:!0,get:function(){return D.InlineCompletionRequest}}),function(e){e.is=function(e){const t=e;return r.string(t)||r.string(t.language)||r.string(t.scheme)||r.string(t.pattern)}}(C||(t.TextDocumentFilter=C={})),function(e){e.is=function(e){const t=e;return r.objectLiteral(t)&&(r.string(t.notebookType)||r.string(t.scheme)||r.string(t.pattern))}}(x||(t.NotebookDocumentFilter=x={})),function(e){e.is=function(e){const t=e;return r.objectLiteral(t)&&(r.string(t.notebook)||x.is(t.notebook))&&(void 0===t.language||r.string(t.language))}}(K||(t.NotebookCellTextDocumentFilter=K={})),function(e){e.is=function(e){if(!Array.isArray(e))return!1;for(let t of e)if(!r.string(t)&&!C.is(t)&&!K.is(t))return!1;return!0}}(O||(t.DocumentSelector=O={})),function(e){e.method="client/registerCapability",e.messageDirection=i.MessageDirection.serverToClient,e.type=new i.ProtocolRequestType(e.method)}(E||(t.RegistrationRequest=E={})),function(e){e.method="client/unregisterCapability",e.messageDirection=i.MessageDirection.serverToClient,e.type=new i.ProtocolRequestType(e.method)}(P||(t.UnregistrationRequest=P={})),function(e){e.Create="create",e.Rename="rename",e.Delete="delete"}(A||(t.ResourceOperationKind=A={})),function(e){e.Abort="abort",e.Transactional="transactional",e.TextOnlyTransactional="textOnlyTransactional",e.Undo="undo"}(M||(t.FailureHandlingKind=M={})),function(e){e.UTF8="utf-8",e.UTF16="utf-16",e.UTF32="utf-32"}(N||(t.PositionEncodingKind=N={})),function(e){e.hasId=function(e){const t=e;return t&&r.string(t.id)&&t.id.length>0}}(q||(t.StaticRegistrationOptions=q={})),function(e){e.is=function(e){const t=e;return t&&(null===t.documentSelector||O.is(t.documentSelector))}}(L||(t.TextDocumentRegistrationOptions=L={})),function(e){e.is=function(e){const t=e;return r.objectLiteral(t)&&(void 0===t.workDoneProgress||r.boolean(t.workDoneProgress))},e.hasWorkDoneProgress=function(e){const t=e;return t&&r.boolean(t.workDoneProgress)}}(I||(t.WorkDoneProgressOptions=I={})),function(e){e.method="initialize",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolRequestType(e.method)}(F||(t.InitializeRequest=F={})),function(e){e.unknownProtocolVersion=1}(j||(t.InitializeErrorCodes=j={})),function(e){e.method="initialized",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolNotificationType(e.method)}(W||(t.InitializedNotification=W={})),function(e){e.method="shutdown",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolRequestType0(e.method)}($||(t.ShutdownRequest=$={})),function(e){e.method="exit",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolNotificationType0(e.method)}(U||(t.ExitNotification=U={})),function(e){e.method="workspace/didChangeConfiguration",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolNotificationType(e.method)}(V||(t.DidChangeConfigurationNotification=V={})),function(e){e.Error=1,e.Warning=2,e.Info=3,e.Log=4,e.Debug=5}(B||(t.MessageType=B={})),function(e){e.method="window/showMessage",e.messageDirection=i.MessageDirection.serverToClient,e.type=new i.ProtocolNotificationType(e.method)}(H||(t.ShowMessageNotification=H={})),function(e){e.method="window/showMessageRequest",e.messageDirection=i.MessageDirection.serverToClient,e.type=new i.ProtocolRequestType(e.method)}(z||(t.ShowMessageRequest=z={})),function(e){e.method="window/logMessage",e.messageDirection=i.MessageDirection.serverToClient,e.type=new i.ProtocolNotificationType(e.method)}(G||(t.LogMessageNotification=G={})),function(e){e.method="telemetry/event",e.messageDirection=i.MessageDirection.serverToClient,e.type=new i.ProtocolNotificationType(e.method)}(X||(t.TelemetryEventNotification=X={})),function(e){e.None=0,e.Full=1,e.Incremental=2}(Q||(t.TextDocumentSyncKind=Q={})),function(e){e.method="textDocument/didOpen",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolNotificationType(e.method)}(J||(t.DidOpenTextDocumentNotification=J={})),function(e){e.isIncremental=function(e){let t=e;return null!=t&&"string"==typeof t.text&&void 0!==t.range&&(void 0===t.rangeLength||"number"==typeof t.rangeLength)},e.isFull=function(e){let t=e;return null!=t&&"string"==typeof t.text&&void 0===t.range&&void 0===t.rangeLength}}(Y||(t.TextDocumentContentChangeEvent=Y={})),function(e){e.method="textDocument/didChange",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolNotificationType(e.method)}(Z||(t.DidChangeTextDocumentNotification=Z={})),function(e){e.method="textDocument/didClose",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolNotificationType(e.method)}(ee||(t.DidCloseTextDocumentNotification=ee={})),function(e){e.method="textDocument/didSave",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolNotificationType(e.method)}(te||(t.DidSaveTextDocumentNotification=te={})),function(e){e.Manual=1,e.AfterDelay=2,e.FocusOut=3}(ne||(t.TextDocumentSaveReason=ne={})),function(e){e.method="textDocument/willSave",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolNotificationType(e.method)}(ie||(t.WillSaveTextDocumentNotification=ie={})),function(e){e.method="textDocument/willSaveWaitUntil",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolRequestType(e.method)}(oe||(t.WillSaveTextDocumentWaitUntilRequest=oe={})),function(e){e.method="workspace/didChangeWatchedFiles",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolNotificationType(e.method)}(re||(t.DidChangeWatchedFilesNotification=re={})),function(e){e.Created=1,e.Changed=2,e.Deleted=3}(se||(t.FileChangeType=se={})),function(e){e.is=function(e){const t=e;return r.objectLiteral(t)&&(o.URI.is(t.baseUri)||o.WorkspaceFolder.is(t.baseUri))&&r.string(t.pattern)}}(ae||(t.RelativePattern=ae={})),function(e){e.Create=1,e.Change=2,e.Delete=4}(ce||(t.WatchKind=ce={})),function(e){e.method="textDocument/publishDiagnostics",e.messageDirection=i.MessageDirection.serverToClient,e.type=new i.ProtocolNotificationType(e.method)}(le||(t.PublishDiagnosticsNotification=le={})),function(e){e.Invoked=1,e.TriggerCharacter=2,e.TriggerForIncompleteCompletions=3}(de||(t.CompletionTriggerKind=de={})),function(e){e.method="textDocument/completion",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolRequestType(e.method)}(ue||(t.CompletionRequest=ue={})),function(e){e.method="completionItem/resolve",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolRequestType(e.method)}(fe||(t.CompletionResolveRequest=fe={})),function(e){e.method="textDocument/hover",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolRequestType(e.method)}(pe||(t.HoverRequest=pe={})),function(e){e.Invoked=1,e.TriggerCharacter=2,e.ContentChange=3}(he||(t.SignatureHelpTriggerKind=he={})),function(e){e.method="textDocument/signatureHelp",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolRequestType(e.method)}(ge||(t.SignatureHelpRequest=ge={})),function(e){e.method="textDocument/definition",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolRequestType(e.method)}(me||(t.DefinitionRequest=me={})),function(e){e.method="textDocument/references",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolRequestType(e.method)}(ye||(t.ReferencesRequest=ye={})),function(e){e.method="textDocument/documentHighlight",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolRequestType(e.method)}(_e||(t.DocumentHighlightRequest=_e={})),function(e){e.method="textDocument/documentSymbol",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolRequestType(e.method)}(be||(t.DocumentSymbolRequest=be={})),function(e){e.method="textDocument/codeAction",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolRequestType(e.method)}(ve||(t.CodeActionRequest=ve={})),function(e){e.method="codeAction/resolve",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolRequestType(e.method)}(ke||(t.CodeActionResolveRequest=ke={})),function(e){e.method="workspace/symbol",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolRequestType(e.method)}(Te||(t.WorkspaceSymbolRequest=Te={})),function(e){e.method="workspaceSymbol/resolve",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolRequestType(e.method)}(Re||(t.WorkspaceSymbolResolveRequest=Re={})),function(e){e.method="textDocument/codeLens",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolRequestType(e.method)}(Se||(t.CodeLensRequest=Se={})),function(e){e.method="codeLens/resolve",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolRequestType(e.method)}(we||(t.CodeLensResolveRequest=we={})),function(e){e.method="workspace/codeLens/refresh",e.messageDirection=i.MessageDirection.serverToClient,e.type=new i.ProtocolRequestType0(e.method)}(De||(t.CodeLensRefreshRequest=De={})),function(e){e.method="textDocument/documentLink",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolRequestType(e.method)}(Ce||(t.DocumentLinkRequest=Ce={})),function(e){e.method="documentLink/resolve",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolRequestType(e.method)}(xe||(t.DocumentLinkResolveRequest=xe={})),function(e){e.method="textDocument/formatting",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolRequestType(e.method)}(Ke||(t.DocumentFormattingRequest=Ke={})),function(e){e.method="textDocument/rangeFormatting",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolRequestType(e.method)}(Oe||(t.DocumentRangeFormattingRequest=Oe={})),function(e){e.method="textDocument/rangesFormatting",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolRequestType(e.method)}(Ee||(t.DocumentRangesFormattingRequest=Ee={})),function(e){e.method="textDocument/onTypeFormatting",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolRequestType(e.method)}(Pe||(t.DocumentOnTypeFormattingRequest=Pe={})),function(e){e.Identifier=1}(Ae||(t.PrepareSupportDefaultBehavior=Ae={})),function(e){e.method="textDocument/rename",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolRequestType(e.method)}(Me||(t.RenameRequest=Me={})),function(e){e.method="textDocument/prepareRename",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolRequestType(e.method)}(Ne||(t.PrepareRenameRequest=Ne={})),function(e){e.method="workspace/executeCommand",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolRequestType(e.method)}(qe||(t.ExecuteCommandRequest=qe={})),function(e){e.method="workspace/applyEdit",e.messageDirection=i.MessageDirection.serverToClient,e.type=new i.ProtocolRequestType("workspace/applyEdit")}(Le||(t.ApplyWorkspaceEditRequest=Le={}))},7323:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LinkedEditingRangeRequest=void 0;const i=n(4742);var o;!function(e){e.method="textDocument/linkedEditingRange",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolRequestType(e.method)}(o||(t.LinkedEditingRangeRequest=o={}))},9219:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MonikerRequest=t.MonikerKind=t.UniquenessLevel=void 0;const i=n(4742);var o,r,s;!function(e){e.document="document",e.project="project",e.group="group",e.scheme="scheme",e.global="global"}(o||(t.UniquenessLevel=o={})),function(e){e.$import="import",e.$export="export",e.local="local"}(r||(t.MonikerKind=r={})),function(e){e.method="textDocument/moniker",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolRequestType(e.method)}(s||(t.MonikerRequest=s={}))},5626:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DidCloseNotebookDocumentNotification=t.DidSaveNotebookDocumentNotification=t.DidChangeNotebookDocumentNotification=t.NotebookCellArrayChange=t.DidOpenNotebookDocumentNotification=t.NotebookDocumentSyncRegistrationType=t.NotebookDocument=t.NotebookCell=t.ExecutionSummary=t.NotebookCellKind=void 0;const i=n(1516),o=n(9348),r=n(4742);var s,a,c,l,d,u,f,p,h,g;!function(e){e.Markup=1,e.Code=2,e.is=function(e){return 1===e||2===e}}(s||(t.NotebookCellKind=s={})),function(e){e.create=function(e,t){const n={executionOrder:e};return!0!==t&&!1!==t||(n.success=t),n},e.is=function(e){const t=e;return o.objectLiteral(t)&&i.uinteger.is(t.executionOrder)&&(void 0===t.success||o.boolean(t.success))},e.equals=function(e,t){return e===t||null!=e&&null!=t&&e.executionOrder===t.executionOrder&&e.success===t.success}}(a||(t.ExecutionSummary=a={})),function(e){function t(e,n){if(e===n)return!0;if(null==e||null==n)return!1;if(typeof e!=typeof n)return!1;if("object"!=typeof e)return!1;const i=Array.isArray(e),r=Array.isArray(n);if(i!==r)return!1;if(i&&r){if(e.length!==n.length)return!1;for(let i=0;i<e.length;i++)if(!t(e[i],n[i]))return!1}if(o.objectLiteral(e)&&o.objectLiteral(n)){const i=Object.keys(e),o=Object.keys(n);if(i.length!==o.length)return!1;if(i.sort(),o.sort(),!t(i,o))return!1;for(let o=0;o<i.length;o++){const r=i[o];if(!t(e[r],n[r]))return!1}}return!0}e.create=function(e,t){return{kind:e,document:t}},e.is=function(e){const t=e;return o.objectLiteral(t)&&s.is(t.kind)&&i.DocumentUri.is(t.document)&&(void 0===t.metadata||o.objectLiteral(t.metadata))},e.diff=function(e,n){const i=new Set;return e.document!==n.document&&i.add("document"),e.kind!==n.kind&&i.add("kind"),e.executionSummary!==n.executionSummary&&i.add("executionSummary"),void 0===e.metadata&&void 0===n.metadata||t(e.metadata,n.metadata)||i.add("metadata"),void 0===e.executionSummary&&void 0===n.executionSummary||a.equals(e.executionSummary,n.executionSummary)||i.add("executionSummary"),i}}(c||(t.NotebookCell=c={})),function(e){e.create=function(e,t,n,i){return{uri:e,notebookType:t,version:n,cells:i}},e.is=function(e){const t=e;return o.objectLiteral(t)&&o.string(t.uri)&&i.integer.is(t.version)&&o.typedArray(t.cells,c.is)}}(l||(t.NotebookDocument=l={})),function(e){e.method="notebookDocument/sync",e.messageDirection=r.MessageDirection.clientToServer,e.type=new r.RegistrationType(e.method)}(d||(t.NotebookDocumentSyncRegistrationType=d={})),function(e){e.method="notebookDocument/didOpen",e.messageDirection=r.MessageDirection.clientToServer,e.type=new r.ProtocolNotificationType(e.method),e.registrationMethod=d.method}(u||(t.DidOpenNotebookDocumentNotification=u={})),function(e){e.is=function(e){const t=e;return o.objectLiteral(t)&&i.uinteger.is(t.start)&&i.uinteger.is(t.deleteCount)&&(void 0===t.cells||o.typedArray(t.cells,c.is))},e.create=function(e,t,n){const i={start:e,deleteCount:t};return void 0!==n&&(i.cells=n),i}}(f||(t.NotebookCellArrayChange=f={})),function(e){e.method="notebookDocument/didChange",e.messageDirection=r.MessageDirection.clientToServer,e.type=new r.ProtocolNotificationType(e.method),e.registrationMethod=d.method}(p||(t.DidChangeNotebookDocumentNotification=p={})),function(e){e.method="notebookDocument/didSave",e.messageDirection=r.MessageDirection.clientToServer,e.type=new r.ProtocolNotificationType(e.method),e.registrationMethod=d.method}(h||(t.DidSaveNotebookDocumentNotification=h={})),function(e){e.method="notebookDocument/didClose",e.messageDirection=r.MessageDirection.clientToServer,e.type=new r.ProtocolNotificationType(e.method),e.registrationMethod=d.method}(g||(t.DidCloseNotebookDocumentNotification=g={}))},7450:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WorkDoneProgressCancelNotification=t.WorkDoneProgressCreateRequest=t.WorkDoneProgress=void 0;const i=n(9406),o=n(4742);var r,s,a;!function(e){e.type=new i.ProgressType,e.is=function(t){return t===e.type}}(r||(t.WorkDoneProgress=r={})),function(e){e.method="window/workDoneProgress/create",e.messageDirection=o.MessageDirection.serverToClient,e.type=new o.ProtocolRequestType(e.method)}(s||(t.WorkDoneProgressCreateRequest=s={})),function(e){e.method="window/workDoneProgress/cancel",e.messageDirection=o.MessageDirection.clientToServer,e.type=new o.ProtocolNotificationType(e.method)}(a||(t.WorkDoneProgressCancelNotification=a={}))},2964:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SelectionRangeRequest=void 0;const i=n(4742);var o;!function(e){e.method="textDocument/selectionRange",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolRequestType(e.method)}(o||(t.SelectionRangeRequest=o={}))},5402:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SemanticTokensRefreshRequest=t.SemanticTokensRangeRequest=t.SemanticTokensDeltaRequest=t.SemanticTokensRequest=t.SemanticTokensRegistrationType=t.TokenFormat=void 0;const i=n(4742);var o,r,s,a,c,l;!function(e){e.Relative="relative"}(o||(t.TokenFormat=o={})),function(e){e.method="textDocument/semanticTokens",e.type=new i.RegistrationType(e.method)}(r||(t.SemanticTokensRegistrationType=r={})),function(e){e.method="textDocument/semanticTokens/full",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolRequestType(e.method),e.registrationMethod=r.method}(s||(t.SemanticTokensRequest=s={})),function(e){e.method="textDocument/semanticTokens/full/delta",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolRequestType(e.method),e.registrationMethod=r.method}(a||(t.SemanticTokensDeltaRequest=a={})),function(e){e.method="textDocument/semanticTokens/range",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolRequestType(e.method),e.registrationMethod=r.method}(c||(t.SemanticTokensRangeRequest=c={})),function(e){e.method="workspace/semanticTokens/refresh",e.messageDirection=i.MessageDirection.serverToClient,e.type=new i.ProtocolRequestType0(e.method)}(l||(t.SemanticTokensRefreshRequest=l={}))},903:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ShowDocumentRequest=void 0;const i=n(4742);var o;!function(e){e.method="window/showDocument",e.messageDirection=i.MessageDirection.serverToClient,e.type=new i.ProtocolRequestType(e.method)}(o||(t.ShowDocumentRequest=o={}))},8685:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TypeDefinitionRequest=void 0;const i=n(4742);var o;!function(e){e.method="textDocument/typeDefinition",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolRequestType(e.method)}(o||(t.TypeDefinitionRequest=o={}))},9970:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TypeHierarchySubtypesRequest=t.TypeHierarchySupertypesRequest=t.TypeHierarchyPrepareRequest=void 0;const i=n(4742);var o,r,s;!function(e){e.method="textDocument/prepareTypeHierarchy",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolRequestType(e.method)}(o||(t.TypeHierarchyPrepareRequest=o={})),function(e){e.method="typeHierarchy/supertypes",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolRequestType(e.method)}(r||(t.TypeHierarchySupertypesRequest=r={})),function(e){e.method="typeHierarchy/subtypes",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolRequestType(e.method)}(s||(t.TypeHierarchySubtypesRequest=s={}))},6098:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DidChangeWorkspaceFoldersNotification=t.WorkspaceFoldersRequest=void 0;const i=n(4742);var o,r;!function(e){e.method="workspace/workspaceFolders",e.messageDirection=i.MessageDirection.serverToClient,e.type=new i.ProtocolRequestType0(e.method)}(o||(t.WorkspaceFoldersRequest=o={})),function(e){e.method="workspace/didChangeWorkspaceFolders",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolNotificationType(e.method)}(r||(t.DidChangeWorkspaceFoldersNotification=r={}))},9348:(e,t)=>{"use strict";function n(e){return"string"==typeof e||e instanceof String}function i(e){return Array.isArray(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.objectLiteral=t.typedArray=t.stringArray=t.array=t.func=t.error=t.number=t.string=t.boolean=void 0,t.boolean=function(e){return!0===e||!1===e},t.string=n,t.number=function(e){return"number"==typeof e||e instanceof Number},t.error=function(e){return e instanceof Error},t.func=function(e){return"function"==typeof e},t.array=i,t.stringArray=function(e){return i(e)&&e.every((e=>n(e)))},t.typedArray=function(e,t){return Array.isArray(e)&&e.every(t)},t.objectLiteral=function(e){return null!==e&&"object"==typeof e}},429:(e,t,n)=>{"use strict";e.exports=n(5751)},5751:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,o)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.createConnection=void 0;const r=n(9936);o(n(9351),t),o(n(9936),t);let s=!1;const a={initialize:e=>{},get shutdownReceived(){return s},set shutdownReceived(e){s=e},exit:e=>{}};t.createConnection=function(e,t,n,i){let o,s,c,l;return void 0!==e&&"features"===e.__brand&&(o=e,e=t,t=n,n=i),r.ConnectionStrategy.is(e)||r.ConnectionOptions.is(e)?l=e:(s=e,c=t,l=n),(0,r.createConnection)((e=>(0,r.createProtocolConnection)(s,c,e,l)),a,o)}},9936:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,o)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.ProposedFeatures=t.NotebookDocuments=t.TextDocuments=t.SemanticTokensBuilder=void 0;const r=n(7255);Object.defineProperty(t,"SemanticTokensBuilder",{enumerable:!0,get:function(){return r.SemanticTokensBuilder}});const s=n(1778);o(n(5968),t);const a=n(7086);Object.defineProperty(t,"TextDocuments",{enumerable:!0,get:function(){return a.TextDocuments}});const c=n(5083);var l;Object.defineProperty(t,"NotebookDocuments",{enumerable:!0,get:function(){return c.NotebookDocuments}}),o(n(6717),t),function(e){e.all={__brand:"features",languages:s.InlineCompletionFeature}}(l||(t.ProposedFeatures=l={}))},4225:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CallHierarchyFeature=void 0;const i=n(5968);t.CallHierarchyFeature=e=>class extends e{get callHierarchy(){return{onPrepare:e=>this.connection.onRequest(i.CallHierarchyPrepareRequest.type,((t,n)=>e(t,n,this.attachWorkDoneProgress(t),void 0))),onIncomingCalls:e=>{const t=i.CallHierarchyIncomingCallsRequest.type;return this.connection.onRequest(t,((n,i)=>e(n,i,this.attachWorkDoneProgress(n),this.attachPartialResultProgress(t,n))))},onOutgoingCalls:e=>{const t=i.CallHierarchyOutgoingCallsRequest.type;return this.connection.onRequest(t,((n,i)=>e(n,i,this.attachWorkDoneProgress(n),this.attachPartialResultProgress(t,n))))}}}}},3606:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ConfigurationFeature=void 0;const i=n(5968),o=n(6960);t.ConfigurationFeature=e=>class extends e{getConfiguration(e){return e?o.string(e)?this._getConfiguration({section:e}):this._getConfiguration(e):this._getConfiguration({})}_getConfiguration(e){let t={items:Array.isArray(e)?e:[e]};return this.connection.sendRequest(i.ConfigurationRequest.type,t).then((t=>Array.isArray(t)?Array.isArray(e)?t:t[0]:Array.isArray(e)?[]:null))}}},2473:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DiagnosticFeature=void 0;const i=n(5968);t.DiagnosticFeature=e=>class extends e{get diagnostics(){return{refresh:()=>this.connection.sendRequest(i.DiagnosticRefreshRequest.type),on:e=>this.connection.onRequest(i.DocumentDiagnosticRequest.type,((t,n)=>e(t,n,this.attachWorkDoneProgress(t),this.attachPartialResultProgress(i.DocumentDiagnosticRequest.partialResult,t)))),onWorkspace:e=>this.connection.onRequest(i.WorkspaceDiagnosticRequest.type,((t,n)=>e(t,n,this.attachWorkDoneProgress(t),this.attachPartialResultProgress(i.WorkspaceDiagnosticRequest.partialResult,t))))}}}},7695:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FileOperationsFeature=void 0;const i=n(5968);t.FileOperationsFeature=e=>class extends e{onDidCreateFiles(e){return this.connection.onNotification(i.DidCreateFilesNotification.type,(t=>{e(t)}))}onDidRenameFiles(e){return this.connection.onNotification(i.DidRenameFilesNotification.type,(t=>{e(t)}))}onDidDeleteFiles(e){return this.connection.onNotification(i.DidDeleteFilesNotification.type,(t=>{e(t)}))}onWillCreateFiles(e){return this.connection.onRequest(i.WillCreateFilesRequest.type,((t,n)=>e(t,n)))}onWillRenameFiles(e){return this.connection.onRequest(i.WillRenameFilesRequest.type,((t,n)=>e(t,n)))}onWillDeleteFiles(e){return this.connection.onRequest(i.WillDeleteFilesRequest.type,((t,n)=>e(t,n)))}}},3183:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FoldingRangeFeature=void 0;const i=n(5968);t.FoldingRangeFeature=e=>class extends e{get foldingRange(){return{refresh:()=>this.connection.sendRequest(i.FoldingRangeRefreshRequest.type),on:e=>{const t=i.FoldingRangeRequest.type;return this.connection.onRequest(t,((n,i)=>e(n,i,this.attachWorkDoneProgress(n),this.attachPartialResultProgress(t,n))))}}}}},8339:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InlayHintFeature=void 0;const i=n(5968);t.InlayHintFeature=e=>class extends e{get inlayHint(){return{refresh:()=>this.connection.sendRequest(i.InlayHintRefreshRequest.type),on:e=>this.connection.onRequest(i.InlayHintRequest.type,((t,n)=>e(t,n,this.attachWorkDoneProgress(t)))),resolve:e=>this.connection.onRequest(i.InlayHintResolveRequest.type,((t,n)=>e(t,n)))}}}},1778:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InlineCompletionFeature=void 0;const i=n(5968);t.InlineCompletionFeature=e=>class extends e{get inlineCompletion(){return{on:e=>this.connection.onRequest(i.InlineCompletionRequest.type,((t,n)=>e(t,n,this.attachWorkDoneProgress(t))))}}}},8714:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InlineValueFeature=void 0;const i=n(5968);t.InlineValueFeature=e=>class extends e{get inlineValue(){return{refresh:()=>this.connection.sendRequest(i.InlineValueRefreshRequest.type),on:e=>this.connection.onRequest(i.InlineValueRequest.type,((t,n)=>e(t,n,this.attachWorkDoneProgress(t))))}}}},7129:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LinkedEditingRangeFeature=void 0;const i=n(5968);t.LinkedEditingRangeFeature=e=>class extends e{onLinkedEditingRange(e){return this.connection.onRequest(i.LinkedEditingRangeRequest.type,((t,n)=>e(t,n,this.attachWorkDoneProgress(t),void 0)))}}},8535:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MonikerFeature=void 0;const i=n(5968);t.MonikerFeature=e=>class extends e{get moniker(){return{on:e=>{const t=i.MonikerRequest.type;return this.connection.onRequest(t,((n,i)=>e(n,i,this.attachWorkDoneProgress(n),this.attachPartialResultProgress(t,n))))}}}}},5083:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NotebookDocuments=t.NotebookSyncFeature=void 0;const i=n(5968),o=n(7086);t.NotebookSyncFeature=e=>class extends e{get synchronization(){return{onDidOpenNotebookDocument:e=>this.connection.onNotification(i.DidOpenNotebookDocumentNotification.type,(t=>{e(t)})),onDidChangeNotebookDocument:e=>this.connection.onNotification(i.DidChangeNotebookDocumentNotification.type,(t=>{e(t)})),onDidSaveNotebookDocument:e=>this.connection.onNotification(i.DidSaveNotebookDocumentNotification.type,(t=>{e(t)})),onDidCloseNotebookDocument:e=>this.connection.onNotification(i.DidCloseNotebookDocumentNotification.type,(t=>{e(t)}))}}};class r{onDidOpenTextDocument(e){return this.openHandler=e,i.Disposable.create((()=>{this.openHandler=void 0}))}openTextDocument(e){this.openHandler&&this.openHandler(e)}onDidChangeTextDocument(e){return this.changeHandler=e,i.Disposable.create((()=>{this.changeHandler=e}))}changeTextDocument(e){this.changeHandler&&this.changeHandler(e)}onDidCloseTextDocument(e){return this.closeHandler=e,i.Disposable.create((()=>{this.closeHandler=void 0}))}closeTextDocument(e){this.closeHandler&&this.closeHandler(e)}onWillSaveTextDocument(){return r.NULL_DISPOSE}onWillSaveTextDocumentWaitUntil(){return r.NULL_DISPOSE}onDidSaveTextDocument(){return r.NULL_DISPOSE}}r.NULL_DISPOSE=Object.freeze({dispose:()=>{}}),t.NotebookDocuments=class{constructor(e){e instanceof o.TextDocuments?this._cellTextDocuments=e:this._cellTextDocuments=new o.TextDocuments(e),this.notebookDocuments=new Map,this.notebookCellMap=new Map,this._onDidOpen=new i.Emitter,this._onDidChange=new i.Emitter,this._onDidSave=new i.Emitter,this._onDidClose=new i.Emitter}get cellTextDocuments(){return this._cellTextDocuments}getCellTextDocument(e){return this._cellTextDocuments.get(e.document)}getNotebookDocument(e){return this.notebookDocuments.get(e)}getNotebookCell(e){const t=this.notebookCellMap.get(e);return t&&t[0]}findNotebookDocumentForCell(e){const t="string"==typeof e?e:e.document,n=this.notebookCellMap.get(t);return n&&n[1]}get onDidOpen(){return this._onDidOpen.event}get onDidSave(){return this._onDidSave.event}get onDidChange(){return this._onDidChange.event}get onDidClose(){return this._onDidClose.event}listen(e){const t=new r,n=[];return n.push(this.cellTextDocuments.listen(t)),n.push(e.notebooks.synchronization.onDidOpenNotebookDocument((e=>{this.notebookDocuments.set(e.notebookDocument.uri,e.notebookDocument);for(const n of e.cellTextDocuments)t.openTextDocument({textDocument:n});this.updateCellMap(e.notebookDocument),this._onDidOpen.fire(e.notebookDocument)}))),n.push(e.notebooks.synchronization.onDidChangeNotebookDocument((e=>{const n=this.notebookDocuments.get(e.notebookDocument.uri);if(void 0===n)return;n.version=e.notebookDocument.version;const i=n.metadata;let o=!1;const r=e.change;void 0!==r.metadata&&(o=!0,n.metadata=r.metadata);const s=[],a=[],c=[],l=[];if(void 0!==r.cells){const e=r.cells;if(void 0!==e.structure){const i=e.structure.array;if(n.cells.splice(i.start,i.deleteCount,...void 0!==i.cells?i.cells:[]),void 0!==e.structure.didOpen)for(const n of e.structure.didOpen)t.openTextDocument({textDocument:n}),s.push(n.uri);if(e.structure.didClose)for(const n of e.structure.didClose)t.closeTextDocument({textDocument:n}),a.push(n.uri)}if(void 0!==e.data){const t=new Map(e.data.map((e=>[e.document,e])));for(let e=0;e<=n.cells.length;e++){const i=t.get(n.cells[e].document);if(void 0!==i){const o=n.cells.splice(e,1,i);if(c.push({old:o[0],new:i}),t.delete(i.document),0===t.size)break}}}if(void 0!==e.textContent)for(const n of e.textContent)t.changeTextDocument({textDocument:n.document,contentChanges:n.changes}),l.push(n.document.uri)}this.updateCellMap(n);const d={notebookDocument:n};o&&(d.metadata={old:i,new:n.metadata});const u=[];for(const e of s)u.push(this.getNotebookCell(e));const f=[];for(const e of a)f.push(this.getNotebookCell(e));const p=[];for(const e of l)p.push(this.getNotebookCell(e));(u.length>0||f.length>0||c.length>0||p.length>0)&&(d.cells={added:u,removed:f,changed:{data:c,textContent:p}}),void 0===d.metadata&&void 0===d.cells||this._onDidChange.fire(d)}))),n.push(e.notebooks.synchronization.onDidSaveNotebookDocument((e=>{const t=this.notebookDocuments.get(e.notebookDocument.uri);void 0!==t&&this._onDidSave.fire(t)}))),n.push(e.notebooks.synchronization.onDidCloseNotebookDocument((e=>{const n=this.notebookDocuments.get(e.notebookDocument.uri);if(void 0!==n){this._onDidClose.fire(n);for(const n of e.cellTextDocuments)t.closeTextDocument({textDocument:n});this.notebookDocuments.delete(e.notebookDocument.uri);for(const e of n.cells)this.notebookCellMap.delete(e.document)}}))),i.Disposable.create((()=>{n.forEach((e=>e.dispose()))}))}updateCellMap(e){for(const t of e.cells)this.notebookCellMap.set(t.document,[t,e])}}},3787:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.attachPartialResult=t.ProgressFeature=t.attachWorkDone=void 0;const i=n(5968),o=n(7867);class r{constructor(e,t){this._connection=e,this._token=t,r.Instances.set(this._token,this)}begin(e,t,n,o){let r={kind:"begin",title:e,percentage:t,message:n,cancellable:o};this._connection.sendProgress(i.WorkDoneProgress.type,this._token,r)}report(e,t){let n={kind:"report"};"number"==typeof e?(n.percentage=e,void 0!==t&&(n.message=t)):n.message=e,this._connection.sendProgress(i.WorkDoneProgress.type,this._token,n)}done(){r.Instances.delete(this._token),this._connection.sendProgress(i.WorkDoneProgress.type,this._token,{kind:"end"})}}r.Instances=new Map;class s extends r{constructor(e,t){super(e,t),this._source=new i.CancellationTokenSource}get token(){return this._source.token}done(){this._source.dispose(),super.done()}cancel(){this._source.cancel()}}class a{constructor(){}begin(){}report(){}done(){}}class c extends a{constructor(){super(),this._source=new i.CancellationTokenSource}get token(){return this._source.token}done(){this._source.dispose()}cancel(){this._source.cancel()}}var l;t.attachWorkDone=function(e,t){if(void 0===t||void 0===t.workDoneToken)return new a;const n=t.workDoneToken;return delete t.workDoneToken,new r(e,n)},t.ProgressFeature=e=>class extends e{constructor(){super(),this._progressSupported=!1}initialize(e){super.initialize(e),!0===e?.window?.workDoneProgress&&(this._progressSupported=!0,this.connection.onNotification(i.WorkDoneProgressCancelNotification.type,(e=>{let t=r.Instances.get(e.token);(t instanceof s||t instanceof c)&&t.cancel()})))}attachWorkDoneProgress(e){return void 0===e?new a:new r(this.connection,e)}createWorkDoneProgress(){if(this._progressSupported){const e=(0,o.generateUuid)();return this.connection.sendRequest(i.WorkDoneProgressCreateRequest.type,{token:e}).then((()=>new s(this.connection,e)))}return Promise.resolve(new c)}},function(e){e.type=new i.ProgressType}(l||(l={}));class d{constructor(e,t){this._connection=e,this._token=t}report(e){this._connection.sendProgress(l.type,this._token,e)}}t.attachPartialResult=function(e,t){if(void 0===t||void 0===t.partialResultToken)return;const n=t.partialResultToken;return delete t.partialResultToken,new d(e,n)}},7255:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SemanticTokensBuilder=t.SemanticTokensDiff=t.SemanticTokensFeature=void 0;const i=n(5968);t.SemanticTokensFeature=e=>class extends e{get semanticTokens(){return{refresh:()=>this.connection.sendRequest(i.SemanticTokensRefreshRequest.type),on:e=>{const t=i.SemanticTokensRequest.type;return this.connection.onRequest(t,((n,i)=>e(n,i,this.attachWorkDoneProgress(n),this.attachPartialResultProgress(t,n))))},onDelta:e=>{const t=i.SemanticTokensDeltaRequest.type;return this.connection.onRequest(t,((n,i)=>e(n,i,this.attachWorkDoneProgress(n),this.attachPartialResultProgress(t,n))))},onRange:e=>{const t=i.SemanticTokensRangeRequest.type;return this.connection.onRequest(t,((n,i)=>e(n,i,this.attachWorkDoneProgress(n),this.attachPartialResultProgress(t,n))))}}}};class o{constructor(e,t){this.originalSequence=e,this.modifiedSequence=t}computeDiff(){const e=this.originalSequence.length,t=this.modifiedSequence.length;let n=0;for(;n<t&&n<e&&this.originalSequence[n]===this.modifiedSequence[n];)n++;if(n<t&&n<e){let i=e-1,o=t-1;for(;i>=n&&o>=n&&this.originalSequence[i]===this.modifiedSequence[o];)i--,o--;(i<n||o<n)&&(i++,o++);const r=i-n+1,s=this.modifiedSequence.slice(n,o+1);return 1===s.length&&s[0]===this.originalSequence[i]?[{start:n,deleteCount:r-1}]:[{start:n,deleteCount:r,data:s}]}return n<t?[{start:n,deleteCount:0,data:this.modifiedSequence.slice(n)}]:n<e?[{start:n,deleteCount:e-n}]:[]}}t.SemanticTokensDiff=o,t.SemanticTokensBuilder=class{constructor(){this._prevData=void 0,this.initialize()}initialize(){this._id=Date.now(),this._prevLine=0,this._prevChar=0,this._data=[],this._dataLen=0}push(e,t,n,i,o){let r=e,s=t;this._dataLen>0&&(r-=this._prevLine,0===r&&(s-=this._prevChar)),this._data[this._dataLen++]=r,this._data[this._dataLen++]=s,this._data[this._dataLen++]=n,this._data[this._dataLen++]=i,this._data[this._dataLen++]=o,this._prevLine=e,this._prevChar=t}get id(){return this._id.toString()}previousResult(e){this.id===e&&(this._prevData=this._data),this.initialize()}build(){return this._prevData=void 0,{resultId:this.id,data:this._data}}canBuildEdits(){return void 0!==this._prevData}buildEdits(){return void 0!==this._prevData?{resultId:this.id,edits:new o(this._prevData,this._data).computeDiff()}:this.build()}}},6717:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createConnection=t.combineFeatures=t.combineNotebooksFeatures=t.combineLanguagesFeatures=t.combineWorkspaceFeatures=t.combineWindowFeatures=t.combineClientFeatures=t.combineTracerFeatures=t.combineTelemetryFeatures=t.combineConsoleFeatures=t._NotebooksImpl=t._LanguagesImpl=t.BulkUnregistration=t.BulkRegistration=t.ErrorMessageTracker=void 0;const i=n(5968),o=n(6960),r=n(7867),s=n(3787),a=n(3606),c=n(2268),l=n(4225),d=n(7255),u=n(9283),f=n(7695),p=n(7129),h=n(7350),g=n(8714),m=n(3183),y=n(8339),_=n(2473),b=n(5083),v=n(8535);function k(e){if(null!==e)return e}t.ErrorMessageTracker=class{constructor(){this._messages=Object.create(null)}add(e){let t=this._messages[e];t||(t=0),t++,this._messages[e]=t}sendErrors(e){Object.keys(this._messages).forEach((t=>{e.window.showErrorMessage(t)}))}};class T{constructor(){}rawAttach(e){this._rawConnection=e}attach(e){this._connection=e}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}fillServerCapabilities(e){}initialize(e){}error(e){this.send(i.MessageType.Error,e)}warn(e){this.send(i.MessageType.Warning,e)}info(e){this.send(i.MessageType.Info,e)}log(e){this.send(i.MessageType.Log,e)}debug(e){this.send(i.MessageType.Debug,e)}send(e,t){this._rawConnection&&this._rawConnection.sendNotification(i.LogMessageNotification.type,{type:e,message:t}).catch((()=>{(0,i.RAL)().console.error("Sending log message failed")}))}}const R=(0,u.ShowDocumentFeature)((0,s.ProgressFeature)(class{constructor(){}attach(e){this._connection=e}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(e){}fillServerCapabilities(e){}showErrorMessage(e,...t){let n={type:i.MessageType.Error,message:e,actions:t};return this.connection.sendRequest(i.ShowMessageRequest.type,n).then(k)}showWarningMessage(e,...t){let n={type:i.MessageType.Warning,message:e,actions:t};return this.connection.sendRequest(i.ShowMessageRequest.type,n).then(k)}showInformationMessage(e,...t){let n={type:i.MessageType.Info,message:e,actions:t};return this.connection.sendRequest(i.ShowMessageRequest.type,n).then(k)}}));var S,w;!function(e){e.create=function(){return new D}}(S||(t.BulkRegistration=S={}));class D{constructor(){this._registrations=[],this._registered=new Set}add(e,t){const n=o.string(e)?e:e.method;if(this._registered.has(n))throw new Error(`${n} is already added to this registration`);const i=r.generateUuid();this._registrations.push({id:i,method:n,registerOptions:t||{}}),this._registered.add(n)}asRegistrationParams(){return{registrations:this._registrations}}}!function(e){e.create=function(){return new C(void 0,[])}}(w||(t.BulkUnregistration=w={}));class C{constructor(e,t){this._connection=e,this._unregistrations=new Map,t.forEach((e=>{this._unregistrations.set(e.method,e)}))}get isAttached(){return!!this._connection}attach(e){this._connection=e}add(e){this._unregistrations.set(e.method,e)}dispose(){let e=[];for(let t of this._unregistrations.values())e.push(t);let t={unregisterations:e};this._connection.sendRequest(i.UnregistrationRequest.type,t).catch((()=>{this._connection.console.info("Bulk unregistration failed.")}))}disposeSingle(e){const t=o.string(e)?e:e.method,n=this._unregistrations.get(t);if(!n)return!1;let r={unregisterations:[n]};return this._connection.sendRequest(i.UnregistrationRequest.type,r).then((()=>{this._unregistrations.delete(t)}),(e=>{this._connection.console.info(`Un-registering request handler for ${n.id} failed.`)})),!0}}class x{attach(e){this._connection=e}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(e){}fillServerCapabilities(e){}register(e,t,n){return e instanceof D?this.registerMany(e):e instanceof C?this.registerSingle1(e,t,n):this.registerSingle2(e,t)}registerSingle1(e,t,n){const s=o.string(t)?t:t.method,a=r.generateUuid();let c={registrations:[{id:a,method:s,registerOptions:n||{}}]};return e.isAttached||e.attach(this.connection),this.connection.sendRequest(i.RegistrationRequest.type,c).then((t=>(e.add({id:a,method:s}),e)),(e=>(this.connection.console.info(`Registering request handler for ${s} failed.`),Promise.reject(e))))}registerSingle2(e,t){const n=o.string(e)?e:e.method,s=r.generateUuid();let a={registrations:[{id:s,method:n,registerOptions:t||{}}]};return this.connection.sendRequest(i.RegistrationRequest.type,a).then((e=>i.Disposable.create((()=>{this.unregisterSingle(s,n).catch((()=>{this.connection.console.info(`Un-registering capability with id ${s} failed.`)}))}))),(e=>(this.connection.console.info(`Registering request handler for ${n} failed.`),Promise.reject(e))))}unregisterSingle(e,t){let n={unregisterations:[{id:e,method:t}]};return this.connection.sendRequest(i.UnregistrationRequest.type,n).catch((()=>{this.connection.console.info(`Un-registering request handler for ${e} failed.`)}))}registerMany(e){let t=e.asRegistrationParams();return this.connection.sendRequest(i.RegistrationRequest.type,t).then((()=>new C(this._connection,t.registrations.map((e=>({id:e.id,method:e.method}))))),(e=>(this.connection.console.info("Bulk registration failed."),Promise.reject(e))))}}const K=(0,f.FileOperationsFeature)((0,c.WorkspaceFoldersFeature)((0,a.ConfigurationFeature)(class{constructor(){}attach(e){this._connection=e}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(e){}fillServerCapabilities(e){}applyEdit(e){let t=(n=e)&&n.edit?e:{edit:e};var n;return this.connection.sendRequest(i.ApplyWorkspaceEditRequest.type,t)}})));class O{constructor(){this._trace=i.Trace.Off}attach(e){this._connection=e}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(e){}fillServerCapabilities(e){}set trace(e){this._trace=e}log(e,t){this._trace!==i.Trace.Off&&this.connection.sendNotification(i.LogTraceNotification.type,{message:e,verbose:this._trace===i.Trace.Verbose?t:void 0}).catch((()=>{}))}}class E{constructor(){}attach(e){this._connection=e}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(e){}fillServerCapabilities(e){}logEvent(e){this.connection.sendNotification(i.TelemetryEventNotification.type,e).catch((()=>{this.connection.console.log("Sending TelemetryEventNotification failed")}))}}class P{constructor(){}attach(e){this._connection=e}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(e){}fillServerCapabilities(e){}attachWorkDoneProgress(e){return(0,s.attachWorkDone)(this.connection,e)}attachPartialResultProgress(e,t){return(0,s.attachPartialResult)(this.connection,t)}}t._LanguagesImpl=P;const A=(0,m.FoldingRangeFeature)((0,v.MonikerFeature)((0,_.DiagnosticFeature)((0,y.InlayHintFeature)((0,g.InlineValueFeature)((0,h.TypeHierarchyFeature)((0,p.LinkedEditingRangeFeature)((0,d.SemanticTokensFeature)((0,l.CallHierarchyFeature)(P)))))))));class M{constructor(){}attach(e){this._connection=e}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(e){}fillServerCapabilities(e){}attachWorkDoneProgress(e){return(0,s.attachWorkDone)(this.connection,e)}attachPartialResultProgress(e,t){return(0,s.attachPartialResult)(this.connection,t)}}t._NotebooksImpl=M;const N=(0,b.NotebookSyncFeature)(M);function q(e,t){return function(n){return t(e(n))}}function L(e,t){return function(n){return t(e(n))}}function I(e,t){return function(n){return t(e(n))}}function F(e,t){return function(n){return t(e(n))}}function j(e,t){return function(n){return t(e(n))}}function W(e,t){return function(n){return t(e(n))}}function $(e,t){return function(n){return t(e(n))}}function U(e,t){return function(n){return t(e(n))}}t.combineConsoleFeatures=q,t.combineTelemetryFeatures=L,t.combineTracerFeatures=I,t.combineClientFeatures=F,t.combineWindowFeatures=j,t.combineWorkspaceFeatures=W,t.combineLanguagesFeatures=$,t.combineNotebooksFeatures=U,t.combineFeatures=function(e,t){function n(e,t,n){return e&&t?n(e,t):e||t}return{__brand:"features",console:n(e.console,t.console,q),tracer:n(e.tracer,t.tracer,I),telemetry:n(e.telemetry,t.telemetry,L),client:n(e.client,t.client,F),window:n(e.window,t.window,j),workspace:n(e.workspace,t.workspace,W),languages:n(e.languages,t.languages,$),notebooks:n(e.notebooks,t.notebooks,U)}},t.createConnection=function(e,t,n){const r=n&&n.console?new(n.console(T)):new T,a=e(r);r.rawAttach(a);const c=n&&n.tracer?new(n.tracer(O)):new O,l=n&&n.telemetry?new(n.telemetry(E)):new E,d=n&&n.client?new(n.client(x)):new x,u=n&&n.window?new(n.window(R)):new R,f=n&&n.workspace?new(n.workspace(K)):new K,p=n&&n.languages?new(n.languages(A)):new A,h=n&&n.notebooks?new(n.notebooks(N)):new N,g=[r,c,l,d,u,f,p,h];let m,y,_,b={listen:()=>a.listen(),sendRequest:(e,...t)=>a.sendRequest(o.string(e)?e:e.method,...t),onRequest:(e,t)=>a.onRequest(e,t),sendNotification:(e,t)=>{const n=o.string(e)?e:e.method;return a.sendNotification(n,t)},onNotification:(e,t)=>a.onNotification(e,t),onProgress:a.onProgress,sendProgress:a.sendProgress,onInitialize:e=>(y=e,{dispose:()=>{y=void 0}}),onInitialized:e=>a.onNotification(i.InitializedNotification.type,e),onShutdown:e=>(m=e,{dispose:()=>{m=void 0}}),onExit:e=>(_=e,{dispose:()=>{_=void 0}}),get console(){return r},get telemetry(){return l},get tracer(){return c},get client(){return d},get window(){return u},get workspace(){return f},get languages(){return p},get notebooks(){return h},onDidChangeConfiguration:e=>a.onNotification(i.DidChangeConfigurationNotification.type,e),onDidChangeWatchedFiles:e=>a.onNotification(i.DidChangeWatchedFilesNotification.type,e),__textDocumentSync:void 0,onDidOpenTextDocument:e=>a.onNotification(i.DidOpenTextDocumentNotification.type,e),onDidChangeTextDocument:e=>a.onNotification(i.DidChangeTextDocumentNotification.type,e),onDidCloseTextDocument:e=>a.onNotification(i.DidCloseTextDocumentNotification.type,e),onWillSaveTextDocument:e=>a.onNotification(i.WillSaveTextDocumentNotification.type,e),onWillSaveTextDocumentWaitUntil:e=>a.onRequest(i.WillSaveTextDocumentWaitUntilRequest.type,e),onDidSaveTextDocument:e=>a.onNotification(i.DidSaveTextDocumentNotification.type,e),sendDiagnostics:e=>a.sendNotification(i.PublishDiagnosticsNotification.type,e),onHover:e=>a.onRequest(i.HoverRequest.type,((t,n)=>e(t,n,(0,s.attachWorkDone)(a,t),void 0))),onCompletion:e=>a.onRequest(i.CompletionRequest.type,((t,n)=>e(t,n,(0,s.attachWorkDone)(a,t),(0,s.attachPartialResult)(a,t)))),onCompletionResolve:e=>a.onRequest(i.CompletionResolveRequest.type,e),onSignatureHelp:e=>a.onRequest(i.SignatureHelpRequest.type,((t,n)=>e(t,n,(0,s.attachWorkDone)(a,t),void 0))),onDeclaration:e=>a.onRequest(i.DeclarationRequest.type,((t,n)=>e(t,n,(0,s.attachWorkDone)(a,t),(0,s.attachPartialResult)(a,t)))),onDefinition:e=>a.onRequest(i.DefinitionRequest.type,((t,n)=>e(t,n,(0,s.attachWorkDone)(a,t),(0,s.attachPartialResult)(a,t)))),onTypeDefinition:e=>a.onRequest(i.TypeDefinitionRequest.type,((t,n)=>e(t,n,(0,s.attachWorkDone)(a,t),(0,s.attachPartialResult)(a,t)))),onImplementation:e=>a.onRequest(i.ImplementationRequest.type,((t,n)=>e(t,n,(0,s.attachWorkDone)(a,t),(0,s.attachPartialResult)(a,t)))),onReferences:e=>a.onRequest(i.ReferencesRequest.type,((t,n)=>e(t,n,(0,s.attachWorkDone)(a,t),(0,s.attachPartialResult)(a,t)))),onDocumentHighlight:e=>a.onRequest(i.DocumentHighlightRequest.type,((t,n)=>e(t,n,(0,s.attachWorkDone)(a,t),(0,s.attachPartialResult)(a,t)))),onDocumentSymbol:e=>a.onRequest(i.DocumentSymbolRequest.type,((t,n)=>e(t,n,(0,s.attachWorkDone)(a,t),(0,s.attachPartialResult)(a,t)))),onWorkspaceSymbol:e=>a.onRequest(i.WorkspaceSymbolRequest.type,((t,n)=>e(t,n,(0,s.attachWorkDone)(a,t),(0,s.attachPartialResult)(a,t)))),onWorkspaceSymbolResolve:e=>a.onRequest(i.WorkspaceSymbolResolveRequest.type,e),onCodeAction:e=>a.onRequest(i.CodeActionRequest.type,((t,n)=>e(t,n,(0,s.attachWorkDone)(a,t),(0,s.attachPartialResult)(a,t)))),onCodeActionResolve:e=>a.onRequest(i.CodeActionResolveRequest.type,((t,n)=>e(t,n))),onCodeLens:e=>a.onRequest(i.CodeLensRequest.type,((t,n)=>e(t,n,(0,s.attachWorkDone)(a,t),(0,s.attachPartialResult)(a,t)))),onCodeLensResolve:e=>a.onRequest(i.CodeLensResolveRequest.type,((t,n)=>e(t,n))),onDocumentFormatting:e=>a.onRequest(i.DocumentFormattingRequest.type,((t,n)=>e(t,n,(0,s.attachWorkDone)(a,t),void 0))),onDocumentRangeFormatting:e=>a.onRequest(i.DocumentRangeFormattingRequest.type,((t,n)=>e(t,n,(0,s.attachWorkDone)(a,t),void 0))),onDocumentOnTypeFormatting:e=>a.onRequest(i.DocumentOnTypeFormattingRequest.type,((t,n)=>e(t,n))),onRenameRequest:e=>a.onRequest(i.RenameRequest.type,((t,n)=>e(t,n,(0,s.attachWorkDone)(a,t),void 0))),onPrepareRename:e=>a.onRequest(i.PrepareRenameRequest.type,((t,n)=>e(t,n))),onDocumentLinks:e=>a.onRequest(i.DocumentLinkRequest.type,((t,n)=>e(t,n,(0,s.attachWorkDone)(a,t),(0,s.attachPartialResult)(a,t)))),onDocumentLinkResolve:e=>a.onRequest(i.DocumentLinkResolveRequest.type,((t,n)=>e(t,n))),onDocumentColor:e=>a.onRequest(i.DocumentColorRequest.type,((t,n)=>e(t,n,(0,s.attachWorkDone)(a,t),(0,s.attachPartialResult)(a,t)))),onColorPresentation:e=>a.onRequest(i.ColorPresentationRequest.type,((t,n)=>e(t,n,(0,s.attachWorkDone)(a,t),(0,s.attachPartialResult)(a,t)))),onFoldingRanges:e=>a.onRequest(i.FoldingRangeRequest.type,((t,n)=>e(t,n,(0,s.attachWorkDone)(a,t),(0,s.attachPartialResult)(a,t)))),onSelectionRanges:e=>a.onRequest(i.SelectionRangeRequest.type,((t,n)=>e(t,n,(0,s.attachWorkDone)(a,t),(0,s.attachPartialResult)(a,t)))),onExecuteCommand:e=>a.onRequest(i.ExecuteCommandRequest.type,((t,n)=>e(t,n,(0,s.attachWorkDone)(a,t),void 0))),dispose:()=>a.dispose()};for(let e of g)e.attach(b);return a.onRequest(i.InitializeRequest.type,(e=>{t.initialize(e),o.string(e.trace)&&(c.trace=i.Trace.fromString(e.trace));for(let t of g)t.initialize(e.capabilities);if(y){let t=y(e,(new i.CancellationTokenSource).token,(0,s.attachWorkDone)(a,e),void 0);return(n=t,n instanceof Promise?n:o.thenable(n)?new Promise(((e,t)=>{n.then((t=>e(t)),(e=>t(e)))})):Promise.resolve(n)).then((e=>{if(e instanceof i.ResponseError)return e;let t=e;t||(t={capabilities:{}});let n=t.capabilities;n||(n={},t.capabilities=n),void 0===n.textDocumentSync||null===n.textDocumentSync?n.textDocumentSync=o.number(b.__textDocumentSync)?b.__textDocumentSync:i.TextDocumentSyncKind.None:o.number(n.textDocumentSync)||o.number(n.textDocumentSync.change)||(n.textDocumentSync.change=o.number(b.__textDocumentSync)?b.__textDocumentSync:i.TextDocumentSyncKind.None);for(let e of g)e.fillServerCapabilities(n);return t}))}{let e={capabilities:{textDocumentSync:i.TextDocumentSyncKind.None}};for(let t of g)t.fillServerCapabilities(e.capabilities);return e}var n})),a.onRequest(i.ShutdownRequest.type,(()=>(t.shutdownReceived=!0,m?m((new i.CancellationTokenSource).token):void 0))),a.onNotification(i.ExitNotification.type,(()=>{try{_&&_()}finally{t.shutdownReceived?t.exit(0):t.exit(1)}})),a.onNotification(i.SetTraceNotification.type,(e=>{c.trace=i.Trace.fromString(e.value)})),b}},9283:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ShowDocumentFeature=void 0;const i=n(5968);t.ShowDocumentFeature=e=>class extends e{showDocument(e){return this.connection.sendRequest(i.ShowDocumentRequest.type,e)}}},7086:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TextDocuments=void 0;const i=n(5968);t.TextDocuments=class{constructor(e){this._configuration=e,this._syncedDocuments=new Map,this._onDidChangeContent=new i.Emitter,this._onDidOpen=new i.Emitter,this._onDidClose=new i.Emitter,this._onDidSave=new i.Emitter,this._onWillSave=new i.Emitter}get onDidOpen(){return this._onDidOpen.event}get onDidChangeContent(){return this._onDidChangeContent.event}get onWillSave(){return this._onWillSave.event}onWillSaveWaitUntil(e){this._willSaveWaitUntil=e}get onDidSave(){return this._onDidSave.event}get onDidClose(){return this._onDidClose.event}get(e){return this._syncedDocuments.get(e)}all(){return Array.from(this._syncedDocuments.values())}keys(){return Array.from(this._syncedDocuments.keys())}listen(e){e.__textDocumentSync=i.TextDocumentSyncKind.Incremental;const t=[];return t.push(e.onDidOpenTextDocument((e=>{const t=e.textDocument,n=this._configuration.create(t.uri,t.languageId,t.version,t.text);this._syncedDocuments.set(t.uri,n);const i=Object.freeze({document:n});this._onDidOpen.fire(i),this._onDidChangeContent.fire(i)}))),t.push(e.onDidChangeTextDocument((e=>{const t=e.textDocument,n=e.contentChanges;if(0===n.length)return;const{version:i}=t;if(null==i)throw new Error(`Received document change event for ${t.uri} without valid version identifier`);let o=this._syncedDocuments.get(t.uri);void 0!==o&&(o=this._configuration.update(o,n,i),this._syncedDocuments.set(t.uri,o),this._onDidChangeContent.fire(Object.freeze({document:o})))}))),t.push(e.onDidCloseTextDocument((e=>{let t=this._syncedDocuments.get(e.textDocument.uri);void 0!==t&&(this._syncedDocuments.delete(e.textDocument.uri),this._onDidClose.fire(Object.freeze({document:t})))}))),t.push(e.onWillSaveTextDocument((e=>{let t=this._syncedDocuments.get(e.textDocument.uri);void 0!==t&&this._onWillSave.fire(Object.freeze({document:t,reason:e.reason}))}))),t.push(e.onWillSaveTextDocumentWaitUntil(((e,t)=>{let n=this._syncedDocuments.get(e.textDocument.uri);return void 0!==n&&this._willSaveWaitUntil?this._willSaveWaitUntil(Object.freeze({document:n,reason:e.reason}),t):[]}))),t.push(e.onDidSaveTextDocument((e=>{let t=this._syncedDocuments.get(e.textDocument.uri);void 0!==t&&this._onDidSave.fire(Object.freeze({document:t}))}))),i.Disposable.create((()=>{t.forEach((e=>e.dispose()))}))}}},7350:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TypeHierarchyFeature=void 0;const i=n(5968);t.TypeHierarchyFeature=e=>class extends e{get typeHierarchy(){return{onPrepare:e=>this.connection.onRequest(i.TypeHierarchyPrepareRequest.type,((t,n)=>e(t,n,this.attachWorkDoneProgress(t),void 0))),onSupertypes:e=>{const t=i.TypeHierarchySupertypesRequest.type;return this.connection.onRequest(t,((n,i)=>e(n,i,this.attachWorkDoneProgress(n),this.attachPartialResultProgress(t,n))))},onSubtypes:e=>{const t=i.TypeHierarchySubtypesRequest.type;return this.connection.onRequest(t,((n,i)=>e(n,i,this.attachWorkDoneProgress(n),this.attachPartialResultProgress(t,n))))}}}}},6960:(e,t)=>{"use strict";function n(e){return"string"==typeof e||e instanceof String}function i(e){return"function"==typeof e}function o(e){return Array.isArray(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.thenable=t.typedArray=t.stringArray=t.array=t.func=t.error=t.number=t.string=t.boolean=void 0,t.boolean=function(e){return!0===e||!1===e},t.string=n,t.number=function(e){return"number"==typeof e||e instanceof Number},t.error=function(e){return e instanceof Error},t.func=i,t.array=o,t.stringArray=function(e){return o(e)&&e.every((e=>n(e)))},t.typedArray=function(e,t){return Array.isArray(e)&&e.every(t)},t.thenable=function(e){return e&&i(e.then)}},7867:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.generateUuid=t.parse=t.isUUID=t.v4=t.empty=void 0;class n{constructor(e){this._value=e}asHex(){return this._value}equals(e){return this.asHex()===e.asHex()}}class i extends n{static _oneOf(e){return e[Math.floor(e.length*Math.random())]}static _randomHex(){return i._oneOf(i._chars)}constructor(){super([i._randomHex(),i._randomHex(),i._randomHex(),i._randomHex(),i._randomHex(),i._randomHex(),i._randomHex(),i._randomHex(),"-",i._randomHex(),i._randomHex(),i._randomHex(),i._randomHex(),"-","4",i._randomHex(),i._randomHex(),i._randomHex(),"-",i._oneOf(i._timeHighBits),i._randomHex(),i._randomHex(),i._randomHex(),"-",i._randomHex(),i._randomHex(),i._randomHex(),i._randomHex(),i._randomHex(),i._randomHex(),i._randomHex(),i._randomHex(),i._randomHex(),i._randomHex(),i._randomHex(),i._randomHex()].join(""))}}function o(){return new i}i._chars=["0","1","2","3","4","5","6","6","7","8","9","a","b","c","d","e","f"],i._timeHighBits=["8","9","a","b"],t.empty=new n("00000000-0000-0000-0000-000000000000"),t.v4=o;const r=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;function s(e){return r.test(e)}t.isUUID=s,t.parse=function(e){if(!s(e))throw new Error("invalid uuid");return new n(e)},t.generateUuid=function(){return o().asHex()}},2268:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WorkspaceFoldersFeature=void 0;const i=n(5968);t.WorkspaceFoldersFeature=e=>class extends e{constructor(){super(),this._notificationIsAutoRegistered=!1}initialize(e){super.initialize(e);let t=e.workspace;t&&t.workspaceFolders&&(this._onDidChangeWorkspaceFolders=new i.Emitter,this.connection.onNotification(i.DidChangeWorkspaceFoldersNotification.type,(e=>{this._onDidChangeWorkspaceFolders.fire(e.event)})))}fillServerCapabilities(e){super.fillServerCapabilities(e);const t=e.workspace?.workspaceFolders?.changeNotifications;this._notificationIsAutoRegistered=!0===t||"string"==typeof t}getWorkspaceFolders(){return this.connection.sendRequest(i.WorkspaceFoldersRequest.type)}get onDidChangeWorkspaceFolders(){if(!this._onDidChangeWorkspaceFolders)throw new Error("Client doesn't support sending workspace folder change events.");return this._notificationIsAutoRegistered||this._unregistration||(this._unregistration=this.connection.client.register(i.DidChangeWorkspaceFoldersNotification.type)),this._onDidChangeWorkspaceFolders.event}}},7237:function(e){var t;t=()=>(()=>{"use strict";var e={470:e=>{function t(e){if("string"!=typeof e)throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}function n(e,t){for(var n,i="",o=0,r=-1,s=0,a=0;a<=e.length;++a){if(a<e.length)n=e.charCodeAt(a);else{if(47===n)break;n=47}if(47===n){if(r===a-1||1===s);else if(r!==a-1&&2===s){if(i.length<2||2!==o||46!==i.charCodeAt(i.length-1)||46!==i.charCodeAt(i.length-2))if(i.length>2){var c=i.lastIndexOf("/");if(c!==i.length-1){-1===c?(i="",o=0):o=(i=i.slice(0,c)).length-1-i.lastIndexOf("/"),r=a,s=0;continue}}else if(2===i.length||1===i.length){i="",o=0,r=a,s=0;continue}t&&(i.length>0?i+="/..":i="..",o=2)}else i.length>0?i+="/"+e.slice(r+1,a):i=e.slice(r+1,a),o=a-r-1;r=a,s=0}else 46===n&&-1!==s?++s:s=-1}return i}var i={resolve:function(){for(var e,i="",o=!1,r=arguments.length-1;r>=-1&&!o;r--){var s;r>=0?s=arguments[r]:(void 0===e&&(e=process.cwd()),s=e),t(s),0!==s.length&&(i=s+"/"+i,o=47===s.charCodeAt(0))}return i=n(i,!o),o?i.length>0?"/"+i:"/":i.length>0?i:"."},normalize:function(e){if(t(e),0===e.length)return".";var i=47===e.charCodeAt(0),o=47===e.charCodeAt(e.length-1);return 0!==(e=n(e,!i)).length||i||(e="."),e.length>0&&o&&(e+="/"),i?"/"+e:e},isAbsolute:function(e){return t(e),e.length>0&&47===e.charCodeAt(0)},join:function(){if(0===arguments.length)return".";for(var e,n=0;n<arguments.length;++n){var o=arguments[n];t(o),o.length>0&&(void 0===e?e=o:e+="/"+o)}return void 0===e?".":i.normalize(e)},relative:function(e,n){if(t(e),t(n),e===n)return"";if((e=i.resolve(e))===(n=i.resolve(n)))return"";for(var o=1;o<e.length&&47===e.charCodeAt(o);++o);for(var r=e.length,s=r-o,a=1;a<n.length&&47===n.charCodeAt(a);++a);for(var c=n.length-a,l=s<c?s:c,d=-1,u=0;u<=l;++u){if(u===l){if(c>l){if(47===n.charCodeAt(a+u))return n.slice(a+u+1);if(0===u)return n.slice(a+u)}else s>l&&(47===e.charCodeAt(o+u)?d=u:0===u&&(d=0));break}var f=e.charCodeAt(o+u);if(f!==n.charCodeAt(a+u))break;47===f&&(d=u)}var p="";for(u=o+d+1;u<=r;++u)u!==r&&47!==e.charCodeAt(u)||(0===p.length?p+="..":p+="/..");return p.length>0?p+n.slice(a+d):(a+=d,47===n.charCodeAt(a)&&++a,n.slice(a))},_makeLong:function(e){return e},dirname:function(e){if(t(e),0===e.length)return".";for(var n=e.charCodeAt(0),i=47===n,o=-1,r=!0,s=e.length-1;s>=1;--s)if(47===(n=e.charCodeAt(s))){if(!r){o=s;break}}else r=!1;return-1===o?i?"/":".":i&&1===o?"//":e.slice(0,o)},basename:function(e,n){if(void 0!==n&&"string"!=typeof n)throw new TypeError('"ext" argument must be a string');t(e);var i,o=0,r=-1,s=!0;if(void 0!==n&&n.length>0&&n.length<=e.length){if(n.length===e.length&&n===e)return"";var a=n.length-1,c=-1;for(i=e.length-1;i>=0;--i){var l=e.charCodeAt(i);if(47===l){if(!s){o=i+1;break}}else-1===c&&(s=!1,c=i+1),a>=0&&(l===n.charCodeAt(a)?-1==--a&&(r=i):(a=-1,r=c))}return o===r?r=c:-1===r&&(r=e.length),e.slice(o,r)}for(i=e.length-1;i>=0;--i)if(47===e.charCodeAt(i)){if(!s){o=i+1;break}}else-1===r&&(s=!1,r=i+1);return-1===r?"":e.slice(o,r)},extname:function(e){t(e);for(var n=-1,i=0,o=-1,r=!0,s=0,a=e.length-1;a>=0;--a){var c=e.charCodeAt(a);if(47!==c)-1===o&&(r=!1,o=a+1),46===c?-1===n?n=a:1!==s&&(s=1):-1!==n&&(s=-1);else if(!r){i=a+1;break}}return-1===n||-1===o||0===s||1===s&&n===o-1&&n===i+1?"":e.slice(n,o)},format:function(e){if(null===e||"object"!=typeof e)throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof e);return function(e,t){var n=t.dir||t.root,i=t.base||(t.name||"")+(t.ext||"");return n?n===t.root?n+i:n+"/"+i:i}(0,e)},parse:function(e){t(e);var n={root:"",dir:"",base:"",ext:"",name:""};if(0===e.length)return n;var i,o=e.charCodeAt(0),r=47===o;r?(n.root="/",i=1):i=0;for(var s=-1,a=0,c=-1,l=!0,d=e.length-1,u=0;d>=i;--d)if(47!==(o=e.charCodeAt(d)))-1===c&&(l=!1,c=d+1),46===o?-1===s?s=d:1!==u&&(u=1):-1!==s&&(u=-1);else if(!l){a=d+1;break}return-1===s||-1===c||0===u||1===u&&s===c-1&&s===a+1?-1!==c&&(n.base=n.name=0===a&&r?e.slice(1,c):e.slice(a,c)):(0===a&&r?(n.name=e.slice(1,s),n.base=e.slice(1,c)):(n.name=e.slice(a,s),n.base=e.slice(a,c)),n.ext=e.slice(s,c)),a>0?n.dir=e.slice(0,a-1):r&&(n.dir="/"),n},sep:"/",delimiter:":",win32:null,posix:null};i.posix=i,e.exports=i},674:(e,t)=>{if(Object.defineProperty(t,"__esModule",{value:!0}),t.isWindows=void 0,"object"==typeof process)t.isWindows="win32"===process.platform;else if("object"==typeof navigator){let e=navigator.userAgent;t.isWindows=e.indexOf("Windows")>=0}},796:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.uriToFsPath=t.URI=void 0;const i=n(674),o=/^\w[\w\d+.-]*$/,r=/^\//,s=/^\/\//;function a(e,t){if(!e.scheme&&t)throw new Error(`[UriError]: Scheme is missing: {scheme: "", authority: "${e.authority}", path: "${e.path}", query: "${e.query}", fragment: "${e.fragment}"}`);if(e.scheme&&!o.test(e.scheme))throw new Error("[UriError]: Scheme contains illegal characters.");if(e.path)if(e.authority){if(!r.test(e.path))throw new Error('[UriError]: If a URI contains an authority component, then the path component must either be empty or begin with a slash ("/") character')}else if(s.test(e.path))throw new Error('[UriError]: If a URI does not contain an authority component, then the path cannot begin with two slash characters ("//")')}const c="",l="/",d=/^(([^:/?#]+?):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/;class u{static isUri(e){return e instanceof u||!!e&&"string"==typeof e.authority&&"string"==typeof e.fragment&&"string"==typeof e.path&&"string"==typeof e.query&&"string"==typeof e.scheme&&"string"==typeof e.fsPath&&"function"==typeof e.with&&"function"==typeof e.toString}scheme;authority;path;query;fragment;constructor(e,t,n,i,o,r=!1){"object"==typeof e?(this.scheme=e.scheme||c,this.authority=e.authority||c,this.path=e.path||c,this.query=e.query||c,this.fragment=e.fragment||c):(this.scheme=function(e,t){return e||t?e:"file"}(e,r),this.authority=t||c,this.path=function(e,t){switch(e){case"https":case"http":case"file":t?t[0]!==l&&(t=l+t):t=l}return t}(this.scheme,n||c),this.query=i||c,this.fragment=o||c,a(this,r))}get fsPath(){return y(this,!1)}with(e){if(!e)return this;let{scheme:t,authority:n,path:i,query:o,fragment:r}=e;return void 0===t?t=this.scheme:null===t&&(t=c),void 0===n?n=this.authority:null===n&&(n=c),void 0===i?i=this.path:null===i&&(i=c),void 0===o?o=this.query:null===o&&(o=c),void 0===r?r=this.fragment:null===r&&(r=c),t===this.scheme&&n===this.authority&&i===this.path&&o===this.query&&r===this.fragment?this:new p(t,n,i,o,r)}static parse(e,t=!1){const n=d.exec(e);return n?new p(n[2]||c,k(n[4]||c),k(n[5]||c),k(n[7]||c),k(n[9]||c),t):new p(c,c,c,c,c)}static file(e){let t=c;if(i.isWindows&&(e=e.replace(/\\/g,l)),e[0]===l&&e[1]===l){const n=e.indexOf(l,2);-1===n?(t=e.substring(2),e=l):(t=e.substring(2,n),e=e.substring(n)||l)}return new p("file",t,e,c,c)}static from(e){const t=new p(e.scheme,e.authority,e.path,e.query,e.fragment);return a(t,!0),t}toString(e=!1){return _(this,e)}toJSON(){return this}static revive(e){if(e){if(e instanceof u)return e;{const t=new p(e);return t._formatted=e.external,t._fsPath=e._sep===f?e.fsPath:null,t}}return e}}t.URI=u;const f=i.isWindows?1:void 0;class p extends u{_formatted=null;_fsPath=null;get fsPath(){return this._fsPath||(this._fsPath=y(this,!1)),this._fsPath}toString(e=!1){return e?_(this,!0):(this._formatted||(this._formatted=_(this,!1)),this._formatted)}toJSON(){const e={$mid:1};return this._fsPath&&(e.fsPath=this._fsPath,e._sep=f),this._formatted&&(e.external=this._formatted),this.path&&(e.path=this.path),this.scheme&&(e.scheme=this.scheme),this.authority&&(e.authority=this.authority),this.query&&(e.query=this.query),this.fragment&&(e.fragment=this.fragment),e}}const h={58:"%3A",47:"%2F",63:"%3F",35:"%23",91:"%5B",93:"%5D",64:"%40",33:"%21",36:"%24",38:"%26",39:"%27",40:"%28",41:"%29",42:"%2A",43:"%2B",44:"%2C",59:"%3B",61:"%3D",32:"%20"};function g(e,t,n){let i,o=-1;for(let r=0;r<e.length;r++){const s=e.charCodeAt(r);if(s>=97&&s<=122||s>=65&&s<=90||s>=48&&s<=57||45===s||46===s||95===s||126===s||t&&47===s||n&&91===s||n&&93===s||n&&58===s)-1!==o&&(i+=encodeURIComponent(e.substring(o,r)),o=-1),void 0!==i&&(i+=e.charAt(r));else{void 0===i&&(i=e.substr(0,r));const t=h[s];void 0!==t?(-1!==o&&(i+=encodeURIComponent(e.substring(o,r)),o=-1),i+=t):-1===o&&(o=r)}}return-1!==o&&(i+=encodeURIComponent(e.substring(o))),void 0!==i?i:e}function m(e){let t;for(let n=0;n<e.length;n++){const i=e.charCodeAt(n);35===i||63===i?(void 0===t&&(t=e.substr(0,n)),t+=h[i]):void 0!==t&&(t+=e[n])}return void 0!==t?t:e}function y(e,t){let n;return n=e.authority&&e.path.length>1&&"file"===e.scheme?`//${e.authority}${e.path}`:47===e.path.charCodeAt(0)&&(e.path.charCodeAt(1)>=65&&e.path.charCodeAt(1)<=90||e.path.charCodeAt(1)>=97&&e.path.charCodeAt(1)<=122)&&58===e.path.charCodeAt(2)?t?e.path.substr(1):e.path[1].toLowerCase()+e.path.substr(2):e.path,i.isWindows&&(n=n.replace(/\//g,"\\")),n}function _(e,t){const n=t?m:g;let i="",{scheme:o,authority:r,path:s,query:a,fragment:c}=e;if(o&&(i+=o,i+=":"),(r||"file"===o)&&(i+=l,i+=l),r){let e=r.indexOf("@");if(-1!==e){const t=r.substr(0,e);r=r.substr(e+1),e=t.lastIndexOf(":"),-1===e?i+=n(t,!1,!1):(i+=n(t.substr(0,e),!1,!1),i+=":",i+=n(t.substr(e+1),!1,!0)),i+="@"}r=r.toLowerCase(),e=r.lastIndexOf(":"),-1===e?i+=n(r,!1,!0):(i+=n(r.substr(0,e),!1,!0),i+=r.substr(e))}if(s){if(s.length>=3&&47===s.charCodeAt(0)&&58===s.charCodeAt(2)){const e=s.charCodeAt(1);e>=65&&e<=90&&(s=`/${String.fromCharCode(e+32)}:${s.substr(3)}`)}else if(s.length>=2&&58===s.charCodeAt(1)){const e=s.charCodeAt(0);e>=65&&e<=90&&(s=`${String.fromCharCode(e+32)}:${s.substr(2)}`)}i+=n(s,!0,!1)}return a&&(i+="?",i+=n(a,!1,!1)),c&&(i+="#",i+=t?c:g(c,!1,!1)),i}function b(e){try{return decodeURIComponent(e)}catch{return e.length>3?e.substr(0,3)+b(e.substr(3)):e}}t.uriToFsPath=y;const v=/(%[0-9A-Za-z][0-9A-Za-z])+/g;function k(e){return e.match(v)?e.replace(v,(e=>b(e))):e}},679:function(e,t,n){var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,o)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return o(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Utils=void 0;const s=r(n(470)),a=s.posix||s,c="/";var l;!function(e){e.joinPath=function(e,...t){return e.with({path:a.join(e.path,...t)})},e.resolvePath=function(e,...t){let n=e.path,i=!1;n[0]!==c&&(n=c+n,i=!0);let o=a.resolve(n,...t);return i&&o[0]===c&&!e.authority&&(o=o.substring(1)),e.with({path:o})},e.dirname=function(e){if(0===e.path.length||e.path===c)return e;let t=a.dirname(e.path);return 1===t.length&&46===t.charCodeAt(0)&&(t=""),e.with({path:t})},e.basename=function(e){return a.basename(e.path)},e.extname=function(e){return a.extname(e.path)}}(l||(t.Utils=l={}))}},t={};function n(i){var o=t[i];if(void 0!==o)return o.exports;var r=t[i]={exports:{}};return e[i].call(r.exports,r,r.exports,n),r.exports}var i={};return(()=>{var e=i;Object.defineProperty(e,"__esModule",{value:!0}),e.Utils=e.URI=void 0;const t=n(796);Object.defineProperty(e,"URI",{enumerable:!0,get:function(){return t.URI}});const o=n(679);Object.defineProperty(e,"Utils",{enumerable:!0,get:function(){return o.Utils}})})(),i})(),e.exports=t()},7351:()=>{},1727:(e,t,n)=>{"use strict";n.r(t),n.d(t,{TextDocument:()=>o});class i{constructor(e,t,n,i){this._uri=e,this._languageId=t,this._version=n,this._content=i,this._lineOffsets=void 0}get uri(){return this._uri}get languageId(){return this._languageId}get version(){return this._version}getText(e){if(e){const t=this.offsetAt(e.start),n=this.offsetAt(e.end);return this._content.substring(t,n)}return this._content}update(e,t){for(let t of e)if(i.isIncremental(t)){const e=a(t.range),n=this.offsetAt(e.start),i=this.offsetAt(e.end);this._content=this._content.substring(0,n)+t.text+this._content.substring(i,this._content.length);const o=Math.max(e.start.line,0),r=Math.max(e.end.line,0);let c=this._lineOffsets;const l=s(t.text,!1,n);if(r-o===l.length)for(let e=0,t=l.length;e<t;e++)c[e+o+1]=l[e];else l.length<1e4?c.splice(o+1,r-o,...l):this._lineOffsets=c=c.slice(0,o+1).concat(l,c.slice(r+1));const d=t.text.length-(i-n);if(0!==d)for(let e=o+1+l.length,t=c.length;e<t;e++)c[e]=c[e]+d}else{if(!i.isFull(t))throw new Error("Unknown change event received");this._content=t.text,this._lineOffsets=void 0}this._version=t}getLineOffsets(){return void 0===this._lineOffsets&&(this._lineOffsets=s(this._content,!0)),this._lineOffsets}positionAt(e){e=Math.max(Math.min(e,this._content.length),0);let t=this.getLineOffsets(),n=0,i=t.length;if(0===i)return{line:0,character:e};for(;n<i;){let o=Math.floor((n+i)/2);t[o]>e?i=o:n=o+1}let o=n-1;return{line:o,character:e-t[o]}}offsetAt(e){let t=this.getLineOffsets();if(e.line>=t.length)return this._content.length;if(e.line<0)return 0;let n=t[e.line],i=e.line+1<t.length?t[e.line+1]:this._content.length;return Math.max(Math.min(n+e.character,i),n)}get lineCount(){return this.getLineOffsets().length}static isIncremental(e){let t=e;return null!=t&&"string"==typeof t.text&&void 0!==t.range&&(void 0===t.rangeLength||"number"==typeof t.rangeLength)}static isFull(e){let t=e;return null!=t&&"string"==typeof t.text&&void 0===t.range&&void 0===t.rangeLength}}var o;function r(e,t){if(e.length<=1)return e;const n=e.length/2|0,i=e.slice(0,n),o=e.slice(n);r(i,t),r(o,t);let s=0,a=0,c=0;for(;s<i.length&&a<o.length;){let n=t(i[s],o[a]);e[c++]=n<=0?i[s++]:o[a++]}for(;s<i.length;)e[c++]=i[s++];for(;a<o.length;)e[c++]=o[a++];return e}function s(e,t,n=0){const i=t?[n]:[];for(let t=0;t<e.length;t++){let o=e.charCodeAt(t);13!==o&&10!==o||(13===o&&t+1<e.length&&10===e.charCodeAt(t+1)&&t++,i.push(n+t+1))}return i}function a(e){const t=e.start,n=e.end;return t.line>n.line||t.line===n.line&&t.character>n.character?{start:n,end:t}:e}function c(e){const t=a(e.range);return t!==e.range?{newText:e.newText,range:t}:e}!function(e){e.create=function(e,t,n,o){return new i(e,t,n,o)},e.update=function(e,t,n){if(e instanceof i)return e.update(t,n),e;throw new Error("TextDocument.update: document must be created by TextDocument.create")},e.applyEdits=function(e,t){let n=e.getText(),i=r(t.map(c),((e,t)=>{let n=e.range.start.line-t.range.start.line;return 0===n?e.range.start.character-t.range.start.character:n})),o=0;const s=[];for(const t of i){let i=e.offsetAt(t.range.start);if(i<o)throw new Error("Overlapping edit");i>o&&s.push(n.substring(o,i)),t.newText.length&&s.push(t.newText),o=e.offsetAt(t.range.end)}return s.push(n.substr(o)),s.join("")}}(o||(o={}))},1516:(e,t,n)=>{"use strict";var i,o,r,s,a,c,l,d,u,f,p,h,g,m,y,_,b,v,k,T,R,S,w,D,C,x,K,O,E,P,A,M,N,q,L,I,F,j,W,$,U,V,B,H,z,G,X,Q,J,Y,Z,ee,te,ne,ie,oe,re,se,ae,ce,le,de,ue,fe,pe,he,ge,me,ye,_e,be,ve,ke,Te,Re,Se,we,De;n.r(t),n.d(t,{AnnotatedTextEdit:()=>w,ChangeAnnotation:()=>R,ChangeAnnotationIdentifier:()=>S,CodeAction:()=>re,CodeActionContext:()=>oe,CodeActionKind:()=>ne,CodeActionTriggerKind:()=>ie,CodeDescription:()=>b,CodeLens:()=>se,Color:()=>u,ColorInformation:()=>f,ColorPresentation:()=>p,Command:()=>k,CompletionItem:()=>U,CompletionItemKind:()=>L,CompletionItemLabelDetails:()=>$,CompletionItemTag:()=>F,CompletionList:()=>V,CreateFile:()=>C,DeleteFile:()=>K,Diagnostic:()=>v,DiagnosticRelatedInformation:()=>m,DiagnosticSeverity:()=>y,DiagnosticTag:()=>_,DocumentHighlight:()=>Q,DocumentHighlightKind:()=>X,DocumentLink:()=>ce,DocumentSymbol:()=>te,DocumentUri:()=>i,EOL:()=>Oe,FoldingRange:()=>g,FoldingRangeKind:()=>h,FormattingOptions:()=>ae,Hover:()=>H,InlayHint:()=>be,InlayHintKind:()=>ye,InlayHintLabelPart:()=>_e,InlineCompletionContext:()=>we,InlineCompletionItem:()=>ke,InlineCompletionList:()=>Te,InlineCompletionTriggerKind:()=>Re,InlineValueContext:()=>me,InlineValueEvaluatableExpression:()=>ge,InlineValueText:()=>pe,InlineValueVariableLookup:()=>he,InsertReplaceEdit:()=>j,InsertTextFormat:()=>I,InsertTextMode:()=>W,Location:()=>l,LocationLink:()=>d,MarkedString:()=>B,MarkupContent:()=>q,MarkupKind:()=>N,OptionalVersionedTextDocumentIdentifier:()=>A,ParameterInformation:()=>z,Position:()=>a,Range:()=>c,RenameFile:()=>x,SelectedCompletionInfo:()=>Se,SelectionRange:()=>le,SemanticTokenModifiers:()=>ue,SemanticTokenTypes:()=>de,SemanticTokens:()=>fe,SignatureInformation:()=>G,StringValue:()=>ve,SymbolInformation:()=>Z,SymbolKind:()=>J,SymbolTag:()=>Y,TextDocument:()=>Ee,TextDocumentEdit:()=>D,TextDocumentIdentifier:()=>E,TextDocumentItem:()=>M,TextEdit:()=>T,URI:()=>o,VersionedTextDocumentIdentifier:()=>P,WorkspaceChange:()=>Ke,WorkspaceEdit:()=>O,WorkspaceFolder:()=>De,WorkspaceSymbol:()=>ee,integer:()=>r,uinteger:()=>s}),function(e){e.is=function(e){return"string"==typeof e}}(i||(i={})),function(e){e.is=function(e){return"string"==typeof e}}(o||(o={})),function(e){e.MIN_VALUE=-2147483648,e.MAX_VALUE=2147483647,e.is=function(t){return"number"==typeof t&&e.MIN_VALUE<=t&&t<=e.MAX_VALUE}}(r||(r={})),function(e){e.MIN_VALUE=0,e.MAX_VALUE=2147483647,e.is=function(t){return"number"==typeof t&&e.MIN_VALUE<=t&&t<=e.MAX_VALUE}}(s||(s={})),function(e){e.create=function(e,t){return e===Number.MAX_VALUE&&(e=s.MAX_VALUE),t===Number.MAX_VALUE&&(t=s.MAX_VALUE),{line:e,character:t}},e.is=function(e){let t=e;return Pe.objectLiteral(t)&&Pe.uinteger(t.line)&&Pe.uinteger(t.character)}}(a||(a={})),function(e){e.create=function(e,t,n,i){if(Pe.uinteger(e)&&Pe.uinteger(t)&&Pe.uinteger(n)&&Pe.uinteger(i))return{start:a.create(e,t),end:a.create(n,i)};if(a.is(e)&&a.is(t))return{start:e,end:t};throw new Error(`Range#create called with invalid arguments[${e}, ${t}, ${n}, ${i}]`)},e.is=function(e){let t=e;return Pe.objectLiteral(t)&&a.is(t.start)&&a.is(t.end)}}(c||(c={})),function(e){e.create=function(e,t){return{uri:e,range:t}},e.is=function(e){let t=e;return Pe.objectLiteral(t)&&c.is(t.range)&&(Pe.string(t.uri)||Pe.undefined(t.uri))}}(l||(l={})),function(e){e.create=function(e,t,n,i){return{targetUri:e,targetRange:t,targetSelectionRange:n,originSelectionRange:i}},e.is=function(e){let t=e;return Pe.objectLiteral(t)&&c.is(t.targetRange)&&Pe.string(t.targetUri)&&c.is(t.targetSelectionRange)&&(c.is(t.originSelectionRange)||Pe.undefined(t.originSelectionRange))}}(d||(d={})),function(e){e.create=function(e,t,n,i){return{red:e,green:t,blue:n,alpha:i}},e.is=function(e){const t=e;return Pe.objectLiteral(t)&&Pe.numberRange(t.red,0,1)&&Pe.numberRange(t.green,0,1)&&Pe.numberRange(t.blue,0,1)&&Pe.numberRange(t.alpha,0,1)}}(u||(u={})),function(e){e.create=function(e,t){return{range:e,color:t}},e.is=function(e){const t=e;return Pe.objectLiteral(t)&&c.is(t.range)&&u.is(t.color)}}(f||(f={})),function(e){e.create=function(e,t,n){return{label:e,textEdit:t,additionalTextEdits:n}},e.is=function(e){const t=e;return Pe.objectLiteral(t)&&Pe.string(t.label)&&(Pe.undefined(t.textEdit)||T.is(t))&&(Pe.undefined(t.additionalTextEdits)||Pe.typedArray(t.additionalTextEdits,T.is))}}(p||(p={})),function(e){e.Comment="comment",e.Imports="imports",e.Region="region"}(h||(h={})),function(e){e.create=function(e,t,n,i,o,r){const s={startLine:e,endLine:t};return Pe.defined(n)&&(s.startCharacter=n),Pe.defined(i)&&(s.endCharacter=i),Pe.defined(o)&&(s.kind=o),Pe.defined(r)&&(s.collapsedText=r),s},e.is=function(e){const t=e;return Pe.objectLiteral(t)&&Pe.uinteger(t.startLine)&&Pe.uinteger(t.startLine)&&(Pe.undefined(t.startCharacter)||Pe.uinteger(t.startCharacter))&&(Pe.undefined(t.endCharacter)||Pe.uinteger(t.endCharacter))&&(Pe.undefined(t.kind)||Pe.string(t.kind))}}(g||(g={})),function(e){e.create=function(e,t){return{location:e,message:t}},e.is=function(e){let t=e;return Pe.defined(t)&&l.is(t.location)&&Pe.string(t.message)}}(m||(m={})),function(e){e.Error=1,e.Warning=2,e.Information=3,e.Hint=4}(y||(y={})),function(e){e.Unnecessary=1,e.Deprecated=2}(_||(_={})),function(e){e.is=function(e){const t=e;return Pe.objectLiteral(t)&&Pe.string(t.href)}}(b||(b={})),function(e){e.create=function(e,t,n,i,o,r){let s={range:e,message:t};return Pe.defined(n)&&(s.severity=n),Pe.defined(i)&&(s.code=i),Pe.defined(o)&&(s.source=o),Pe.defined(r)&&(s.relatedInformation=r),s},e.is=function(e){var t;let n=e;return Pe.defined(n)&&c.is(n.range)&&Pe.string(n.message)&&(Pe.number(n.severity)||Pe.undefined(n.severity))&&(Pe.integer(n.code)||Pe.string(n.code)||Pe.undefined(n.code))&&(Pe.undefined(n.codeDescription)||Pe.string(null===(t=n.codeDescription)||void 0===t?void 0:t.href))&&(Pe.string(n.source)||Pe.undefined(n.source))&&(Pe.undefined(n.relatedInformation)||Pe.typedArray(n.relatedInformation,m.is))}}(v||(v={})),function(e){e.create=function(e,t,...n){let i={title:e,command:t};return Pe.defined(n)&&n.length>0&&(i.arguments=n),i},e.is=function(e){let t=e;return Pe.defined(t)&&Pe.string(t.title)&&Pe.string(t.command)}}(k||(k={})),function(e){e.replace=function(e,t){return{range:e,newText:t}},e.insert=function(e,t){return{range:{start:e,end:e},newText:t}},e.del=function(e){return{range:e,newText:""}},e.is=function(e){const t=e;return Pe.objectLiteral(t)&&Pe.string(t.newText)&&c.is(t.range)}}(T||(T={})),function(e){e.create=function(e,t,n){const i={label:e};return void 0!==t&&(i.needsConfirmation=t),void 0!==n&&(i.description=n),i},e.is=function(e){const t=e;return Pe.objectLiteral(t)&&Pe.string(t.label)&&(Pe.boolean(t.needsConfirmation)||void 0===t.needsConfirmation)&&(Pe.string(t.description)||void 0===t.description)}}(R||(R={})),function(e){e.is=function(e){const t=e;return Pe.string(t)}}(S||(S={})),function(e){e.replace=function(e,t,n){return{range:e,newText:t,annotationId:n}},e.insert=function(e,t,n){return{range:{start:e,end:e},newText:t,annotationId:n}},e.del=function(e,t){return{range:e,newText:"",annotationId:t}},e.is=function(e){const t=e;return T.is(t)&&(R.is(t.annotationId)||S.is(t.annotationId))}}(w||(w={})),function(e){e.create=function(e,t){return{textDocument:e,edits:t}},e.is=function(e){let t=e;return Pe.defined(t)&&A.is(t.textDocument)&&Array.isArray(t.edits)}}(D||(D={})),function(e){e.create=function(e,t,n){let i={kind:"create",uri:e};return void 0===t||void 0===t.overwrite&&void 0===t.ignoreIfExists||(i.options=t),void 0!==n&&(i.annotationId=n),i},e.is=function(e){let t=e;return t&&"create"===t.kind&&Pe.string(t.uri)&&(void 0===t.options||(void 0===t.options.overwrite||Pe.boolean(t.options.overwrite))&&(void 0===t.options.ignoreIfExists||Pe.boolean(t.options.ignoreIfExists)))&&(void 0===t.annotationId||S.is(t.annotationId))}}(C||(C={})),function(e){e.create=function(e,t,n,i){let o={kind:"rename",oldUri:e,newUri:t};return void 0===n||void 0===n.overwrite&&void 0===n.ignoreIfExists||(o.options=n),void 0!==i&&(o.annotationId=i),o},e.is=function(e){let t=e;return t&&"rename"===t.kind&&Pe.string(t.oldUri)&&Pe.string(t.newUri)&&(void 0===t.options||(void 0===t.options.overwrite||Pe.boolean(t.options.overwrite))&&(void 0===t.options.ignoreIfExists||Pe.boolean(t.options.ignoreIfExists)))&&(void 0===t.annotationId||S.is(t.annotationId))}}(x||(x={})),function(e){e.create=function(e,t,n){let i={kind:"delete",uri:e};return void 0===t||void 0===t.recursive&&void 0===t.ignoreIfNotExists||(i.options=t),void 0!==n&&(i.annotationId=n),i},e.is=function(e){let t=e;return t&&"delete"===t.kind&&Pe.string(t.uri)&&(void 0===t.options||(void 0===t.options.recursive||Pe.boolean(t.options.recursive))&&(void 0===t.options.ignoreIfNotExists||Pe.boolean(t.options.ignoreIfNotExists)))&&(void 0===t.annotationId||S.is(t.annotationId))}}(K||(K={})),function(e){e.is=function(e){let t=e;return t&&(void 0!==t.changes||void 0!==t.documentChanges)&&(void 0===t.documentChanges||t.documentChanges.every((e=>Pe.string(e.kind)?C.is(e)||x.is(e)||K.is(e):D.is(e))))}}(O||(O={}));class Ce{constructor(e,t){this.edits=e,this.changeAnnotations=t}insert(e,t,n){let i,o;if(void 0===n?i=T.insert(e,t):S.is(n)?(o=n,i=w.insert(e,t,n)):(this.assertChangeAnnotations(this.changeAnnotations),o=this.changeAnnotations.manage(n),i=w.insert(e,t,o)),this.edits.push(i),void 0!==o)return o}replace(e,t,n){let i,o;if(void 0===n?i=T.replace(e,t):S.is(n)?(o=n,i=w.replace(e,t,n)):(this.assertChangeAnnotations(this.changeAnnotations),o=this.changeAnnotations.manage(n),i=w.replace(e,t,o)),this.edits.push(i),void 0!==o)return o}delete(e,t){let n,i;if(void 0===t?n=T.del(e):S.is(t)?(i=t,n=w.del(e,t)):(this.assertChangeAnnotations(this.changeAnnotations),i=this.changeAnnotations.manage(t),n=w.del(e,i)),this.edits.push(n),void 0!==i)return i}add(e){this.edits.push(e)}all(){return this.edits}clear(){this.edits.splice(0,this.edits.length)}assertChangeAnnotations(e){if(void 0===e)throw new Error("Text edit change is not configured to manage change annotations.")}}class xe{constructor(e){this._annotations=void 0===e?Object.create(null):e,this._counter=0,this._size=0}all(){return this._annotations}get size(){return this._size}manage(e,t){let n;if(S.is(e)?n=e:(n=this.nextId(),t=e),void 0!==this._annotations[n])throw new Error(`Id ${n} is already in use.`);if(void 0===t)throw new Error(`No annotation provided for id ${n}`);return this._annotations[n]=t,this._size++,n}nextId(){return this._counter++,this._counter.toString()}}class Ke{constructor(e){this._textEditChanges=Object.create(null),void 0!==e?(this._workspaceEdit=e,e.documentChanges?(this._changeAnnotations=new xe(e.changeAnnotations),e.changeAnnotations=this._changeAnnotations.all(),e.documentChanges.forEach((e=>{if(D.is(e)){const t=new Ce(e.edits,this._changeAnnotations);this._textEditChanges[e.textDocument.uri]=t}}))):e.changes&&Object.keys(e.changes).forEach((t=>{const n=new Ce(e.changes[t]);this._textEditChanges[t]=n}))):this._workspaceEdit={}}get edit(){return this.initDocumentChanges(),void 0!==this._changeAnnotations&&(0===this._changeAnnotations.size?this._workspaceEdit.changeAnnotations=void 0:this._workspaceEdit.changeAnnotations=this._changeAnnotations.all()),this._workspaceEdit}getTextEditChange(e){if(A.is(e)){if(this.initDocumentChanges(),void 0===this._workspaceEdit.documentChanges)throw new Error("Workspace edit is not configured for document changes.");const t={uri:e.uri,version:e.version};let n=this._textEditChanges[t.uri];if(!n){const e=[],i={textDocument:t,edits:e};this._workspaceEdit.documentChanges.push(i),n=new Ce(e,this._changeAnnotations),this._textEditChanges[t.uri]=n}return n}{if(this.initChanges(),void 0===this._workspaceEdit.changes)throw new Error("Workspace edit is not configured for normal text edit changes.");let t=this._textEditChanges[e];if(!t){let n=[];this._workspaceEdit.changes[e]=n,t=new Ce(n),this._textEditChanges[e]=t}return t}}initDocumentChanges(){void 0===this._workspaceEdit.documentChanges&&void 0===this._workspaceEdit.changes&&(this._changeAnnotations=new xe,this._workspaceEdit.documentChanges=[],this._workspaceEdit.changeAnnotations=this._changeAnnotations.all())}initChanges(){void 0===this._workspaceEdit.documentChanges&&void 0===this._workspaceEdit.changes&&(this._workspaceEdit.changes=Object.create(null))}createFile(e,t,n){if(this.initDocumentChanges(),void 0===this._workspaceEdit.documentChanges)throw new Error("Workspace edit is not configured for document changes.");let i,o,r;if(R.is(t)||S.is(t)?i=t:n=t,void 0===i?o=C.create(e,n):(r=S.is(i)?i:this._changeAnnotations.manage(i),o=C.create(e,n,r)),this._workspaceEdit.documentChanges.push(o),void 0!==r)return r}renameFile(e,t,n,i){if(this.initDocumentChanges(),void 0===this._workspaceEdit.documentChanges)throw new Error("Workspace edit is not configured for document changes.");let o,r,s;if(R.is(n)||S.is(n)?o=n:i=n,void 0===o?r=x.create(e,t,i):(s=S.is(o)?o:this._changeAnnotations.manage(o),r=x.create(e,t,i,s)),this._workspaceEdit.documentChanges.push(r),void 0!==s)return s}deleteFile(e,t,n){if(this.initDocumentChanges(),void 0===this._workspaceEdit.documentChanges)throw new Error("Workspace edit is not configured for document changes.");let i,o,r;if(R.is(t)||S.is(t)?i=t:n=t,void 0===i?o=K.create(e,n):(r=S.is(i)?i:this._changeAnnotations.manage(i),o=K.create(e,n,r)),this._workspaceEdit.documentChanges.push(o),void 0!==r)return r}}!function(e){e.create=function(e){return{uri:e}},e.is=function(e){let t=e;return Pe.defined(t)&&Pe.string(t.uri)}}(E||(E={})),function(e){e.create=function(e,t){return{uri:e,version:t}},e.is=function(e){let t=e;return Pe.defined(t)&&Pe.string(t.uri)&&Pe.integer(t.version)}}(P||(P={})),function(e){e.create=function(e,t){return{uri:e,version:t}},e.is=function(e){let t=e;return Pe.defined(t)&&Pe.string(t.uri)&&(null===t.version||Pe.integer(t.version))}}(A||(A={})),function(e){e.create=function(e,t,n,i){return{uri:e,languageId:t,version:n,text:i}},e.is=function(e){let t=e;return Pe.defined(t)&&Pe.string(t.uri)&&Pe.string(t.languageId)&&Pe.integer(t.version)&&Pe.string(t.text)}}(M||(M={})),function(e){e.PlainText="plaintext",e.Markdown="markdown",e.is=function(t){const n=t;return n===e.PlainText||n===e.Markdown}}(N||(N={})),function(e){e.is=function(e){const t=e;return Pe.objectLiteral(e)&&N.is(t.kind)&&Pe.string(t.value)}}(q||(q={})),function(e){e.Text=1,e.Method=2,e.Function=3,e.Constructor=4,e.Field=5,e.Variable=6,e.Class=7,e.Interface=8,e.Module=9,e.Property=10,e.Unit=11,e.Value=12,e.Enum=13,e.Keyword=14,e.Snippet=15,e.Color=16,e.File=17,e.Reference=18,e.Folder=19,e.EnumMember=20,e.Constant=21,e.Struct=22,e.Event=23,e.Operator=24,e.TypeParameter=25}(L||(L={})),function(e){e.PlainText=1,e.Snippet=2}(I||(I={})),function(e){e.Deprecated=1}(F||(F={})),function(e){e.create=function(e,t,n){return{newText:e,insert:t,replace:n}},e.is=function(e){const t=e;return t&&Pe.string(t.newText)&&c.is(t.insert)&&c.is(t.replace)}}(j||(j={})),function(e){e.asIs=1,e.adjustIndentation=2}(W||(W={})),function(e){e.is=function(e){const t=e;return t&&(Pe.string(t.detail)||void 0===t.detail)&&(Pe.string(t.description)||void 0===t.description)}}($||($={})),function(e){e.create=function(e){return{label:e}}}(U||(U={})),function(e){e.create=function(e,t){return{items:e||[],isIncomplete:!!t}}}(V||(V={})),function(e){e.fromPlainText=function(e){return e.replace(/[\\`*_{}[\]()#+\-.!]/g,"\\$&")},e.is=function(e){const t=e;return Pe.string(t)||Pe.objectLiteral(t)&&Pe.string(t.language)&&Pe.string(t.value)}}(B||(B={})),function(e){e.is=function(e){let t=e;return!!t&&Pe.objectLiteral(t)&&(q.is(t.contents)||B.is(t.contents)||Pe.typedArray(t.contents,B.is))&&(void 0===e.range||c.is(e.range))}}(H||(H={})),function(e){e.create=function(e,t){return t?{label:e,documentation:t}:{label:e}}}(z||(z={})),function(e){e.create=function(e,t,...n){let i={label:e};return Pe.defined(t)&&(i.documentation=t),Pe.defined(n)?i.parameters=n:i.parameters=[],i}}(G||(G={})),function(e){e.Text=1,e.Read=2,e.Write=3}(X||(X={})),function(e){e.create=function(e,t){let n={range:e};return Pe.number(t)&&(n.kind=t),n}}(Q||(Q={})),function(e){e.File=1,e.Module=2,e.Namespace=3,e.Package=4,e.Class=5,e.Method=6,e.Property=7,e.Field=8,e.Constructor=9,e.Enum=10,e.Interface=11,e.Function=12,e.Variable=13,e.Constant=14,e.String=15,e.Number=16,e.Boolean=17,e.Array=18,e.Object=19,e.Key=20,e.Null=21,e.EnumMember=22,e.Struct=23,e.Event=24,e.Operator=25,e.TypeParameter=26}(J||(J={})),function(e){e.Deprecated=1}(Y||(Y={})),function(e){e.create=function(e,t,n,i,o){let r={name:e,kind:t,location:{uri:i,range:n}};return o&&(r.containerName=o),r}}(Z||(Z={})),function(e){e.create=function(e,t,n,i){return void 0!==i?{name:e,kind:t,location:{uri:n,range:i}}:{name:e,kind:t,location:{uri:n}}}}(ee||(ee={})),function(e){e.create=function(e,t,n,i,o,r){let s={name:e,detail:t,kind:n,range:i,selectionRange:o};return void 0!==r&&(s.children=r),s},e.is=function(e){let t=e;return t&&Pe.string(t.name)&&Pe.number(t.kind)&&c.is(t.range)&&c.is(t.selectionRange)&&(void 0===t.detail||Pe.string(t.detail))&&(void 0===t.deprecated||Pe.boolean(t.deprecated))&&(void 0===t.children||Array.isArray(t.children))&&(void 0===t.tags||Array.isArray(t.tags))}}(te||(te={})),function(e){e.Empty="",e.QuickFix="quickfix",e.Refactor="refactor",e.RefactorExtract="refactor.extract",e.RefactorInline="refactor.inline",e.RefactorRewrite="refactor.rewrite",e.Source="source",e.SourceOrganizeImports="source.organizeImports",e.SourceFixAll="source.fixAll"}(ne||(ne={})),function(e){e.Invoked=1,e.Automatic=2}(ie||(ie={})),function(e){e.create=function(e,t,n){let i={diagnostics:e};return null!=t&&(i.only=t),null!=n&&(i.triggerKind=n),i},e.is=function(e){let t=e;return Pe.defined(t)&&Pe.typedArray(t.diagnostics,v.is)&&(void 0===t.only||Pe.typedArray(t.only,Pe.string))&&(void 0===t.triggerKind||t.triggerKind===ie.Invoked||t.triggerKind===ie.Automatic)}}(oe||(oe={})),function(e){e.create=function(e,t,n){let i={title:e},o=!0;return"string"==typeof t?(o=!1,i.kind=t):k.is(t)?i.command=t:i.edit=t,o&&void 0!==n&&(i.kind=n),i},e.is=function(e){let t=e;return t&&Pe.string(t.title)&&(void 0===t.diagnostics||Pe.typedArray(t.diagnostics,v.is))&&(void 0===t.kind||Pe.string(t.kind))&&(void 0!==t.edit||void 0!==t.command)&&(void 0===t.command||k.is(t.command))&&(void 0===t.isPreferred||Pe.boolean(t.isPreferred))&&(void 0===t.edit||O.is(t.edit))}}(re||(re={})),function(e){e.create=function(e,t){let n={range:e};return Pe.defined(t)&&(n.data=t),n},e.is=function(e){let t=e;return Pe.defined(t)&&c.is(t.range)&&(Pe.undefined(t.command)||k.is(t.command))}}(se||(se={})),function(e){e.create=function(e,t){return{tabSize:e,insertSpaces:t}},e.is=function(e){let t=e;return Pe.defined(t)&&Pe.uinteger(t.tabSize)&&Pe.boolean(t.insertSpaces)}}(ae||(ae={})),function(e){e.create=function(e,t,n){return{range:e,target:t,data:n}},e.is=function(e){let t=e;return Pe.defined(t)&&c.is(t.range)&&(Pe.undefined(t.target)||Pe.string(t.target))}}(ce||(ce={})),function(e){e.create=function(e,t){return{range:e,parent:t}},e.is=function(t){let n=t;return Pe.objectLiteral(n)&&c.is(n.range)&&(void 0===n.parent||e.is(n.parent))}}(le||(le={})),function(e){e.namespace="namespace",e.type="type",e.class="class",e.enum="enum",e.interface="interface",e.struct="struct",e.typeParameter="typeParameter",e.parameter="parameter",e.variable="variable",e.property="property",e.enumMember="enumMember",e.event="event",e.function="function",e.method="method",e.macro="macro",e.keyword="keyword",e.modifier="modifier",e.comment="comment",e.string="string",e.number="number",e.regexp="regexp",e.operator="operator",e.decorator="decorator"}(de||(de={})),function(e){e.declaration="declaration",e.definition="definition",e.readonly="readonly",e.static="static",e.deprecated="deprecated",e.abstract="abstract",e.async="async",e.modification="modification",e.documentation="documentation",e.defaultLibrary="defaultLibrary"}(ue||(ue={})),function(e){e.is=function(e){const t=e;return Pe.objectLiteral(t)&&(void 0===t.resultId||"string"==typeof t.resultId)&&Array.isArray(t.data)&&(0===t.data.length||"number"==typeof t.data[0])}}(fe||(fe={})),function(e){e.create=function(e,t){return{range:e,text:t}},e.is=function(e){const t=e;return null!=t&&c.is(t.range)&&Pe.string(t.text)}}(pe||(pe={})),function(e){e.create=function(e,t,n){return{range:e,variableName:t,caseSensitiveLookup:n}},e.is=function(e){const t=e;return null!=t&&c.is(t.range)&&Pe.boolean(t.caseSensitiveLookup)&&(Pe.string(t.variableName)||void 0===t.variableName)}}(he||(he={})),function(e){e.create=function(e,t){return{range:e,expression:t}},e.is=function(e){const t=e;return null!=t&&c.is(t.range)&&(Pe.string(t.expression)||void 0===t.expression)}}(ge||(ge={})),function(e){e.create=function(e,t){return{frameId:e,stoppedLocation:t}},e.is=function(e){const t=e;return Pe.defined(t)&&c.is(e.stoppedLocation)}}(me||(me={})),function(e){e.Type=1,e.Parameter=2,e.is=function(e){return 1===e||2===e}}(ye||(ye={})),function(e){e.create=function(e){return{value:e}},e.is=function(e){const t=e;return Pe.objectLiteral(t)&&(void 0===t.tooltip||Pe.string(t.tooltip)||q.is(t.tooltip))&&(void 0===t.location||l.is(t.location))&&(void 0===t.command||k.is(t.command))}}(_e||(_e={})),function(e){e.create=function(e,t,n){const i={position:e,label:t};return void 0!==n&&(i.kind=n),i},e.is=function(e){const t=e;return Pe.objectLiteral(t)&&a.is(t.position)&&(Pe.string(t.label)||Pe.typedArray(t.label,_e.is))&&(void 0===t.kind||ye.is(t.kind))&&void 0===t.textEdits||Pe.typedArray(t.textEdits,T.is)&&(void 0===t.tooltip||Pe.string(t.tooltip)||q.is(t.tooltip))&&(void 0===t.paddingLeft||Pe.boolean(t.paddingLeft))&&(void 0===t.paddingRight||Pe.boolean(t.paddingRight))}}(be||(be={})),function(e){e.createSnippet=function(e){return{kind:"snippet",value:e}}}(ve||(ve={})),function(e){e.create=function(e,t,n,i){return{insertText:e,filterText:t,range:n,command:i}}}(ke||(ke={})),function(e){e.create=function(e){return{items:e}}}(Te||(Te={})),function(e){e.Invoked=0,e.Automatic=1}(Re||(Re={})),function(e){e.create=function(e,t){return{range:e,text:t}}}(Se||(Se={})),function(e){e.create=function(e,t){return{triggerKind:e,selectedCompletionInfo:t}}}(we||(we={})),function(e){e.is=function(e){const t=e;return Pe.objectLiteral(t)&&o.is(t.uri)&&Pe.string(t.name)}}(De||(De={}));const Oe=["\n","\r\n","\r"];var Ee,Pe;!function(e){function t(e,n){if(e.length<=1)return e;const i=e.length/2|0,o=e.slice(0,i),r=e.slice(i);t(o,n),t(r,n);let s=0,a=0,c=0;for(;s<o.length&&a<r.length;){let t=n(o[s],r[a]);e[c++]=t<=0?o[s++]:r[a++]}for(;s<o.length;)e[c++]=o[s++];for(;a<r.length;)e[c++]=r[a++];return e}e.create=function(e,t,n,i){return new Ae(e,t,n,i)},e.is=function(e){let t=e;return!!(Pe.defined(t)&&Pe.string(t.uri)&&(Pe.undefined(t.languageId)||Pe.string(t.languageId))&&Pe.uinteger(t.lineCount)&&Pe.func(t.getText)&&Pe.func(t.positionAt)&&Pe.func(t.offsetAt))},e.applyEdits=function(e,n){let i=e.getText(),o=t(n,((e,t)=>{let n=e.range.start.line-t.range.start.line;return 0===n?e.range.start.character-t.range.start.character:n})),r=i.length;for(let t=o.length-1;t>=0;t--){let n=o[t],s=e.offsetAt(n.range.start),a=e.offsetAt(n.range.end);if(!(a<=r))throw new Error("Overlapping edit");i=i.substring(0,s)+n.newText+i.substring(a,i.length),r=s}return i}}(Ee||(Ee={}));class Ae{constructor(e,t,n,i){this._uri=e,this._languageId=t,this._version=n,this._content=i,this._lineOffsets=void 0}get uri(){return this._uri}get languageId(){return this._languageId}get version(){return this._version}getText(e){if(e){let t=this.offsetAt(e.start),n=this.offsetAt(e.end);return this._content.substring(t,n)}return this._content}update(e,t){this._content=e.text,this._version=t,this._lineOffsets=void 0}getLineOffsets(){if(void 0===this._lineOffsets){let e=[],t=this._content,n=!0;for(let i=0;i<t.length;i++){n&&(e.push(i),n=!1);let o=t.charAt(i);n="\r"===o||"\n"===o,"\r"===o&&i+1<t.length&&"\n"===t.charAt(i+1)&&i++}n&&t.length>0&&e.push(t.length),this._lineOffsets=e}return this._lineOffsets}positionAt(e){e=Math.max(Math.min(e,this._content.length),0);let t=this.getLineOffsets(),n=0,i=t.length;if(0===i)return a.create(0,e);for(;n<i;){let o=Math.floor((n+i)/2);t[o]>e?i=o:n=o+1}let o=n-1;return a.create(o,e-t[o])}offsetAt(e){let t=this.getLineOffsets();if(e.line>=t.length)return this._content.length;if(e.line<0)return 0;let n=t[e.line],i=e.line+1<t.length?t[e.line+1]:this._content.length;return Math.max(Math.min(n+e.character,i),n)}get lineCount(){return this.getLineOffsets().length}}!function(e){const t=Object.prototype.toString;e.defined=function(e){return void 0!==e},e.undefined=function(e){return void 0===e},e.boolean=function(e){return!0===e||!1===e},e.string=function(e){return"[object String]"===t.call(e)},e.number=function(e){return"[object Number]"===t.call(e)},e.numberRange=function(e,n,i){return"[object Number]"===t.call(e)&&n<=e&&e<=i},e.integer=function(e){return"[object Number]"===t.call(e)&&-2147483648<=e&&e<=2147483647},e.uinteger=function(e){return"[object Number]"===t.call(e)&&0<=e&&e<=2147483647},e.func=function(e){return"[object Function]"===t.call(e)},e.objectLiteral=function(e){return null!==e&&"object"==typeof e},e.typedArray=function(e,t){return Array.isArray(e)&&e.every(t)}}(Pe||(Pe={}))}},t={};function n(i){var o=t[i];if(void 0!==o)return o.exports;var r=t[i]={exports:{}};return e[i].call(r.exports,r,r.exports,n),r.exports}n.d=(e,t)=>{for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var i={};(()=>{"use strict";var e=i;Object.defineProperty(e,"__esModule",{value:!0});const t=n(1727),o=n(429),r=n(3939),s=new o.BrowserMessageReader(self),a=new o.BrowserMessageWriter(self),c=new o.TextDocuments(t.TextDocument),l=(0,r.set_Connection)((0,o.createConnection)(s,a));let d=!1,u=!1,f="",p=new Set;l.onInitialize((e=>{const t=e.capabilities;d=!(!t.workspace||!t.workspace.configuration),u=!(!t.workspace||!t.workspace.workspaceFolders);const n={serverInfo:{name:"ahk2-language-server"},capabilities:{textDocumentSync:{change:o.TextDocumentSyncKind.Incremental,openClose:!0},completionProvider:{resolveProvider:!1,triggerCharacters:[".","#","*","@"]},signatureHelpProvider:{triggerCharacters:["(",","]},documentSymbolProvider:!0,definitionProvider:!0,documentFormattingProvider:!0,documentRangeFormattingProvider:!0,documentOnTypeFormattingProvider:{firstTriggerCharacter:"}",moreTriggerCharacter:["\n",...Object.keys(r.chinese_punctuations)]},executeCommandProvider:{commands:["ahk2.diagnostic.full","ahk2.generate.comment"]},hoverProvider:!0,foldingRangeProvider:!0,colorProvider:!0,renameProvider:{prepareProvider:!0},referencesProvider:{workDoneProgress:!0},semanticTokensProvider:{legend:{tokenTypes:(0,r.enumNames)(r.SemanticTokenTypes),tokenModifiers:(0,r.enumNames)(r.SemanticTokenModifiers)},full:!0,range:!0},workspaceSymbolProvider:!0}};u&&(e.workspaceFolders?.forEach((e=>p.add(e.uri.toLowerCase()+"/"))),n.capabilities.workspace={workspaceFolders:{supported:!0}});const i=e.initializationOptions;return(0,r.set_ahk_h)(!0),(0,r.set_locale)(e.locale),(0,r.set_dirname)(i.extensionUri),(0,r.loadlocalize)(),(0,r.update_settings)(i),(0,r.set_WorkspaceFolders)(p),(0,r.set_version)("3.0.0"),(0,r.initahk2cache)(),(0,r.loadahk2)(),(0,r.loadahk2)("ahk2_h"),(0,r.loadahk2)("winapi",4),n})),l.onInitialized((()=>{d&&l.client.register(o.DidChangeConfigurationNotification.type),u&&l.workspace.onDidChangeWorkspaceFolders((e=>{e.removed.forEach((e=>p.delete(e.uri.toLowerCase()+"/"))),e.added.forEach((e=>p.add(e.uri.toLowerCase()+"/"))),(0,r.set_WorkspaceFolders)(p)}))})),l.onDidChangeConfiguration((async e=>{let t=e?.settings;d&&!t&&(t=await l.workspace.getConfiguration("AutoHotkey2")),t?((0,r.update_settings)(t),(0,r.set_WorkspaceFolders)(p)):l.window.showWarningMessage("Failed to obtain the configuration")})),c.onDidOpen((e=>{let t=f===e.document.uri,n=e.document.uri.toLowerCase(),i=r.lexers[n];i?i.document=e.document:r.lexers[n]=i=new r.Lexer(e.document),i.actived=!0,t&&(i.actionwhenv1="Continue")})),c.onDidClose((e=>r.lexers[e.document.uri.toLowerCase()]?.close())),c.onDidChangeContent((e=>r.lexers[e.document.uri.toLowerCase()].update())),l.onCompletion(r.completionProvider),l.onColorPresentation(r.colorPresentation),l.onDocumentColor(r.colorProvider),l.onDefinition(r.defintionProvider),l.onDocumentFormatting(r.documentFormatting),l.onDocumentRangeFormatting(r.rangeFormatting),l.onDocumentOnTypeFormatting(r.typeFormatting),l.onDocumentSymbol(r.symbolProvider),l.onFoldingRanges((e=>r.lexers[e.textDocument.uri.toLowerCase()].foldingranges)),l.onHover(r.hoverProvider),l.onPrepareRename(r.prepareRename),l.onReferences(r.referenceProvider),l.onRenameRequest(r.renameProvider),l.onSignatureHelp(r.signatureProvider),l.onExecuteCommand((async function(e){switch(e.arguments,e.command){case"ahk2.diagnostic.full":(0,r.diagnosticFull)();break;case"ahk2.generate.comment":(0,r.generateComment)()}})),l.onWorkspaceSymbol(r.workspaceSymbolProvider),l.languages.semanticTokens.on(r.semanticTokensOnFull),l.languages.semanticTokens.onRange(r.semanticTokensOnRange),l.onRequest("ahk2.exportSymbols",r.exportSymbols),l.onRequest("ahk2.getContent",(e=>r.lexers[e.toLowerCase()]?.document.getText())),l.onRequest("ahk2.getVersionInfo",(e=>{let t=r.lexers[e.toLowerCase()];if(t){let n=t.get_token(0);if(("TK_BLOCK_COMMENT"===n.type||""===n.type)&&n.content.match(/^\s*[;*]?\s*@(date|version)\b/im))return{uri:e,content:n.content,range:{start:t.document.positionAt(n.offset),end:t.document.positionAt(n.offset+n.length)}}}return null})),l.onNotification("onDidCloseTextDocument",(e=>{"ahk2"===e.id?r.lexers[e.uri.toLowerCase()]?.close(!0):f=e.uri})),c.listen(l),l.listen()})(),serverExportVar=i})();